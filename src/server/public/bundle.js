/*! For license information please see bundle.js.LICENSE.txt */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=309)}([function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return l}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function l(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||t)}Object.create},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"h",(function(){return a})),n.d(t,"k",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"m",(function(){return f})),n.d(t,"l",(function(){return h})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"n",(function(){return m})),n.d(t,"c",(function(){return y}));var r=function(){},i=function(){},o=function(){},a=function(){},s=function(){},c=function(){},u=function(){},l=function(){},f=function(){},h=function(){},d=function(){},p=function(){},m=function(){},y=function(){}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(38),t),i(n(257),t),i(n(68),t),i(n(152),t),i(n(515),t),i(n(120),t),i(n(259),t),i(n(258),t),i(n(516),t),i(n(518),t),i(n(519),t),i(n(521),t),i(n(204),t),i(n(522),t),i(n(121),t),i(n(107),t),i(n(524),t),i(n(261),t),i(n(205),t),i(n(262),t),i(n(263),t),i(n(264),t),i(n(153),t),i(n(253),t),i(n(265),t),i(n(527),t),i(n(201),t),i(n(255),t),i(n(63),t),i(n(529),t),i(n(211),t),i(n(139),t),i(n(64),t),i(n(267),t),i(n(530),t),i(n(531),t),i(n(268),t),i(n(256),t),i(n(200),t),i(n(22),t),i(n(533),t),i(n(534),t),i(n(11),t),i(n(535),t),i(n(269),t),i(n(537),t),i(n(126),t),i(n(538),t),i(n(270),t),i(n(539),t),i(n(69),t),i(n(260),t),i(n(31),t),i(n(43),t),i(n(271),t)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e,t){this.query=e,this.parameters=t}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(16),t),i(n(111),t),i(n(4),t)},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Helper=void 0;const i=n(42);class o{static isNull(e,...t){return o.isAllNull(...arguments)}static isAllNull(...e){for(let t=0;t<e.length;t++)if(null!==e[t]&&void 0!==e[t])return!1;return!0}static isAtLeastOneNull(...e){return!o.isAllNull(...e)}static isNotNull(e,...t){return o.isAllNotNull(...arguments)}static isAllNotNull(...e){for(let t=0;t<e.length;t++)if(null===e[t]||void 0===e[t])return!1;return!0}static isAtLeastOneNotNull(...e){return!o.isAllNull(...e)}static nonNull(e,t,...n){for(let e=0;e<arguments.length;e++)if(o.isNotNull(arguments[e]))return arguments[e];return null}static isSet(e,...t){return!!o.isNotNull(e)&&(0===t.length||o.isSet.apply(null,[e[t[0]]].concat(t.slice(1))))}static empty(e){return o.isNull(e)||"string"==typeof e&&""===e.trim()}static notEmpty(e){return!o.empty(e)}static arrayToObject(e,t){let n={};return e.forEach((e=>{n[t(e)]=e})),n}static cloneJson(e){return i.JsonHelper.deepCopy(e)}static formDataFromObject(e){let t=new FormData;for(let n in e)t.set(n,e[n]);return t}static shuffleArray(e){let t,n,r=e.length;for(;0!==r;)n=Math.floor(Math.random()*r),r-=1,t=e[r],e[r]=e[n],e[n]=t;return e}static padZero(e,t,n){return n=o.nonNull(n,"0"),e+="",t=o.nonNull(t,1),e.length>=t?e:new Array(t-e.length+1).join(n)+e}static deepEqual(e,t){if(e===t)return!0;if("object"==typeof e&&"object"==typeof t){let n=Object.keys(t);return Object.keys(e).every((r=>{let i=n.indexOf(r);return!(i<0)&&(n.splice(i,1),o.deepEqual(e[r],t[r]))}))&&0===n.length}return!1}static htmlspecialcharsDecode(e){const t={"&amp;":"&","&#038;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#039;":"'","&#8217;":"’","&#8216;":"‘","&#8211;":"–","&#8212;":"—","&#8230;":"…","&#8221;":"”"};return o.isNotNull(e)&&"function"==typeof e.replace?e.replace(/\&[\w\d\#]{2,5}\;/g,(function(e){return t[e]})):e}static invertKeyValues(e){let t={};for(let n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}static asyncForEach(e,t,n){return r(this,void 0,void 0,(function*(){n=o.nonNull(n,!1);let r=[];for(let i=0;i<e.length;i++){let o=i,a=Promise.resolve(t(e[o],o,e));n||(yield a),r.push(a)}return Promise.all(r)}))}static escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}static objectForEach(e,t){Object.keys(e).forEach((n=>{t(e[n],n,e)}))}static toArray(e){let t=[];for(let n in e)t.push(e[n]);return t}static imageUrlIsEmpty(e){return o.isNull(e)||""===e.trim()||"data:"===e.trim()}static newPromiseWithResolve(){let e=null,t=null,n=new Promise(((n,r)=>{e=n,t=r}));return n.resolve=e,n.reject=t,n}static isMobileApp(){return"undefined"!=typeof device&&"browser"!==device.platform}static toSnakeCase(e){return e.replace(/([A-Z])/g,(function(e,t,n){return(n>0?"_":"")+e[0].toLowerCase()}))}static wait(e,t){return r(this,void 0,void 0,(function*(){return new Promise((n=>{setTimeout((()=>{n(t)}),e)}))}))}static timeout(e,t,n){return r(this,void 0,void 0,(function*(){return Promise.race([t,o.wait(e).then((()=>void 0===n?Promise.reject():n))])}))}}t.Helper=o},function(e,t,n){var r=n(17),i=n(33),o=n(61),a=n(54),s=n(75),c=function(e,t,n){var u,l,f,h,d=e&c.F,p=e&c.G,m=e&c.S,y=e&c.P,g=e&c.B,b=p?r:m?r[t]||(r[t]={}):(r[t]||{}).prototype,v=p?i:i[t]||(i[t]={}),w=v.prototype||(v.prototype={});for(u in p&&(n=t),n)f=((l=!d&&b&&void 0!==b[u])?b:n)[u],h=g&&l?s(f,r):y&&"function"==typeof f?s(Function.call,f):f,b&&a(b,u,f,e&c.U),v[u]!=f&&o(v,u,h),y&&w[u]!=f&&(w[u]=f)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(496),t),i(n(28),t),i(n(5),t),i(n(42),t),i(n(24),t),i(n(507),t),i(n(508),t),i(n(509),t),i(n(252),t)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(32),i=n(48),o=n(58),a=n(131),s=n(40),c=n(52),u=n(70),l=function(){function e(e){this.columns=[],this.indices=[],this.foreignKeys=[],this.uniques=[],this.checks=[],this.exclusions=[],this.justCreated=!1,e&&(this.name=e.name,e.columns&&(this.columns=e.columns.map((function(e){return new r.a(e)}))),e.indices&&(this.indices=e.indices.map((function(e){return new i.a(e)}))),e.foreignKeys&&(this.foreignKeys=e.foreignKeys.map((function(e){return new o.a(e)}))),e.uniques&&(this.uniques=e.uniques.map((function(e){return new s.a(e)}))),e.checks&&(this.checks=e.checks.map((function(e){return new c.a(e)}))),e.exclusions&&(this.exclusions=e.exclusions.map((function(e){return new u.a(e)}))),void 0!==e.justCreated&&(this.justCreated=e.justCreated),this.engine=e.engine)}return Object.defineProperty(e.prototype,"primaryColumns",{get:function(){return this.columns.filter((function(e){return e.isPrimary}))},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e({name:this.name,columns:this.columns.map((function(e){return e.clone()})),indices:this.indices.map((function(e){return e.clone()})),foreignKeys:this.foreignKeys.map((function(e){return e.clone()})),uniques:this.uniques.map((function(e){return e.clone()})),checks:this.checks.map((function(e){return e.clone()})),exclusions:this.exclusions.map((function(e){return e.clone()})),justCreated:this.justCreated,engine:this.engine})},e.prototype.addColumn=function(e){this.columns.push(e)},e.prototype.removeColumn=function(e){var t=this.columns.find((function(t){return t.name===e.name}));t&&this.columns.splice(this.columns.indexOf(t),1)},e.prototype.addUniqueConstraint=function(e){if(this.uniques.push(e),1===e.columnNames.length){var t=this.columns.find((function(t){return t.name===e.columnNames[0]}));t&&(t.isUnique=!0)}},e.prototype.removeUniqueConstraint=function(e){var t=this.uniques.find((function(t){return t.name===e.name}));if(t&&(this.uniques.splice(this.uniques.indexOf(t),1),1===t.columnNames.length)){var n=this.columns.find((function(e){return e.name===t.columnNames[0]}));n&&(n.isUnique=!1)}},e.prototype.addCheckConstraint=function(e){this.checks.push(e)},e.prototype.removeCheckConstraint=function(e){var t=this.checks.find((function(t){return t.name===e.name}));t&&this.checks.splice(this.checks.indexOf(t),1)},e.prototype.addExclusionConstraint=function(e){this.exclusions.push(e)},e.prototype.removeExclusionConstraint=function(e){var t=this.exclusions.find((function(t){return t.name===e.name}));t&&this.exclusions.splice(this.exclusions.indexOf(t),1)},e.prototype.addForeignKey=function(e){this.foreignKeys.push(e)},e.prototype.removeForeignKey=function(e){var t=this.foreignKeys.find((function(t){return t.name===e.name}));t&&this.foreignKeys.splice(this.foreignKeys.indexOf(t),1)},e.prototype.addIndex=function(e,t){if(void 0===t&&(t=!1),this.indices.push(e),1===e.columnNames.length&&e.isUnique&&t){var n=this.columns.find((function(t){return t.name===e.columnNames[0]}));n&&(n.isUnique=!0)}},e.prototype.removeIndex=function(e,t){void 0===t&&(t=!1);var n=this.indices.find((function(t){return t.name===e.name}));if(n&&(this.indices.splice(this.indices.indexOf(n),1),1===n.columnNames.length&&n.isUnique&&t)){var r=this.columns.find((function(e){return e.name===n.columnNames[0]}));r&&(r.isUnique=this.indices.some((function(e){return 1===e.columnNames.length&&e.columnNames[0]===r.name&&!!n.isUnique})))}},e.prototype.findColumnByName=function(e){return this.columns.find((function(t){return t.name===e}))},e.prototype.findColumnIndices=function(e){return this.indices.filter((function(t){return!!t.columnNames.find((function(t){return t===e.name}))}))},e.prototype.findColumnForeignKeys=function(e){return this.foreignKeys.filter((function(t){return!!t.columnNames.find((function(t){return t===e.name}))}))},e.prototype.findColumnUniques=function(e){return this.uniques.filter((function(t){return!!t.columnNames.find((function(t){return t===e.name}))}))},e.prototype.findColumnChecks=function(e){return this.checks.filter((function(t){return!!t.columnNames.find((function(t){return t===e.name}))}))},e.create=function(t,n){return new e({name:n.buildTableName(t.tableName,t.schema,t.database),engine:t.engine,columns:t.columns.filter((function(e){return e})).map((function(e){return a.a.createTableColumnOptions(e,n)})),indices:t.indices.filter((function(e){return!0===e.synchronize})).map((function(e){return i.a.create(e)})),uniques:t.uniques.map((function(e){return s.a.create(e)})),checks:t.checks.map((function(e){return c.a.create(e)})),exclusions:t.exclusions.map((function(e){return u.a.create(e)}))})},e}()},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var r=n(0),i=function(){function t(){}return t.chunk=function(e,t){return Array.from(Array(Math.ceil(e.length/t)),(function(n,r){return e.slice(r*t,r*t+t)}))},t.splitClassesAndStrings=function(e){return[e.filter((function(e){return"string"!=typeof e})),e.filter((function(e){return"string"==typeof e}))]},t.groupBy=function(e,t){return e.reduce((function(e,n){var r=t(n),i=e.find((function(e){return e.id===r}));return i||(i={id:r,items:[]},e.push(i)),i.items.push(n),e}),[])},t.uniq=function(e,t){return e.reduce((function(e,n){var r=!1;if(t instanceof Function){var i=t(n);r=!!e.find((function(e){return t(e)===i}))}else r="string"==typeof t?!!e.find((function(e){return e[t]===n[t]})):-1!==e.indexOf(n);return r||e.push(n),e}),[])},t.isObject=function(e){return e&&"object"==typeof e&&!Array.isArray(e)},t.mergeDeep=function(t){for(var n,i,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];if(!o.length)return t;var s=o.shift();if(this.isObject(t)&&this.isObject(s))for(var c in s){var u=s[c];"__proto__"===c||u instanceof Promise||(!this.isObject(u)||u instanceof Map||u instanceof Set||u instanceof Date||u instanceof e||u instanceof RegExp?Object.assign(t,((i={})[c]=u,i)):(t[c]||Object.assign(t,((n={})[c]=Object.create(Object.getPrototypeOf(u)),n)),this.mergeDeep(t[c],u)))}return this.mergeDeep.apply(this,Object(r.f)([t],Object(r.e)(o)))},t.deepCompare=function(){for(var e,t,n,r,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];if(arguments.length<1)return!0;for(e=1,t=arguments.length;e<t;e++)if(n=[],r=[],!this.compare2Objects(n,r,arguments[0],arguments[e]))return!1;return!0},t.compareIds=function(e,n){return null!=e&&null!=n&&(("string"==typeof e.id&&"string"==typeof n.id||"number"==typeof e.id&&"number"==typeof n.id)&&1===Object.keys(e).length&&1===Object.keys(n).length?e.id===n.id:t.deepCompare(e,n))},t.toBoolean=function(e){return"boolean"==typeof e?e:"string"==typeof e?"true"===e||"1"===e:"number"==typeof e&&e>0},t.zipObject=function(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})},t.isArraysEqual=function(e,t){return e.length===t.length&&e.every((function(e){return-1!==t.indexOf(e)}))},t.compare2Objects=function(e,t,n,r){var i;if(Number.isNaN(n)&&Number.isNaN(r))return!0;if(n===r)return!0;if(null===n||null===r||void 0===n||void 0===r)return!1;if(("function"==typeof n.equals||n.equals instanceof Function)&&n.equals(r))return!0;if("function"==typeof n&&"function"==typeof r||n instanceof Date&&r instanceof Date||n instanceof RegExp&&r instanceof RegExp||n instanceof String&&r instanceof String||n instanceof Number&&r instanceof Number)return n.toString()===r.toString();if(!(n instanceof Object&&r instanceof Object))return!1;if(n.isPrototypeOf(r)||r.isPrototypeOf(n))return!1;if(n.constructor!==r.constructor)return!1;if(n.prototype!==r.prototype)return!1;if(e.indexOf(n)>-1||t.indexOf(r)>-1)return!1;for(i in r){if(r.hasOwnProperty(i)!==n.hasOwnProperty(i))return!1;if(typeof r[i]!=typeof n[i])return!1}for(i in n){if(r.hasOwnProperty(i)!==n.hasOwnProperty(i))return!1;if(typeof r[i]!=typeof n[i])return!1;switch(typeof n[i]){case"object":case"function":if(e.push(n),t.push(r),!this.compare2Objects(e,t,n[i],r[i]))return!1;e.pop(),t.pop();break;default:if(n[i]!==r[i])return!1}}return!0},t}()}).call(this,n(106).Buffer)},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(39),t),i(n(276),t),i(n(81),t),i(n(549),t)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NativeStoragePromise=void 0;var a=n(5),s=n(42),c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,c;return t=e,c=[{key:"_isElectron",value:function(){return"object"===("undefined"==typeof navigator?"undefined":r(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}},{key:"setItem",value:function(e,t){return o(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.persistent){n.next=8;break}if(!this._isElectron()){n.next=5;break}return n.abrupt("return",new Promise((function(n,i){return r.electronStorage.set(r.prefix+e,t,(function(e){e?i(e):n()}))})));case 5:return n.abrupt("return",new Promise((function(n,i){return NativeStorage.setItem(r.prefix+e,t,n,i)})));case 6:n.next=9;break;case 8:this._cache[this.prefix+e]=t;case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getItem",value:function(e,t){return o(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,i){r._isElectron()?r.electronStorage.get(r.prefix+e,(function(i,o){n(i?a.Helper.nonNull(r._cache[r.prefix+e],t):s.JsonHelper.deepEqual(o,{})?t:o)})):NativeStorage.getItem(r.prefix+e,(function(e){return n(a.Helper.nonNull(e,t))}),(function(i){n(a.Helper.nonNull(r._cache[r.prefix+e],t))}))})));case 1:case"end":return n.stop()}}),n)})))}},{key:"keys",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!this.persistent){e.next=13;break}if(!this._isElectron()){e.next=8;break}return e.next=5,new Promise((function(e,t){return n.electronStorage.keys((function(n,r){n?t(n):e(r)}))}));case 5:t=e.sent,e.next=11;break;case 8:return e.next=10,new Promise((function(e,t){return NativeStorage.keys(e,t)}));case 10:t=e.sent;case 11:e.next=14;break;case 13:t=Object.keys(this._cache);case 14:return e.abrupt("return",t.filter((function(e){return e.startsWith(n.prefix)})));case 15:case"end":return e.stop()}}),e,this)})))}},{key:"remove",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(delete this._cache[this.prefix+e],!this._isElectron()){t.next=5;break}return t.abrupt("return",new Promise((function(t,r){return n.electronStorage.remove(n.prefix+e,(function(e){e?r(e):t()}))})));case 5:return t.abrupt("return",new Promise((function(t,r){return NativeStorage.remove(n.prefix+e,t,r)})));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"clear",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.keys();case 2:return t=e.sent,e.next=5,a.Helper.asyncForEach(t,(function(e){return o(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.remove(e);case 2:case"end":return t.stop()}}),t,this)})))}),!0);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"makePersistent",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistent){e.next=4;break}return this.persistent=!0,e.next=4,a.Helper.asyncForEach(Object.keys(this._cache),(function(e){return o(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setItem(e,this._cache[e]);case 2:case"end":return t.stop()}}),t,this)})))}),!0);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"makeUnpersistent",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.persistent){e.next=10;break}return e.next=3,this.keys();case 3:return t=e.sent,n={},e.next=7,a.Helper.asyncForEach(t,(function(e){return o(r,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getItem(e);case 2:n[e]=t.sent;case 3:case"end":return t.stop()}}),t,this)})))}));case 7:this.clear(),this.persistent=!1,this._cache=n;case 10:case"end":return e.stop()}}),e,this)})))}}],(n=null)&&i(t.prototype,n),c&&i(t,c),e}();t.NativeStoragePromise=c,c._cache={},c.prefix="",c.persistent=!0,c.electronStorage=null},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){this.count=0,this.promises=[]}},function(e,t,n){"use strict";n.r(t),n.d(t,"useContainer",(function(){return Nt})),n.d(t,"getFromContainer",(function(){return Mt})),n.d(t,"CannotReflectMethodParameterTypeError",(function(){return Ge})),n.d(t,"AlreadyHasActiveConnectionError",(function(){return Je})),n.d(t,"SubjectWithoutIdentifierError",(function(){return K})),n.d(t,"CannotConnectAlreadyConnectedError",(function(){return u})),n.d(t,"LockNotSupportedOnGivenDriverError",(function(){return Ke.a})),n.d(t,"ConnectionIsNotSetError",(function(){return $e})),n.d(t,"CannotCreateEntityIdMapError",(function(){return Xe.a})),n.d(t,"MetadataAlreadyExistsError",(function(){return Ze})),n.d(t,"CannotDetermineEntityError",(function(){return oe})),n.d(t,"UpdateValuesMissingError",(function(){return et.a})),n.d(t,"TreeRepositoryNotSupportedError",(function(){return H})),n.d(t,"CustomRepositoryNotFoundError",(function(){return D})),n.d(t,"TransactionNotStartedError",(function(){return Me.a})),n.d(t,"TransactionAlreadyStartedError",(function(){return Ne.a})),n.d(t,"EntityNotFoundError",(function(){return O.a})),n.d(t,"EntityMetadataNotFoundError",(function(){return l})),n.d(t,"MustBeEntityError",(function(){return z})),n.d(t,"OptimisticLockVersionMismatchError",(function(){return tt.a})),n.d(t,"LimitOnUpdateNotSupportedError",(function(){return nt.a})),n.d(t,"PrimaryColumnCannotBeNullableError",(function(){return rt})),n.d(t,"CustomRepositoryCannotInheritRepositoryError",(function(){return F})),n.d(t,"QueryRunnerProviderAlreadyReleasedError",(function(){return E})),n.d(t,"CannotAttachTreeChildrenEntityError",(function(){return te})),n.d(t,"CustomRepositoryDoesNotHaveEntityError",(function(){return L})),n.d(t,"MissingDeleteDateColumnError",(function(){return it.a})),n.d(t,"NoConnectionForRepositoryError",(function(){return ot})),n.d(t,"CircularRelationsError",(function(){return y})),n.d(t,"ReturningStatementNotSupportedError",(function(){return at.a})),n.d(t,"UsingJoinTableIsNotAllowedError",(function(){return st})),n.d(t,"MissingJoinColumnError",(function(){return ct})),n.d(t,"MissingPrimaryColumnError",(function(){return m})),n.d(t,"EntityColumnNotFound",(function(){return ut.a})),n.d(t,"MissingDriverError",(function(){return ve})),n.d(t,"DriverPackageNotInstalledError",(function(){return xe.a})),n.d(t,"CannotGetEntityManagerNotConnectedError",(function(){return lt})),n.d(t,"ConnectionNotFoundError",(function(){return ft})),n.d(t,"NoVersionOrUpdateDateColumnError",(function(){return ht.a})),n.d(t,"InsertValuesMissingError",(function(){return dt.a})),n.d(t,"OptimisticLockCanNotBeUsedError",(function(){return pt.a})),n.d(t,"MetadataWithSuchNameAlreadyExistsError",(function(){return mt})),n.d(t,"DriverOptionNotSetError",(function(){return Te.a})),n.d(t,"FindRelationsNotFoundError",(function(){return R})),n.d(t,"RepositoryNotFoundError",(function(){return q})),n.d(t,"NamingStrategyNotFoundError",(function(){return yt})),n.d(t,"PessimisticLockTransactionRequiredError",(function(){return gt.a})),n.d(t,"RepositoryNotTreeError",(function(){return V})),n.d(t,"DataTypeNotSupportedError",(function(){return v})),n.d(t,"InitializedRelationError",(function(){return _})),n.d(t,"MissingJoinTableError",(function(){return bt})),n.d(t,"QueryFailedError",(function(){return _e.a})),n.d(t,"NoNeedToReleaseEntityManagerError",(function(){return T})),n.d(t,"UsingJoinColumnOnlyOnOneSideAllowedError",(function(){return vt})),n.d(t,"UsingJoinTableOnlyOnOneSideAllowedError",(function(){return wt})),n.d(t,"SubjectRemovedAndUpdatedError",(function(){return $})),n.d(t,"PersistedEntityNotFoundError",(function(){return _t})),n.d(t,"UsingJoinColumnIsNotAllowedError",(function(){return kt})),n.d(t,"ColumnTypeUndefinedError",(function(){return Et})),n.d(t,"QueryRunnerAlreadyReleasedError",(function(){return we.a})),n.d(t,"OffsetWithoutLimitNotSupportedError",(function(){return Ot.a})),n.d(t,"CannotExecuteNotConnectedError",(function(){return c})),n.d(t,"NoConnectionOptionError",(function(){return w})),n.d(t,"Column",(function(){return bn})),n.d(t,"CreateDateColumn",(function(){return vn})),n.d(t,"DeleteDateColumn",(function(){return wn})),n.d(t,"PrimaryGeneratedColumn",(function(){return _n})),n.d(t,"PrimaryColumn",(function(){return kn})),n.d(t,"UpdateDateColumn",(function(){return En})),n.d(t,"VersionColumn",(function(){return On})),n.d(t,"ViewColumn",(function(){return Tn})),n.d(t,"ObjectIdColumn",(function(){return xn})),n.d(t,"AfterInsert",(function(){return Sn})),n.d(t,"AfterLoad",(function(){return Cn})),n.d(t,"AfterRemove",(function(){return Rn})),n.d(t,"AfterUpdate",(function(){return Pn})),n.d(t,"BeforeInsert",(function(){return Nn})),n.d(t,"BeforeRemove",(function(){return Mn})),n.d(t,"BeforeUpdate",(function(){return An})),n.d(t,"EventSubscriber",(function(){return jn})),n.d(t,"JoinColumn",(function(){return In})),n.d(t,"JoinTable",(function(){return Dn})),n.d(t,"ManyToMany",(function(){return Ln})),n.d(t,"ManyToOne",(function(){return Bn})),n.d(t,"OneToMany",(function(){return Fn})),n.d(t,"OneToOne",(function(){return qn})),n.d(t,"RelationCount",(function(){return Vn})),n.d(t,"RelationId",(function(){return Un})),n.d(t,"Entity",(function(){return Hn})),n.d(t,"ChildEntity",(function(){return zn})),n.d(t,"TableInheritance",(function(){return Wn})),n.d(t,"ViewEntity",(function(){return Yn})),n.d(t,"Transaction",(function(){return Qn})),n.d(t,"TransactionManager",(function(){return Gn})),n.d(t,"TransactionRepository",(function(){return Jn})),n.d(t,"TreeLevelColumn",(function(){return Kn})),n.d(t,"TreeParent",(function(){return $n})),n.d(t,"TreeChildren",(function(){return Xn})),n.d(t,"Tree",(function(){return Zn})),n.d(t,"Index",(function(){return er})),n.d(t,"Unique",(function(){return tr})),n.d(t,"Check",(function(){return nr})),n.d(t,"Exclusion",(function(){return rr})),n.d(t,"Generated",(function(){return ir})),n.d(t,"EntityRepository",(function(){return or})),n.d(t,"Any",(function(){return sr})),n.d(t,"Between",(function(){return cr})),n.d(t,"Equal",(function(){return ur})),n.d(t,"In",(function(){return lr.a})),n.d(t,"IsNull",(function(){return fr})),n.d(t,"LessThan",(function(){return hr})),n.d(t,"LessThanOrEqual",(function(){return dr})),n.d(t,"ILike",(function(){return pr})),n.d(t,"Like",(function(){return mr})),n.d(t,"MoreThan",(function(){return yr})),n.d(t,"MoreThanOrEqual",(function(){return gr})),n.d(t,"Not",(function(){return br})),n.d(t,"Raw",(function(){return vr})),n.d(t,"FindOperator",(function(){return ar.a})),n.d(t,"FindOptionsUtils",(function(){return N})),n.d(t,"AdvancedConsoleLogger",(function(){return nn})),n.d(t,"SimpleConsoleLogger",(function(){return tn})),n.d(t,"DummyLogger",(function(){return rn})),n.d(t,"FileLogger",(function(){return on})),n.d(t,"EntityMetadata",(function(){return se.a})),n.d(t,"EntityManager",(function(){return me})),n.d(t,"AbstractRepository",(function(){return B})),n.d(t,"Repository",(function(){return x})),n.d(t,"BaseEntity",(function(){return wr})),n.d(t,"TreeRepository",(function(){return C})),n.d(t,"MongoDriver",(function(){return h.e})),n.d(t,"MongoQueryRunner",(function(){return h.g})),n.d(t,"MongoRepository",(function(){return h.h})),n.d(t,"PostgresDriver",(function(){return h.k})),n.d(t,"AuroraDataApiDriver",(function(){return h.a})),n.d(t,"CockroachDriver",(function(){return h.d})),n.d(t,"AuroraDataApiPostgresDriver",(function(){return h.b})),n.d(t,"SqlServerDriver",(function(){return h.m})),n.d(t,"SapDriver",(function(){return h.l})),n.d(t,"MysqlDriver",(function(){return h.i})),n.d(t,"OracleDriver",(function(){return h.j})),n.d(t,"SqliteDriver",(function(){return h.n})),n.d(t,"BetterSqlite3Driver",(function(){return h.c})),n.d(t,"TableCheck",(function(){return Le.a})),n.d(t,"TableColumn",(function(){return Be.a})),n.d(t,"TableExclusion",(function(){return Fe.a})),n.d(t,"TableForeignKey",(function(){return qe.a})),n.d(t,"TableIndex",(function(){return Ve.a})),n.d(t,"TableUnique",(function(){return Ue.a})),n.d(t,"Table",(function(){return a.a})),n.d(t,"MssqlParameter",(function(){return d})),n.d(t,"ConnectionOptionsReader",(function(){return gn})),n.d(t,"Connection",(function(){return mn})),n.d(t,"ConnectionManager",(function(){return yn})),n.d(t,"QueryBuilder",(function(){return _r.a})),n.d(t,"SelectQueryBuilder",(function(){return en.SelectQueryBuilder})),n.d(t,"DeleteQueryBuilder",(function(){return kr.DeleteQueryBuilder})),n.d(t,"InsertQueryBuilder",(function(){return Er.InsertQueryBuilder})),n.d(t,"UpdateQueryBuilder",(function(){return Or.UpdateQueryBuilder})),n.d(t,"RelationQueryBuilder",(function(){return Tr.RelationQueryBuilder})),n.d(t,"Brackets",(function(){return xr.a})),n.d(t,"InsertResult",(function(){return Sr.a})),n.d(t,"UpdateResult",(function(){return Cr.a})),n.d(t,"DeleteResult",(function(){return Rr.a})),n.d(t,"MongoEntityManager",(function(){return h.f})),n.d(t,"Migration",(function(){return f})),n.d(t,"MigrationExecutor",(function(){return p})),n.d(t,"DefaultNamingStrategy",(function(){return s})),n.d(t,"EntitySchema",(function(){return Xt.a})),n.d(t,"getMetadataArgsStorage",(function(){return Pr})),n.d(t,"getConnectionOptions",(function(){return Nr})),n.d(t,"getConnectionManager",(function(){return Mr})),n.d(t,"createConnection",(function(){return Ar})),n.d(t,"createConnections",(function(){return jr})),n.d(t,"getConnection",(function(){return Ir})),n.d(t,"getManager",(function(){return Dr})),n.d(t,"getMongoManager",(function(){return Lr})),n.d(t,"getSqljsManager",(function(){return Br})),n.d(t,"getRepository",(function(){return Fr})),n.d(t,"getTreeRepository",(function(){return qr})),n.d(t,"getCustomRepository",(function(){return Vr})),n.d(t,"getMongoRepository",(function(){return Ur})),n.d(t,"createQueryBuilder",(function(){return Hr}));var r=n(0),i=(n(497),n(73)),o=n(66),a=n(8),s=function(){function e(){this.nestedSetColumnNames={left:"nsleft",right:"nsright"},this.materializedPathColumnName="mpath"}return e.prototype.tableName=function(e,t){return t||Object(o.d)(e)},e.prototype.closureJunctionTableName=function(e){return e+"_closure"},e.prototype.columnName=function(e,t,n){var r=t||e;return n.length?Object(o.a)(n.join("_"))+Object(o.e)(r):r},e.prototype.relationName=function(e){return e},e.prototype.primaryKeyName=function(e,t){var n=Object(r.f)([],Object(r.e)(t));n.sort();var o=(e instanceof a.a?e.name:e).replace(".","_")+"_"+n.join("_");return"PK_"+i.a.sha1(o).substr(0,27)},e.prototype.uniqueConstraintName=function(e,t){var n=Object(r.f)([],Object(r.e)(t));n.sort();var o=(e instanceof a.a?e.name:e).replace(".","_")+"_"+n.join("_");return"UQ_"+i.a.sha1(o).substr(0,27)},e.prototype.relationConstraintName=function(e,t,n){var o=Object(r.f)([],Object(r.e)(t));o.sort();var s=(e instanceof a.a?e.name:e).replace(".","_")+"_"+o.join("_");return n&&(s+="_"+n),"REL_"+i.a.sha1(s).substr(0,26)},e.prototype.defaultConstraintName=function(e,t){var n=(e instanceof a.a?e.name:e).replace(".","_")+"_"+t;return"DF_"+i.a.sha1(n).substr(0,27)},e.prototype.foreignKeyName=function(e,t,n,o){var s=Object(r.f)([],Object(r.e)(t));s.sort();var c=(e instanceof a.a?e.name:e).replace(".","_")+"_"+s.join("_");return"FK_"+i.a.sha1(c).substr(0,27)},e.prototype.indexName=function(e,t,n){var o=Object(r.f)([],Object(r.e)(t));o.sort();var s=(e instanceof a.a?e.name:e).replace(".","_")+"_"+o.join("_");return n&&(s+="_"+n),"IDX_"+i.a.sha1(s).substr(0,26)},e.prototype.checkConstraintName=function(e,t,n){var r=(e instanceof a.a?e.name:e).replace(".","_")+"_"+t,o="CHK_"+i.a.sha1(r).substr(0,26);return n?o+"_ENUM":o},e.prototype.exclusionConstraintName=function(e,t){var n=(e instanceof a.a?e.name:e).replace(".","_")+"_"+t;return"XCL_"+i.a.sha1(n).substr(0,26)},e.prototype.joinColumnName=function(e,t){return Object(o.a)(e+"_"+t)},e.prototype.joinTableName=function(e,t,n,r){return Object(o.d)(e+"_"+n.replace(/\./gi,"_")+"_"+t)},e.prototype.joinTableColumnDuplicationPrefix=function(e,t){return e+"_"+t},e.prototype.joinTableColumnName=function(e,t,n){return Object(o.a)(e+"_"+(n||t))},e.prototype.joinTableInverseColumnName=function(e,t,n){return this.joinTableColumnName(e,t,n)},e.prototype.prefixTableName=function(e,t){return e+t},e.prototype.eagerJoinRelationAlias=function(e,t){return e+"_"+t.replace(".","_")},e}(),c=function(e){function t(n){var r=e.call(this)||this;return r.name="CannotExecuteNotConnectedError",Object.setPrototypeOf(r,t.prototype),r.message='Cannot execute operation on "'+n+'" connection because connection is not yet established.',r}return Object(r.c)(t,e),t}(Error),u=function(e){function t(n){var r=e.call(this)||this;return r.name="CannotConnectAlreadyConnectedError",Object.setPrototypeOf(r,t.prototype),r.message='Cannot create a "'+n+'" connection because connection to the database already established.',r}return Object(r.c)(t,e),t}(Error),l=function(e){function t(n){var r,i=e.call(this)||this;return i.name="EntityMetadataNotFound",Object.setPrototypeOf(i,t.prototype),r=n instanceof Xt.a?n.options.name:"function"==typeof n||"object"==typeof n&&"name"in n?n.name:n,i.message='No metadata for "'+r+'" was found.',i}return Object(r.c)(t,e),t}(Error),f=function(e,t,n,r){this.id=e,this.timestamp=t,this.name=n,this.instance=r},h=n(1),d=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];this.value=e,this.type=t,this.params=[],this.params=n||[]},p=function(){function e(e,t){this.connection=e,this.queryRunner=t,this.transaction="all";var n=this.connection.driver.options;this.migrationsTableName=e.options.migrationsTableName||"migrations",this.migrationsTable=this.connection.driver.buildTableName(this.migrationsTableName,n.schema,n.database)}return e.prototype.executeMigration=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t=this;return Object(r.d)(this,(function(n){return[2,this.withQueryRunner((function(n){return Object(r.b)(t,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.createMigrationsTableIfNotExist(n)];case 1:return t.sent(),[4,e.instance.up(n)];case 2:return t.sent(),[4,this.insertExecutedMigration(n,e)];case 3:return t.sent(),[2,e]}}))}))}))]}))}))},e.prototype.getAllMigrations=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve(this.getMigrations())]}))}))},e.prototype.getExecutedMigrations=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){return[2,this.withQueryRunner((function(t){return Object(r.b)(e,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:return[4,this.createMigrationsTableIfNotExist(t)];case 1:return e.sent(),[4,this.loadExecutedMigrations(t)];case 2:return[2,e.sent()]}}))}))}))]}))}))},e.prototype.getPendingMigrations=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,this.getAllMigrations()];case 1:return e=n.sent(),[4,this.getExecutedMigrations()];case 2:return t=n.sent(),[2,e.filter((function(e){return!t.find((function(t){return t.name===e.name}))}))]}}))}))},e.prototype.insertMigration=function(e){var t=this;return new Promise((function(n,r){t.withQueryRunner((function(i){t.insertExecutedMigration(i,e).then(n).catch(r)}))}))},e.prototype.deleteMigration=function(e){var t=this;return new Promise((function(n,r){t.withQueryRunner((function(i){t.deleteExecutedMigration(i,e).then(n).catch(r)}))}))},e.prototype.showMigrations=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u,l,f;return Object(r.d)(this,(function(h){switch(h.label){case 0:return e=!1,t=this.queryRunner||this.connection.createQueryRunner(),[4,this.createMigrationsTableIfNotExist(t)];case 1:return h.sent(),[4,this.loadExecutedMigrations(t)];case 2:n=h.sent(),i=this.getMigrations(),o=function(t){n.find((function(e){return e.name===t.name}))?a.connection.logger.logSchemaBuild(" [X] "+t.name):(e=!0,a.connection.logger.logSchemaBuild(" [ ] "+t.name))},a=this;try{for(s=Object(r.g)(i),c=s.next();!c.done;c=s.next())u=c.value,o(u)}catch(e){l={error:e}}finally{try{c&&!c.done&&(f=s.return)&&f.call(s)}finally{if(l)throw l.error}}return this.queryRunner?[3,4]:[4,t.release()];case 3:h.sent(),h.label=4;case 4:return[2,e]}}))}))},e.prototype.executePendingMigrations=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u,l,f,h,d,p,m,y,g=this;return Object(r.d)(this,(function(b){switch(b.label){case 0:return e=this.queryRunner||this.connection.createQueryRunner(),[4,this.createMigrationsTableIfNotExist(e)];case 1:return b.sent(),[4,this.loadExecutedMigrations(e)];case 2:return t=b.sent(),n=this.getLatestTimestampMigration(t),i=this.getMigrations(),o=[],(a=i.filter((function(e){return!t.find((function(t){return t.name===e.name}))}))).length?[3,5]:(this.connection.logger.logSchemaBuild("No migrations are pending"),this.queryRunner?[3,4]:[4,e.release()]);case 3:b.sent(),b.label=4;case 4:return[2,[]];case 5:return this.connection.logger.logSchemaBuild(t.length+" migrations are already loaded in the database."),this.connection.logger.logSchemaBuild(i.length+" migrations were found in the source code."),n&&this.connection.logger.logSchemaBuild(n.name+" is the last executed migration. It was executed on "+new Date(n.timestamp).toString()+"."),this.connection.logger.logSchemaBuild(a.length+" migrations are new migrations that needs to be executed."),s=!1,"all"!==this.transaction||e.isTransactionActive?[3,7]:[4,e.startTransaction()];case 6:b.sent(),s=!0,b.label=7;case 7:b.trys.push([7,18,23,26]),c=function(t){return Object(r.d)(this,(function(n){switch(n.label){case 0:return"each"!==u.transaction||e.isTransactionActive?[3,2]:[4,e.startTransaction()];case 1:n.sent(),s=!0,n.label=2;case 2:return[4,t.instance.up(e).then((function(){return Object(r.b)(g,void 0,void 0,(function(){return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,this.insertExecutedMigration(e,t)];case 1:return n.sent(),"each"===this.transaction&&s?[4,e.commitTransaction()]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))})).then((function(){o.push(t),g.connection.logger.logSchemaBuild("Migration "+t.name+" has been executed successfully.")}))];case 3:return n.sent(),[2]}}))},u=this,b.label=8;case 8:b.trys.push([8,13,14,15]),l=Object(r.g)(a),f=l.next(),b.label=9;case 9:return f.done?[3,12]:(h=f.value,[5,c(h)]);case 10:b.sent(),b.label=11;case 11:return f=l.next(),[3,9];case 12:return[3,15];case 13:return d=b.sent(),m={error:d},[3,15];case 14:try{f&&!f.done&&(y=l.return)&&y.call(l)}finally{if(m)throw m.error}return[7];case 15:return"all"===this.transaction&&s?[4,e.commitTransaction()]:[3,17];case 16:b.sent(),b.label=17;case 17:return[3,26];case 18:if(p=b.sent(),!s)return[3,22];b.label=19;case 19:return b.trys.push([19,21,,22]),[4,e.rollbackTransaction()];case 20:return b.sent(),[3,22];case 21:return b.sent(),[3,22];case 22:throw p;case 23:return this.queryRunner?[3,25]:[4,e.release()];case 24:b.sent(),b.label=25;case 25:return[7];case 26:return[2,o]}}))}))},e.prototype.undoLastMigration=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e=this.queryRunner||this.connection.createQueryRunner(),[4,this.createMigrationsTableIfNotExist(e)];case 1:return r.sent(),[4,this.loadExecutedMigrations(e)];case 2:if(t=r.sent(),!(n=this.getLatestExecutedMigration(t)))return this.connection.logger.logSchemaBuild("No migrations was found in the database. Nothing to revert!"),[2];if(i=this.getMigrations(),!(o=i.find((function(e){return e.name===n.name}))))throw new Error("No migration "+n.name+" was found in the source code. Make sure you have this migration in your codebase and its included in the connection options.");return this.connection.logger.logSchemaBuild(t.length+" migrations are already loaded in the database."),this.connection.logger.logSchemaBuild(n.name+" is the last executed migration. It was executed on "+new Date(n.timestamp).toString()+"."),this.connection.logger.logSchemaBuild("Now reverting it..."),a=!1,"none"===this.transaction||e.isTransactionActive?[3,4]:[4,e.startTransaction()];case 3:r.sent(),a=!0,r.label=4;case 4:return r.trys.push([4,9,14,17]),[4,o.instance.down(e)];case 5:return r.sent(),[4,this.deleteExecutedMigration(e,o)];case 6:return r.sent(),this.connection.logger.logSchemaBuild("Migration "+o.name+" has been reverted successfully."),a?[4,e.commitTransaction()]:[3,8];case 7:r.sent(),r.label=8;case 8:return[3,17];case 9:if(s=r.sent(),!a)return[3,13];r.label=10;case 10:return r.trys.push([10,12,,13]),[4,e.rollbackTransaction()];case 11:return r.sent(),[3,13];case 12:return r.sent(),[3,13];case 13:throw s;case 14:return this.queryRunner?[3,16]:[4,e.release()];case 15:r.sent(),r.label=16;case 16:return[7];case 17:return[2]}}))}))},e.prototype.createMigrationsTableIfNotExist=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return this.connection.driver instanceof h.e?[2]:[4,e.hasTable(this.migrationsTable)];case 1:return t.sent()?[3,3]:[4,e.createTable(new a.a({name:this.migrationsTable,columns:[{name:"id",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationId}),isGenerated:!0,generationStrategy:"increment",isPrimary:!0,isNullable:!1},{name:"timestamp",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp}),isPrimary:!1,isNullable:!1},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}),isNullable:!1}]}))];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},e.prototype.loadExecutedMigrations=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return this.connection.driver instanceof h.e?[4,e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).find().sort({_id:-1}).toArray()]:[3,2];case 1:return[2,t.sent()];case 2:return[4,this.connection.manager.createQueryBuilder(e).select().orderBy(this.connection.driver.escape("id"),"DESC").from(this.migrationsTable,this.migrationsTableName).getRawMany()];case 3:return[2,t.sent().map((function(e){return new f(parseInt(e.id),parseInt(e.timestamp),e.name)}))]}}))}))},e.prototype.getMigrations=function(){var e=this.connection.migrations.map((function(e){var t=e.name||e.constructor.name,n=parseInt(t.substr(-13),10);if(!n||isNaN(n))throw new Error(t+" migration name is wrong. Migration class name should have a JavaScript timestamp appended.");return new f(void 0,n,t,e)}));return this.checkForDuplicateMigrations(e),e.sort((function(e,t){return e.timestamp-t.timestamp}))},e.prototype.checkForDuplicateMigrations=function(e){var t=e.map((function(e){return e.name})),n=Array.from(new Set(t.filter((function(e,n){return t.indexOf(e)<n}))));if(n.length>0)throw Error("Duplicate migrations: "+n.join(", "))},e.prototype.getLatestTimestampMigration=function(e){var t=e.map((function(e){return e})).sort((function(e,t){return-1*(e.timestamp-t.timestamp)}));return t.length>0?t[0]:void 0},e.prototype.getLatestExecutedMigration=function(e){return e.length>0?e[0]:void 0},e.prototype.insertExecutedMigration=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n={},this.connection.driver instanceof h.m?(n.timestamp=new d(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),n.name=new d(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(n.timestamp=t.timestamp,n.name=t.name),this.connection.driver instanceof h.e?[4,e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).insertOne(n)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,e.manager.createQueryBuilder().insert().into(this.migrationsTable).values(n).execute()];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},e.prototype.deleteExecutedMigration=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n={},this.connection.driver instanceof h.m?(n.timestamp=new d(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),n.name=new d(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(n.timestamp=t.timestamp,n.name=t.name),this.connection.driver instanceof h.e?[4,e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).deleteOne(n)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,(i=e.manager.createQueryBuilder()).delete().from(this.migrationsTable).where(i.escape("timestamp")+" = :timestamp").andWhere(i.escape("name")+" = :name").setParameters(n).execute()];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},e.prototype.withQueryRunner=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:t=this.queryRunner||this.connection.createQueryRunner(),n.label=1;case 1:return n.trys.push([1,,2,5]),[2,e(t)];case 2:return this.queryRunner?[3,4]:[4,t.release()];case 3:n.sent(),n.label=4;case 4:return[7];case 5:return[2]}}))}))},e}(),m=function(e){function t(n){var r=e.call(this)||this;return r.name="MissingPrimaryColumnError",Object.setPrototypeOf(r,t.prototype),r.message='Entity "'+n.name+'" does not have a primary column. Primary column is required to have in all your entities. Use @PrimaryColumn decorator to add a primary column to your entity.',r}return Object(r.c)(t,e),t}(Error),y=function(e){function t(n){var r=e.call(this)||this;return r.name="CircularRelationsError",Object.setPrototypeOf(r,t.prototype),r.message="Circular relations detected: "+n+". To resolve this issue you need to set nullable: true somewhere in this dependency structure.",r}return Object(r.c)(t,e),t}(Error);function g(e,t,n){var r=[],i={};return function o(a){i[a]=!0,r.push(a),e[a].forEach((function(e){if(i[e]){if(r.indexOf(e)>=0)throw r.push(e),new Error("Dependency Cycle Found: "+r.join(" -> "))}else o(e)})),r.pop(),t&&0!==e[a].length||-1!==n.indexOf(a)||n.push(a)}}var b=function(){function e(){this.nodes={},this.outgoingEdges={},this.incomingEdges={}}return e.prototype.addNode=function(e,t){this.hasNode(e)||(this.nodes[e]=2===arguments.length?t:e,this.outgoingEdges[e]=[],this.incomingEdges[e]=[])},e.prototype.removeNode=function(e){this.hasNode(e)&&(delete this.nodes[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],[this.incomingEdges,this.outgoingEdges].forEach((function(t){Object.keys(t).forEach((function(n){var r=t[n].indexOf(e);r>=0&&t[n].splice(r,1)}),this)})))},e.prototype.hasNode=function(e){return this.nodes.hasOwnProperty(e)},e.prototype.getNodeData=function(e){if(this.hasNode(e))return this.nodes[e];throw new Error("Node does not exist: "+e)},e.prototype.setNodeData=function(e,t){if(!this.hasNode(e))throw new Error("Node does not exist: "+e);this.nodes[e]=t},e.prototype.addDependency=function(e,t){if(!this.hasNode(e))throw new Error("Node does not exist: "+e);if(!this.hasNode(t))throw new Error("Node does not exist: "+t);return-1===this.outgoingEdges[e].indexOf(t)&&this.outgoingEdges[e].push(t),-1===this.incomingEdges[t].indexOf(e)&&this.incomingEdges[t].push(e),!0},e.prototype.removeDependency=function(e,t){var n;this.hasNode(e)&&(n=this.outgoingEdges[e].indexOf(t))>=0&&this.outgoingEdges[e].splice(n,1),this.hasNode(t)&&(n=this.incomingEdges[t].indexOf(e))>=0&&this.incomingEdges[t].splice(n,1)},e.prototype.dependenciesOf=function(e,t){if(this.hasNode(e)){var n=[];g(this.outgoingEdges,t,n)(e);var r=n.indexOf(e);return r>=0&&n.splice(r,1),n}throw new Error("Node does not exist: "+e)},e.prototype.dependantsOf=function(e,t){if(this.hasNode(e)){var n=[];g(this.incomingEdges,t,n)(e);var r=n.indexOf(e);return r>=0&&n.splice(r,1),n}throw new Error("Node does not exist: "+e)},e.prototype.overallOrder=function(e){var t=this,n=[],r=Object.keys(this.nodes);if(0===r.length)return n;var i=g(this.outgoingEdges,!1,[]);r.forEach((function(e){i(e)}));var o=g(this.outgoingEdges,e,n);return r.filter((function(e){return 0===t.incomingEdges[e].length})).forEach((function(e){o(e)})),n},e}(),v=function(e){function t(n,r,i){var o=e.call(this)||this;o.name="DataTypeNotSupportedError",Object.setPrototypeOf(o,t.prototype);var a="string"==typeof r?r:r.name;return o.message='Data type "'+a+'" in "'+n.entityMetadata.targetName+"."+n.propertyName+'" is not supported by "'+i+'" database.',o}return Object(r.c)(t,e),t}(Error),w=function(e){function t(n){var r=e.call(this)||this;return Object.setPrototypeOf(r,t.prototype),r.message='Option "'+n+'" is not set in your connection options, please define "'+n+'" option in your connection options or ormconfig.json',r}return Object(r.c)(t,e),t}(Error),_=function(e){function t(n){var r=e.call(this)||this;return Object.setPrototypeOf(r,t.prototype),r.message='Array initializations are not allowed in entity relations. Please remove array initialization (= []) from "'+n.entityMetadata.targetName+"#"+n.propertyPath+'". This is ORM requirement to make relations to work properly. Refer docs for more information.',r}return Object(r.c)(t,e),t}(Error),k=function(){function e(){}return e.prototype.validateMany=function(e,t){var n=this;e.forEach((function(r){return n.validate(r,e,t)})),this.validateDependencies(e),this.validateEagerRelations(e)},e.prototype.validate=function(e,t,n){if(!e.primaryColumns.length&&!e.isJunction)throw new m(e);if("STI"===e.inheritancePattern||"entity-child"===e.tableType){if(!e.discriminatorColumn)throw new Error("Entity "+e.name+" using single-table inheritance, it should also have a discriminator column. Did you forget to put discriminator column options?");if(void 0===e.discriminatorValue)throw new Error("Entity "+e.name+" has an undefined discriminator value. Discriminator value should be defined.");var r=t.find((function(t){return t!==e&&("STI"===t.inheritancePattern||"entity-child"===t.tableType)&&t.discriminatorValue===e.discriminatorValue&&t.inheritanceTree.some((function(t){return-1!==e.inheritanceTree.indexOf(t)}))}));if(r)throw new Error("Entities "+e.name+" and "+r.name+" have the same discriminator values. Make sure they are different while using the @ChildEntity decorator.")}if((e.relationCounts.forEach((function(e){if(e.relation.isManyToOne||e.relation.isOneToOne)throw new Error("Relation count can not be implemented on ManyToOne or OneToOne relations.")})),n instanceof h.e||e.columns.forEach((function(t){var r=n.normalizeType(t);if(-1===n.supportedDataTypes.indexOf(r))throw new v(t,r,n.options.type);if(t.length&&-1===n.withLengthColumnTypes.indexOf(r))throw new Error("Column "+t.propertyName+" of Entity "+e.name+" does not support length property.");if("enum"===t.type&&!t.enum&&!t.enumName)throw new Error('Column "'+t.propertyName+'" of Entity "'+e.name+'" is defined as enum, but missing "enum" or "enumName" properties.')})),n instanceof h.i||n instanceof h.a)&&e.columns.filter((function(e){return e.isGenerated&&"uuid"!==e.generationStrategy})).length>1)throw new Error("Error in "+e.name+" entity. There can be only one auto-increment column in MySql table.");if(n instanceof h.i&&(0===t.filter((function(e){return e.database})).length&&!n.database))throw new w("database");if(n instanceof h.m&&e.columns.filter((function(e){return e.charset})).length>1)throw new Error("Character set specifying is not supported in Sql Server");var i=e.create();e.relations.forEach((function(e){if(e.isManyToMany||e.isOneToMany){if(!1===e.persistenceEnabled)return;var t=e.getEntityValue(i);if(Array.isArray(t))throw new _(e)}})),e.relations.forEach((function(e){})),e.relations.forEach((function(t){if(t.isCascadeRemove&&t.inverseRelation&&t.inverseRelation.isCascadeRemove)throw new Error("Relation "+e.name+"#"+t.propertyName+" and "+t.inverseRelation.entityMetadata.name+"#"+t.inverseRelation.propertyName+" both has cascade remove set. This may lead to unexpected circular removals. Please set cascade remove only from one side of relationship.")})),e.eagerRelations.forEach((function(e){}))},e.prototype.validateDependencies=function(e){var t=new b;e.forEach((function(e){t.addNode(e.name)})),e.forEach((function(e){e.relationsWithJoinColumns.filter((function(e){return!e.isNullable})).forEach((function(n){t.addDependency(e.name,n.inverseEntityMetadata.name)}))}));try{t.overallOrder()}catch(e){throw new y(e.toString().replace("Error: Dependency Cycle Found: ",""))}},e.prototype.validateEagerRelations=function(e){e.forEach((function(e){e.eagerRelations.forEach((function(t){if(t.inverseRelation&&t.inverseRelation.isEager)throw new Error("Circular eager relations are disallowed. "+e.targetName+"#"+t.propertyPath+' contains "eager: true", and its inverse side '+t.inverseEntityMetadata.targetName+"#"+t.inverseRelation.propertyPath+' contains "eager: true" as well. Remove "eager: true" from one side of the relation.')}))}))},e}(),E=function(e){function t(){var n=e.call(this)||this;return n.name="QueryRunnerProviderAlreadyReleasedError",Object.setPrototypeOf(n,t.prototype),n.message="Database connection provided by a query runner was already released, cannot continue to use its querying methods anymore.",n}return Object(r.c)(t,e),t}(Error),O=n(122),T=function(e){function t(){var n=e.call(this)||this;return n.name="NoNeedToReleaseEntityManagerError",Object.setPrototypeOf(n,t.prototype),n.message="Entity manager is not using single database connection and cannot be released. Only entity managers created by connection#createEntityManagerWithSingleDatabaseConnection methods have a single database connection and they should be released.",n}return Object(r.c)(t,e),t}(Error),x=function(){function e(){}return e.prototype.createQueryBuilder=function(e,t){return this.manager.createQueryBuilder(this.metadata.target,e||this.metadata.targetName,t||this.queryRunner)},Object.defineProperty(e.prototype,"target",{get:function(){return this.metadata.target},enumerable:!1,configurable:!0}),e.prototype.hasId=function(e){return this.manager.hasId(this.metadata.target,e)},e.prototype.getId=function(e){return this.manager.getId(this.metadata.target,e)},e.prototype.create=function(e){return this.manager.create(this.metadata.target,e)},e.prototype.merge=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return(t=this.manager).merge.apply(t,Object(r.f)([this.metadata.target,e],Object(r.e)(n)))},e.prototype.preload=function(e){return this.manager.preload(this.metadata.target,e)},e.prototype.save=function(e,t){return this.manager.save(this.metadata.target,e,t)},e.prototype.remove=function(e,t){return this.manager.remove(this.metadata.target,e,t)},e.prototype.softRemove=function(e,t){return this.manager.softRemove(this.metadata.target,e,t)},e.prototype.recover=function(e,t){return this.manager.recover(this.metadata.target,e,t)},e.prototype.insert=function(e){return this.manager.insert(this.metadata.target,e)},e.prototype.update=function(e,t){return this.manager.update(this.metadata.target,e,t)},e.prototype.delete=function(e){return this.manager.delete(this.metadata.target,e)},e.prototype.softDelete=function(e){return this.manager.softDelete(this.metadata.target,e)},e.prototype.restore=function(e){return this.manager.restore(this.metadata.target,e)},e.prototype.count=function(e){return this.manager.count(this.metadata.target,e)},e.prototype.find=function(e){return this.manager.find(this.metadata.target,e)},e.prototype.findAndCount=function(e){return this.manager.findAndCount(this.metadata.target,e)},e.prototype.findByIds=function(e,t){return this.manager.findByIds(this.metadata.target,e,t)},e.prototype.findOne=function(e,t){return this.manager.findOne(this.metadata.target,e,t)},e.prototype.findOneOrFail=function(e,t){return this.manager.findOneOrFail(this.metadata.target,e,t)},e.prototype.query=function(e,t){return this.manager.query(e,t)},e.prototype.clear=function(){return this.manager.clear(this.metadata.target)},e.prototype.increment=function(e,t,n){return this.manager.increment(this.metadata.target,e,t,n)},e.prototype.decrement=function(e,t,n){return this.manager.decrement(this.metadata.target,e,t,n)},e}(),S=n(21),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.c)(t,e),t.prototype.findTrees=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t=this;return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,this.findRoots()];case 1:return e=n.sent(),[4,Promise.all(e.map((function(e){return t.findDescendantsTree(e)})))];case 2:return n.sent(),[2,e]}}))}))},t.prototype.findRoots=function(){var e,t,n=this,r=this.manager.connection.namingStrategy.joinColumnName(this.metadata.treeParentRelation.propertyName,this.metadata.primaryColumns[0].propertyName);return this.createQueryBuilder("treeEntity").where((t="treeEntity",n.manager.connection.driver.escape(t)+"."+(e=r,n.manager.connection.driver.escape(e)+" IS NULL"))).getMany()},t.prototype.findDescendants=function(e){return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getMany()},t.prototype.findDescendantsTree=function(e){var t=this;return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getRawAndEntities().then((function(n){var r=t.createRelationMaps("treeEntity",n.raw);return t.buildChildrenEntityTree(e,n.entities,r),e}))},t.prototype.countDescendants=function(e){return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getCount()},t.prototype.createDescendantsQueryBuilder=function(e,t,n){var r=this,i=function(e){return r.manager.connection.driver.escape(e)};if("closure-table"===this.metadata.treeType){var o=this.metadata.closureJunctionTable.descendantColumns.map((function(n){return i(t)+"."+i(n.propertyPath)+" = "+i(e)+"."+i(n.referencedColumn.propertyPath)})).join(" AND "),a={},s=this.metadata.closureJunctionTable.ancestorColumns.map((function(e){return a[e.referencedColumn.propertyName]=e.referencedColumn.getEntityValue(n),i(t)+"."+i(e.propertyPath)+" = :"+e.referencedColumn.propertyName})).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,o).where(s).setParameters(a)}if("nested-set"===this.metadata.treeType){s=e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN joined."+this.metadata.nestedSetLeftColumn.propertyPath+" AND joined."+this.metadata.nestedSetRightColumn.propertyPath;var c={};o=this.metadata.treeParentRelation.joinColumns.map((function(e){var t=e.referencedColumn.propertyPath.replace(".","_");return c[t]=e.referencedColumn.getEntityValue(n),"joined."+e.referencedColumn.propertyPath+" = :"+t})).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",s).where(o,c)}if("materialized-path"===this.metadata.treeType)return this.createQueryBuilder(e).where((function(t){var i=t.subQuery().select(r.metadata.targetName+"."+r.metadata.materializedPathColumn.propertyPath,"path").from(r.metadata.target,r.metadata.targetName).whereInIds(r.metadata.getEntityIdMap(n));return t.setNativeParameters(i.expressionMap.nativeParameters),r.manager.connection.driver instanceof S.a?e+"."+r.metadata.materializedPathColumn.propertyPath+" LIKE "+i.getQuery()+" || '%'":e+"."+r.metadata.materializedPathColumn.propertyPath+" LIKE CONCAT("+i.getQuery()+", '%')"}));throw new Error("Supported only in tree entities")},t.prototype.findAncestors=function(e){return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getMany()},t.prototype.findAncestorsTree=function(e){var t=this;return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getRawAndEntities().then((function(n){var r=t.createRelationMaps("treeEntity",n.raw);return t.buildParentEntityTree(e,n.entities,r),e}))},t.prototype.countAncestors=function(e){return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getCount()},t.prototype.createAncestorsQueryBuilder=function(e,t,n){var r=this;if("closure-table"===this.metadata.treeType){var i=this.metadata.closureJunctionTable.ancestorColumns.map((function(n){return t+"."+n.propertyPath+" = "+e+"."+n.referencedColumn.propertyPath})).join(" AND "),o={},a=this.metadata.closureJunctionTable.descendantColumns.map((function(e){return o[e.referencedColumn.propertyName]=e.referencedColumn.getEntityValue(n),t+"."+e.propertyPath+" = :"+e.referencedColumn.propertyName})).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,i).where(a).setParameters(o)}if("nested-set"===this.metadata.treeType){i="joined."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN "+e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" AND "+e+"."+this.metadata.nestedSetRightColumn.propertyPath;var s={};a=this.metadata.treeParentRelation.joinColumns.map((function(e){var t=e.referencedColumn.propertyPath.replace(".","_");return s[t]=e.referencedColumn.getEntityValue(n),"joined."+e.referencedColumn.propertyPath+" = :"+t})).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",i).where(a,s)}if("materialized-path"===this.metadata.treeType)return this.createQueryBuilder(e).where((function(t){var i=t.subQuery().select(r.metadata.targetName+"."+r.metadata.materializedPathColumn.propertyPath,"path").from(r.metadata.target,r.metadata.targetName).whereInIds(r.metadata.getEntityIdMap(n));return t.setNativeParameters(i.expressionMap.nativeParameters),r.manager.connection.driver instanceof S.a?i.getQuery()+" LIKE "+e+"."+r.metadata.materializedPathColumn.propertyPath+" || '%'":i.getQuery()+" LIKE CONCAT("+e+"."+r.metadata.materializedPathColumn.propertyPath+", '%')"}));throw new Error("Supported only in tree entities")},t.prototype.createRelationMaps=function(e,t){var n=this;return t.map((function(t){var r=n.metadata.treeParentRelation.joinColumns[0],i=r.givenDatabaseName||r.databaseName,o=t[e+"_"+n.metadata.primaryColumns[0].databaseName],a=t[e+"_"+i];return{id:n.manager.connection.driver.prepareHydratedValue(o,n.metadata.primaryColumns[0]),parentId:n.manager.connection.driver.prepareHydratedValue(a,r)}}))},t.prototype.buildChildrenEntityTree=function(e,t,n){var r=this,i=this.metadata.treeChildrenRelation.propertyName,o=this.metadata.primaryColumns[0].getEntityValue(e),a=n.filter((function(e){return e.parentId===o})),s=new Set(a.map((function(e){return e.id})));e[i]=t.filter((function(e){return s.has(r.metadata.primaryColumns[0].getEntityValue(e))})),e[i].forEach((function(e){r.buildChildrenEntityTree(e,t,n)}))},t.prototype.buildParentEntityTree=function(e,t,n){var r=this,i=this.metadata.treeParentRelation.propertyName,o=this.metadata.primaryColumns[0].getEntityValue(e),a=n.find((function(e){return e.id===o})),s=t.find((function(e){return!!a&&r.metadata.primaryColumns[0].getEntityValue(e)===a.parentId}));s&&(e[i]=s,this.buildParentEntityTree(e[i],t,n))},t}(x),R=function(e){function t(n){var r=e.call(this)||this;return Object.setPrototypeOf(r,t.prototype),1===n.length?r.message='Relation "'+n[0]+'" was not found; please check if it is correct and really exists in your entity.':r.message="Relations "+n.map((function(e){return'"'+e+'"'})).join(", ")+" were not found; please check if relations are correct and they exist in your entities.",r}return Object(r.c)(t,e),t}(Error),P=n(23),N=function(){function e(){}return e.isFindOneOptions=function(e){var t=e;return t&&(Array.isArray(t.select)||t.where instanceof Object||"string"==typeof t.where||Array.isArray(t.relations)||t.join instanceof Object||t.order instanceof Object||t.cache instanceof Object||"boolean"==typeof t.cache||"number"==typeof t.cache||t.lock instanceof Object||t.loadRelationIds instanceof Object||"boolean"==typeof t.loadRelationIds||"boolean"==typeof t.loadEagerRelations||"boolean"==typeof t.withDeleted||"boolean"==typeof t.transaction)},e.isFindManyOptions=function(e){var t=e;return t&&(this.isFindOneOptions(t)||"number"==typeof t.skip||"number"==typeof t.take||"string"==typeof t.skip||"string"==typeof t.take)},e.extractFindManyOptionsAlias=function(e){if(this.isFindManyOptions(e)&&e.join)return e.join.alias},e.applyFindManyOptionsOrConditionsToQueryBuilder=function(e,t){return this.isFindManyOptions(t)?this.applyOptionsToQueryBuilder(e,t):t?e.where(t):e},e.applyOptionsToQueryBuilder=function(e,t){if(!t||!this.isFindOneOptions(t)&&!this.isFindManyOptions(t))return e;if(!0===t.transaction&&(e.expressionMap.useTransaction=!0),!e.expressionMap.mainAlias||!e.expressionMap.mainAlias.hasMetadata)return e;var n=e.expressionMap.mainAlias.metadata;if(t.select&&(e.select([]),t.select.forEach((function(t){if(!n.findColumnWithPropertyPath(String(t)))throw new Error(t+" column was not found in the "+n.name+" entity.");e.addSelect(e.alias+"."+t)}))),t.where&&e.where(t.where),t.skip&&e.skip(t.skip),t.take&&e.take(t.take),t.order&&Object.keys(t.order).forEach((function(r){var i=t.order[r];if(!n.findColumnWithPropertyPath(r))throw new Error(r+" column was not found in the "+n.name+" entity.");switch(i){case 1:e.addOrderBy(e.alias+"."+r,"ASC");break;case-1:e.addOrderBy(e.alias+"."+r,"DESC");break;case"ASC":e.addOrderBy(e.alias+"."+r,"ASC");break;case"DESC":e.addOrderBy(e.alias+"."+r,"DESC")}})),t.relations){var r=t.relations.map((function(e){return e}));if(this.applyRelationsRecursively(e,r,e.expressionMap.mainAlias.name,e.expressionMap.mainAlias.metadata,""),r.length>0)throw new R(r)}if(t.join&&(t.join.leftJoin&&Object.keys(t.join.leftJoin).forEach((function(n){e.leftJoin(t.join.leftJoin[n],n)})),t.join.innerJoin&&Object.keys(t.join.innerJoin).forEach((function(n){e.innerJoin(t.join.innerJoin[n],n)})),t.join.leftJoinAndSelect&&Object.keys(t.join.leftJoinAndSelect).forEach((function(n){e.leftJoinAndSelect(t.join.leftJoinAndSelect[n],n)})),t.join.innerJoinAndSelect&&Object.keys(t.join.innerJoinAndSelect).forEach((function(n){e.innerJoinAndSelect(t.join.innerJoinAndSelect[n],n)}))),t.cache)if(t.cache instanceof Object){var i=t.cache;e.cache(i.id,i.milliseconds)}else e.cache(t.cache);if(t.lock)if("optimistic"===t.lock.mode)e.setLock(t.lock.mode,t.lock.version);else if("pessimistic_read"===t.lock.mode||"pessimistic_write"===t.lock.mode||"dirty_read"===t.lock.mode||"pessimistic_partial_write"===t.lock.mode||"pessimistic_write_or_fail"===t.lock.mode){var o=t.lock.tables?t.lock.tables.map((function(t){var n=e.expressionMap.aliases.find((function(e){return e.metadata.tableNameWithoutPrefix===t}));if(!n)throw new Error('"'+t+'" is not part of this query');return e.escape(n.name)})):void 0;e.setLock(t.lock.mode,void 0,o)}return t.withDeleted&&e.withDeleted(),!0===t.loadRelationIds?e.loadAllRelationIds():t.loadRelationIds instanceof Object&&e.loadAllRelationIds(t.loadRelationIds),e},e.applyRelationsRecursively=function(e,t,n,r,i){var o=this,a=[];if(i){var s=new RegExp("^"+i.replace(".","\\.")+"\\.");a=t.filter((function(e){return e.match(s)})).map((function(e){return e.replace(s,"")})).filter((function(e){return r.findRelationWithPropertyPath(e)}))}else a=t.filter((function(e){return r.findRelationWithPropertyPath(e)}));a.forEach((function(a){var s=P.a.buildAlias(e.connection.driver,{shorten:!0,joiner:"__"},n,a),c=n+"."+a;e.leftJoinAndSelect(c,s);var u=r.relations.find((function(e){return e.propertyName===a}));u&&o.joinEagerRelations(e,s,u.inverseEntityMetadata),t.splice(t.indexOf(i?i+"."+a:a),1);var l=e.expressionMap.joinAttributes.find((function(e){return e.entityOrProperty===c}));o.applyRelationsRecursively(e,t,l.alias.name,l.metadata,i?i+"."+a:a)}))},e.joinEagerRelations=function(e,t,n){var r=this;n.eagerRelations.forEach((function(n){var i=P.a.buildAlias(e.connection.driver,{shorten:!0},e.connection.namingStrategy.eagerJoinRelationAlias(t,n.propertyPath));e.leftJoinAndSelect(t+"."+n.propertyPath,i),r.joinEagerRelations(e,i,n.inverseEntityMetadata)}))},e}(),M=function(){function e(){}return e.prototype.transform=function(e,t,n,r){return void 0===r&&(r=!1),this.groupAndTransform(e,t,n,r),e},e.prototype.groupAndTransform=function(e,t,n,r){var i=this;void 0===r&&(r=!1),n.nonVirtualColumns.forEach((function(n){var r=n.getEntityValue(t);void 0!==r&&n.setEntityValue(e,r)})),n.relations.length&&n.relations.forEach((function(n){var o=n.getEntityValue(e),a=n.getEntityValue(t,r);if(void 0!==a)if(n.isOneToMany||n.isManyToMany){if(!Array.isArray(a))return;o||(o=[],n.setEntityValue(e,o)),a.forEach((function(e){var t=o.find((function(t){return n.inverseEntityMetadata.compareEntities(e,t)}));t||(t=n.inverseEntityMetadata.create(),o.push(t)),i.groupAndTransform(t,e,n.inverseEntityMetadata,r)}))}else{if(!(a instanceof Object))return void(o instanceof Object||n.setEntityValue(e,a));o||(o=n.inverseEntityMetadata.create(),n.setEntityValue(e,o)),i.groupAndTransform(o,a,n.inverseEntityMetadata,r)}}))},e}(),A=function(){function e(e,t,n,r){this.plainEntity=e,this.metadata=t,this.parentLoadMapItem=n,this.relation=r}return Object.defineProperty(e.prototype,"target",{get:function(){return this.metadata.target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.metadata.getEntityIdMixedMap(this.plainEntity)},enumerable:!1,configurable:!0}),e}(),j=function(){function e(){this.loadMapItems=[]}return Object.defineProperty(e.prototype,"mainLoadMapItem",{get:function(){return this.loadMapItems.find((function(e){return!e.relation&&!e.parentLoadMapItem}))},enumerable:!1,configurable:!0}),e.prototype.addLoadMap=function(e){this.loadMapItems.find((function(t){return t.target===e.target&&t.id===e.id}))||this.loadMapItems.push(e)},e.prototype.fillEntities=function(e,t){var n=this;t.forEach((function(t){var r=n.loadMapItems.find((function(n){return n.target===e&&n.metadata.compareEntities(t,n.plainEntity)}));r&&(r.entity=t)}))},e.prototype.groupByTargetIds=function(){var e=[];return this.loadMapItems.forEach((function(t){var n=e.find((function(e){return e.target===t.target}));n||(n={target:t.target,ids:[]},e.push(n)),n.ids.push(t.id)})),e},e}(),I=function(){function e(e){this.manager=e}return e.prototype.transform=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o=this;return Object(r.d)(this,(function(a){switch(a.label){case 0:return t.hasAllPrimaryKeys(e)?(n=new j,(i=function(e,o,a,s){var c=new A(e,o,a,s);n.addLoadMap(c),o.extractRelationValuesFromEntity(e,t.relations).filter((function(e){return null!=e})).forEach((function(e){var t=Object(r.e)(e,3),n=t[0],o=t[1],a=t[2];return i(o,a,c,n)}))})(e,t),[4,Promise.all(n.groupByTargetIds().map((function(e){return o.manager.findByIds(e.target,e.ids).then((function(t){return n.fillEntities(e.target,t)}))})))]):[2,Promise.reject("Given object does not have a primary column, cannot transform it to database entity.")];case 1:return a.sent(),n.loadMapItems.forEach((function(e){e.relation&&e.entity&&e.parentLoadMapItem&&e.parentLoadMapItem.entity&&(e.relation.isManyToMany||e.relation.isOneToMany?(e.parentLoadMapItem.entity[e.relation.propertyName]||(e.parentLoadMapItem.entity[e.relation.propertyName]=[]),e.parentLoadMapItem.entity[e.relation.propertyName].push(e.entity)):e.parentLoadMapItem.entity[e.relation.propertyName]=e.entity)})),[2,n.mainLoadMapItem?n.mainLoadMapItem.entity:void 0]}}))}))},e}(),D=function(e){function t(n){var r=e.call(this)||this;return r.name="CustomRepositoryNotFoundError",Object.setPrototypeOf(r,t.prototype),r.message="Custom repository "+(n instanceof Function?n.name:n.constructor.name)+" was not found. Did you forgot to put @EntityRepository decorator on it?",r}return Object(r.c)(t,e),t}(Error),L=function(e){function t(n){var r=e.call(this)||this;return r.name="CustomRepositoryDoesNotHaveEntityError",Object.setPrototypeOf(r,t.prototype),r.message="Custom repository "+(n instanceof Function?n.name:n.constructor.name)+" does not have managed entity. Did you forget to specify entity for it @EntityRepository(MyEntity)? ",r}return Object(r.c)(t,e),t}(Error),B=function(){function e(){}return Object.defineProperty(e.prototype,"repository",{get:function(){var e=this.getCustomRepositoryTarget(this);if(!e)throw new L(this.constructor);return this.manager.getRepository(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"treeRepository",{get:function(){var e=this.getCustomRepositoryTarget(this);if(!e)throw new L(this.constructor);return this.manager.getTreeRepository(e)},enumerable:!1,configurable:!0}),e.prototype.createQueryBuilder=function(e){var t=this.getCustomRepositoryTarget(this.constructor);if(!t)throw new L(this.constructor);return this.manager.getRepository(t).createQueryBuilder(e)},e.prototype.createQueryBuilderFor=function(e,t){return this.getRepositoryFor(e).createQueryBuilder(t)},e.prototype.getRepositoryFor=function(e){return this.manager.getRepository(e)},e.prototype.getTreeRepositoryFor=function(e){return this.manager.getTreeRepository(e)},e.prototype.getCustomRepositoryTarget=function(e){var t=Pr().entityRepositories.find((function(t){return t.target===(e instanceof Function?e:e.constructor)}));if(!t)throw new D(e);return t.entity},e}(),F=function(e){function t(n){var r=e.call(this)||this;return r.name="CustomRepositoryCannotInheritRepositoryError",Object.setPrototypeOf(r,t.prototype),r.message="Custom entity repository "+(n instanceof Function?n.name:n.constructor.name)+"  cannot inherit Repository class without entity being set in the @EntityRepository decorator.",r}return Object(r.c)(t,e),t}(Error),q=function(e){function t(n,r){var i,o=e.call(this)||this;return o.name="RepositoryNotFoundError",Object.setPrototypeOf(o,t.prototype),i=r instanceof Xt.a?r.options.name:"function"==typeof r||"object"==typeof r&&"name"in r?r.name:r,o.message='No repository for "'+i+'" was found. Looks like this entity is not registered in current "'+n+'" connection?',o}return Object(r.c)(t,e),t}(Error),V=function(e){function t(n){var r,i=e.call(this)||this;return i.name="RepositoryNotTreeError",Object.setPrototypeOf(i,t.prototype),r=n instanceof Xt.a?n.options.name:"function"==typeof n||"object"==typeof n&&"name"in n?n.name:n,i.message='Repository of the "'+r+'" class is not a TreeRepository. Try to apply @Tree decorator on your entity.',i}return Object(r.c)(t,e),t}(Error),U=function(){function e(){}return e.prototype.create=function(e,t,n){if(t.treeType){var r=new C;return Object.assign(r,{manager:e,metadata:t,queryRunner:n}),r}r=void 0;return r=e.connection.driver instanceof h.e?new h.h:new x,Object.assign(r,{manager:e,metadata:t,queryRunner:n}),r},e}(),H=function(e){function t(n){var r=e.call(this)||this;return r.name="TreeRepositoryNotSupportedError",Object.setPrototypeOf(r,t.prototype),r.message="Tree repositories are not supported in "+n.options.type+" driver.",r}return Object(r.c)(t,e),t}(Error),z=function(e){function t(n,r){var i=e.call(this)||this;return i.name="MustBeEntityError",Object.setPrototypeOf(i,t.prototype),i.message="Cannot "+n+', given value must be an entity, instead "'+r+'" is given.',i}return Object(r.c)(t,e),t}(Error),W=function(){function e(e){this.subjects=Object(r.f)([],Object(r.e)(e)),this.metadatas=this.getUniqueMetadatas(this.subjects)}return e.prototype.sort=function(e){var t=this;if(!this.metadatas.length)return this.subjects;var n=[];if("delete"===e){var i=this.subjects.filter((function(e){return!e.entity&&!e.databaseEntity}));n.push.apply(n,Object(r.f)([],Object(r.e)(i))),this.removeAlreadySorted(i)}var o=this.getNonNullableDependencies(),a=this.toposort(o);"insert"===e&&(a=a.reverse()),a.forEach((function(e){var i=t.subjects.filter((function(t){return t.metadata.targetName===e}));n.push.apply(n,Object(r.f)([],Object(r.e)(i))),t.removeAlreadySorted(i)}));var s=this.getDependencies(),c=this.toposort(s);return"insert"===e&&(c=c.reverse()),c.forEach((function(e){var i=t.subjects.filter((function(t){return t.metadata.targetName===e}));n.push.apply(n,Object(r.f)([],Object(r.e)(i))),t.removeAlreadySorted(i)})),n.push.apply(n,Object(r.f)([],Object(r.e)(this.subjects))),n},e.prototype.removeAlreadySorted=function(e){var t=this;e.forEach((function(e){t.subjects.splice(t.subjects.indexOf(e),1)}))},e.prototype.getUniqueMetadatas=function(e){var t=[];return e.forEach((function(e){-1===t.indexOf(e.metadata)&&t.push(e.metadata)})),t},e.prototype.getNonNullableDependencies=function(){return this.metadatas.reduce((function(e,t){return t.relationsWithJoinColumns.forEach((function(n){n.isNullable||e.push([t.targetName,n.inverseEntityMetadata.targetName])})),e}),[])},e.prototype.getDependencies=function(){return this.metadatas.reduce((function(e,t){return t.relationsWithJoinColumns.forEach((function(n){n.inverseEntityMetadata!==t&&e.push([t.targetName,n.inverseEntityMetadata.targetName])})),e}),[])},e.prototype.toposort=function(e){for(var t=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.indexOf(i[0])<0&&t.push(i[0]),t.indexOf(i[1])<0&&t.push(i[1])}return t}(e),n=t.length,r=new Array(n),i={},o=n;o--;)i[o]||a(t[o],o,[]);function a(o,s,c){if(c.indexOf(o)>=0)throw new Error("Cyclic dependency: "+JSON.stringify(o));if(!~t.indexOf(o))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(o));if(!i[s]){i[s]=!0;var u=e.filter((function(e){return e[0]===o}));if(s=u.length){var l=c.concat(o);do{var f=u[--s][1];a(f,t.indexOf(f),l)}while(s)}r[--n]=o}}return r},e}(),Y=n(27),Q=n(9),G=n(71),J=function(){function e(){}return e.prototype.compute=function(e){var t=this;e.forEach((function(n){t.computeDiffColumns(n),t.computeDiffRelationalColumns(e,n)}))},e.prototype.computeDiffColumns=function(e){e.entity&&e.metadata.columns.forEach((function(t){if(!t.isVirtual&&!t.isDiscriminator){var n=e.changeMaps.find((function(e){return e.column===t}));n&&e.changeMaps.splice(e.changeMaps.indexOf(n),1);var r=t.getEntityValue(e.entity);if(void 0!==r){if(e.databaseEntity){var i="json"!==t.type&&"jsonb"!==t.type,o=t.getEntityValue(e.databaseEntity,i);if(t.relationMetadata){var a=t.relationMetadata.getEntityValue(e.entity);if(null!=a)return}var s=r;if(null!==r){switch(t.type){case"date":s=Y.a.mixedDateToDateString(r);break;case"time":case"time with time zone":case"time without time zone":case"timetz":s=Y.a.mixedDateToTimeString(r);break;case"datetime":case"datetime2":case Date:case"timestamp":case"timestamp without time zone":case"timestamp with time zone":case"timestamp with local time zone":case"timestamptz":s=Y.a.mixedDateToUtcDatetimeString(r),o=Y.a.mixedDateToUtcDatetimeString(o);break;case"json":case"jsonb":if(Q.a.deepCompare(r,o))return;break;case"simple-array":s=Y.a.simpleArrayToString(r),o=Y.a.simpleArrayToString(o);break;case"simple-enum":s=Y.a.simpleEnumToString(r),o=Y.a.simpleEnumToString(o);break;case"simple-json":s=Y.a.simpleJsonToString(r),o=Y.a.simpleJsonToString(o)}t.transformer&&(s=G.a.transformTo(t.transformer,r))}if(s===o)return}e.diffColumns.push(t),e.changeMaps.push({column:t,value:r})}}}))},e.prototype.computeDiffRelationalColumns=function(e,t){t.entity&&t.metadata.relationsWithJoinColumns.forEach((function(n){var r=n.getEntityValue(t.entity);if(void 0!==r){if(t.databaseEntity){var i=r;null!==i&&i instanceof Object&&(i=n.getRelationIdMap(i));var o=n.getEntityValue(t.databaseEntity);if(Q.a.compareIds(i,o))return;t.diffRelations.push(n)}var a=e.find((function(e){return e.mustBeInserted&&e.entity===r}));a&&(r=a);var s=t.changeMaps.find((function(e){return e.relation===n}));s?s.value=r:t.changeMaps.push({relation:n,value:r})}}))},e}(),K=function(e){function t(n){var r=e.call(this)||this;return r.name="SubjectWithoutIdentifierError",Object.setPrototypeOf(r,t.prototype),r.message="Internal error. Subject "+n.metadata.targetName+" must have an identifier to perform operation. Please report a github issue if you face this error.",r}return Object(r.c)(t,e),t}(Error),$=function(e){function t(n){var r=e.call(this)||this;return r.name="SubjectRemovedAndUpdatedError",Object.setPrototypeOf(r,t.prototype),r.message='Removed entity "'+n.metadata.name+'" is also scheduled for update operation. Make sure you are not updating and removing same object (note that update or remove may be executed by cascade operations).',r}return Object(r.c)(t,e),t}(Error),X=n(12),Z=function(e){function t(){var n=e.call(this)||this;return n.name="NestedSetMultipleRootError",Object.setPrototypeOf(n,t.prototype),n.message="Nested sets do not support multiple root entities.",n}return Object(r.c)(t,e),t}(Error),ee=function(){function e(e){this.queryRunner=e}return e.prototype.insert=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t=function(e){return u.queryRunner.connection.driver.escape(e)},n=this.getTableName(e.metadata.tablePath),i=t(e.metadata.nestedSetLeftColumn.databaseName),o=t(e.metadata.nestedSetRightColumn.databaseName),!(a=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(a=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity),s=e.metadata.getEntityIdMap(a),c=void 0,s?[4,this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.nestedSetRightColumn.propertyPath,"right").from(e.metadata.target,e.metadata.targetName).whereInIds(s).getRawOne().then((function(e){var t=e?e.right:void 0;return"string"==typeof t?parseInt(t):t}))]:[3,2];case 1:c=r.sent(),r.label=2;case 2:return void 0===c?[3,4]:[4,this.queryRunner.query("UPDATE "+n+" SET "+i+" = CASE WHEN "+i+" > "+c+" THEN "+i+" + 2 ELSE "+i+" END,"+o+" = "+o+" + 2 WHERE "+o+" >= "+c)];case 3:return r.sent(),Q.a.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(c),e.metadata.nestedSetRightColumn.createValueMap(c+1)),[3,6];case 4:return[4,this.isUniqueRootEntity(e,a)];case 5:if(!r.sent())throw new Z;Q.a.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(1),e.metadata.nestedSetRightColumn.createValueMap(2)),r.label=6;case 6:return[2]}}))}))},e.prototype.update=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u,l,f,h,d,p,m,y,g,b,v=this;return Object(r.d)(this,(function(w){switch(w.label){case 0:return!(t=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity),!(n=e.databaseEntity)&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find((function(t){return Object.entries(e.identifier).every((function(e){var n=Object(r.e)(e,2),i=n[0],o=n[1];return t[i]===o}))}))),void 0===n||void 0===t?[2]:(i=e.metadata.treeParentRelation.getEntityValue(n),o=e.metadata.getEntityIdMap(i),a=e.metadata.getEntityIdMap(t),Q.a.compareIds(o,a)?[2]:t?(s=function(e){return v.queryRunner.connection.driver.escape(e)},c=this.getTableName(e.metadata.tablePath),u=s(e.metadata.nestedSetLeftColumn.databaseName),l=s(e.metadata.nestedSetRightColumn.databaseName),f=e.metadata.getEntityIdMap(n),h=void 0,f?[4,this.getNestedSetIds(e.metadata,f)]:[3,2]):[3,9]);case 1:h=w.sent()[0],w.label=2;case 2:return d=void 0,a?[4,this.getNestedSetIds(e.metadata,a)]:[3,4];case 3:d=w.sent()[0],w.label=4;case 4:return void 0===h||void 0===d?[3,8]:(p=d.left>h.left,m=h.right-h.left+1,y=void 0,y=p?d.left-h.right:d.right-h.left,g="WHEN "+u+" >= "+h.left+" AND "+u+" < "+h.right+" THEN "+u+" + "+y+" ",b="WHEN "+l+" > "+h.left+" AND "+l+" <= "+h.right+" THEN "+l+" + "+y+" ",p?[4,this.queryRunner.query("UPDATE "+c+" SET "+u+" = CASE WHEN "+u+" > "+h.right+" AND "+u+" <= "+d.left+" THEN "+u+" - "+m+" "+g+"ELSE "+u+" END, "+l+" = CASE WHEN "+l+" > "+h.right+" AND "+l+" < "+d.left+" THEN "+l+" - "+m+" "+b+"ELSE "+l+" END")]:[3,6]);case 5:return w.sent(),[3,8];case 6:return[4,this.queryRunner.query("UPDATE "+c+" SET "+u+" = CASE WHEN "+u+" < "+h.left+" AND "+u+" > "+d.right+" THEN "+u+" + "+m+" "+g+"ELSE "+u+" END, "+l+" = CASE WHEN "+l+" < "+h.left+" AND "+l+" >= "+d.right+" THEN "+l+" + "+m+" "+b+"ELSE "+l+" END")];case 7:w.sent(),w.label=8;case 8:return[3,11];case 9:return[4,this.isUniqueRootEntity(e,t)];case 10:if(!w.sent())throw new Z;w.label=11;case 11:return[2]}}))}))},e.prototype.remove=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u,l,f,h,d,p,m,y,g,b,v,w,_,k=this;return Object(r.d)(this,(function(E){switch(E.label){case 0:Array.isArray(e)||(e=[e]),t=e[0].metadata,n=function(e){return k.queryRunner.connection.driver.escape(e)},i=this.getTableName(t.tablePath),o=n(t.nestedSetLeftColumn.databaseName),a=n(t.nestedSetRightColumn.databaseName),s=[];try{for(c=Object(r.g)(e),u=c.next();!u.done;u=c.next())l=u.value,(f=t.getEntityIdMap(l.entity))&&s.push(f)}catch(e){b={error:e}}finally{try{u&&!u.done&&(v=c.return)&&v.call(c)}finally{if(b)throw b.error}}return[4,this.getNestedSetIds(t,s)];case 1:h=E.sent(),E.label=2;case 2:E.trys.push([2,7,8,9]),d=Object(r.g)(h),p=d.next(),E.label=3;case 3:return p.done?[3,6]:(m=p.value,y=m.right-m.left+1,[4,this.queryRunner.query("UPDATE "+i+" SET "+o+" = CASE WHEN "+o+" > "+m.left+" THEN "+o+" - "+y+" ELSE "+o+" END, "+a+" = CASE WHEN "+a+" > "+m.right+" THEN "+a+" - "+y+" ELSE "+a+" END")]);case 4:E.sent(),E.label=5;case 5:return p=d.next(),[3,3];case 6:return[3,9];case 7:return g=E.sent(),w={error:g},[3,9];case 8:try{p&&!p.done&&(_=d.return)&&_.call(d)}finally{if(w)throw w.error}return[7];case 9:return[2]}}))}))},e.prototype.getNestedSetIds=function(e,t){var n={left:e.targetName+"."+e.nestedSetLeftColumn.propertyPath,right:e.targetName+"."+e.nestedSetRightColumn.propertyPath},i=this.queryRunner.manager.createQueryBuilder();return Object.entries(n).forEach((function(e){var t=Object(r.e)(e,2),n=t[0],o=t[1];i.addSelect(o,n)})),i.from(e.target,e.targetName).whereInIds(t).orderBy(n.right,"DESC").getRawMany().then((function(e){var t,i,o,a,s=[];try{for(var c=Object(r.g)(e),u=c.next();!u.done;u=c.next()){var l=u.value,f={};try{for(var h=(o=void 0,Object(r.g)(Object.keys(n))),d=h.next();!d.done;d=h.next()){var p=d.value,m=l?l[p]:void 0;f[p]="string"==typeof m?parseInt(m):m}}catch(e){o={error:e}}finally{try{d&&!d.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}s.push(f)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(t)throw t.error}}return s}))},e.prototype.isUniqueRootEntity=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c,u=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=function(e){return u.queryRunner.connection.driver.escape(e)},i=this.getTableName(e.metadata.tablePath),o=[],a=e.metadata.treeParentRelation.joinColumns.map((function(e){var r=n(e.databaseName),i=e.getEntityValue(t);return null==i?r+" IS NULL":(o.push(i),r+" = "+u.queryRunner.connection.driver.createParameter("entity_"+e.databaseName,o.length-1))})).join(" AND "),s="count",[4,this.queryRunner.query("SELECT COUNT(1) AS "+n(s)+" FROM "+i+" WHERE "+a,o)];case 1:return c=r.sent(),[2,0===parseInt(c[0][s])]}}))}))},e.prototype.getTableName=function(e){var t=this;return e.split(".").map((function(e){return""===e?e:t.queryRunner.connection.driver.escape(e)})).join(".")},e}(),te=function(e){function t(n){var r=e.call(this)||this;return r.name="CannotAttachTreeChildrenEntityError",Object.setPrototypeOf(r,t.prototype),r.message='Cannot attach entity "'+n+'" to its parent. Please make sure parent is saved in the database before saving children nodes.',r}return Object(r.c)(t,e),t}(Error),ne=function(){function e(e){this.queryRunner=e}return e.prototype.insert=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u,l,f=this;return Object(r.d)(this,(function(h){switch(h.label){case 0:return t={},e.metadata.closureJunctionTable.ancestorColumns.forEach((function(n){t[n.databaseName]=e.identifier})),e.metadata.closureJunctionTable.descendantColumns.forEach((function(n){t[n.databaseName]=e.identifier})),[4,this.queryRunner.manager.createQueryBuilder().insert().into(e.metadata.closureJunctionTable.tablePath).values(t).updateEntity(!1).callListeners(!1).execute()];case 1:return h.sent(),!(n=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(n=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity),n?(i=function(e){return f.queryRunner.connection.driver.escape(e)},o=this.getTableName(e.metadata.closureJunctionTable.tablePath),a=[],s=e.metadata.closureJunctionTable.ancestorColumns.map((function(e){return i(e.databaseName)})),c=e.metadata.closureJunctionTable.descendantColumns.map((function(e){return i(e.databaseName)})),u=e.metadata.primaryColumns.map((function(t){return a.push(t.getEntityValue(e.insertedValueSet?e.insertedValueSet:e.entity)),f.queryRunner.connection.driver.createParameter("child_entity_"+t.databaseName,a.length-1)})),l=e.metadata.closureJunctionTable.descendantColumns.map((function(t){var r=i(t.databaseName),o=t.referencedColumn.getEntityValue(n);if(!o)throw new te(e.metadata.name);return a.push(o),r+" = "+f.queryRunner.connection.driver.createParameter("parent_entity_"+t.referencedColumn.databaseName,a.length-1)})),[4,this.queryRunner.query("INSERT INTO "+o+" ("+Object(r.f)(Object(r.f)([],Object(r.e)(s)),Object(r.e)(c)).join(", ")+") SELECT "+s.join(", ")+", "+u.join(", ")+" FROM "+o+" WHERE "+l.join(" AND "),a)]):[3,3];case 2:h.sent(),h.label=3;case 3:return[2]}}))}))},e.prototype.update=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u,l,f,h,d,p,m,y,g,b,v,w,_,k,E,O,T=this;return Object(r.d)(this,(function(x){switch(x.label){case 0:if(!(t=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity),!(n=e.databaseEntity)&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find((function(t){return Object.entries(e.identifier).every((function(e){var n=Object(r.e)(e,2),i=n[0],o=n[1];return t[i]===o}))}))),void 0===n||void 0===t)return[2];if(i=e.metadata.treeParentRelation.getEntityValue(n),o=e.metadata.getEntityIdMap(i),a=e.metadata.getEntityIdMap(t),Q.a.compareIds(o,a))return[2];s=function(e){return T.queryRunner.connection.driver.escape(e)},c=e.metadata.closureJunctionTable,u=c.ancestorColumns.map((function(e){return s(e.databaseName)})),l=c.descendantColumns.map((function(e){return s(e.databaseName)})),f=function(e,t){var n,i,o="sub"+t,a=e.createQueryBuilder().select(l.join(", ")).from(c.tablePath,o);try{for(var u=Object(r.g)(c.ancestorColumns),f=u.next();!f.done;f=u.next()){var h=f.value;a.andWhere(s(o)+"."+s(h.databaseName)+" = :value_"+h.referencedColumn.databaseName)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}return e.createQueryBuilder().select(l.join(", ")).from("("+a.getQuery()+")",t).setParameters(a.getParameters()).getQuery()},h={};try{for(d=Object(r.g)(e.metadata.primaryColumns),p=d.next();!p.done;p=d.next())m=p.value,h["value_"+m.databaseName]=n[m.databaseName]}catch(e){E={error:e}}finally{try{p&&!p.done&&(O=d.return)&&O.call(d)}finally{if(E)throw E.error}}return[4,this.queryRunner.manager.createQueryBuilder().delete().from(c.tablePath).where((function(e){return"("+l.join(", ")+") IN ("+f(e,"descendant")+")"})).andWhere((function(e){return"("+u.join(", ")+") NOT IN ("+f(e,"ancestor")+")"})).setParameters(h).execute()];case 1:return x.sent(),t?(y=[],g=this.getTableName(c.tablePath),b=s("supertree"),v=s("subtree"),w=Object(r.f)(Object(r.f)([],Object(r.e)(u.map((function(e){return b+"."+e})))),Object(r.e)(l.map((function(e){return v+"."+e})))),_=e.metadata.closureJunctionTable.ancestorColumns.map((function(e){var t=s(e.databaseName),r=e.referencedColumn.getEntityValue(n);y.push(r);var i=T.queryRunner.connection.driver.createParameter("entity_"+e.referencedColumn.databaseName,y.length-1);return v+"."+t+" = "+i})),k=e.metadata.closureJunctionTable.descendantColumns.map((function(n){var r=s(n.databaseName),i=n.referencedColumn.getEntityValue(t);if(!i)throw new te(e.metadata.name);y.push(i);var o=T.queryRunner.connection.driver.createParameter("parent_entity_"+n.referencedColumn.databaseName,y.length-1);return b+"."+r+" = "+o})),[4,this.queryRunner.query("INSERT INTO "+g+" ("+Object(r.f)(Object(r.f)([],Object(r.e)(u)),Object(r.e)(l)).join(", ")+") SELECT "+w.join(", ")+" FROM "+g+" AS "+b+", "+g+" AS "+v+" WHERE "+Object(r.f)(Object(r.f)([],Object(r.e)(_)),Object(r.e)(k)).join(" AND "),y)]):[3,3];case 2:x.sent(),x.label=3;case 3:return[2]}}))}))},e.prototype.remove=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return this.queryRunner.connection.driver instanceof h.m?(Array.isArray(e)||(e=[e]),t=function(e){return c.queryRunner.connection.driver.escape(e)},n=e.map((function(e){return e.identifier})),i=e[0].metadata.closureJunctionTable,a=(o=function(e){return e.map((function(e){var r=n.map((function(t){return t[e.referencedColumn.databaseName]}));return t(e.databaseName)+" IN ("+r.join(", ")+")"})).join(" AND ")})(i.ancestorColumns),s=o(i.descendantColumns),[4,this.queryRunner.manager.createQueryBuilder().delete().from(i.tablePath).where(a).orWhere(s).execute()]):[2];case 1:return r.sent(),[2]}}))}))},e.prototype.getTableName=function(e){var t=this;return e.split(".").map((function(e){return""===e?e:t.queryRunner.connection.driver.escape(e)})).join(".")},e}(),re=function(){function e(e){this.queryRunner=e}return e.prototype.insert=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a;return Object(r.d)(this,(function(r){switch(r.label){case 0:return!(t=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity),n=e.metadata.getEntityIdMap(t),i="",n?[4,this.getEntityPath(e,n)]:[3,2];case 1:i=r.sent(),r.label=2;case 2:return o=e.metadata.treeParentRelation.joinColumns.map((function(t){return t.referencedColumn.getEntityValue(e.insertedValueSet)})).join("_"),[4,this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set((a={},a[e.metadata.materializedPathColumn.propertyPath]=i+o+".",a)).where(e.identifier).execute()];case 3:return r.sent(),[2]}}))}))},e.prototype.update=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u,l,f;return Object(r.d)(this,(function(h){switch(h.label){case 0:return!(t=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity),!(n=e.databaseEntity)&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find((function(t){return Object.entries(e.identifier).every((function(e){var n=Object(r.e)(e,2),i=n[0],o=n[1];return t[i]===o}))}))),i=e.metadata.treeParentRelation.getEntityValue(n),o=e.metadata.getEntityIdMap(i),a=e.metadata.getEntityIdMap(t),Q.a.compareIds(o,a)?[2]:(s="",a?[4,this.getEntityPath(e,a)]:[3,2]);case 1:s=h.sent(),h.label=2;case 2:return c="",o?[4,this.getEntityPath(e,o)]:[3,4];case 3:c=h.sent()||"",h.label=4;case 4:return u=e.metadata.treeParentRelation.joinColumns.map((function(e){return e.referencedColumn.getEntityValue(n)})).join("_"),l=e.metadata.materializedPathColumn.propertyPath,[4,this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set((f={},f[l]=function(){return"REPLACE("+l+", '"+c+u+".', '"+s+u+".')"},f)).where(l+" LIKE :path",{path:""+c+u+".%"}).execute()];case 5:return h.sent(),[2]}}))}))},e.prototype.getEntityPath=function(e,t){return this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.materializedPathColumn.propertyPath,"path").from(e.metadata.target,e.metadata.targetName).whereInIds(t).getRawOne().then((function(e){return e?e.path:void 0}))},e}(),ie=function(){function e(e,t,n){this.hasExecutableOperations=!1,this.insertSubjects=[],this.updateSubjects=[],this.removeSubjects=[],this.softRemoveSubjects=[],this.recoverSubjects=[],this.queryRunner=e,this.allSubjects=t,this.options=n,this.validate(),this.recompute()}return e.prototype.execute=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(t){switch(t.label){case 0:return e=void 0,this.options&&!1===this.options.listeners?[3,2]:(e=this.broadcastBeforeEventsForAll()).promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e&&e.count>0&&(this.insertSubjects.forEach((function(e){return e.recompute()})),this.updateSubjects.forEach((function(e){return e.recompute()})),this.removeSubjects.forEach((function(e){return e.recompute()})),this.softRemoveSubjects.forEach((function(e){return e.recompute()})),this.recoverSubjects.forEach((function(e){return e.recompute()})),this.recompute()),this.insertSubjects=new W(this.insertSubjects).sort("insert"),[4,this.executeInsertOperations()];case 3:return t.sent(),this.updateSubjects=this.allSubjects.filter((function(e){return e.mustBeUpdated})),[4,this.executeUpdateOperations()];case 4:return t.sent(),this.removeSubjects=new W(this.removeSubjects).sort("delete"),[4,this.executeRemoveOperations()];case 5:return t.sent(),this.softRemoveSubjects=this.allSubjects.filter((function(e){return e.mustBeSoftRemoved})),[4,this.executeSoftRemoveOperations()];case 6:return t.sent(),this.recoverSubjects=this.allSubjects.filter((function(e){return e.mustBeRecovered})),[4,this.executeRecoverOperations()];case 7:return t.sent(),[4,this.updateSpecialColumnsInPersistedEntities()];case 8:return t.sent(),this.options&&!1===this.options.listeners?[3,10]:(e=this.broadcastAfterEventsForAll()).promises.length>0?[4,Promise.all(e.promises)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[2]}}))}))},e.prototype.validate=function(){this.allSubjects.forEach((function(e){if(e.mustBeUpdated&&e.mustBeRemoved)throw new $(e)}))},e.prototype.recompute=function(){(new J).compute(this.allSubjects),this.insertSubjects=this.allSubjects.filter((function(e){return e.mustBeInserted})),this.updateSubjects=this.allSubjects.filter((function(e){return e.mustBeUpdated})),this.removeSubjects=this.allSubjects.filter((function(e){return e.mustBeRemoved})),this.softRemoveSubjects=this.allSubjects.filter((function(e){return e.mustBeSoftRemoved})),this.recoverSubjects=this.allSubjects.filter((function(e){return e.mustBeRecovered})),this.hasExecutableOperations=this.insertSubjects.length>0||this.updateSubjects.length>0||this.removeSubjects.length>0||this.softRemoveSubjects.length>0||this.recoverSubjects.length>0},e.prototype.broadcastBeforeEventsForAll=function(){var e=this,t=new X.a;return this.insertSubjects.length&&this.insertSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastBeforeInsertEvent(t,n.metadata,n.entity)})),this.updateSubjects.length&&this.updateSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastBeforeUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),this.removeSubjects.length&&this.removeSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastBeforeRemoveEvent(t,n.metadata,n.entity,n.databaseEntity)})),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastBeforeUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),this.recoverSubjects.length&&this.recoverSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastBeforeUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),t},e.prototype.broadcastAfterEventsForAll=function(){var e=this,t=new X.a;return this.insertSubjects.length&&this.insertSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastAfterInsertEvent(t,n.metadata,n.entity)})),this.updateSubjects.length&&this.updateSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastAfterUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),this.removeSubjects.length&&this.removeSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastAfterRemoveEvent(t,n.metadata,n.entity,n.databaseEntity)})),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastAfterUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),this.recoverSubjects.length&&this.recoverSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastAfterUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),t},e.prototype.executeInsertOperations=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u,l,f,d=this;return Object(r.d)(this,(function(p){switch(p.label){case 0:e=Object(r.e)(this.groupBulkSubjects(this.insertSubjects,"insert"),2),t=e[0],n=e[1],i=function(e){var n,i,a,s,c,u,l,f,p,m,y,g,b;return Object(r.d)(this,(function(v){switch(v.label){case 0:return n=t[e],i=[],a=[],s=[],o.queryRunner.connection.driver instanceof h.e?n.forEach((function(e){e.metadata.createDateColumn&&e.entity&&(e.entity[e.metadata.createDateColumn.databaseName]=new Date),e.metadata.updateDateColumn&&e.entity&&(e.entity[e.metadata.updateDateColumn.databaseName]=new Date),e.createValueSetAndPopChangeMap(),a.push(e),i.push(e.entity)})):o.queryRunner.connection.driver instanceof h.j?n.forEach((function(e){s.push(e)})):n.forEach((function(e){0===e.changeMaps.length||e.metadata.treeType||d.queryRunner.connection.driver instanceof h.j||d.queryRunner.connection.driver instanceof h.l?s.push(e):(a.push(e),i.push(e.createValueSetAndPopChangeMap()))})),o.queryRunner instanceof h.g?[4,o.queryRunner.manager.insert(n[0].metadata.target,i)]:[3,2];case 1:return c=v.sent(),n.forEach((function(e,t){e.identifier=c.identifiers[t],e.generatedMap=c.generatedMaps[t],e.insertedValueSet=i[t]})),[3,12];case 2:return i.length>0?[4,o.queryRunner.manager.createQueryBuilder().insert().into(n[0].metadata.target).values(i).updateEntity(!o.options||!1!==o.options.reload).callListeners(!1).execute()]:[3,4];case 3:u=v.sent(),a.forEach((function(e,t){e.identifier=u.identifiers[t],e.generatedMap=u.generatedMaps[t],e.insertedValueSet=i[t]})),v.label=4;case 4:if(!(s.length>0))return[3,12];l=function(e){return Object(r.d)(this,(function(t){switch(t.label){case 0:return e.insertedValueSet=e.createValueSetAndPopChangeMap(),"nested-set"!==e.metadata.treeType?[3,2]:[4,new ee(o.queryRunner).insert(e)];case 1:t.sent(),t.label=2;case 2:return[4,o.queryRunner.manager.createQueryBuilder().insert().into(e.metadata.target).values(e.insertedValueSet).updateEntity(!o.options||!1!==o.options.reload).callListeners(!1).execute().then((function(t){e.identifier=t.identifiers[0],e.generatedMap=t.generatedMaps[0]}))];case 3:return t.sent(),"closure-table"!==e.metadata.treeType?[3,5]:[4,new ne(o.queryRunner).insert(e)];case 4:return t.sent(),[3,7];case 5:return"materialized-path"!==e.metadata.treeType?[3,7]:[4,new re(o.queryRunner).insert(e)];case 6:t.sent(),t.label=7;case 7:return[2]}}))},v.label=5;case 5:v.trys.push([5,10,11,12]),g=void 0,f=Object(r.g)(s),p=f.next(),v.label=6;case 6:return p.done?[3,9]:(m=p.value,[5,l(m)]);case 7:v.sent(),v.label=8;case 8:return p=f.next(),[3,6];case 9:return[3,12];case 10:return y=v.sent(),g={error:y},[3,12];case 11:try{p&&!p.done&&(b=f.return)&&b.call(f)}finally{if(g)throw g.error}return[7];case 12:return n.forEach((function(e){e.generatedMap&&e.metadata.columns.forEach((function(t){var n=t.getEntityValue(e.generatedMap);if(null!=n){var r=d.queryRunner.connection.driver.prepareHydratedValue(n,t);t.setEntityValue(e.generatedMap,r)}}))})),[2]}}))},o=this,p.label=1;case 1:p.trys.push([1,6,7,8]),a=Object(r.g)(n),s=a.next(),p.label=2;case 2:return s.done?[3,5]:(c=s.value,[5,i(c)]);case 3:p.sent(),p.label=4;case 4:return s=a.next(),[3,2];case 5:return[3,8];case 6:return u=p.sent(),l={error:u},[3,8];case 7:try{s&&!s.done&&(f=a.return)&&f.call(a)}finally{if(l)throw l.error}return[7];case 8:return[2]}}))}))},e.prototype.executeUpdateOperations=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u,l=this;return Object(r.d)(this,(function(f){switch(f.label){case 0:e=function(e){return Object(r.b)(l,void 0,void 0,(function(){var t,n,i,o,a,s=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(!e.identifier)throw new K(e);return this.queryRunner instanceof h.g?(t=Q.a.mergeDeep({},e.entity),e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete t[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete t[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(t[e.metadata.updateDateColumn.propertyName]=new Date),[4,this.queryRunner.manager.update(e.metadata.target,e.identifier,t)]):[3,2];case 1:return r.sent(),[3,11];case 2:switch(n=e.createValueSetAndPopChangeMap(),e.metadata.treeType){case"nested-set":return[3,3];case"closure-table":return[3,5];case"materialized-path":return[3,7]}return[3,9];case 3:return[4,new ee(this.queryRunner).update(e)];case 4:return r.sent(),[3,9];case 5:return[4,new ne(this.queryRunner).update(e)];case 6:return r.sent(),[3,9];case 7:return[4,new re(this.queryRunner).update(e)];case 8:return r.sent(),[3,9];case 9:return i=this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set(n).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1),e.entity?i.whereEntity(e.identifier):i.where(e.identifier),[4,i.execute()];case 10:o=r.sent(),(a=o.generatedMaps[0])&&(e.metadata.columns.forEach((function(e){var t=e.getEntityValue(a);if(null!=t){var n=s.queryRunner.connection.driver.prepareHydratedValue(t,e);e.setEntityValue(a,n)}})),e.generatedMap||(e.generatedMap={}),Object.assign(e.generatedMap,a)),r.label=11;case 11:return[2]}}))}))},t=[],n=[];try{for(i=Object(r.g)(this.updateSubjects),o=i.next();!o.done;o=i.next())"nested-set"===(a=o.value).metadata.treeType?t.push(a):n.push(a)}catch(e){c={error:e}}finally{try{o&&!o.done&&(u=i.return)&&u.call(i)}finally{if(c)throw c.error}}return s=new Promise((function(n,i){return Object(r.b)(l,void 0,void 0,(function(){var o,a,s,c,u,l,f;return Object(r.d)(this,(function(h){switch(h.label){case 0:h.trys.push([0,7,8,9]),o=Object(r.g)(t),a=o.next(),h.label=1;case 1:if(a.done)return[3,6];s=a.value,h.label=2;case 2:return h.trys.push([2,4,,5]),[4,e(s)];case 3:return h.sent(),[3,5];case 4:return c=h.sent(),i(c),[3,5];case 5:return a=o.next(),[3,1];case 6:return[3,9];case 7:return u=h.sent(),l={error:u},[3,9];case 8:try{a&&!a.done&&(f=o.return)&&f.call(o)}finally{if(l)throw l.error}return[7];case 9:return n(),[2]}}))}))})),[4,Promise.all(Object(r.f)(Object(r.f)([],Object(r.e)(n.map(e))),[s]))];case 1:return f.sent(),[2]}}))}))},e.prototype.executeRemoveOperations=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u,l,f;return Object(r.d)(this,(function(d){switch(d.label){case 0:e=Object(r.e)(this.groupBulkSubjects(this.removeSubjects,"delete"),2),t=e[0],n=e[1],d.label=1;case 1:d.trys.push([1,13,14,15]),i=Object(r.g)(n),o=i.next(),d.label=2;case 2:return o.done?[3,12]:(a=o.value,s=t[a],c=s.map((function(e){if(!e.identifier)throw new K(e);return e.identifier})),this.queryRunner instanceof h.g?[4,this.queryRunner.manager.delete(s[0].metadata.target,c)]:[3,4]);case 3:return d.sent(),[3,11];case 4:switch(s[0].metadata.treeType){case"nested-set":return[3,5];case"closure-table":return[3,7]}return[3,9];case 5:return[4,new ee(this.queryRunner).remove(s)];case 6:return d.sent(),[3,9];case 7:return[4,new ne(this.queryRunner).remove(s)];case 8:return d.sent(),[3,9];case 9:return[4,this.queryRunner.manager.createQueryBuilder().delete().from(s[0].metadata.target).where(c).callListeners(!1).execute()];case 10:d.sent(),d.label=11;case 11:return o=i.next(),[3,2];case 12:return[3,15];case 13:return u=d.sent(),l={error:u},[3,15];case 14:try{o&&!o.done&&(f=i.return)&&f.call(i)}finally{if(l)throw l.error}return[7];case 15:return[2]}}))}))},e.prototype.executeSoftRemoveOperations=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,Promise.all(this.softRemoveSubjects.map((function(t){return Object(r.b)(e,void 0,void 0,(function(){var e,n,i,o=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(!t.identifier)throw new K(t);return this.queryRunner instanceof h.g?(e=Q.a.mergeDeep({},t.entity),t.metadata.objectIdColumn&&t.metadata.objectIdColumn.propertyName&&delete e[t.metadata.objectIdColumn.propertyName],t.metadata.createDateColumn&&t.metadata.createDateColumn.propertyName&&delete e[t.metadata.createDateColumn.propertyName],t.metadata.updateDateColumn&&t.metadata.updateDateColumn.propertyName&&(e[t.metadata.updateDateColumn.propertyName]=new Date),t.metadata.deleteDateColumn&&t.metadata.deleteDateColumn.propertyName&&(e[t.metadata.deleteDateColumn.propertyName]=new Date),[4,this.queryRunner.manager.update(t.metadata.target,t.identifier,e)]):[3,2];case 1:return r.sent(),[3,4];case 2:return n=this.queryRunner.manager.createQueryBuilder().softDelete().from(t.metadata.target).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1),t.entity?n.whereEntity(t.identifier):n.where(t.identifier),[4,n.execute()];case 3:i=r.sent(),t.generatedMap=i.generatedMaps[0],t.generatedMap&&t.metadata.columns.forEach((function(e){var n=e.getEntityValue(t.generatedMap);if(null!=n){var r=o.queryRunner.connection.driver.prepareHydratedValue(n,e);e.setEntityValue(t.generatedMap,r)}})),r.label=4;case 4:return[2]}}))}))})))];case 1:return t.sent(),[2]}}))}))},e.prototype.executeRecoverOperations=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,Promise.all(this.recoverSubjects.map((function(t){return Object(r.b)(e,void 0,void 0,(function(){var e,n,i,o=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(!t.identifier)throw new K(t);return this.queryRunner instanceof h.g?(e=Q.a.mergeDeep({},t.entity),t.metadata.objectIdColumn&&t.metadata.objectIdColumn.propertyName&&delete e[t.metadata.objectIdColumn.propertyName],t.metadata.createDateColumn&&t.metadata.createDateColumn.propertyName&&delete e[t.metadata.createDateColumn.propertyName],t.metadata.updateDateColumn&&t.metadata.updateDateColumn.propertyName&&(e[t.metadata.updateDateColumn.propertyName]=new Date),t.metadata.deleteDateColumn&&t.metadata.deleteDateColumn.propertyName&&(e[t.metadata.deleteDateColumn.propertyName]=null),[4,this.queryRunner.manager.update(t.metadata.target,t.identifier,e)]):[3,2];case 1:return r.sent(),[3,4];case 2:return n=this.queryRunner.manager.createQueryBuilder().restore().from(t.metadata.target).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1),t.entity?n.whereEntity(t.identifier):n.where(t.identifier),[4,n.execute()];case 3:i=r.sent(),t.generatedMap=i.generatedMaps[0],t.generatedMap&&t.metadata.columns.forEach((function(e){var n=e.getEntityValue(t.generatedMap);if(null!=n){var r=o.queryRunner.connection.driver.prepareHydratedValue(n,e);e.setEntityValue(t.generatedMap,r)}})),r.label=4;case 4:return[2]}}))}))})))];case 1:return t.sent(),[2]}}))}))},e.prototype.updateSpecialColumnsInPersistedEntities=function(){var e=this;this.insertSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.insertSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.updateSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.softRemoveSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.recoverSubjects),this.removeSubjects.length&&this.removeSubjects.forEach((function(e){e.entity&&e.metadata.primaryColumns.forEach((function(t){t.setEntityValue(e.entity,void 0)}))})),this.allSubjects.forEach((function(t){t.entity&&(t.metadata.relationIds.forEach((function(e){e.setValue(t.entity)})),e.queryRunner instanceof h.g&&t.metadata.objectIdColumn&&t.metadata.objectIdColumn.databaseName&&t.metadata.objectIdColumn.databaseName!==t.metadata.objectIdColumn.propertyName&&delete t.entity[t.metadata.objectIdColumn.databaseName])}))},e.prototype.updateSpecialColumnsInInsertedAndUpdatedEntities=function(e){var t=this;e.forEach((function(e){e.entity&&(e.metadata.columns.forEach((function(t){if(!(e.metadata.childEntityMetadatas.length>0&&-1!==e.metadata.childEntityMetadatas.map((function(e){return e.target})).indexOf(t.target)||t.isVirtual)){if(t.isNullable)void 0===t.getEntityValue(e.entity)&&t.setEntityValue(e.entity,null);e.updatedRelationMaps.length>0&&e.updatedRelationMaps.forEach((function(t){t.relation.joinColumns.forEach((function(n){!0!==n.isVirtual&&n.setEntityValue(e.entity,t.value instanceof Object?n.referencedColumn.getEntityValue(t.value):t.value)}))}))}})),e.generatedMap&&t.queryRunner.manager.merge(e.metadata.target,e.entity,e.generatedMap))}))},e.prototype.groupBulkSubjects=function(e,t){var n={},r=[],i="delete"===t||this.queryRunner.connection.driver.isReturningSqlSupported();return e.forEach((function(e,t){var o=i||e.metadata.isJunction?e.metadata.name:e.metadata.name+"_"+t;n[o]?n[o].push(e):(n[o]=[e],r.push(o))})),[n,r]},e}(),oe=function(e){function t(n){var r=e.call(this)||this;return r.name="CannotDetermineEntityError",Object.setPrototypeOf(r,t.prototype),r.message="Cannot "+n+", given value must be instance of entity class, instead object literal is given. Or you must specify an entity target to method call.",r}return Object(r.c)(t,e),t}(Error),ae=function(){function e(e){var t;this.identifier=void 0,this.entityWithFulfilledIds=void 0,this.databaseEntityLoaded=!1,this.changeMaps=[],this.canBeInserted=!1,this.canBeUpdated=!1,this.mustBeRemoved=!1,this.canBeSoftRemoved=!1,this.canBeRecovered=!1,this.updatedRelationMaps=[],this.diffColumns=[],this.diffRelations=[],this.metadata=e.metadata,this.entity=e.entity,this.parentSubject=e.parentSubject,void 0!==e.canBeInserted&&(this.canBeInserted=e.canBeInserted),void 0!==e.canBeUpdated&&(this.canBeUpdated=e.canBeUpdated),void 0!==e.mustBeRemoved&&(this.mustBeRemoved=e.mustBeRemoved),void 0!==e.canBeSoftRemoved&&(this.canBeSoftRemoved=e.canBeSoftRemoved),void 0!==e.canBeRecovered&&(this.canBeRecovered=e.canBeRecovered),void 0!==e.identifier&&(this.identifier=e.identifier),void 0!==e.changeMaps&&(t=this.changeMaps).push.apply(t,Object(r.f)([],Object(r.e)(e.changeMaps))),this.recompute()}return Object.defineProperty(e.prototype,"mustBeInserted",{get:function(){return this.canBeInserted&&!this.databaseEntity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mustBeUpdated",{get:function(){return this.canBeUpdated&&this.identifier&&(!1===this.databaseEntityLoaded||this.databaseEntityLoaded&&this.databaseEntity)&&this.changeMaps.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mustBeSoftRemoved",{get:function(){return this.canBeSoftRemoved&&this.identifier&&(!1===this.databaseEntityLoaded||this.databaseEntityLoaded&&this.databaseEntity)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mustBeRecovered",{get:function(){return this.canBeRecovered&&this.identifier&&(!1===this.databaseEntityLoaded||this.databaseEntityLoaded&&this.databaseEntity)},enumerable:!1,configurable:!0}),e.prototype.createValueSetAndPopChangeMap=function(){var t=this,n=[],r=this.changeMaps.reduce((function(r,i){var o,a=i.value;if(a instanceof e&&(a=a.insertedValueSet?a.insertedValueSet:a.entity),t.metadata.isJunction&&i.column)o=i.column.createValueMap(i.column.referencedColumn.getEntityValue(a));else if(i.column)o=i.column.createValueMap(a);else if(i.relation)if(a instanceof Object){var s=i.relation.getRelationIdMap(a);if(void 0===s)return n.push(i),t.canBeUpdated=!0,r;o=i.relation.createValueMap(s),t.updatedRelationMaps.push({relation:i.relation,value:s})}else o=i.relation.createValueMap(a),t.updatedRelationMaps.push({relation:i.relation,value:a});return Q.a.mergeDeep(r,o),r}),{});return this.changeMaps=n,r},e.prototype.recompute=function(){var e=this;this.entity?(this.entityWithFulfilledIds=Object.assign({},this.entity),this.parentSubject&&this.metadata.primaryColumns.forEach((function(t){if(t.relationMetadata&&t.relationMetadata.inverseEntityMetadata===e.parentSubject.metadata){var n=t.referencedColumn.getEntityValue(e.parentSubject.entity);t.setEntityValue(e.entityWithFulfilledIds,n)}})),this.identifier=this.metadata.getEntityIdMap(this.entityWithFulfilledIds)):this.databaseEntity&&(this.identifier=this.metadata.getEntityIdMap(this.databaseEntity))},e}(),se=n(44),ce=function(){function e(e){this.subjects=e}return e.prototype.build=function(){var e=this;this.subjects.forEach((function(t){t.metadata.oneToManyRelations.forEach((function(n){!1!==n.persistenceEnabled&&e.buildForSubjectRelation(t,n)}))}))},e.prototype.buildForSubjectRelation=function(e,t){var n=this,r=[];e.databaseEntity&&(r=t.getEntityValue(e.databaseEntity));var i=t.getEntityValue(e.entity);if(null===i&&(i=[]),void 0!==i){var o=[];i.forEach((function(i){var a=t.inverseEntityMetadata.getEntityIdMap(i),s=n.subjects.find((function(e){return e.entity===i}));if(s&&(a=s.identifier),a){r.find((function(e){return Q.a.compareIds(a,e)}))||(s||(s=new ae({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:a}),n.subjects.push(s)),s.changeMaps.push({relation:t.inverseRelation,value:e})),o.push(a)}else{if(!s)return;s.changeMaps.push({relation:t.inverseRelation,value:e})}})),se.a.difference(r,o).forEach((function(r){var i=new ae({metadata:t.inverseEntityMetadata,parentSubject:e,identifier:r});t.inverseRelation&&"nullify"!==t.inverseRelation.orphanedRowAction?"delete"===t.inverseRelation.orphanedRowAction&&(i.mustBeRemoved=!0):(i.canBeUpdated=!0,i.changeMaps=[{relation:t.inverseRelation,value:null}]),n.subjects.push(i)}))}},e}(),ue=function(){function e(e){this.subjects=e}return e.prototype.build=function(){var e=this;this.subjects.forEach((function(t){t.metadata.oneToOneRelations.forEach((function(n){n.isOwning||!1===n.persistenceEnabled||e.buildForSubjectRelation(t,n)}))}))},e.prototype.buildForSubjectRelation=function(e,t){var n=void 0;e.databaseEntity&&(n=t.getEntityValue(e.databaseEntity));var r=t.getEntityValue(e.entity);if(void 0!==r)if(null!==r){var i=t.inverseEntityMetadata.getEntityIdMap(r),o=this.subjects.find((function(e){return!!e.entity&&e.entity===r}));if(o&&(i=o.identifier),!i){if(!o)return;o.changeMaps.push({relation:t.inverseRelation,value:e})}n&&Q.a.compareIds(i,n)||(o||(o=new ae({metadata:t.inverseEntityMetadata,canBeUpdated:!0,identifier:i}),this.subjects.push(o)),o.changeMaps.push({relation:t.inverseRelation,value:e}))}else if(n){var a=new ae({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:n,changeMaps:[{relation:t.inverseRelation,value:null}]});this.subjects.push(a)}},e}(),le=function(){function e(e){this.subjects=e}return e.prototype.build=function(){var e=this;this.subjects.forEach((function(t){t.entity&&t.metadata.manyToManyRelations.forEach((function(n){!1!==n.persistenceEnabled&&e.buildForSubjectRelation(t,n)}))}))},e.prototype.buildForAllRemoval=function(e){var t=this;e.databaseEntity&&e.metadata.manyToManyRelations.forEach((function(n){!1!==n.persistenceEnabled&&n.getEntityValue(e.databaseEntity).forEach((function(r){var i=new ae({metadata:n.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:t.buildJunctionIdentifier(e,n,r)});t.subjects.push(i)}))}))},e.prototype.buildForSubjectRelation=function(e,t){var n=this,r=[];e.databaseEntity&&(r=t.getEntityValue(e.databaseEntity));var i=t.getEntityValue(e.entity);if(null===i&&(i=[]),Array.isArray(i)){i.forEach((function(i){var o=t.inverseEntityMetadata.getEntityIdMap(i),a=n.subjects.find((function(e){return e.entity===i}));if((a&&(o=a.identifier),o||a)&&!r.find((function(e){return Q.a.compareIds(e,o)}))){var s=t.isOwning?e:a||i,c=t.isOwning?a||i:e,u=new ae({metadata:t.junctionEntityMetadata,parentSubject:e,canBeInserted:!0});n.subjects.push(u),t.junctionEntityMetadata.ownerColumns.forEach((function(e){u.changeMaps.push({column:e,value:s})})),t.junctionEntityMetadata.inverseColumns.forEach((function(e){u.changeMaps.push({column:e,value:c})}))}}));var o=[];i.forEach((function(e){var r=t.inverseEntityMetadata.getEntityIdMap(e),i=n.subjects.find((function(t){return t.entity===e}));i&&(r=i.identifier),null!=r&&o.push(r)})),r.filter((function(e){return!o.find((function(t){return Q.a.compareIds(t,e)}))})).forEach((function(r){var i=new ae({metadata:t.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:n.buildJunctionIdentifier(e,t,r)});n.subjects.push(i)}))}},e.prototype.buildJunctionIdentifier=function(e,t,n){var r=t.isOwning?e.entity:n,i=t.isOwning?n:e.entity,o={};return t.junctionEntityMetadata.ownerColumns.forEach((function(e){Q.a.mergeDeep(o,e.createValueMap(e.referencedColumn.getEntityValue(r)))})),t.junctionEntityMetadata.inverseColumns.forEach((function(e){Q.a.mergeDeep(o,e.createValueMap(e.referencedColumn.getEntityValue(i)))})),o},e}(),fe=function(){function e(e,t){this.queryRunner=e,this.subjects=t}return e.prototype.load=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n=this;return Object(r.d)(this,(function(i){switch(i.label){case 0:return t=this.groupByEntityTargets().map((function(t){return Object(r.b)(n,void 0,void 0,(function(){var n,i,o,a,s,c,u,l,f=this;return Object(r.d)(this,(function(h){switch(h.label){case 0:return n=[],i=[],t.subjects.forEach((function(e){!e.databaseEntity&&e.identifier&&(n.push(e.identifier),i.push(e))})),n.length?(o=[],"save"===e||"soft-remove"===e||"recover"===e?t.subjects.forEach((function(e){e.metadata.relations.forEach((function(t){void 0!==t.getEntityValue(e.entityWithFulfilledIds)&&-1===o.indexOf(t.propertyPath)&&o.push(t.propertyPath)}))})):o.push.apply(o,Object(r.f)([],Object(r.e)(t.subjects[0].metadata.manyToManyRelations.map((function(e){return e.propertyPath}))))),a={loadEagerRelations:!1,loadRelationIds:{relations:o,disableMixedMap:!0},withDeleted:!0},[4,this.queryRunner.manager.getRepository(t.target).findByIds(n,a)]):[2];case 1:h.sent().forEach((function(e){f.findByPersistEntityLike(t.target,e).forEach((function(t){t.databaseEntity=e,t.identifier||(t.identifier=t.metadata.hasAllPrimaryKeys(e)?t.metadata.getEntityIdMap(e):void 0)}))}));try{for(s=Object(r.g)(i),c=s.next();!c.done;c=s.next())c.value.databaseEntityLoaded=!0}catch(e){u={error:e}}finally{try{c&&!c.done&&(l=s.return)&&l.call(s)}finally{if(u)throw u.error}}return[2]}}))}))})),[4,Promise.all(t)];case 1:return i.sent(),[2]}}))}))},e.prototype.findByPersistEntityLike=function(e,t){return this.subjects.filter((function(n){return!!n.entity&&(n.entity===t||n.metadata.target===e&&n.metadata.compareEntities(n.entityWithFulfilledIds,t))}))},e.prototype.groupByEntityTargets=function(){return this.subjects.reduce((function(e,t){var n=e.find((function(e){return e.target===t.metadata.target}));return n||(n={target:t.metadata.target,subjects:[]},e.push(n)),n.subjects.push(t),e}),[])},e}(),he=function(){function e(e){this.allSubjects=e}return e.prototype.build=function(e,t){var n=this;e.metadata.extractRelationValuesFromEntity(e.entity,e.metadata.relations).forEach((function(i){var o=Object(r.e)(i,3),a=o[0],s=o[1],c=o[2];if(null!=s&&(a.isCascadeInsert||a.isCascadeUpdate||a.isCascadeSoftRemove||a.isCascadeRecover)&&s instanceof Object){var u=n.findByPersistEntityLike(c.target,s);if(u)return!1===u.canBeInserted&&(u.canBeInserted=!0===a.isCascadeInsert&&"save"===t),!1===u.canBeUpdated&&(u.canBeUpdated=!0===a.isCascadeUpdate&&"save"===t),!1===u.canBeSoftRemoved&&(u.canBeSoftRemoved=!0===a.isCascadeSoftRemove&&"soft-remove"===t),void(!1===u.canBeRecovered&&(u.canBeRecovered=!0===a.isCascadeRecover&&"recover"===t));var l=new ae({metadata:c,parentSubject:e,entity:s,canBeInserted:!0===a.isCascadeInsert&&"save"===t,canBeUpdated:!0===a.isCascadeUpdate&&"save"===t,canBeSoftRemoved:!0===a.isCascadeSoftRemove&&"soft-remove"===t,canBeRecovered:!0===a.isCascadeRecover&&"recover"===t});n.allSubjects.push(l),n.build(l,t)}}))},e.prototype.findByPersistEntityLike=function(e,t){return this.allSubjects.find((function(n){return!!n.entity&&(n.entity===t||n.metadata.target===e&&n.metadata.compareEntities(n.entityWithFulfilledIds,t))}))},e}(),de=function(){function e(e,t,n,r,i,o){this.connection=e,this.queryRunner=t,this.mode=n,this.target=r,this.entity=i,this.options=o}return e.prototype.execute=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u,l,f,h,d=this;return Object(r.d)(this,(function(p){switch(p.label){case 0:return this.entity&&"object"==typeof this.entity?[4,Promise.resolve()]:[2,Promise.reject(new z(this.mode,this.entity))];case 1:p.sent(),e=this.queryRunner||this.connection.createQueryRunner(),this.options&&this.options.data&&(e.data=this.options.data),p.label=2;case 2:return p.trys.push([2,,22,25]),t=Array.isArray(this.entity)?this.entity:[this.entity],n=this.options&&this.options.chunk&&this.options.chunk>0?Q.a.chunk(t,this.options.chunk):[t],[4,Promise.all(n.map((function(t){return Object(r.b)(d,void 0,void 0,(function(){var n,i,o=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=[],t.forEach((function(e){var t=o.target?o.target:e.constructor;if(t===Object)throw new oe(o.mode);n.push(new ae({metadata:o.connection.getMetadata(t),entity:e,canBeInserted:"save"===o.mode,canBeUpdated:"save"===o.mode,mustBeRemoved:"remove"===o.mode,canBeSoftRemoved:"soft-remove"===o.mode,canBeRecovered:"recover"===o.mode}))})),i=new he(n),n.forEach((function(e){i.build(e,o.mode)})),[4,new fe(e,n).load(this.mode)];case 1:return r.sent(),"save"===this.mode||"soft-remove"===this.mode||"recover"===this.mode?(new ce(n).build(),new ue(n).build(),new le(n).build()):n.forEach((function(e){e.mustBeRemoved&&new le(n).buildForAllRemoval(e)})),[2,new ie(e,n,this.options)]}}))}))})))];case 3:if(i=p.sent(),0===(o=i.filter((function(e){return e.hasExecutableOperations}))).length)return[2];a=!1,p.label=4;case 4:return p.trys.push([4,16,,21]),e.isTransactionActive?[3,6]:this.options&&!1===this.options.transaction?[3,6]:(a=!0,[4,e.startTransaction()]);case 5:p.sent(),p.label=6;case 6:p.trys.push([6,11,12,13]),s=Object(r.g)(o),c=s.next(),p.label=7;case 7:return c.done?[3,10]:[4,c.value.execute()];case 8:p.sent(),p.label=9;case 9:return c=s.next(),[3,7];case 10:return[3,13];case 11:return u=p.sent(),f={error:u},[3,13];case 12:try{c&&!c.done&&(h=s.return)&&h.call(s)}finally{if(f)throw f.error}return[7];case 13:return!0!==a?[3,15]:[4,e.commitTransaction()];case 14:p.sent(),p.label=15;case 15:return[3,21];case 16:if(l=p.sent(),!a)return[3,20];p.label=17;case 17:return p.trys.push([17,19,,20]),[4,e.rollbackTransaction()];case 18:return p.sent(),[3,20];case 19:return p.sent(),[3,20];case 20:throw l;case 21:return[3,25];case 22:return this.queryRunner?[3,24]:[4,e.release()];case 23:p.sent(),p.label=24;case 24:return[7];case 25:return[2]}}))}))},e}(),pe=n(30),me=function(){function e(e,t){this.repositories=[],this.plainObjectToEntityTransformer=new M,this.connection=e,t&&(this.queryRunner=t,pe.a.assign(this.queryRunner,{manager:this}))}return e.prototype.transaction=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(n="string"==typeof e?e:void 0,!(i="function"==typeof e?e:t))throw new Error("Transaction method requires callback in second paramter if isolation level is supplied.");if(this.connection.driver instanceof h.e)throw new Error("Transactions aren't supported by MongoDB.");if(this.queryRunner&&this.queryRunner.isReleased)throw new E;if(this.queryRunner&&this.queryRunner.isTransactionActive)throw new Error("Cannot start transaction because its already started");o=this.queryRunner||this.connection.createQueryRunner(),r.label=1;case 1:return r.trys.push([1,8,13,16]),n?[4,o.startTransaction(n)]:[3,3];case 2:return r.sent(),[3,5];case 3:return[4,o.startTransaction()];case 4:r.sent(),r.label=5;case 5:return[4,i(o.manager)];case 6:return a=r.sent(),[4,o.commitTransaction()];case 7:return r.sent(),[2,a];case 8:s=r.sent(),r.label=9;case 9:return r.trys.push([9,11,,12]),[4,o.rollbackTransaction()];case 10:return r.sent(),[3,12];case 11:return r.sent(),[3,12];case 12:throw s;case 13:return this.queryRunner?[3,15]:[4,o.release()];case 14:r.sent(),r.label=15;case 15:return[7];case 16:return[2]}}))}))},e.prototype.query=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(n){return[2,this.connection.query(e,t,this.queryRunner)]}))}))},e.prototype.createQueryBuilder=function(e,t,n){return t?this.connection.createQueryBuilder(e,t,n||this.queryRunner):this.connection.createQueryBuilder(e||n||this.queryRunner)},e.prototype.hasId=function(e,t){var n=2===arguments.length?e:e.constructor,r=2===arguments.length?t:e,i=this.connection.getMetadata(n);return i.hasId(r)},e.prototype.getId=function(e,t){var n=2===arguments.length?e:e.constructor,r=2===arguments.length?t:e,i=this.connection.getMetadata(n);return i.getEntityIdMixedMap(r)},e.prototype.create=function(e,t){var n=this,r=this.connection.getMetadata(e);if(!t)return r.create(this.queryRunner);if(Array.isArray(t))return t.map((function(t){return n.create(e,t)}));var i=r.create(this.queryRunner);return this.plainObjectToEntityTransformer.transform(i,t,r,!0),i},e.prototype.merge=function(e,t){for(var n=this,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=this.connection.getMetadata(e);return r.forEach((function(e){return n.plainObjectToEntityTransformer.transform(t,e,o)})),t},e.prototype.preload=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=this.connection.getMetadata(e),[4,new I(this.connection.manager).transform(t,n)];case 1:return(i=r.sent())?[2,this.merge(e,i,t)]:[2,void 0]}}))}))},e.prototype.save=function(e,t,n){var r=arguments.length>1&&(e instanceof Function||e instanceof Xt.a||"string"==typeof e)?e:void 0,i=r?t:e,o=r?n:t;return r instanceof Xt.a&&(r=r.options.name),Array.isArray(i)&&0===i.length?Promise.resolve(i):new de(this.connection,this.queryRunner,"save",r,i,o).execute().then((function(){return i}))},e.prototype.remove=function(e,t,n){var r=arguments.length>1&&(e instanceof Function||"string"==typeof e)?e:void 0,i=r?t:e,o=r?n:t;return Array.isArray(i)&&0===i.length?Promise.resolve(i):new de(this.connection,this.queryRunner,"remove",r,i,o).execute().then((function(){return i}))},e.prototype.softRemove=function(e,t,n){var r=arguments.length>1&&(e instanceof Function||e instanceof Xt.a||"string"==typeof e)?e:void 0,i=r?t:e,o=r?n:t;return r instanceof Xt.a&&(r=r.options.name),Array.isArray(i)&&0===i.length?Promise.resolve(i):new de(this.connection,this.queryRunner,"soft-remove",r,i,o).execute().then((function(){return i}))},e.prototype.recover=function(e,t,n){var r=arguments.length>1&&(e instanceof Function||e instanceof Xt.a||"string"==typeof e)?e:void 0,i=r?t:e,o=r?n:t;return r instanceof Xt.a&&(r=r.options.name),Array.isArray(i)&&0===i.length?Promise.resolve(i):new de(this.connection,this.queryRunner,"recover",r,i,o).execute().then((function(){return i}))},e.prototype.insert=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(n){return[2,this.createQueryBuilder().insert().into(e).values(t).execute()]}))}))},e.prototype.update=function(e,t,n){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new Error("Empty criteria(s) are not allowed for the update method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().update(e).set(n).whereInIds(t).execute():this.createQueryBuilder().update(e).set(n).where(t).execute()},e.prototype.delete=function(e,t){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new Error("Empty criteria(s) are not allowed for the delete method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().delete().from(e).whereInIds(t).execute():this.createQueryBuilder().delete().from(e).where(t).execute()},e.prototype.softDelete=function(e,t){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new Error("Empty criteria(s) are not allowed for the delete method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().softDelete().from(e).whereInIds(t).execute():this.createQueryBuilder().softDelete().from(e).where(t).execute()},e.prototype.restore=function(e,t){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new Error("Empty criteria(s) are not allowed for the delete method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().restore().from(e).whereInIds(t).execute():this.createQueryBuilder().restore().from(e).where(t).execute()},e.prototype.count=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){return n=this.connection.getMetadata(e),i=this.createQueryBuilder(e,N.extractFindManyOptionsAlias(t)||n.name),[2,N.applyFindManyOptionsOrConditionsToQueryBuilder(i,t).getCount()]}))}))},e.prototype.find=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){return n=this.connection.getMetadata(e),i=this.createQueryBuilder(e,N.extractFindManyOptionsAlias(t)||n.name),N.isFindManyOptions(t)&&!1===t.loadEagerRelations||N.joinEagerRelations(i,i.alias,n),[2,N.applyFindManyOptionsOrConditionsToQueryBuilder(i,t).getMany()]}))}))},e.prototype.findAndCount=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){return n=this.connection.getMetadata(e),i=this.createQueryBuilder(e,N.extractFindManyOptionsAlias(t)||n.name),N.isFindManyOptions(t)&&!1===t.loadEagerRelations||N.joinEagerRelations(i,i.alias,n),[2,N.applyFindManyOptionsOrConditionsToQueryBuilder(i,t).getManyAndCount()]}))}))},e.prototype.findByIds=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o;return Object(r.d)(this,(function(r){return t.length?(i=this.connection.getMetadata(e),o=this.createQueryBuilder(e,N.extractFindManyOptionsAlias(n)||i.name),N.applyFindManyOptionsOrConditionsToQueryBuilder(o,n),N.isFindManyOptions(n)&&!1===n.loadEagerRelations||N.joinEagerRelations(o,o.alias,i),[2,o.andWhereInIds(t).getMany()]):[2,Promise.resolve([])]}))}))},e.prototype.findOne=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,a,s,c,u;return Object(r.d)(this,(function(l){return i=void 0,N.isFindOneOptions(t)?i=t:n&&N.isFindOneOptions(n)&&(i=n),o=void 0,t instanceof Object&&!N.isFindOneOptions(t)&&(o=t),a=this.connection.getMetadata(e),s=a.name,i&&i.join?s=i.join.alias:n&&N.isFindOneOptions(n)&&n.join&&(s=n.join.alias),c=this.createQueryBuilder(e,s),i&&!1===i.loadEagerRelations||N.joinEagerRelations(c,c.alias,c.expressionMap.mainAlias.metadata),(u="string"==typeof t||"number"==typeof t||t instanceof Date)||(i=Object(r.a)(Object(r.a)({},i||{}),{take:1})),N.applyOptionsToQueryBuilder(c,i),o?c.where(o):u&&c.andWhereInIds(a.ensureEntityIdMap(t)),[2,c.getOne()]}))}))},e.prototype.findOneOrFail=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(r){return[2,this.findOne(e,t,n).then((function(n){return void 0===n?Promise.reject(new O.a(e,t)):Promise.resolve(n)}))]}))}))},e.prototype.clear=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:t=this.connection.getMetadata(e),n=this.queryRunner||this.connection.createQueryRunner(),r.label=1;case 1:return r.trys.push([1,,3,6]),[4,n.clearTable(t.tablePath)];case 2:return[2,r.sent()];case 3:return this.queryRunner?[3,5]:[4,n.release()];case 4:r.sent(),r.label=5;case 5:return[7];case 6:return[2]}}))}))},e.prototype.increment=function(e,t,n,i){return Object(r.b)(this,void 0,void 0,(function(){var o,a,s,c=this;return Object(r.d)(this,(function(r){if(o=this.connection.getMetadata(e),!(a=o.findColumnWithPropertyPath(n)))throw new Error("Column "+n+" was not found in "+o.targetName+" entity.");if(isNaN(Number(i)))throw new Error('Value "'+i+'" is not a number.');return s=n.split(".").reduceRight((function(e,t){var n;return(n={})[t]=e,n}),(function(){return c.connection.driver.escape(a.databaseName)+" + "+i})),[2,this.createQueryBuilder(e,"entity").update(e).set(s).where(t).execute()]}))}))},e.prototype.decrement=function(e,t,n,i){return Object(r.b)(this,void 0,void 0,(function(){var o,a,s,c=this;return Object(r.d)(this,(function(r){if(o=this.connection.getMetadata(e),!(a=o.findColumnWithPropertyPath(n)))throw new Error("Column "+n+" was not found in "+o.targetName+" entity.");if(isNaN(Number(i)))throw new Error('Value "'+i+'" is not a number.');return s=n.split(".").reduceRight((function(e,t){var n;return(n={})[t]=e,n}),(function(){return c.connection.driver.escape(a.databaseName)+" - "+i})),[2,this.createQueryBuilder(e,"entity").update(e).set(s).where(t).execute()]}))}))},e.prototype.getRepository=function(e){if(!this.connection.hasMetadata(e))throw new q(this.connection.name,e);var t=this.connection.getMetadata(e),n=this.repositories.find((function(e){return e.metadata===t}));if(n)return n;var r=(new U).create(this,t,this.queryRunner);return this.repositories.push(r),r},e.prototype.getTreeRepository=function(e){if(!1===this.connection.driver.treeSupport)throw new H(this.connection.driver);var t=this.getRepository(e);if(!(t instanceof C))throw new V(e);return t},e.prototype.getMongoRepository=function(e){return this.connection.getMongoRepository(e)},e.prototype.getCustomRepository=function(e){var t=Pr().entityRepositories.find((function(t){return t.target===(e instanceof Function?e:e.constructor)}));if(!t)throw new D(e);var n=t.entity?this.connection.getMetadata(t.entity):void 0,r=new t.target(this,n);if(r instanceof B&&(r.manager||(r.manager=this)),r instanceof x){if(!n)throw new F(e);r.manager=this,r.metadata=n}return r},e.prototype.release=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){if(!this.queryRunner)throw new T;return[2,this.queryRunner.release()]}))}))},e}(),ye=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.driver=t.driver,r}return Object(r.c)(t,e),t.prototype.loadDatabase=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.driver.load(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.saveDatabase=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.driver.save(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.exportDatabase=function(){return this.driver.export()},t}(me),ge=n(50),be=function(){function e(){}return e.prototype.create=function(e,t){return e.driver instanceof h.e?new h.f(e):e.driver instanceof ge.a?new ye(e,t):new me(e,t)},e}(),ve=function(e){function t(n){var r=e.call(this)||this;return r.name="MissingDriverError",Object.setPrototypeOf(r,t.prototype),r.message='Wrong driver: "'+n+'" given. Supported drivers are: "cordova", "expo", "mariadb", "mongodb", "mssql", "mysql", "oracle", "postgres", "sqlite", "better-sqlite3", "sqljs", "react-native", "aurora-data-api", "aurora-data-api-pg".',r}return Object(r.c)(t,e),t}(Error),we=n(35),_e=n(45),ke=n(65),Ee=n(51),Oe=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new Ee.a(n),n}return Object(r.c)(t,e),t.prototype.query=function(e,t){var n=this;if(this.isReleased)throw new we.a;return new Promise((function(i,o){return Object(r.b)(n,void 0,void 0,(function(){var n,a,s=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.connect()];case 1:return n=r.sent(),this.driver.connection.logger.logQuery(e,t,this),a=+new Date,n.executeSql(e,t,(function(n){var r=s.driver.connection.options.maxQueryExecutionTime,o=+new Date-a;if(r&&o>r&&s.driver.connection.logger.logQuerySlow(o,e,t,s),"INSERT INTO"===e.substr(0,11))i(n.insertId);else{for(var c=[],u=0;u<n.rows.length;u++)c.push(n.rows.item(u));i(c)}}),(function(n){s.driver.connection.logger.logQueryError(n,e,t,s),o(new _e.a(e,t,n))})),[2]}}))}))}))},t.prototype.parametrize=function(e,t){return void 0===t&&(t=0),Object.keys(e).map((function(e,t){return'"'+e+'"=?'}))},t}(ke.a),Te=n(47),xe=n(83),Se=function(e){function t(t){var n=e.call(this,t)||this;if(n.database=n.options.database,!n.options.database)throw new Te.a("database");if(!n.options.location)throw new Te.a("location");return n.loadDependencies(),n}return Object(r.c)(t,e),t.prototype.disconnect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){return[2,new Promise((function(t,n){e.queryRunner=void 0,e.databaseConnection.close(t,n)}))]}))}))},t.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new Oe(this)),this.queryRunner},t.prototype.createDatabaseConnection=function(){var e=this;return new Promise((function(t,n){var r=Object.assign({},{name:e.options.database,location:e.options.location},e.options.extra||{});e.sqlite.openDatabase(r,(function(e){var r=e;r.executeSql("PRAGMA foreign_keys = ON;",[],(function(e){t(r)}),(function(e){n(e)}))}),(function(e){n(e)}))}))},t.prototype.loadDependencies=function(){try{this.sqlite=window.sqlitePlugin}catch(e){throw new xe.a("Cordova-SQLite","cordova-sqlite-storage")}},t}(S.a),Ce=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new Ee.a(n),n}return Object(r.c)(t,e),t.prototype.query=function(e,t){var n=this;if(this.isReleased)throw new we.a;return new Promise((function(i,o){return Object(r.b)(n,void 0,void 0,(function(){var n,a,s=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.connect()];case 1:return n=r.sent(),this.driver.connection.logger.logQuery(e,t,this),a=+new Date,n.executeSql(e,t,(function(n){var r=s.driver.connection.options.maxQueryExecutionTime,o=+new Date-a;if(r&&o>r&&s.driver.connection.logger.logQuerySlow(o,e,t,s),"INSERT INTO"===e.substr(0,11))i(n.insertId);else{for(var c=[],u=0;u<n.rows.length;u++)c.push(n.rows.item(u));i(c)}}),(function(n){s.driver.connection.logger.logQueryError(n,e,t,s),o(new _e.a(e,t,n))})),[2]}}))}))}))},t.prototype.parametrize=function(e,t){return void 0===t&&(t=0),Object.keys(e).map((function(e,t){return'"'+e+'"=?'}))},t}(ke.a),Re=function(e){function t(t){var n=e.call(this,t)||this;if(n.database=n.options.database,!n.options.database)throw new Te.a("database");if(!n.options.location)throw new Te.a("location");return n.loadDependencies(),n}return Object(r.c)(t,e),t.prototype.disconnect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){return[2,new Promise((function(t,n){e.queryRunner=void 0,e.databaseConnection.close(t,n)}))]}))}))},t.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new Ce(this)),this.queryRunner},t.prototype.createDatabaseConnection=function(){var e=this;return new Promise((function(t,n){var r=Object.assign({},{name:e.options.database,location:e.options.location},e.options.extra||{});e.sqlite.openDatabase(r,(function(e){var r=e;r.executeSql("PRAGMA foreign_keys = ON;",[],(function(e){t(r)}),(function(e){n(e)}))}),(function(e){n(e)}))}))},t.prototype.loadDependencies=function(){try{this.sqlite=n(!function(){var e=new Error("Cannot find module 'react-native-sqlite-storage'");throw e.code="MODULE_NOT_FOUND",e}())}catch(e){throw new xe.a("React-Native","react-native-sqlite-storage")}},t}(S.a),Pe=n(288),Ne=n(82),Me=n(53),Ae=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new Ee.a(n),n}return Object(r.c)(t,e),t.prototype.startTransaction=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(this.isTransactionActive&&void 0!==this.transaction)throw new Ne.a;return e=new X.a,this.broadcaster.broadcastBeforeTransactionStartEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isTransactionActive=!0,t=new X.a,this.broadcaster.broadcastAfterTransactionStartEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.prototype.commitTransaction=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive&&void 0===this.transaction)throw new Me.a;return e=new X.a,this.broadcaster.broadcastBeforeTransactionCommitEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isTransactionActive=!1,this.transaction=void 0,t=new X.a,this.broadcaster.broadcastAfterTransactionCommitEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.prototype.rollbackTransaction=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive&&void 0===this.transaction)throw new Me.a;return e=new X.a,this.broadcaster.broadcastBeforeTransactionRollbackEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isTransactionActive=!1,this.transaction=void 0,t=new X.a,this.broadcaster.broadcastAfterTransactionRollbackEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.prototype.query=function(e,t){var n=this;if(this.isReleased)throw new we.a;return new Promise((function(i,o){return Object(r.b)(n,void 0,void 0,(function(){var n,a,s=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.connect()];case 1:return n=r.sent(),this.driver.connection.logger.logQuery(e,t,this),a=+new Date,n.transaction((function(n){void 0===s.transaction&&(s.startTransaction(),s.transaction=n),s.transaction.executeSql(e,t,(function(n,r){var o=s.driver.connection.options.maxQueryExecutionTime,c=+new Date-a;if(o&&c>o&&s.driver.connection.logger.logQuerySlow(c,e,t,s),"INSERT INTO"===e.substr(0,11))i(r.insertId);else{for(var u=[],l=0;l<r.rows.length;l++)u.push(r.rows.item(l));i(u)}}),(function(n,r){s.driver.connection.logger.logQueryError(r,e,t,s),o(new _e.a(e,t,r))}))}),(function(e){s.rollbackTransaction()}),(function(){s.isTransactionActive=!1,s.transaction=void 0})),[2]}}))}))}))},t}(ke.a),je=function(e){function t(t){var n=e.call(this,t)||this;if(n.database=n.options.database,!n.options.database)throw new Te.a("database");if(!n.options.driver)throw new Te.a("driver");return n.sqlite=n.options.driver,n}return Object(r.c)(t,e),t.prototype.disconnect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){return[2,new Promise((function(t,n){try{e.queryRunner=void 0,e.databaseConnection._db.close(),e.databaseConnection=void 0,t()}catch(e){n(e)}}))]}))}))},t.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new Ae(this)),this.queryRunner},t.prototype.createDatabaseConnection=function(){var e=this;return new Promise((function(t,n){try{var r=e.sqlite.openDatabase(e.options.database);r.transaction((function(e){e.executeSql("PRAGMA foreign_keys = ON;",[],(function(e,n){t(r)}),(function(e,t){n({transaction:e,error:t})}))}),(function(e){n(e)}))}catch(e){n(e)}}))},t}(S.a),Ie=n(15),De=n(167),Le=n(52),Be=n(32),Fe=n(70),qe=n(58),Ve=n(48),Ue=n(40),He=n(72),ze=n(3),We=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.client=n,i}return Object(r.c)(t,e),t.prototype.connect=function(){var e=this;return this.databaseConnection?Promise.resolve(this.databaseConnection):(this.databaseConnectionPromise||("slave"===this.mode&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then((function(t){var n=Object(r.e)(t,2),i=n[0],o=n[1];return e.driver.connectedQueryRunners.push(e),e.databaseConnection=i,e.releaseCallback=o,e.databaseConnection})):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then((function(t){var n=Object(r.e)(t,2),i=n[0],o=n[1];return e.driver.connectedQueryRunners.push(e),e.databaseConnection=i,e.releaseCallback=o,e.databaseConnection}))),this.databaseConnectionPromise)},t.prototype.startTransaction=function(e){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(this.isTransactionActive)throw new Ne.a;return e=new X.a,this.broadcaster.broadcastBeforeTransactionStartEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isTransactionActive=!0,[4,this.client.startTransaction()];case 3:return n.sent(),t=new X.a,this.broadcaster.broadcastAfterTransactionStartEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.commitTransaction=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new Me.a;return e=new X.a,this.broadcaster.broadcastBeforeTransactionCommitEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.client.commitTransaction()];case 3:return n.sent(),this.isTransactionActive=!1,t=new X.a,this.broadcaster.broadcastAfterTransactionCommitEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.rollbackTransaction=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new Me.a;return e=new X.a,this.broadcaster.broadcastBeforeTransactionRollbackEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.client.rollbackTransaction()];case 3:return n.sent(),t=new X.a,this.broadcaster.broadcastAfterTransactionRollbackEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.query=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(this.isReleased)throw new we.a;return[4,this.client.query(e,t)];case 1:return(n=r.sent()).records?[2,n.records]:[2,n]}}))}))},t}(function(e){function t(t,n){return e.call(this,t,n)||this}return Object(r.c)(t,e),t}(function(e){function t(t,n){var r=e.call(this)||this;return r.driver=t,r.connection=t.connection,r.mode=n,r.broadcaster=new Ee.a(r),r}return Object(r.c)(t,e),t.prototype.connect=function(){var e=this;return this.databaseConnection?Promise.resolve(this.databaseConnection):(this.databaseConnectionPromise||("slave"===this.mode&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then((function(t){var n=Object(r.e)(t,2),i=n[0],o=n[1];e.driver.connectedQueryRunners.push(e),e.databaseConnection=i;var a=function(){return e.release()};return e.releaseCallback=function(){e.databaseConnection.removeListener("error",a),o()},e.databaseConnection.on("error",a),e.databaseConnection})):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then((function(t){var n=Object(r.e)(t,2),i=n[0],o=n[1];e.driver.connectedQueryRunners.push(e),e.databaseConnection=i;var a=function(){return e.release()};return e.releaseCallback=function(){e.databaseConnection.removeListener("error",a),o()},e.databaseConnection.on("error",a),e.databaseConnection}))),this.databaseConnectionPromise)},t.prototype.release=function(){if(this.isReleased)return Promise.resolve();this.isReleased=!0,this.releaseCallback&&this.releaseCallback();var e=this.driver.connectedQueryRunners.indexOf(this);return-1!==e&&this.driver.connectedQueryRunners.splice(e,1),Promise.resolve()},t.prototype.startTransaction=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(this.isTransactionActive)throw new Ne.a;return t=new X.a,this.broadcaster.broadcastBeforeTransactionStartEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.isTransactionActive=!0,[4,this.query("START TRANSACTION")];case 3:return r.sent(),e?[4,this.query("SET TRANSACTION ISOLATION LEVEL "+e)]:[3,5];case 4:r.sent(),r.label=5;case 5:return n=new X.a,this.broadcaster.broadcastAfterTransactionStartEvent(n),n.promises.length>0?[4,Promise.all(n.promises)]:[3,7];case 6:r.sent(),r.label=7;case 7:return[2]}}))}))},t.prototype.commitTransaction=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new Me.a;return e=new X.a,this.broadcaster.broadcastBeforeTransactionCommitEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.query("COMMIT")];case 3:return n.sent(),this.isTransactionActive=!1,t=new X.a,this.broadcaster.broadcastAfterTransactionCommitEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.rollbackTransaction=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new Me.a;return e=new X.a,this.broadcaster.broadcastBeforeTransactionRollbackEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.query("ROLLBACK")];case 3:return n.sent(),this.isTransactionActive=!1,t=new X.a,this.broadcaster.broadcastAfterTransactionRollbackEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.query=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c,u;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(this.isReleased)throw new we.a;return[4,this.connect()];case 1:n=r.sent(),this.driver.connection.logger.logQuery(e,t,this),r.label=2;case 2:return r.trys.push([2,4,,5]),i=+new Date,[4,n.query(e,t)];case 3:switch(o=r.sent(),a=this.driver.connection.options.maxQueryExecutionTime,s=+new Date,c=s-i,a&&c>a&&this.driver.connection.logger.logQuerySlow(c,e,t,this),o.command){case"DELETE":case"UPDATE":return[2,[o.rows,o.rowCount]];default:return[2,o.rows]}return[3,5];case 4:throw u=r.sent(),this.driver.connection.logger.logQueryError(u,e,t,this),new _e.a(e,t,u);case 5:return[2]}}))}))},t.prototype.stream=function(e,t,n,i){var o=this,a=this.driver.loadStreamDependency();if(this.isReleased)throw new we.a;return new Promise((function(s,c){return Object(r.b)(o,void 0,void 0,(function(){var o,u,l;return Object(r.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.connect()];case 1:return o=r.sent(),this.driver.connection.logger.logQuery(e,t,this),u=o.query(new a(e,t)),n&&u.on("end",n),i&&u.on("error",i),s(u),[3,3];case 2:return l=r.sent(),c(l),[3,3];case 3:return[2]}}))}))}))},t.prototype.getDatabases=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve([])]}))}))},t.prototype.getSchemas=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve([])]}))}))},t.prototype.hasDatabase=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.query("SELECT * FROM pg_database WHERE datname='"+e+"';")];case 1:return[2,!!t.sent().length]}}))}))},t.prototype.getCurrentDatabase=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:return[4,this.query("SELECT * FROM current_database()")];case 1:return[2,e.sent()[0].current_database]}}))}))},t.prototype.hasSchema=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.query('SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = \''+e+"'")];case 1:return[2,!!t.sent().length]}}))}))},t.prototype.getCurrentSchema=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:return[4,this.query("SELECT * FROM current_schema()")];case 1:return[2,e.sent()[0].current_schema]}}))}))},t.prototype.hasTable=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t=this.parseTableName(e),n='SELECT * FROM "information_schema"."tables" WHERE "table_schema" = '+t.schema+' AND "table_name" = '+t.tableName,[4,this.query(n)];case 1:return[2,!!r.sent().length]}}))}))},t.prototype.hasColumn=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=this.parseTableName(e),i='SELECT * FROM "information_schema"."columns" WHERE "table_schema" = '+n.schema+' AND "table_name" = '+n.tableName+' AND "column_name" = \''+t+"'",[4,this.query(i)];case 1:return[2,!!r.sent().length]}}))}))},t.prototype.createDatabase=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t?[4,this.hasDatabase(e)]:[3,2];case 1:if(r.sent())return[2,Promise.resolve()];r.label=2;case 2:return n='CREATE DATABASE "'+e+'"',i='DROP DATABASE "'+e+'"',[4,this.executeQueries(new ze.a(n),new ze.a(i))];case 3:return r.sent(),[2]}}))}))},t.prototype.dropDatabase=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=t?'DROP DATABASE IF EXISTS "'+e+'"':'DROP DATABASE "'+e+'"',i='CREATE DATABASE "'+e+'"',[4,this.executeQueries(new ze.a(n),new ze.a(i))];case 1:return r.sent(),[2]}}))}))},t.prototype.createSchema=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=t?'CREATE SCHEMA IF NOT EXISTS "'+e+'"':'CREATE SCHEMA "'+e+'"',i='DROP SCHEMA "'+e+'" CASCADE',[4,this.executeQueries(new ze.a(n),new ze.a(i))];case 1:return r.sent(),[2]}}))}))},t.prototype.dropSchema=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,a;return Object(r.d)(this,(function(r){switch(r.label){case 0:return i=-1===e.indexOf(".")?e:e.split(".")[0],o=t?'DROP SCHEMA IF EXISTS "'+i+'" '+(n?"CASCADE":""):'DROP SCHEMA "'+i+'" '+(n?"CASCADE":""),a='CREATE SCHEMA "'+i+'"',[4,this.executeQueries(new ze.a(o),new ze.a(a))];case 1:return r.sent(),[2]}}))}))},t.prototype.createTable=function(e,t,n,i){return void 0===t&&(t=!1),void 0===n&&(n=!0),void 0===i&&(i=!0),Object(r.b)(this,void 0,void 0,(function(){var o,a,s,c,u,l,f,h,d,p,m,y,g=this;return Object(r.d)(this,(function(b){switch(b.label){case 0:return t?[4,this.hasTable(e)]:[3,2];case 1:if(b.sent())return[2,Promise.resolve()];b.label=2;case 2:o=[],a=[],s=e.columns.filter((function(e){return"enum"===e.type||"simple-enum"===e.type})),c=[],b.label=3;case 3:b.trys.push([3,8,9,10]),u=Object(r.g)(s),l=u.next(),b.label=4;case 4:return l.done?[3,7]:(f=l.value,[4,this.hasEnumType(e,f)]);case 5:h=b.sent(),d=this.buildEnumName(e,f),h||-1!==c.indexOf(d)||(c.push(d),o.push(this.createEnumTypeSql(e,f,d)),a.push(this.dropEnumTypeSql(e,f,d))),b.label=6;case 6:return l=u.next(),[3,4];case 7:return[3,10];case 8:return p=b.sent(),m={error:p},[3,10];case 9:try{l&&!l.done&&(y=u.return)&&y.call(u)}finally{if(m)throw m.error}return[7];case 10:return o.push(this.createTableSql(e,n)),a.push(this.dropTableSql(e)),n&&e.foreignKeys.forEach((function(t){return a.push(g.dropForeignKeySql(e,t))})),i&&e.indices.forEach((function(t){t.name||(t.name=g.connection.namingStrategy.indexName(e.name,t.columnNames,t.where)),o.push(g.createIndexSql(e,t)),a.push(g.dropIndexSql(e,t))})),[4,this.executeQueries(o,a)];case 11:return b.sent(),[2]}}))}))},t.prototype.dropTable=function(e,t,n,i){return void 0===n&&(n=!0),void 0===i&&(i=!0),Object(r.b)(this,void 0,void 0,(function(){var o,s,c,u,l,f=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t?[4,this.hasTable(e)]:[3,2];case 1:if(!r.sent())return[2,Promise.resolve()];r.label=2;case 2:return o=n,s=e instanceof a.a?e.name:e,[4,this.getCachedTable(s)];case 3:return c=r.sent(),u=[],l=[],i&&c.indices.forEach((function(e){u.push(f.dropIndexSql(c,e)),l.push(f.createIndexSql(c,e))})),n&&c.foreignKeys.forEach((function(e){return u.push(f.dropForeignKeySql(c,e))})),u.push(this.dropTableSql(c)),l.push(this.createTableSql(c,o)),[4,this.executeQueries(u,l)];case 4:return r.sent(),[2]}}))}))},t.prototype.createView=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=[],(t=[]).push(this.createViewSql(e)),o=(i=t).push,[4,this.insertViewDefinitionSql(e)];case 1:return o.apply(i,[r.sent()]),n.push(this.dropViewSql(e)),s=(a=n).push,[4,this.deleteViewDefinitionSql(e)];case 2:return s.apply(a,[r.sent()]),[4,this.executeQueries(t,n)];case 3:return r.sent(),[2]}}))}))},t.prototype.dropView=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t=e instanceof He.a?e.name:e,[4,this.getCachedView(t)];case 1:return n=r.sent(),o=[],s=(a=i=[]).push,[4,this.deleteViewDefinitionSql(n)];case 2:return s.apply(a,[r.sent()]),i.push(this.dropViewSql(n)),u=(c=o).push,[4,this.insertViewDefinitionSql(n)];case 3:return u.apply(c,[r.sent()]),o.push(this.createViewSql(n)),[4,this.executeQueries(i,o)];case 4:return r.sent(),[2]}}))}))},t.prototype.renameTable=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,c,u,l,f,h,d,p,m,y,g,b,v,w,_,k=this;return Object(r.d)(this,(function(E){switch(E.label){case 0:return n=[],i=[],e instanceof a.a?(s=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:s=E.sent(),E.label=3;case 3:c=(o=s).clone(),u=-1===o.name.indexOf(".")?o.name:o.name.split(".")[1],l=-1===o.name.indexOf(".")?void 0:o.name.split(".")[0],c.name=l?l+"."+t:t,n.push(new ze.a("ALTER TABLE "+this.escapePath(o)+' RENAME TO "'+t+'"')),i.push(new ze.a("ALTER TABLE "+this.escapePath(c)+' RENAME TO "'+u+'"')),c.primaryColumns.length>0&&(f=c.primaryColumns.map((function(e){return e.name})),h=this.connection.namingStrategy.primaryKeyName(o,f),d=this.connection.namingStrategy.primaryKeyName(c,f),n.push(new ze.a("ALTER TABLE "+this.escapePath(c)+' RENAME CONSTRAINT "'+h+'" TO "'+d+'"')),i.push(new ze.a("ALTER TABLE "+this.escapePath(c)+' RENAME CONSTRAINT "'+d+'" TO "'+h+'"'))),c.columns.map((function(e){if(e.isGenerated&&"increment"===e.generationStrategy){var t=k.buildSequenceName(o,e.name,void 0,!0,!0),r=k.buildSequenceName(c,e.name,void 0,!0,!0),a=l?'ALTER SEQUENCE "'+l+'"."'+t+'" RENAME TO "'+r+'"':'ALTER SEQUENCE "'+t+'" RENAME TO "'+r+'"',s=l?'ALTER SEQUENCE "'+l+'"."'+r+'" RENAME TO "'+t+'"':'ALTER SEQUENCE "'+r+'" RENAME TO "'+t+'"';n.push(new ze.a(a)),i.push(new ze.a(s))}})),c.uniques.forEach((function(e){var t=k.connection.namingStrategy.uniqueConstraintName(c,e.columnNames);n.push(new ze.a("ALTER TABLE "+k.escapePath(c)+' RENAME CONSTRAINT "'+e.name+'" TO "'+t+'"')),i.push(new ze.a("ALTER TABLE "+k.escapePath(c)+' RENAME CONSTRAINT "'+t+'" TO "'+e.name+'"')),e.name=t})),c.indices.forEach((function(e){var t=k.extractSchema(c),r=k.connection.namingStrategy.indexName(c,e.columnNames,e.where),o=t?'ALTER INDEX "'+t+'"."'+e.name+'" RENAME TO "'+r+'"':'ALTER INDEX "'+e.name+'" RENAME TO "'+r+'"',a=t?'ALTER INDEX "'+t+'"."'+r+'" RENAME TO "'+e.name+'"':'ALTER INDEX "'+r+'" RENAME TO "'+e.name+'"';n.push(new ze.a(o)),i.push(new ze.a(a)),e.name=r})),c.foreignKeys.forEach((function(e){var t=k.connection.namingStrategy.foreignKeyName(c,e.columnNames,e.referencedTableName,e.referencedColumnNames);n.push(new ze.a("ALTER TABLE "+k.escapePath(c)+' RENAME CONSTRAINT "'+e.name+'" TO "'+t+'"')),i.push(new ze.a("ALTER TABLE "+k.escapePath(c)+' RENAME CONSTRAINT "'+t+'" TO "'+e.name+'"')),e.name=t})),p=c.columns.filter((function(e){return"enum"===e.type||"simple-enum"===e.type})),E.label=4;case 4:E.trys.push([4,9,10,11]),m=Object(r.g)(p),y=m.next(),E.label=5;case 5:return y.done?[3,8]:(g=y.value).enumName?[3,7]:[4,this.getUserDefinedTypeName(o,g)];case 6:b=E.sent(),n.push(new ze.a('ALTER TYPE "'+b.schema+'"."'+b.name+'" RENAME TO '+this.buildEnumName(c,g,!1))),i.push(new ze.a("ALTER TYPE "+this.buildEnumName(c,g)+' RENAME TO "'+b.name+'"')),E.label=7;case 7:return y=m.next(),[3,5];case 8:return[3,11];case 9:return v=E.sent(),w={error:v},[3,11];case 10:try{y&&!y.done&&(_=m.return)&&_.call(m)}finally{if(w)throw w.error}return[7];case 11:return[4,this.executeQueries(n,i)];case 12:return E.sent(),[2]}}))}))},t.prototype.addColumn=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,c,u,l,f,h,d,p,m;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),s=[],c=[],"enum"!==t.type&&"simple-enum"!==t.type?[3,5]:[4,this.hasEnumType(n,t)];case 4:r.sent()||(s.push(this.createEnumTypeSql(n,t)),c.push(this.dropEnumTypeSql(n,t))),r.label=5;case 5:return s.push(new ze.a("ALTER TABLE "+this.escapePath(n)+" ADD "+this.buildCreateColumnSql(n,t))),c.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' DROP COLUMN "'+t.name+'"')),t.isPrimary&&((u=o.primaryColumns).length>0&&(l=this.connection.namingStrategy.primaryKeyName(o.name,u.map((function(e){return e.name}))),f=u.map((function(e){return'"'+e.name+'"'})).join(", "),s.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' DROP CONSTRAINT "'+l+'"')),c.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' ADD CONSTRAINT "'+l+'" PRIMARY KEY ('+f+")"))),u.push(t),h=this.connection.namingStrategy.primaryKeyName(o.name,u.map((function(e){return e.name}))),d=u.map((function(e){return'"'+e.name+'"'})).join(", "),s.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' ADD CONSTRAINT "'+h+'" PRIMARY KEY ('+d+")")),c.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' DROP CONSTRAINT "'+h+'"'))),(p=o.indices.find((function(e){return 1===e.columnNames.length&&e.columnNames[0]===t.name})))&&(s.push(this.createIndexSql(n,p)),c.push(this.dropIndexSql(n,p))),t.isUnique&&(m=new Ue.a({name:this.connection.namingStrategy.uniqueConstraintName(n.name,[t.name]),columnNames:[t.name]}),o.uniques.push(m),s.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' ADD CONSTRAINT "'+m.name+'" UNIQUE ("'+t.name+'")')),c.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' DROP CONSTRAINT "'+m.name+'"'))),t.comment&&(s.push(new ze.a("COMMENT ON COLUMN "+this.escapePath(n)+'."'+t.name+'" IS '+this.escapeComment(t.comment))),c.push(new ze.a("COMMENT ON COLUMN "+this.escapePath(n)+'."'+t.name+'" IS '+this.escapeComment(t.comment)))),[4,this.executeQueries(s,c)];case 6:return r.sent(),o.addColumn(t),this.replaceCachedTable(n,o),[2]}}))}))},t.prototype.addColumns=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Object(r.g)(t),i=n.next(),u.label=1;case 1:return i.done?[3,4]:(o=i.value,[4,this.addColumn(e,o)]);case 2:u.sent(),u.label=3;case 3:return i=n.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),s={error:a},[3,7];case 6:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},t.prototype.renameColumn=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s,c;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(o=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:o=r.sent(),r.label=3;case 3:if(i=o,!(s=t instanceof Be.a?t:i.columns.find((function(e){return e.name===t}))))throw new Error('Column "'+t+'" was not found in the "'+i.name+'" table.');return n instanceof Be.a?c=n:(c=s.clone()).name=n,[2,this.changeColumn(i,s,c)]}}))}))},t.prototype.changeColumn=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s,c,u,l,f,h,d,p,m,y,g,b,v,w,_,k,E,O,T,x,S,C,R,P,N,M,A,j=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(o=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:o=r.sent(),r.label=3;case 3:if(s=(i=o).clone(),c=[],u=[],l=!1,!(f=t instanceof Be.a?t:i.columns.find((function(e){return e.name===t}))))throw new Error('Column "'+t+'" was not found in the "'+i.name+'" table.');return f.type===n.type&&f.length===n.length&&n.isArray===f.isArray?[3,6]:[4,this.dropColumn(i,f)];case 4:return r.sent(),[4,this.addColumn(i,n)];case 5:return r.sent(),s=i.clone(),[3,10];case 6:return f.name===n.name?[3,9]:(c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' RENAME COLUMN "'+f.name+'" TO "'+n.name+'"')),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' RENAME COLUMN "'+n.name+'" TO "'+f.name+'"')),"enum"!==f.type&&"simple-enum"!==f.type?[3,8]:[4,this.getUserDefinedTypeName(i,f)]);case 7:h=r.sent(),c.push(new ze.a('ALTER TYPE "'+h.schema+'"."'+h.name+'" RENAME TO '+this.buildEnumName(i,n,!1))),u.push(new ze.a("ALTER TYPE "+this.buildEnumName(i,n)+' RENAME TO "'+h.name+'"')),r.label=8;case 8:!0===f.isPrimary&&(R=s.primaryColumns,M=R.map((function(e){return e.name})),d=this.connection.namingStrategy.primaryKeyName(s,M),M.splice(M.indexOf(f.name),1),M.push(n.name),p=this.connection.namingStrategy.primaryKeyName(s,M),c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' RENAME CONSTRAINT "'+d+'" TO "'+p+'"')),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' RENAME CONSTRAINT "'+p+'" TO "'+d+'"'))),!0===f.isGenerated&&"increment"===n.generationStrategy&&(m=this.extractSchema(i),y=this.buildSequenceName(i,f.name,void 0,!0,!0),g=this.buildSequenceName(i,n.name,void 0,!0,!0),b=m?'ALTER SEQUENCE "'+m+'"."'+y+'" RENAME TO "'+g+'"':'ALTER SEQUENCE "'+y+'" RENAME TO "'+g+'"',v=m?'ALTER SEQUENCE "'+m+'"."'+g+'" RENAME TO "'+y+'"':'ALTER SEQUENCE "'+g+'" RENAME TO "'+y+'"',c.push(new ze.a(b)),u.push(new ze.a(v))),s.findColumnUniques(f).forEach((function(e){e.columnNames.splice(e.columnNames.indexOf(f.name),1),e.columnNames.push(n.name);var t=j.connection.namingStrategy.uniqueConstraintName(s,e.columnNames);c.push(new ze.a("ALTER TABLE "+j.escapePath(i)+' RENAME CONSTRAINT "'+e.name+'" TO "'+t+'"')),u.push(new ze.a("ALTER TABLE "+j.escapePath(i)+' RENAME CONSTRAINT "'+t+'" TO "'+e.name+'"')),e.name=t})),s.findColumnIndices(f).forEach((function(e){e.columnNames.splice(e.columnNames.indexOf(f.name),1),e.columnNames.push(n.name);var t=j.extractSchema(i),r=j.connection.namingStrategy.indexName(s,e.columnNames,e.where),o=t?'ALTER INDEX "'+t+'"."'+e.name+'" RENAME TO "'+r+'"':'ALTER INDEX "'+e.name+'" RENAME TO "'+r+'"',a=t?'ALTER INDEX "'+t+'"."'+r+'" RENAME TO "'+e.name+'"':'ALTER INDEX "'+r+'" RENAME TO "'+e.name+'"';c.push(new ze.a(o)),u.push(new ze.a(a)),e.name=r})),s.findColumnForeignKeys(f).forEach((function(e){e.columnNames.splice(e.columnNames.indexOf(f.name),1),e.columnNames.push(n.name);var t=j.connection.namingStrategy.foreignKeyName(s,e.columnNames,e.referencedTableName,e.referencedColumnNames);c.push(new ze.a("ALTER TABLE "+j.escapePath(i)+' RENAME CONSTRAINT "'+e.name+'" TO "'+t+'"')),u.push(new ze.a("ALTER TABLE "+j.escapePath(i)+' RENAME CONSTRAINT "'+t+'" TO "'+e.name+'"')),e.name=t})),w=s.columns.find((function(e){return e.name===f.name})),s.columns[s.columns.indexOf(w)].name=n.name,f.name=n.name,r.label=9;case 9:n.precision===f.precision&&n.scale===f.scale||(c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" TYPE '+this.driver.createFullType(n))),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" TYPE '+this.driver.createFullType(f)))),"enum"!==n.type&&"simple-enum"!==n.type||"enum"!==f.type&&"simple-enum"!==f.type||Q.a.isArraysEqual(n.enum,f.enum)&&n.enumName===f.enumName||(_=n.isArray?"[]":"",k=this.buildEnumName(i,n),E=this.buildEnumName(i,f),O=this.buildEnumName(i,f,!1),T=this.buildEnumName(i,f,!0,!1,!0),x=this.buildEnumName(i,f,!1,!1,!0),c.push(new ze.a("ALTER TYPE "+E+" RENAME TO "+x)),u.push(new ze.a("ALTER TYPE "+T+" RENAME TO "+O)),c.push(this.createEnumTypeSql(i,n,k)),u.push(this.dropEnumTypeSql(i,n,k)),null!==f.default&&void 0!==f.default&&(l=!0,c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+f.name+'" DROP DEFAULT')),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+f.name+'" SET DEFAULT '+f.default))),S=""+k+_+' USING "'+n.name+'"::"text"::'+k+_,C=""+T+_+' USING "'+n.name+'"::"text"::'+T+_,c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" TYPE '+S)),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" TYPE '+C)),null!==n.default&&void 0!==n.default&&(c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" SET DEFAULT '+n.default)),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" DROP DEFAULT'))),c.push(this.dropEnumTypeSql(i,f,T)),u.push(this.createEnumTypeSql(i,f,T))),f.isNullable!==n.isNullable&&(n.isNullable?(c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+f.name+'" DROP NOT NULL')),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+f.name+'" SET NOT NULL'))):(c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+f.name+'" SET NOT NULL')),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+f.name+'" DROP NOT NULL')))),f.comment!==n.comment&&(c.push(new ze.a("COMMENT ON COLUMN "+this.escapePath(i)+'."'+f.name+'" IS '+this.escapeComment(n.comment))),u.push(new ze.a("COMMENT ON COLUMN "+this.escapePath(i)+'."'+n.name+'" IS '+this.escapeComment(f.comment)))),n.isPrimary!==f.isPrimary&&((R=s.primaryColumns).length>0&&(N=this.connection.namingStrategy.primaryKeyName(s.name,R.map((function(e){return e.name}))),M=R.map((function(e){return'"'+e.name+'"'})).join(", "),c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+N+'"')),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+N+'" PRIMARY KEY ('+M+")"))),!0===n.isPrimary?(R.push(n),s.columns.find((function(e){return e.name===n.name})).isPrimary=!0,N=this.connection.namingStrategy.primaryKeyName(s.name,R.map((function(e){return e.name}))),M=R.map((function(e){return'"'+e.name+'"'})).join(", "),c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+N+'" PRIMARY KEY ('+M+")")),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+N+'"'))):(P=R.find((function(e){return e.name===n.name})),R.splice(R.indexOf(P),1),s.columns.find((function(e){return e.name===n.name})).isPrimary=!1,R.length>0&&(N=this.connection.namingStrategy.primaryKeyName(s.name,R.map((function(e){return e.name}))),M=R.map((function(e){return'"'+e.name+'"'})).join(", "),c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+N+'" PRIMARY KEY ('+M+")")),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+N+'"'))))),n.isUnique!==f.isUnique&&(!0===n.isUnique?(A=new Ue.a({name:this.connection.namingStrategy.uniqueConstraintName(i.name,[n.name]),columnNames:[n.name]}),s.uniques.push(A),c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+A.name+'" UNIQUE ("'+n.name+'")')),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+A.name+'"'))):(A=s.uniques.find((function(e){return 1===e.columnNames.length&&!!e.columnNames.find((function(e){return e===n.name}))})),s.uniques.splice(s.uniques.indexOf(A),1),c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' DROP CONSTRAINT "'+A.name+'"')),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ADD CONSTRAINT "'+A.name+'" UNIQUE ("'+n.name+'")')))),f.isGenerated!==n.isGenerated&&"uuid"!==n.generationStrategy&&(!0===n.isGenerated?(c.push(new ze.a("CREATE SEQUENCE "+this.buildSequenceName(i,n)+" OWNED BY "+this.escapePath(i)+'."'+n.name+'"')),u.push(new ze.a("DROP SEQUENCE "+this.buildSequenceName(i,n))),c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+"\" SET DEFAULT nextval('"+this.buildSequenceName(i,n,void 0,!0)+"')")),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" DROP DEFAULT'))):(c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" DROP DEFAULT')),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+"\" SET DEFAULT nextval('"+this.buildSequenceName(i,n,void 0,!0)+"')")),c.push(new ze.a("DROP SEQUENCE "+this.buildSequenceName(i,n))),u.push(new ze.a("CREATE SEQUENCE "+this.buildSequenceName(i,n)+" OWNED BY "+this.escapePath(i)+'."'+n.name+'"')))),n.default===f.default||l||(null!==n.default&&void 0!==n.default?(c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" SET DEFAULT '+n.default)),null!==f.default&&void 0!==f.default?u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" SET DEFAULT '+f.default)):u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" DROP DEFAULT'))):null!==f.default&&void 0!==f.default&&(c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" DROP DEFAULT')),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" SET DEFAULT '+f.default)))),(n.spatialFeatureType||"").toLowerCase()===(f.spatialFeatureType||"").toLowerCase()&&n.srid===f.srid||(c.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" TYPE '+this.driver.createFullType(n))),u.push(new ze.a("ALTER TABLE "+this.escapePath(i)+' ALTER COLUMN "'+n.name+'" TYPE '+this.driver.createFullType(f)))),r.label=10;case 10:return[4,this.executeQueries(c,u)];case 11:return r.sent(),this.replaceCachedTable(i,s),[2]}}))}))},t.prototype.changeColumns=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c,u,l;return Object(r.d)(this,(function(f){switch(f.label){case 0:f.trys.push([0,5,6,7]),n=Object(r.g)(t),i=n.next(),f.label=1;case 1:return i.done?[3,4]:(o=i.value,a=o.oldColumn,s=o.newColumn,[4,this.changeColumn(e,a,s)]);case 2:f.sent(),f.label=3;case 3:return i=n.next(),[3,1];case 4:return[3,7];case 5:return c=f.sent(),u={error:c},[3,7];case 6:try{i&&!i.done&&(l=n.return)&&l.call(n)}finally{if(u)throw u.error}return[7];case 7:return[2]}}))}))},t.prototype.dropColumn=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,c,u,l,f,h,d,p,m,y,g,b;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof Be.a?t:n.findColumnByName(t)))throw new Error('Column "'+t+'" was not found in table "'+n.name+'"');return s=n.clone(),c=[],u=[],o.isPrimary&&(l=this.connection.namingStrategy.primaryKeyName(s.name,s.primaryColumns.map((function(e){return e.name}))),f=s.primaryColumns.map((function(e){return'"'+e.name+'"'})).join(", "),c.push(new ze.a("ALTER TABLE "+this.escapePath(s)+' DROP CONSTRAINT "'+l+'"')),u.push(new ze.a("ALTER TABLE "+this.escapePath(s)+' ADD CONSTRAINT "'+l+'" PRIMARY KEY ('+f+")")),s.findColumnByName(o.name).isPrimary=!1,s.primaryColumns.length>0&&(h=this.connection.namingStrategy.primaryKeyName(s.name,s.primaryColumns.map((function(e){return e.name}))),d=s.primaryColumns.map((function(e){return'"'+e.name+'"'})).join(", "),c.push(new ze.a("ALTER TABLE "+this.escapePath(s)+' ADD CONSTRAINT "'+h+'" PRIMARY KEY ('+d+")")),u.push(new ze.a("ALTER TABLE "+this.escapePath(s)+' DROP CONSTRAINT "'+h+'"')))),(p=s.indices.find((function(e){return 1===e.columnNames.length&&e.columnNames[0]===o.name})))&&(s.indices.splice(s.indices.indexOf(p),1),c.push(this.dropIndexSql(n,p)),u.push(this.createIndexSql(n,p))),(m=s.checks.find((function(e){return!!e.columnNames&&1===e.columnNames.length&&e.columnNames[0]===o.name})))&&(s.checks.splice(s.checks.indexOf(m),1),c.push(this.dropCheckConstraintSql(n,m)),u.push(this.createCheckConstraintSql(n,m))),(y=s.uniques.find((function(e){return 1===e.columnNames.length&&e.columnNames[0]===o.name})))&&(s.uniques.splice(s.uniques.indexOf(y),1),c.push(this.dropUniqueConstraintSql(n,y)),u.push(this.createUniqueConstraintSql(n,y))),c.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' DROP COLUMN "'+o.name+'"')),u.push(new ze.a("ALTER TABLE "+this.escapePath(n)+" ADD "+this.buildCreateColumnSql(n,o))),"enum"!==o.type&&"simple-enum"!==o.type?[3,6]:[4,this.hasEnumType(n,o)];case 4:return r.sent()?[4,this.getUserDefinedTypeName(n,o)]:[3,6];case 5:g=r.sent(),b='"'+g.schema+'"."'+g.name+'"',c.push(this.dropEnumTypeSql(n,o,b)),u.push(this.createEnumTypeSql(n,o,b)),r.label=6;case 6:return[4,this.executeQueries(c,u)];case 7:return r.sent(),s.removeColumn(o),this.replaceCachedTable(n,s),[2]}}))}))},t.prototype.dropColumns=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Object(r.g)(t),i=n.next(),u.label=1;case 1:return i.done?[3,4]:(o=i.value,[4,this.dropColumn(e,o)]);case 2:u.sent(),u.label=3;case 3:return i=n.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),s={error:a},[3,7];case 6:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},t.prototype.createPrimaryKey=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,c;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),s=this.createPrimaryKeySql(n,t),o.columns.forEach((function(e){t.find((function(t){return t===e.name}))&&(e.isPrimary=!0)})),c=this.dropPrimaryKeySql(o),[4,this.executeQueries(s,c)];case 4:return r.sent(),this.replaceCachedTable(n,o),[2]}}))}))},t.prototype.updatePrimaryKeys=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,c,u,l,f,h,d,p;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),s=t.map((function(e){return e.name})),c=[],u=[],(l=o.primaryColumns).length>0&&(f=this.connection.namingStrategy.primaryKeyName(o.name,l.map((function(e){return e.name}))),h=l.map((function(e){return'"'+e.name+'"'})).join(", "),c.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' DROP CONSTRAINT "'+f+'"')),u.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' ADD CONSTRAINT "'+f+'" PRIMARY KEY ('+h+")"))),o.columns.filter((function(e){return-1!==s.indexOf(e.name)})).forEach((function(e){return e.isPrimary=!0})),d=this.connection.namingStrategy.primaryKeyName(o.name,s),p=s.map((function(e){return'"'+e+'"'})).join(", "),c.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' ADD CONSTRAINT "'+d+'" PRIMARY KEY ('+p+")")),u.push(new ze.a("ALTER TABLE "+this.escapePath(n)+' DROP CONSTRAINT "'+d+'"')),[4,this.executeQueries(c,u)];case 4:return r.sent(),this.replaceCachedTable(n,o),[2]}}))}))},t.prototype.dropPrimaryKey=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(n=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:n=r.sent(),r.label=3;case 3:return t=n,i=this.dropPrimaryKeySql(t),o=this.createPrimaryKeySql(t,t.primaryColumns.map((function(e){return e.name}))),[4,this.executeQueries(i,o)];case 4:return r.sent(),t.primaryColumns.forEach((function(e){e.isPrimary=!1})),[2]}}))}))},t.prototype.createUniqueConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return n=i,t.name||(t.name=this.connection.namingStrategy.uniqueConstraintName(n.name,t.columnNames)),o=this.createUniqueConstraintSql(n,t),s=this.dropUniqueConstraintSql(n,t),[4,this.executeQueries(o,s)];case 4:return r.sent(),n.addUniqueConstraint(t),[2]}}))}))},t.prototype.createUniqueConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Object(r.g)(t),i=n.next(),u.label=1;case 1:return i.done?[3,4]:(o=i.value,[4,this.createUniqueConstraint(e,o)]);case 2:u.sent(),u.label=3;case 3:return i=n.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),s={error:a},[3,7];case 6:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},t.prototype.dropUniqueConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,c;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof Ue.a?t:n.uniques.find((function(e){return e.name===t}))))throw new Error("Supplied unique constraint was not found in table "+n.name);return s=this.dropUniqueConstraintSql(n,o),c=this.createUniqueConstraintSql(n,o),[4,this.executeQueries(s,c)];case 4:return r.sent(),n.removeUniqueConstraint(o),[2]}}))}))},t.prototype.dropUniqueConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Object(r.g)(t),i=n.next(),u.label=1;case 1:return i.done?[3,4]:(o=i.value,[4,this.dropUniqueConstraint(e,o)]);case 2:u.sent(),u.label=3;case 3:return i=n.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),s={error:a},[3,7];case 6:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},t.prototype.createCheckConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return n=i,t.name||(t.name=this.connection.namingStrategy.checkConstraintName(n.name,t.expression)),o=this.createCheckConstraintSql(n,t),s=this.dropCheckConstraintSql(n,t),[4,this.executeQueries(o,s)];case 4:return r.sent(),n.addCheckConstraint(t),[2]}}))}))},t.prototype.createCheckConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=t.map((function(t){return i.createCheckConstraint(e,t)})),[4,Promise.all(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.dropCheckConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,c;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof Le.a?t:n.checks.find((function(e){return e.name===t}))))throw new Error("Supplied check constraint was not found in table "+n.name);return s=this.dropCheckConstraintSql(n,o),c=this.createCheckConstraintSql(n,o),[4,this.executeQueries(s,c)];case 4:return r.sent(),n.removeCheckConstraint(o),[2]}}))}))},t.prototype.dropCheckConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=t.map((function(t){return i.dropCheckConstraint(e,t)})),[4,Promise.all(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.createExclusionConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return n=i,t.name||(t.name=this.connection.namingStrategy.exclusionConstraintName(n.name,t.expression)),o=this.createExclusionConstraintSql(n,t),s=this.dropExclusionConstraintSql(n,t),[4,this.executeQueries(o,s)];case 4:return r.sent(),n.addExclusionConstraint(t),[2]}}))}))},t.prototype.createExclusionConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=t.map((function(t){return i.createExclusionConstraint(e,t)})),[4,Promise.all(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.dropExclusionConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,c;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof Fe.a?t:n.exclusions.find((function(e){return e.name===t}))))throw new Error("Supplied exclusion constraint was not found in table "+n.name);return s=this.dropExclusionConstraintSql(n,o),c=this.createExclusionConstraintSql(n,o),[4,this.executeQueries(s,c)];case 4:return r.sent(),n.removeExclusionConstraint(o),[2]}}))}))},t.prototype.dropExclusionConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=t.map((function(t){return i.dropExclusionConstraint(e,t)})),[4,Promise.all(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.createForeignKey=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return n=i,t.name||(t.name=this.connection.namingStrategy.foreignKeyName(n.name,t.columnNames,t.referencedTableName,t.referencedColumnNames)),o=this.createForeignKeySql(n,t),s=this.dropForeignKeySql(n,t),[4,this.executeQueries(o,s)];case 4:return r.sent(),n.addForeignKey(t),[2]}}))}))},t.prototype.createForeignKeys=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Object(r.g)(t),i=n.next(),u.label=1;case 1:return i.done?[3,4]:(o=i.value,[4,this.createForeignKey(e,o)]);case 2:u.sent(),u.label=3;case 3:return i=n.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),s={error:a},[3,7];case 6:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},t.prototype.dropForeignKey=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,c;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof qe.a?t:n.foreignKeys.find((function(e){return e.name===t}))))throw new Error("Supplied foreign key was not found in table "+n.name);return s=this.dropForeignKeySql(n,o),c=this.createForeignKeySql(n,o),[4,this.executeQueries(s,c)];case 4:return r.sent(),n.removeForeignKey(o),[2]}}))}))},t.prototype.dropForeignKeys=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Object(r.g)(t),i=n.next(),u.label=1;case 1:return i.done?[3,4]:(o=i.value,[4,this.dropForeignKey(e,o)]);case 2:u.sent(),u.label=3;case 3:return i=n.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),s={error:a},[3,7];case 6:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},t.prototype.createIndex=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return n=i,t.name||(t.name=this.connection.namingStrategy.indexName(n.name,t.columnNames,t.where)),o=this.createIndexSql(n,t),s=this.dropIndexSql(n,t),[4,this.executeQueries(o,s)];case 4:return r.sent(),n.addIndex(t),[2]}}))}))},t.prototype.createIndices=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Object(r.g)(t),i=n.next(),u.label=1;case 1:return i.done?[3,4]:(o=i.value,[4,this.createIndex(e,o)]);case 2:u.sent(),u.label=3;case 3:return i=n.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),s={error:a},[3,7];case 6:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},t.prototype.dropIndex=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,s,c;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof a.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof Ve.a?t:n.indices.find((function(e){return e.name===t}))))throw new Error("Supplied index was not found in table "+n.name);return s=this.dropIndexSql(n,o),c=this.createIndexSql(n,o),[4,this.executeQueries(s,c)];case 4:return r.sent(),n.removeIndex(o),[2]}}))}))},t.prototype.dropIndices=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Object(r.g)(t),i=n.next(),u.label=1;case 1:return i.done?[3,4]:(o=i.value,[4,this.dropIndex(e,o)]);case 2:u.sent(),u.label=3;case 3:return i=n.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),s={error:a},[3,7];case 6:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},t.prototype.clearTable=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.query("TRUNCATE TABLE "+this.escapePath(e))];case 1:return t.sent(),[2]}}))}))},t.prototype.clearDatabase=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u,l=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e=[],this.connection.entityMetadatas.filter((function(e){return e.schema})).forEach((function(t){!!e.find((function(e){return e===t.schema}))||e.push(t.schema)})),e.push(this.driver.options.schema||"current_schema()"),t=e.map((function(e){return"current_schema()"===e?e:"'"+e+"'"})).join(", "),[4,this.startTransaction()];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,11,,16]),n='SELECT \'DROP VIEW IF EXISTS "\' || schemaname || \'"."\' || viewname || \'" CASCADE;\' as "query" FROM "pg_views" WHERE "schemaname" IN ('+t+") AND \"viewname\" NOT IN ('geography_columns', 'geometry_columns', 'raster_columns', 'raster_overviews')",[4,this.query(n)];case 3:return i=r.sent(),[4,Promise.all(i.map((function(e){return l.query(e.query)})))];case 4:return r.sent(),o='SELECT \'DROP MATERIALIZED VIEW IF EXISTS "\' || schemaname || \'"."\' || matviewname || \'" CASCADE;\' as "query" FROM "pg_matviews" WHERE "schemaname" IN ('+t+")",[4,this.query(o)];case 5:return a=r.sent(),[4,Promise.all(a.map((function(e){return l.query(e.query)})))];case 6:return r.sent(),s='SELECT \'DROP TABLE IF EXISTS "\' || schemaname || \'"."\' || tablename || \'" CASCADE;\' as "query" FROM "pg_tables" WHERE "schemaname" IN ('+t+") AND \"tablename\" NOT IN ('spatial_ref_sys')",[4,this.query(s)];case 7:return c=r.sent(),[4,Promise.all(c.map((function(e){return l.query(e.query)})))];case 8:return r.sent(),[4,this.dropEnumTypes(t)];case 9:return r.sent(),[4,this.commitTransaction()];case 10:return r.sent(),[3,16];case 11:u=r.sent(),r.label=12;case 12:return r.trys.push([12,14,,15]),[4,this.rollbackTransaction()];case 13:return r.sent(),[3,15];case 14:return r.sent(),[3,15];case 15:throw u;case 16:return[2]}}))}))},t.prototype.loadViews=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o=this;return Object(r.d)(this,(function(a){switch(a.label){case 0:return[4,this.hasTable(this.getTypeormMetadataTableName())];case 1:return a.sent()?[4,this.getCurrentSchema()]:[2,Promise.resolve([])];case 2:return t=a.sent(),n=e.map((function(e){var n=Object(r.e)(e.split("."),2),i=n[0],a=n[1];return a||(a=i,i=o.driver.options.schema||t),'("t"."schema" = \''+i+'\' AND "t"."name" = \''+a+"')"})).join(" OR "),i='SELECT "t".* FROM '+this.escapePath(this.getTypeormMetadataTableName())+' "t" INNER JOIN "pg_catalog"."pg_class" "c" ON "c"."relname" = "t"."name" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "c"."relnamespace" AND "n"."nspname" = "t"."schema" WHERE "t"."type" IN (\'VIEW\', \'MATERIALIZED_VIEW\') '+(n?"AND ("+n+")":""),[4,this.query(i)];case 3:return[2,a.sent().map((function(e){var n=new He.a,r=e.schema!==t||o.driver.options.schema?e.schema:void 0;return n.name=o.driver.buildTableName(e.name,r),n.expression=e.value,n.materialized="MATERIALIZED_VIEW"===e.type,n}))]}}))}))},t.prototype.loadTables=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,s,c,u,l,f,h,d,p,m,y,g,b,v=this;return Object(r.d)(this,(function(w){switch(w.label){case 0:return e&&e.length?[4,this.getCurrentSchema()]:[2,[]];case 1:return t=w.sent(),n=e.map((function(e){var n=Object(r.e)(e.split("."),2),i=n[0],o=n[1];return o||(o=i,i=v.driver.options.schema||t),'("table_schema" = \''+i+"' AND \"table_name\" = '"+o+"')"})).join(" OR "),i='SELECT * FROM "information_schema"."tables" WHERE '+n,o='SELECT columns.*, pg_catalog.col_description((\'"\' || table_catalog || \'"."\' || table_schema || \'"."\' || table_name || \'"\')::regclass::oid, ordinal_position) AS description, (\'"\' || "udt_schema" || \'"."\' || "udt_name" || \'"\')::"regtype" AS "regtype", pg_catalog.format_type("col_attr"."atttypid", "col_attr"."atttypmod") AS "format_type" FROM "information_schema"."columns" LEFT JOIN "pg_catalog"."pg_attribute" AS "col_attr" ON "col_attr"."attname" = "columns"."column_name" AND "col_attr"."attrelid" = ( SELECT "cls"."oid" FROM "pg_catalog"."pg_class" AS "cls" LEFT JOIN "pg_catalog"."pg_namespace" AS "ns" ON "ns"."oid" = "cls"."relnamespace" WHERE "cls"."relname" = "columns"."table_name" AND "ns"."nspname" = "columns"."table_schema" ) WHERE '+n,s=e.map((function(e){var n=Object(r.e)(e.split("."),2),i=n[0],o=n[1];return o||(o=i,i=v.driver.options.schema||t),'("ns"."nspname" = \''+i+'\' AND "t"."relname" = \''+o+"')"})).join(" OR "),c='SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "cnst"."conname" AS "constraint_name", pg_get_constraintdef("cnst"."oid") AS "expression", CASE "cnst"."contype" WHEN \'p\' THEN \'PRIMARY\' WHEN \'u\' THEN \'UNIQUE\' WHEN \'c\' THEN \'CHECK\' WHEN \'x\' THEN \'EXCLUDE\' END AS "constraint_type", "a"."attname" AS "column_name" FROM "pg_constraint" "cnst" INNER JOIN "pg_class" "t" ON "t"."oid" = "cnst"."conrelid" INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "cnst"."connamespace" LEFT JOIN "pg_attribute" "a" ON "a"."attrelid" = "cnst"."conrelid" AND "a"."attnum" = ANY ("cnst"."conkey") WHERE "t"."relkind" IN (\'r\', \'p\') AND ('+s+")",u='SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "i"."relname" AS "constraint_name", "a"."attname" AS "column_name", CASE "ix"."indisunique" WHEN \'t\' THEN \'TRUE\' ELSE\'FALSE\' END AS "is_unique", pg_get_expr("ix"."indpred", "ix"."indrelid") AS "condition", "types"."typname" AS "type_name" FROM "pg_class" "t" INNER JOIN "pg_index" "ix" ON "ix"."indrelid" = "t"."oid" INNER JOIN "pg_attribute" "a" ON "a"."attrelid" = "t"."oid"  AND "a"."attnum" = ANY ("ix"."indkey") INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "t"."relnamespace" INNER JOIN "pg_class" "i" ON "i"."oid" = "ix"."indexrelid" INNER JOIN "pg_type" "types" ON "types"."oid" = "a"."atttypid" LEFT JOIN "pg_constraint" "cnst" ON "cnst"."conname" = "i"."relname" WHERE "t"."relkind" IN (\'r\', \'p\') AND "cnst"."contype" IS NULL AND ('+s+")",l=e.map((function(e){var n=Object(r.e)(e.split("."),2),i=n[0],o=n[1];return o||(o=i,i=v.driver.options.schema||t),'("ns"."nspname" = \''+i+'\' AND "cl"."relname" = \''+o+"')"})).join(" OR "),[4,this.hasSupportForPartitionedTables()];case 2:return f=w.sent(),h='SELECT "con"."conname" AS "constraint_name", "con"."nspname" AS "table_schema", "con"."relname" AS "table_name", "att2"."attname" AS "column_name", "ns"."nspname" AS "referenced_table_schema", "cl"."relname" AS "referenced_table_name", "att"."attname" AS "referenced_column_name", "con"."confdeltype" AS "on_delete", "con"."confupdtype" AS "on_update", "con"."condeferrable" AS "deferrable", "con"."condeferred" AS "deferred" FROM ( SELECT UNNEST ("con1"."conkey") AS "parent", UNNEST ("con1"."confkey") AS "child", "con1"."confrelid", "con1"."conrelid", "con1"."conname", "con1"."contype", "ns"."nspname", "cl"."relname", "con1"."condeferrable", CASE WHEN "con1"."condeferred" THEN \'INITIALLY DEFERRED\' ELSE \'INITIALLY IMMEDIATE\' END as condeferred, CASE "con1"."confdeltype" WHEN \'a\' THEN \'NO ACTION\' WHEN \'r\' THEN \'RESTRICT\' WHEN \'c\' THEN \'CASCADE\' WHEN \'n\' THEN \'SET NULL\' WHEN \'d\' THEN \'SET DEFAULT\' END as "confdeltype", CASE "con1"."confupdtype" WHEN \'a\' THEN \'NO ACTION\' WHEN \'r\' THEN \'RESTRICT\' WHEN \'c\' THEN \'CASCADE\' WHEN \'n\' THEN \'SET NULL\' WHEN \'d\' THEN \'SET DEFAULT\' END as "confupdtype" FROM "pg_class" "cl" INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_constraint" "con1" ON "con1"."conrelid" = "cl"."oid" WHERE "con1"."contype" = \'f\' AND ('+l+') ) "con" INNER JOIN "pg_attribute" "att" ON "att"."attrelid" = "con"."confrelid" AND "att"."attnum" = "con"."child" INNER JOIN "pg_class" "cl" ON "cl"."oid" = "con"."confrelid" '+(f?' AND "cl"."relispartition" = \'f\'':"")+'INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_attribute" "att2" ON "att2"."attrelid" = "con"."conrelid" AND "att2"."attnum" = "con"."parent"',[4,Promise.all([this.query(i),this.query(o),this.query(c),this.query(u),this.query(h)])];case 3:return d=r.e.apply(void 0,[w.sent(),5]),p=d[0],m=d[1],y=d[2],g=d[3],b=d[4],p.length?[2,Promise.all(p.map((function(e){return Object(r.b)(v,void 0,void 0,(function(){var i,o,s,c,u,l,f,h,d,p,v=this;return Object(r.d)(this,(function(w){switch(w.label){case 0:return i=new a.a,s=(o=function(e,n){return e[n]!==t||v.driver.options.schema&&v.driver.options.schema!==t?e[n]:void 0})(e,"table_schema"),i.name=this.driver.buildTableName(e.table_name,s),c=this.driver.buildTableName(e.table_name,e.table_schema),u=i,[4,Promise.all(m.filter((function(e){return v.driver.buildTableName(e.table_name,e.table_schema)===c})).map((function(o){return Object(r.b)(v,void 0,void 0,(function(){var a,s,u,l,f,h,d,p,m,g,b,v,w,_,k=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return a=y.filter((function(e){return k.driver.buildTableName(e.table_name,e.table_schema)===c&&e.column_name===o.column_name})),(s=new Be.a).name=o.column_name,s.type=o.regtype.toLowerCase(),"numeric"!==s.type&&"decimal"!==s.type&&"float"!==s.type||(null===o.numeric_precision||this.isDefaultColumnPrecision(i,s,o.numeric_precision)?null===o.numeric_scale||this.isDefaultColumnScale(i,s,o.numeric_scale)||(s.precision=void 0):s.precision=o.numeric_precision,null===o.numeric_scale||this.isDefaultColumnScale(i,s,o.numeric_scale)?null===o.numeric_precision||this.isDefaultColumnPrecision(i,s,o.numeric_precision)||(s.scale=void 0):s.scale=o.numeric_scale),"interval"!==s.type&&"time without time zone"!==s.type&&"time with time zone"!==s.type&&"timestamp without time zone"!==s.type&&"timestamp with time zone"!==s.type||(s.precision=this.isDefaultColumnPrecision(i,s,o.datetime_precision)?void 0:o.datetime_precision),"USER-DEFINED"!==o.data_type&&"ARRAY"!==o.data_type?[3,3]:[4,this.getUserDefinedTypeName(i,s)];case 1:return u=r.sent().name,l=this.buildEnumName(i,s,!1,!0),f=l!==u?u:void 0,h='SELECT "e"."enumlabel" AS "value" FROM "pg_enum" "e" INNER JOIN "pg_type" "t" ON "t"."oid" = "e"."enumtypid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = \''+e.table_schema+'\' AND "t"."typname" = \''+(f||u)+"'",[4,this.query(h)];case 2:(g=r.sent()).length&&(s.type="enum",s.enum=g.map((function(e){return e.value})),s.enumName=f),"ARRAY"===o.data_type&&(s.isArray=!0,d=s.type.replace("[]",""),s.type=this.connection.driver.normalizeType({type:d})),r.label=3;case 3:return"geometry"!==s.type?[3,5]:(p='SELECT * FROM (\n                        SELECT\n                          "f_table_schema" "table_schema",\n                          "f_table_name" "table_name",\n                          "f_geometry_column" "column_name",\n                          "srid",\n                          "type"\n                        FROM "geometry_columns"\n                      ) AS _\n                      WHERE ('+n+') AND "column_name" = \''+s.name+"' AND \"table_name\" = '"+e.table_name+"'",[4,this.query(p)]);case 4:g=r.sent(),s.spatialFeatureType=g[0].type,s.srid=g[0].srid,r.label=5;case 5:return"geography"!==s.type?[3,7]:(m='SELECT * FROM (\n                        SELECT\n                          "f_table_schema" "table_schema",\n                          "f_table_name" "table_name",\n                          "f_geography_column" "column_name",\n                          "srid",\n                          "type"\n                        FROM "geography_columns"\n                      ) AS _\n                      WHERE ('+n+') AND "column_name" = \''+s.name+"' AND \"table_name\" = '"+e.table_name+"'",[4,this.query(m)]);case 6:g=r.sent(),s.spatialFeatureType=g[0].type,s.srid=g[0].srid,r.label=7;case 7:return-1!==this.driver.withLengthColumnTypes.indexOf(s.type)&&(s.isArray?(v=/\((\d+)\)/.exec(o.format_type),b=v?v[1]:void 0):o.character_maximum_length&&(b=o.character_maximum_length.toString()),b&&(s.length=this.isDefaultColumnLength(i,s,b)?"":b)),s.isNullable="YES"===o.is_nullable,s.isPrimary=!!a.find((function(e){return"PRIMARY"===e.constraint_type})),w=a.find((function(e){return"UNIQUE"===e.constraint_type})),_=!!w&&!!y.find((function(e){return"UNIQUE"===e.constraint_type&&e.constraint_name===w.constraint_name&&e.column_name!==o.column_name})),s.isUnique=!!w&&!_,null!==o.column_default&&void 0!==o.column_default&&(o.column_default.replace(/"/gi,"")==="nextval('"+this.buildSequenceName(i,o.column_name,t,!0)+"'::regclass)"?(s.isGenerated=!0,s.generationStrategy="increment"):"gen_random_uuid()"===o.column_default||/^uuid_generate_v\d\(\)/.test(o.column_default)?(s.isGenerated=!0,s.generationStrategy="uuid"):"now()"===o.column_default||-1!==o.column_default.indexOf("'now'::text")?s.default=o.column_default:(s.default=o.column_default.replace(/::[\w\s\[\]\"]+/g,""),s.default=s.default.replace(/^(-?\d+)$/,"'$1'"))),s.comment=o.description?o.description:void 0,o.character_set_name&&(s.charset=o.character_set_name),o.collation_name&&(s.collation=o.collation_name),[2,s]}}))}))})))];case 1:return u.columns=w.sent(),l=Q.a.uniq(y.filter((function(e){return v.driver.buildTableName(e.table_name,e.table_schema)===c&&"UNIQUE"===e.constraint_type})),(function(e){return e.constraint_name})),i.uniques=l.map((function(e){var t=y.filter((function(t){return t.constraint_name===e.constraint_name}));return new Ue.a({name:e.constraint_name,columnNames:t.map((function(e){return e.column_name}))})})),f=Q.a.uniq(y.filter((function(e){return v.driver.buildTableName(e.table_name,e.table_schema)===c&&"CHECK"===e.constraint_type})),(function(e){return e.constraint_name})),i.checks=f.map((function(e){var t=y.filter((function(t){return t.constraint_name===e.constraint_name}));return new Le.a({name:e.constraint_name,columnNames:t.map((function(e){return e.column_name})),expression:e.expression.replace(/^\s*CHECK\s*\((.*)\)\s*$/i,"$1")})})),h=Q.a.uniq(y.filter((function(e){return v.driver.buildTableName(e.table_name,e.table_schema)===c&&"EXCLUDE"===e.constraint_type})),(function(e){return e.constraint_name})),i.exclusions=h.map((function(e){return new Fe.a({name:e.constraint_name,expression:e.expression.substring(8)})})),d=Q.a.uniq(b.filter((function(e){return v.driver.buildTableName(e.table_name,e.table_schema)===c})),(function(e){return e.constraint_name})),i.foreignKeys=d.map((function(e){var t=b.filter((function(t){return t.constraint_name===e.constraint_name})),n=o(e,"referenced_table_schema"),r=v.driver.buildTableName(e.referenced_table_name,n);return new qe.a({name:e.constraint_name,columnNames:t.map((function(e){return e.column_name})),referencedTableName:r,referencedColumnNames:t.map((function(e){return e.referenced_column_name})),onDelete:e.on_delete,onUpdate:e.on_update,deferrable:e.deferrable?e.deferred:void 0})})),p=Q.a.uniq(g.filter((function(e){return v.driver.buildTableName(e.table_name,e.table_schema)===c})),(function(e){return e.constraint_name})),i.indices=p.map((function(e){var t=g.filter((function(t){return t.table_schema===e.table_schema&&t.table_name===e.table_name&&t.constraint_name===e.constraint_name}));return new Ve.a({table:i,name:e.constraint_name,columnNames:t.map((function(e){return e.column_name})),isUnique:"TRUE"===e.is_unique,where:e.condition,isSpatial:t.every((function(e){return v.driver.spatialTypes.indexOf(e.type_name)>=0})),isFulltext:!1})})),[2,i]}}))}))})))]:[2,[]]}}))}))},t.prototype.createTableSql=function(e,t){var n=this,r=e.columns.map((function(t){return n.buildCreateColumnSql(e,t)})).join(", "),i="CREATE TABLE "+this.escapePath(e)+" ("+r;if(e.columns.filter((function(e){return e.isUnique})).forEach((function(t){e.uniques.some((function(e){return 1===e.columnNames.length&&e.columnNames[0]===t.name}))||e.uniques.push(new Ue.a({name:n.connection.namingStrategy.uniqueConstraintName(e.name,[t.name]),columnNames:[t.name]}))})),e.uniques.length>0){var o=e.uniques.map((function(t){return'CONSTRAINT "'+(t.name?t.name:n.connection.namingStrategy.uniqueConstraintName(e.name,t.columnNames))+'" UNIQUE ('+t.columnNames.map((function(e){return'"'+e+'"'})).join(", ")+")"})).join(", ");i+=", "+o}if(e.checks.length>0){var a=e.checks.map((function(t){return'CONSTRAINT "'+(t.name?t.name:n.connection.namingStrategy.checkConstraintName(e.name,t.expression))+'" CHECK ('+t.expression+")"})).join(", ");i+=", "+a}if(e.exclusions.length>0){var s=e.exclusions.map((function(t){return'CONSTRAINT "'+(t.name?t.name:n.connection.namingStrategy.exclusionConstraintName(e.name,t.expression))+'" EXCLUDE '+t.expression})).join(", ");i+=", "+s}if(e.foreignKeys.length>0&&t){var c=e.foreignKeys.map((function(t){var r=t.columnNames.map((function(e){return'"'+e+'"'})).join(", ");t.name||(t.name=n.connection.namingStrategy.foreignKeyName(e.name,t.columnNames,t.referencedTableName,t.referencedColumnNames));var i=t.referencedColumnNames.map((function(e){return'"'+e+'"'})).join(", "),o='CONSTRAINT "'+t.name+'" FOREIGN KEY ('+r+") REFERENCES "+n.escapePath(t.referencedTableName)+" ("+i+")";return t.onDelete&&(o+=" ON DELETE "+t.onDelete),t.onUpdate&&(o+=" ON UPDATE "+t.onUpdate),t.deferrable&&(o+=" DEFERRABLE "+t.deferrable),o})).join(", ");i+=", "+c}var u=e.columns.filter((function(e){return e.isPrimary}));if(u.length>0){var l=this.connection.namingStrategy.primaryKeyName(e.name,u.map((function(e){return e.name}))),f=u.map((function(e){return'"'+e.name+'"'})).join(", ");i+=', CONSTRAINT "'+l+'" PRIMARY KEY ('+f+")"}return i+=")",e.columns.filter((function(e){return e.comment})).forEach((function(t){return i+="; COMMENT ON COLUMN "+n.escapePath(e)+'."'+t.name+'" IS '+n.escapeComment(t.comment)})),new ze.a(i)},t.prototype.dropTableSql=function(e){return new ze.a("DROP TABLE "+this.escapePath(e))},t.prototype.createViewSql=function(e){var t=e.materialized?"MATERIALIZED ":"",n=this.escapePath(e);return"string"==typeof e.expression?new ze.a("CREATE "+t+"VIEW "+n+" AS "+e.expression):new ze.a("CREATE "+t+"VIEW "+n+" AS "+e.expression(this.connection).getQuery())},t.prototype.insertViewDefinitionSql=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u,l;return Object(r.d)(this,(function(f){switch(f.label){case 0:return[4,this.getCurrentSchema()];case 1:return t=f.sent(),n=e.name.split("."),i=this.driver.options.schema||t,o=e.name,2===n.length&&(i=n[0],o=n[1]),a=e.materialized?"MATERIALIZED_VIEW":"VIEW",s="string"==typeof e.expression?e.expression.trim():e.expression(this.connection).getQuery(),c=Object(r.e)(this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({type:a,schema:i,name:o,value:s}).getQueryAndParameters(),2),u=c[0],l=c[1],[2,new ze.a(u,l)]}}))}))},t.prototype.dropViewSql=function(e){var t=e.materialized?"MATERIALIZED ":"";return new ze.a("DROP "+t+"VIEW "+this.escapePath(e))},t.prototype.deleteViewDefinitionSql=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u,l;return Object(r.d)(this,(function(f){switch(f.label){case 0:return[4,this.getCurrentSchema()];case 1:return t=f.sent(),n=e.name.split("."),i=this.driver.options.schema||t,o=e.name,2===n.length&&(i=n[0],o=n[1]),a=e.materialized?"MATERIALIZED_VIEW":"VIEW",s=this.connection.createQueryBuilder(),c=Object(r.e)(s.delete().from(this.getTypeormMetadataTableName()).where(s.escape("type")+" = :type",{type:a}).andWhere(s.escape("schema")+" = :schema",{schema:i}).andWhere(s.escape("name")+" = :name",{name:o}).getQueryAndParameters(),2),u=c[0],l=c[1],[2,new ze.a(u,l)]}}))}))},t.prototype.extractSchema=function(e){var t=e instanceof a.a?e.name:e;return-1===t.indexOf(".")?this.driver.options.schema:t.split(".")[0]},t.prototype.dropEnumTypes=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t='SELECT \'DROP TYPE IF EXISTS "\' || n.nspname || \'"."\' || t.typname || \'" CASCADE;\' as "query" FROM "pg_type" "t" INNER JOIN "pg_enum" "e" ON "e"."enumtypid" = "t"."oid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" IN ('+e+') GROUP BY "n"."nspname", "t"."typname"',[4,this.query(t)];case 1:return n=r.sent(),[4,Promise.all(n.map((function(e){return i.query(e.query)})))];case 2:return r.sent(),[2]}}))}))},t.prototype.hasEnumType=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=this.parseTableName(e).schema,i=this.buildEnumName(e,t,!1,!0),o='SELECT "n"."nspname", "t"."typname" FROM "pg_type" "t" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = '+n+' AND "t"."typname" = \''+i+"'",[4,this.query(o)];case 1:return[2,!!r.sent().length]}}))}))},t.prototype.createEnumTypeSql=function(e,t,n){n||(n=this.buildEnumName(e,t));var r=t.enum.map((function(e){return"'"+e.replace("'","''")+"'"})).join(", ");return new ze.a("CREATE TYPE "+n+" AS ENUM("+r+")")},t.prototype.dropEnumTypeSql=function(e,t,n){return n||(n=this.buildEnumName(e,t)),new ze.a("DROP TYPE "+n)},t.prototype.createIndexSql=function(e,t){var n=t.columnNames.map((function(e){return'"'+e+'"'})).join(", ");return new ze.a("CREATE "+(t.isUnique?"UNIQUE ":"")+'INDEX "'+t.name+'" ON '+this.escapePath(e)+" "+(t.isSpatial?"USING GiST ":"")+"("+n+") "+(t.where?"WHERE "+t.where:""))},t.prototype.dropIndexSql=function(e,t){var n=t instanceof Ve.a?t.name:t,r=this.extractSchema(e);return r?new ze.a('DROP INDEX "'+r+'"."'+n+'"'):new ze.a('DROP INDEX "'+n+'"')},t.prototype.createPrimaryKeySql=function(e,t){var n=this.connection.namingStrategy.primaryKeyName(e.name,t),r=t.map((function(e){return'"'+e+'"'})).join(", ");return new ze.a("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+n+'" PRIMARY KEY ('+r+")")},t.prototype.dropPrimaryKeySql=function(e){var t=e.primaryColumns.map((function(e){return e.name})),n=this.connection.namingStrategy.primaryKeyName(e.name,t);return new ze.a("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+n+'"')},t.prototype.createUniqueConstraintSql=function(e,t){var n=t.columnNames.map((function(e){return'"'+e+'"'})).join(", ");return new ze.a("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+t.name+'" UNIQUE ('+n+")")},t.prototype.dropUniqueConstraintSql=function(e,t){var n=t instanceof Ue.a?t.name:t;return new ze.a("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+n+'"')},t.prototype.createCheckConstraintSql=function(e,t){return new ze.a("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+t.name+'" CHECK ('+t.expression+")")},t.prototype.dropCheckConstraintSql=function(e,t){var n=t instanceof Le.a?t.name:t;return new ze.a("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+n+'"')},t.prototype.createExclusionConstraintSql=function(e,t){return new ze.a("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+t.name+'" EXCLUDE '+t.expression)},t.prototype.dropExclusionConstraintSql=function(e,t){var n=t instanceof Fe.a?t.name:t;return new ze.a("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+n+'"')},t.prototype.createForeignKeySql=function(e,t){var n=t.columnNames.map((function(e){return'"'+e+'"'})).join(", "),r=t.referencedColumnNames.map((function(e){return'"'+e+'"'})).join(","),i="ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+t.name+'" FOREIGN KEY ('+n+") REFERENCES "+this.escapePath(t.referencedTableName)+"("+r+")";return t.onDelete&&(i+=" ON DELETE "+t.onDelete),t.onUpdate&&(i+=" ON UPDATE "+t.onUpdate),t.deferrable&&(i+=" DEFERRABLE "+t.deferrable),new ze.a(i)},t.prototype.dropForeignKeySql=function(e,t){var n=t instanceof qe.a?t.name:t;return new ze.a("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+n+'"')},t.prototype.buildSequenceName=function(e,t,n,r,i){var o=t instanceof Be.a?t.name:t,a=void 0,s=void 0;-1===e.name.indexOf(".")?s=e.name:(a=e.name.split(".")[0],s=e.name.split(".")[1]);var c=s+"_"+o+"_seq";return c.length>this.connection.driver.maxAliasLength&&(c=s.substring(0,29)+"_"+o.substring(0,Math.max(29,63-s.length-5))+"_seq"),a&&a!==n&&!i?r?a+"."+c:'"'+a+'"."'+c+'"':r?""+c:'"'+c+'"'},t.prototype.buildEnumName=function(e,t,n,r,i){void 0===n&&(n=!0);var o=-1===e.name.indexOf(".")?this.driver.options.schema:e.name.split(".")[0],a=-1===e.name.indexOf(".")?e.name:e.name.split(".")[1],s=t.enumName?t.enumName:a+"_"+t.name.toLowerCase()+"_enum";return o&&n&&(s=o+"."+s),i&&(s+="_old"),s.split(".").map((function(e){return r?e:'"'+e+'"'})).join(".")},t.prototype.getUserDefinedTypeName=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:return[4,this.getCurrentSchema()];case 1:return n=u.sent(),i=Object(r.e)(e.name.split("."),2),o=i[0],(a=i[1])||(a=o,o=this.driver.options.schema||n),[4,this.query('SELECT "udt_schema", "udt_name" FROM "information_schema"."columns" WHERE "table_schema" = \''+o+"' AND \"table_name\" = '"+a+"' AND \"column_name\"='"+t.name+"'")];case 2:return s=u.sent(),0===(c=s[0].udt_name).indexOf("_")&&(c=c.substr(1,c.length)),[2,{schema:s[0].udt_schema,name:c}]}}))}))},t.prototype.escapeComment=function(e){return e&&0!==e.length?"'"+(e=e.replace(/'/g,"''").replace(/\u0000/g,""))+"'":"NULL"},t.prototype.escapePath=function(e,t){var n=e instanceof a.a||e instanceof He.a?e.name:e;return(n=-1===n.indexOf(".")&&this.driver.options.schema?this.driver.options.schema+"."+n:n).split(".").map((function(e){return t?e:'"'+e+'"'})).join(".")},t.prototype.parseTableName=function(e){var t=e instanceof a.a?e.name:e;return-1===t.indexOf(".")?{schema:this.driver.options.schema?"'"+this.driver.options.schema+"'":"current_schema()",tableName:"'"+t+"'"}:{schema:"'"+t.split(".")[0]+"'",tableName:"'"+t.split(".")[1]+"'"}},t.prototype.buildCreateColumnSql=function(e,t){var n='"'+t.name+'"';return!0===t.isGenerated&&"uuid"!==t.generationStrategy&&("integer"!==t.type&&"int"!==t.type&&"int4"!==t.type||(n+=" SERIAL"),"smallint"!==t.type&&"int2"!==t.type||(n+=" SMALLSERIAL"),"bigint"!==t.type&&"int8"!==t.type||(n+=" BIGSERIAL")),"enum"===t.type||"simple-enum"===t.type?(n+=" "+this.buildEnumName(e,t),t.isArray&&(n+=" array")):t.isGenerated&&"uuid"!==t.type||(n+=" "+this.connection.driver.createFullType(t)),t.charset&&(n+=' CHARACTER SET "'+t.charset+'"'),t.collation&&(n+=' COLLATE "'+t.collation+'"'),!0!==t.isNullable&&(n+=" NOT NULL"),void 0!==t.default&&null!==t.default&&(n+=" DEFAULT "+t.default),t.isGenerated&&"uuid"===t.generationStrategy&&!t.default&&(n+=" DEFAULT "+this.driver.uuidGenerator),n},t.prototype.hasSupportForPartitionedTables=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:return[4,this.query("SELECT TRUE FROM information_schema.columns WHERE table_name = 'pg_class' and column_name = 'relispartition'")];case 1:return[2,!!e.sent().length]}}))}))},t}(De.a))),Ye=function(e){function t(t){var n=e.call(this)||this;return n.connection=t,n.options=t.options,n.isReplicated=!1,n.loadDependencies(),n.client=new n.DataApiDriver(n.options.region,n.options.secretArn,n.options.resourceArn,n.options.database,(function(e,t){return n.connection.logger.logQuery(e,t)}),n.options.serviceConfigOptions,n.options.formatOptions),n}return Object(r.c)(t,e),t.prototype.connect=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2]}))}))},t.prototype.disconnect=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2]}))}))},t.prototype.createQueryRunner=function(e){var t=this;return new We(this,new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(function(e,n){return t.connection.logger.logQuery(e,n)}),this.options.serviceConfigOptions,this.options.formatOptions),e)},t.prototype.preparePersistentValue=function(t,n){return this.options.formatOptions&&!1===this.options.formatOptions.castParameters?e.prototype.preparePersistentValue.call(this,t,n):(n.transformer&&(t=G.a.transformTo(n.transformer,t)),this.client.preparePersistentValue(t,n))},t.prototype.prepareHydratedValue=function(t,n){return this.options.formatOptions&&!1===this.options.formatOptions.castParameters?e.prototype.prepareHydratedValue.call(this,t,n):(n.transformer&&(t=G.a.transformFrom(n.transformer,t)),this.client.prepareHydratedValue(t,n))},t.prototype.loadDependencies=function(){var e=Ie.a.load("typeorm-aurora-data-api-driver").pg;this.DataApiDriver=e},t.prototype.executeQuery=function(e,t){return this.connection.query(t)},t.prototype.afterConnect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.checkMetadataForExtensions()];case 1:return(e=t.sent()).hasExtensions?[4,this.enableExtensions(e,this.connection)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2,Promise.resolve()]}}))}))},t}(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.c)(t,e),t}(h.k)),Qe=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new Ee.a(n),n}return Object(r.c)(t,e),t.prototype.executeSet=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:if(this.isReleased)throw new we.a;return[4,this.connect()];case 1:return[2,t.sent().executeSet(e,!1)]}}))}))},t.prototype.query=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(this.isReleased)throw new we.a;return[4,this.connect()];case 1:return n=r.sent(),this.driver.connection.logger.logQuery(e,t,this),i=e.substr(0,e.indexOf(" ")),[2,(-1!==["PRAGMA","BEGIN","ROLLBACK","COMMIT","CREATE","ALTER","DROP"].indexOf(i)?n.execute(e,!1):-1!==["INSERT","UPDATE","DELETE"].indexOf(i)?n.run(e,t,!1).then((function(e){var t=e.changes;return t.lastId||t.changes})):n.query(e,t).then((function(e){return e.values}))).catch((function(n){throw o.driver.connection.logger.logQueryError(n,e,t,o),new _e.a(e,t,n)}))]}}))}))},t.prototype.parametrize=function(e){return Object.keys(e).map((function(e){return'"'+e+'"=?'}))},t}(ke.a),Ge=function(e){function t(n,r){var i=e.call(this)||this;return i.name="CannotReflectMethodParameterTypeError",Object.setPrototypeOf(i,t.prototype),i.message='Cannot get reflected type for a "'+r+'" method\'s parameter of "'+n.name+'" class. Make sure you have turned on an "emitDecoratorMetadata": true option in tsconfig.json. Also make sure you have imported "reflect-metadata" on top of the main entry file in your application.',i}return Object(r.c)(t,e),t}(Error),Je=function(e){function t(n){var r=e.call(this)||this;return r.name="AlreadyHasActiveConnectionError",Object.setPrototypeOf(r,t.prototype),r.message='Cannot create a new connection named "'+n+'", because connection with such name already exist and it now has an active connection session.',r}return Object(r.c)(t,e),t}(Error),Ke=n(94),$e=function(e){function t(n){var r=e.call(this)||this;return r.name="ConnectionIsNotSetError",Object.setPrototypeOf(r,t.prototype),r.message="Connection with "+n+" database is not established. Check connection configuration.",r}return Object(r.c)(t,e),t}(Error),Xe=n(156),Ze=function(e){function t(n,r,i){var o=e.call(this)||this;return o.name="MetadataAlreadyExistsError",Object.setPrototypeOf(o,t.prototype),o.message=n+" metadata already exists for the class constructor "+JSON.stringify(r)+(i?" on property "+i:". If you previously renamed or moved entity class, make sure that compiled version of old entity class source wasn't left in the compiler output directory."),o}return Object(r.c)(t,e),t}(Error),et=n(108),tt=n(137),nt=n(123),rt=function(e){function t(n,r){var i=e.call(this)||this;return i.name="PrimaryColumnCannotBeNullableError",Object.setPrototypeOf(i,t.prototype),i.message="Primary column "+n.constructor.name+"#"+r+" cannot be nullable. Its not allowed for primary keys. Try to remove nullable option.",i}return Object(r.c)(t,e),t}(Error),it=n(157),ot=function(e){function t(n){var r=e.call(this)||this;return r.name="NoConnectionForRepositoryError",Object.setPrototypeOf(r,t.prototype),r.message='Cannot get a Repository for "'+n+" connection, because connection with the database is not established yet. Call connection#connect method to establish connection.",r}return Object(r.c)(t,e),t}(Error),at=n(84),st=function(e){function t(n,r){var i=e.call(this)||this;return i.name="UsingJoinTableIsNotAllowedError",Object.setPrototypeOf(i,t.prototype),i.message="Using JoinTable on "+n.name+"#"+r.propertyName+" is wrong. "+n.name+"#"+r.propertyName+" has "+r.relationType+" relation, however you can use JoinTable only on many-to-many relations.",i}return Object(r.c)(t,e),t}(Error),ct=function(e){function t(n,r){var i=e.call(this)||this;return i.name="MissingJoinColumnError",Object.setPrototypeOf(i,t.prototype),r.inverseRelation?i.message="JoinColumn is missing on both sides of "+n.name+"#"+r.propertyName+" and "+r.inverseEntityMetadata.name+"#"+r.inverseRelation.propertyName+" one-to-one relationship. You need to put JoinColumn decorator on one of the sides.":i.message="JoinColumn is missing on "+n.name+"#"+r.propertyName+" one-to-one relationship. You need to put JoinColumn decorator on it.",i}return Object(r.c)(t,e),t}(Error),ut=n(124),lt=function(e){function t(n){var r=e.call(this)||this;return r.name="CannotGetEntityManagerNotConnectedError",Object.setPrototypeOf(r,t.prototype),r.message='Cannot get entity manager for "'+n+'" connection because connection is not yet established.',r}return Object(r.c)(t,e),t}(Error),ft=function(e){function t(n){var r=e.call(this)||this;return r.name="ConnectionNotFoundError",Object.setPrototypeOf(r,t.prototype),r.message='Connection "'+n+'" was not found.',r}return Object(r.c)(t,e),t}(Error),ht=n(158),dt=n(159),pt=n(110),mt=function(e){function t(n,r){var i=e.call(this)||this;return i.name="MetadataWithSuchNameAlreadyExistsError",Object.setPrototypeOf(i,t.prototype),i.message=n+" metadata with such name "+r+" already exists. Do you apply decorator twice? Or maybe try to change a name?",i}return Object(r.c)(t,e),t}(Error),yt=function(e){function t(n,r){var i=e.call(this)||this;i.name="NamingStrategyNotFoundError",Object.setPrototypeOf(i,t.prototype);var o=n instanceof Function?n.name:n;return i.message='Naming strategy "'+o+'" was not found. Looks like this naming strategy does not exist or it was not registered in current "'+r+'" connection?',i}return Object(r.c)(t,e),t}(Error),gt=n(160),bt=function(e){function t(n,r){var i=e.call(this)||this;return i.name="MissingJoinTableError",Object.setPrototypeOf(i,t.prototype),r.inverseRelation?i.message="JoinTable is missing on both sides of "+n.name+"#"+r.propertyName+" and "+r.inverseEntityMetadata.name+"#"+r.inverseRelation.propertyName+" many-to-many relationship. You need to put decorator decorator on one of the sides.":i.message="JoinTable is missing on "+n.name+"#"+r.propertyName+" many-to-many relationship. You need to put JoinTable decorator on it.",i}return Object(r.c)(t,e),t}(Error),vt=function(e){function t(n,r){var i=e.call(this)||this;return i.name="UsingJoinColumnOnlyOnOneSideAllowedError",Object.setPrototypeOf(i,t.prototype),i.message="Using JoinColumn is allowed only on one side of the one-to-one relationship. Both "+n.name+"#"+r.propertyName+" and "+r.inverseEntityMetadata.name+"#"+r.inverseRelation.propertyName+" has JoinTable decorators. Choose one of them and left JoinTable decorator only on it.",i}return Object(r.c)(t,e),t}(Error),wt=function(e){function t(n,r){var i=e.call(this)||this;return i.name="UsingJoinTableOnlyOnOneSideAllowedError",Object.setPrototypeOf(i,t.prototype),i.message="Using JoinTable is allowed only on one side of the many-to-many relationship. Both "+n.name+"#"+r.propertyName+" and "+r.inverseEntityMetadata.name+"#"+r.inverseRelation.propertyName+" has JoinTable decorators. Choose one of them and left JoinColumn decorator only on it.",i}return Object(r.c)(t,e),t}(Error),_t=function(e){function t(){var n=e.call(this)||this;return n.name="PersistedEntityNotFoundError",Object.setPrototypeOf(n,t.prototype),n.message="Internal error. Persisted entity was not found in the list of prepared operated entities.",n}return Object(r.c)(t,e),t}(Error),kt=function(e){function t(n,r){var i=e.call(this)||this;return i.name="UsingJoinColumnIsNotAllowedError",Object.setPrototypeOf(i,t.prototype),i.message="Using JoinColumn on "+n.name+"#"+r.propertyName+" is wrong. You can use JoinColumn only on one-to-one and many-to-one relations.",i}return Object(r.c)(t,e),t}(Error),Et=function(e){function t(n,r){var i=e.call(this)||this;return i.name="ColumnTypeUndefinedError",Object.setPrototypeOf(i,t.prototype),i.message="Column type for "+n.constructor.name+"#"+r+' is not defined and cannot be guessed. Make sure you have turned on an "emitDecoratorMetadata": true option in tsconfig.json. Also make sure you have imported "reflect-metadata" on top of the main entry file in your application (before any entity imported).If you are using JavaScript instead of TypeScript you must explicitly provide a column type.',i}return Object(r.c)(t,e),t}(Error),Ot=n(161),Tt=function(e){function t(t){var n=e.call(this,t)||this;if(n.database=n.options.database,n.driver=n.options.driver,!n.options.database)throw new Te.a("database");if(!n.options.driver)throw new Te.a("driver");return n.sqlite=n.options.driver,n}return Object(r.c)(t,e),t.prototype.connect=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:return this.databaseConnection=this.createDatabaseConnection(),[4,this.databaseConnection];case 1:return e.sent(),[2]}}))}))},t.prototype.disconnect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){switch(t.label){case 0:return this.queryRunner=void 0,[4,this.databaseConnection];case 1:return[2,t.sent().close().then((function(){e.databaseConnection=void 0}))]}}))}))},t.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new Qe(this)),this.queryRunner},t.prototype.createDatabaseConnection=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.sqlite.createConnection(this.options.database,!1,"no-encryption",1)];case 1:return[4,(e=t.sent()).open()];case 2:return t.sent(),[4,e.execute("PRAGMA foreign_keys = ON;")];case 3:return t.sent(),[2,e]}}))}))},t.prototype.loadDependencies=function(){if(this.sqlite=this.driver,!this.driver)throw new xe.a("Capacitor","@capacitor-community/sqlite")},t}(S.a),xt=function(){function e(){}return e.prototype.create=function(e){var t=e.options.type;switch(t){case"mysql":return new h.i(e);case"postgres":return new h.k(e);case"cockroachdb":return new h.d(e);case"sap":return new h.l(e);case"mariadb":return new h.i(e);case"sqlite":return new h.n(e);case"better-sqlite3":return new h.c(e);case"cordova":return new Se(e);case"nativescript":return new Pe.a(e);case"react-native":return new Re(e);case"sqljs":return new ge.a(e);case"oracle":return new h.j(e);case"mssql":return new h.m(e);case"mongodb":return new h.e(e);case"expo":return new je(e);case"aurora-data-api":return new h.a(e);case"aurora-data-api-pg":return new Ye(e);case"capacitor":return new Tt(e);default:throw new ve(t)}},e}();function St(e,t,n){return void 0===n&&(n=[".js",".cjs",".ts"]),[]}var Ct,Rt,Pt=new(function(){function e(){this.instances=[]}return e.prototype.get=function(e){var t=this.instances.find((function(t){return t.type===e}));return t||(t={type:e,object:new e},this.instances.push(t)),t.object},e}());function Nt(e,t){Ct=e,Rt=t}function Mt(e){if(Ct)try{var t=Ct.get(e);if(t)return t;if(!Rt||!Rt.fallback)return t}catch(e){if(!Rt||!Rt.fallbackOnErrors)throw e}return Pt.get(e)}var At=n(41),jt=function(){function e(e){this.isUnique=!1,this.isSpatial=!1,this.isFulltext=!1,this.synchronize=!0,this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,null!==e.args.synchronize&&void 0!==e.args.synchronize&&(this.synchronize=e.args.synchronize),this.isUnique=!!e.args.unique,this.isSpatial=!!e.args.spatial,this.isFulltext=!!e.args.fulltext,this.parser=e.args.parser,this.where=e.args.where,this.isSparse=e.args.sparse,this.isBackground=e.args.background,this.expireAfterSeconds=e.args.expireAfterSeconds,this.givenName=e.args.name,this.givenColumnNames=e.args.columns)}return e.prototype.build=function(e){var t=this;if(!1===this.synchronize)return this.name=this.givenName,this;var n={};if(this.givenColumnNames){var r=[];if(Array.isArray(this.givenColumnNames))(r=this.givenColumnNames.map((function(e){return t.embeddedMetadata?t.embeddedMetadata.propertyPath+"."+e:e.trim()}))).forEach((function(e){return n[e]=1}));else{var i=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(i)?(r=i.map((function(e){return String(e)}))).forEach((function(e){return n[e]=1})):(r=Object.keys(i).map((function(e){return String(e)})),Object.keys(i).forEach((function(e){return n[e]=i[e]})))}this.columns=r.map((function(e){var n=t.entityMetadata.columns.find((function(t){return t.propertyPath===e}));if(n)return[n];var r=t.entityMetadata.relations.find((function(t){return t.isWithJoinColumn&&t.propertyName===e}));if(r)return r.joinColumns;var i=t.givenName?'"'+t.givenName+'" ':"",o=t.entityMetadata.targetName;throw new Error("Index "+i+"contains column that is missing in the entity ("+o+"): "+e)})).reduce((function(e,t){return e.concat(t)}))}return this.columnNamesWithOrderingMap=Object.keys(n).reduce((function(e,r){var i=t.entityMetadata.columns.find((function(e){return e.propertyPath===r}));return i&&(e[i.databasePath]=n[r]),e}),{}),this.name=this.givenName?this.givenName:e.indexName(this.entityMetadata.tablePath,this.columns.map((function(e){return e.databaseName})),this.where),this},e}(),It=function(){function e(e){this.isTreeParent=!1,this.isTreeChildren=!1,this.isPrimary=!1,this.isLazy=!1,this.isEager=!1,this.persistenceEnabled=!0,this.isCascadeInsert=!1,this.isCascadeUpdate=!1,this.isCascadeRemove=!1,this.isCascadeSoftRemove=!1,this.isCascadeRecover=!1,this.isNullable=!0,this.createForeignKeyConstraints=!0,this.isOwning=!1,this.isOneToOne=!1,this.isOneToOneOwner=!1,this.isWithJoinColumn=!1,this.isOneToOneNotOwner=!1,this.isOneToMany=!1,this.isManyToOne=!1,this.isManyToMany=!1,this.isManyToManyOwner=!1,this.isManyToManyNotOwner=!1,this.foreignKeys=[],this.joinColumns=[],this.inverseJoinColumns=[],this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata;var t=e.args;this.target=t.target,this.propertyName=t.propertyName,this.relationType=t.relationType,t.inverseSideProperty&&(this.givenInverseSidePropertyFactory=t.inverseSideProperty),this.isLazy=t.isLazy||!1,this.isCascadeInsert=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("insert"),this.isCascadeUpdate=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("update"),this.isCascadeRemove=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("remove"),this.isCascadeSoftRemove=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("soft-remove"),this.isCascadeRecover=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("recover"),this.isPrimary=t.options.primary||!1,this.isNullable=!1!==t.options.nullable&&!this.isPrimary,this.onDelete=t.options.onDelete,this.onUpdate=t.options.onUpdate,this.deferrable=t.options.deferrable,this.createForeignKeyConstraints=!1!==t.options.createForeignKeyConstraints,this.isEager=t.options.eager||!1,this.persistenceEnabled=!1!==t.options.persistence,this.orphanedRowAction=t.options.orphanedRowAction||"nullify",this.isTreeParent=t.isTreeParent||!1,this.isTreeChildren=t.isTreeChildren||!1,this.type=t.type instanceof Function?t.type():t.type,this.isOneToOne="one-to-one"===this.relationType,this.isOneToMany="one-to-many"===this.relationType,this.isManyToOne="many-to-one"===this.relationType,this.isManyToMany="many-to-many"===this.relationType,this.isOneToOneNotOwner=!!this.isOneToOne,this.isManyToManyNotOwner=!!this.isManyToMany}return e.prototype.getRelationIdMap=function(e){var t=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map((function(e){return e.referencedColumn}));return se.a.getValueMap(e,t)},e.prototype.ensureRelationIdMap=function(e){if(e instanceof Object)return e;var t=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map((function(e){return e.referencedColumn}));if(t.length>1)throw new Error("Cannot create relation id map for a single value because relation contains multiple referenced columns.");return t[0].createValueMap(e)},e.prototype.getEntityValue=function(e,t){if(void 0===t&&(t=!1),null!=e){if(this.embeddedMetadata){var n=Object(r.f)([],Object(r.e)(this.embeddedMetadata.parentPropertyNames)),i=function(e,t){var n=e.shift();return n?t[n]?i(e,t[n]):void 0:t},o=i(n,e);return this.isLazy?void 0!==o["__"+this.propertyName+"__"]?o["__"+this.propertyName+"__"]:!0===t?o[this.propertyName]:void 0:o?o[this.isLazy?"__"+this.propertyName+"__":this.propertyName]:void 0}return this.isLazy?void 0!==e["__"+this.propertyName+"__"]?e["__"+this.propertyName+"__"]:!0===t?e[this.propertyName]:void 0:e[this.propertyName]}},e.prototype.setEntityValue=function(e,t){var n=this.isLazy?"__"+this.propertyName+"__":this.propertyName;if(this.embeddedMetadata){var i=function(e,r){var o=e.shift();return o?(r[o.propertyName]||(r[o.propertyName]=o.create()),i(e,r[o.propertyName]),r):(r[n]=t,r)};return i(Object(r.f)([],Object(r.e)(this.embeddedMetadata.embeddedMetadataTree)),e)}e[n]=t},e.prototype.createValueMap=function(e){var t,n=this;if(this.embeddedMetadata){var i=Object(r.f)([],Object(r.e)(this.embeddedMetadata.parentPropertyNames)),o=function(t,r){var i=t.shift();return i?(r[i]={},o(t,r[i]),r):(r[n.propertyName]=e,r)};return o(i,{})}return(t={})[this.propertyName]=e,t},e.prototype.build=function(){this.propertyPath=this.buildPropertyPath()},e.prototype.registerForeignKeys=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.foreignKeys).push.apply(e,Object(r.f)([],Object(r.e)(t)))},e.prototype.registerJoinColumns=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.joinColumns=e,this.inverseJoinColumns=t,this.isOwning=this.isManyToOne||(this.isManyToMany||this.isOneToOne)&&this.joinColumns.length>0,this.isOneToOneOwner=this.isOneToOne&&this.isOwning,this.isOneToOneNotOwner=this.isOneToOne&&!this.isOwning,this.isManyToManyOwner=this.isManyToMany&&this.isOwning,this.isManyToManyNotOwner=this.isManyToMany&&!this.isOwning,this.isWithJoinColumn=this.isManyToOne||this.isOneToOneOwner},e.prototype.registerJunctionEntityMetadata=function(e){this.junctionEntityMetadata=e,this.joinTableName=e.tableName,this.inverseRelation&&(this.inverseRelation.junctionEntityMetadata=e,this.joinTableName=e.tableName)},e.prototype.buildInverseSidePropertyPath=function(){if(this.givenInverseSidePropertyFactory){var e=this.inverseEntityMetadata.propertiesMap;if("function"==typeof this.givenInverseSidePropertyFactory)return this.givenInverseSidePropertyFactory(e);if("string"==typeof this.givenInverseSidePropertyFactory)return this.givenInverseSidePropertyFactory}else{if(this.isTreeParent&&this.entityMetadata.treeChildrenRelation)return this.entityMetadata.treeChildrenRelation.propertyName;if(this.isTreeChildren&&this.entityMetadata.treeParentRelation)return this.entityMetadata.treeParentRelation.propertyName}return""},e.prototype.buildPropertyPath=function(){return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length?this.embeddedMetadata.parentPropertyNames.join(".")+"."+this.propertyName:this.propertyName},e}(),Dt=function(){function e(e){this.columns=[],this.relations=[],this.listeners=[],this.indices=[],this.uniques=[],this.relationIds=[],this.relationCounts=[],this.embeddeds=[],this.isArray=!1,this.parentPropertyNames=[],this.parentPrefixes=[],this.embeddedMetadataTree=[],this.columnsFromTree=[],this.relationsFromTree=[],this.listenersFromTree=[],this.indicesFromTree=[],this.uniquesFromTree=[],this.relationIdsFromTree=[],this.relationCountsFromTree=[],this.entityMetadata=e.entityMetadata,this.type=e.args.type(),this.propertyName=e.args.propertyName,this.customPrefix=e.args.prefix,this.isArray=e.args.isArray}return e.prototype.create=function(){return new this.type},e.prototype.build=function(e){return this.embeddeds.forEach((function(t){return t.build(e)})),this.prefix=this.buildPrefix(e),this.parentPropertyNames=this.buildParentPropertyNames(),this.parentPrefixes=this.buildParentPrefixes(),this.propertyPath=this.parentPropertyNames.join("."),this.embeddedMetadataTree=this.buildEmbeddedMetadataTree(),this.columnsFromTree=this.buildColumnsFromTree(),this.relationsFromTree=this.buildRelationsFromTree(),this.listenersFromTree=this.buildListenersFromTree(),this.indicesFromTree=this.buildIndicesFromTree(),this.uniquesFromTree=this.buildUniquesFromTree(),this.relationIdsFromTree=this.buildRelationIdsFromTree(),this.relationCountsFromTree=this.buildRelationCountsFromTree(),this},e.prototype.buildPartialPrefix=function(){if(void 0===this.customPrefix||!0===this.customPrefix)return[this.propertyName];if(""===this.customPrefix||!1===this.customPrefix)return[];if("string"==typeof this.customPrefix)return[this.customPrefix];throw new Error("Invalid prefix option given for "+this.entityMetadata.targetName+"#"+this.propertyName)},e.prototype.buildPrefix=function(e){if(e.driver instanceof h.e)return this.propertyName;var t=[];return this.parentEmbeddedMetadata&&t.push(this.parentEmbeddedMetadata.buildPrefix(e)),t.push.apply(t,Object(r.f)([],Object(r.e)(this.buildPartialPrefix()))),t.join("_")},e.prototype.buildParentPropertyNames=function(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPropertyNames().concat(this.propertyName):[this.propertyName]},e.prototype.buildParentPrefixes=function(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPrefixes().concat(this.buildPartialPrefix()):this.buildPartialPrefix()},e.prototype.buildEmbeddedMetadataTree=function(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildEmbeddedMetadataTree().concat(this):[this]},e.prototype.buildColumnsFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildColumnsFromTree())}),this.columns)},e.prototype.buildRelationsFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildRelationsFromTree())}),this.relations)},e.prototype.buildListenersFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildListenersFromTree())}),this.listeners)},e.prototype.buildIndicesFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildIndicesFromTree())}),this.indices)},e.prototype.buildUniquesFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildUniquesFromTree())}),this.uniques)},e.prototype.buildRelationIdsFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildRelationIdsFromTree())}),this.relationIds)},e.prototype.buildRelationCountsFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildRelationCountsFromTree())}),this.relationCounts)},e}(),Lt=function(){function e(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}return e.prototype.setValue=function(e){var t=this,n=this.relation.getEntityValue(e);if(Array.isArray(n))e[this.propertyName]=n.map((function(e){return t.relation.inverseEntityMetadata.getEntityIdMixedMap(e)})).filter((function(e){return null!=e}));else{var r=this.relation.inverseEntityMetadata.getEntityIdMixedMap(n);void 0!==r&&(e[this.propertyName]=r)}},e.prototype.build=function(){var e=this.relationNameOrFactory instanceof Function?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new Error("Cannot find relation "+e+". Wrong relation specified for @RelationId decorator.");this.relation=t},e}(),Bt=function(){function e(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}return e.prototype.build=function(){var e=this.relationNameOrFactory instanceof Function?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new Error("Cannot find relation "+e+". Wrong relation specified for @RelationCount decorator.");this.relation=t},e}(),Ft=function(){function e(){}return e.AFTER_LOAD="after-load",e.BEFORE_INSERT="before-insert",e.AFTER_INSERT="after-insert",e.BEFORE_UPDATE="before-update",e.AFTER_UPDATE="after-update",e.BEFORE_REMOVE="before-remove",e.AFTER_REMOVE="after-remove",e}(),qt=function(){function e(){}return e.getInheritanceTree=function(e){var t=[e],n=function(e){var r=Object.getPrototypeOf(e);r&&r.name&&(t.push(r),n(r))};return n(e),t},e.isInherited=function(e,t){return e.prototype instanceof t},e.filterByTarget=function(e,t){return t?e.filter((function(e){return e.target&&-1!==t.indexOf(e.target)})):e},e}(),Vt=function(){function e(e){this.columns=[],this.referencedColumns=[],this.columnNames=[],this.referencedColumnNames=[],this.entityMetadata=e.entityMetadata,this.referencedEntityMetadata=e.referencedEntityMetadata,this.columns=e.columns,this.referencedColumns=e.referencedColumns,this.onDelete=e.onDelete||"NO ACTION",this.onUpdate=e.onUpdate||"NO ACTION",this.deferrable=e.deferrable,e.namingStrategy&&this.build(e.namingStrategy)}return e.prototype.build=function(e){this.columnNames=this.columns.map((function(e){return e.databaseName})),this.referencedColumnNames=this.referencedColumns.map((function(e){return e.databaseName})),this.referencedTablePath=this.referencedEntityMetadata.tablePath,this.name=e.foreignKeyName(this.entityMetadata.tablePath,this.columnNames,this.referencedTablePath,this.referencedColumnNames)},e}(),Ut=function(){function e(e){this.connection=e}return e.prototype.build=function(e,t){var n=this,i=this.collectReferencedColumns(e,t),o=this.collectInverseReferencedColumns(e,t),a=t.name||this.connection.namingStrategy.joinTableName(e.entityMetadata.tableNameWithoutPrefix,e.inverseEntityMetadata.tableNameWithoutPrefix,e.propertyPath,e.inverseRelation?e.inverseRelation.propertyName:""),s=new se.a({connection:this.connection,args:{target:"",name:a,type:"junction",database:t.database||e.entityMetadata.database,schema:t.schema||e.entityMetadata.schema}});s.build();var c=i.map((function(r){var i=t.joinColumns?t.joinColumns.find((function(e){return!(e.referencedColumnName&&e.referencedColumnName!==r.propertyName||!e.name)})):void 0,o=i&&i.name?i.name:n.connection.namingStrategy.joinTableColumnName(e.entityMetadata.tableNameWithoutPrefix,r.propertyName,r.databaseName);return new At.a({connection:n.connection,entityMetadata:s,referencedColumn:r,args:{target:"",mode:"virtual",propertyName:o,options:{name:o,length:r.length||!(n.connection.driver instanceof h.i||n.connection.driver instanceof h.a)||"uuid"!==r.generationStrategy&&"uuid"!==r.type?r.length:"36",width:r.width,type:r.type,precision:r.precision,scale:r.scale,charset:r.charset,collation:r.collation,zerofill:r.zerofill,unsigned:!!r.zerofill||r.unsigned,enum:r.enum,enumName:r.enumName,nullable:!1,primary:!0}}})})),u=o.map((function(r){var i=t.inverseJoinColumns?t.inverseJoinColumns.find((function(e){return!(e.referencedColumnName&&e.referencedColumnName!==r.propertyName||!e.name)})):void 0,o=i&&i.name?i.name:n.connection.namingStrategy.joinTableInverseColumnName(e.inverseEntityMetadata.tableNameWithoutPrefix,r.propertyName,r.databaseName);return new At.a({connection:n.connection,entityMetadata:s,referencedColumn:r,args:{target:"",mode:"virtual",propertyName:o,options:{length:r.length||!(n.connection.driver instanceof h.i||n.connection.driver instanceof h.a)||"uuid"!==r.generationStrategy&&"uuid"!==r.type?r.length:"36",width:r.width,type:r.type,precision:r.precision,scale:r.scale,charset:r.charset,collation:r.collation,zerofill:r.zerofill,unsigned:!!r.zerofill||r.unsigned,enum:r.enum,enumName:r.enumName,name:o,nullable:!1,primary:!0}}})}));return this.changeDuplicatedColumnNames(c,u),s.ownerColumns=c,s.inverseColumns=u,s.ownColumns=Object(r.f)(Object(r.f)([],Object(r.e)(c)),Object(r.e)(u)),s.ownColumns.forEach((function(t){return t.relationMetadata=e})),s.foreignKeys=e.createForeignKeyConstraints?[new Vt({entityMetadata:s,referencedEntityMetadata:e.entityMetadata,columns:c,referencedColumns:i,onDelete:e.onDelete||"CASCADE",onUpdate:this.connection.driver instanceof h.j?"NO ACTION":e.onUpdate||"CASCADE"}),new Vt({entityMetadata:s,referencedEntityMetadata:e.inverseEntityMetadata,columns:u,referencedColumns:o,onDelete:e.inverseRelation?e.inverseRelation.onDelete:"CASCADE",onUpdate:this.connection.driver instanceof h.j?"NO ACTION":e.inverseRelation?e.inverseRelation.onUpdate:"CASCADE"})]:[],s.ownIndices=[new jt({entityMetadata:s,columns:c,args:{target:s.target,synchronize:!0}}),new jt({entityMetadata:s,columns:u,args:{target:s.target,synchronize:!0}})],s},e.prototype.collectReferencedColumns=function(e,t){var n=!!t.joinColumns&&t.joinColumns.find((function(e){return!!e.referencedColumnName}));return!t.joinColumns||t.joinColumns&&!n?e.entityMetadata.columns.filter((function(e){return e.isPrimary})):t.joinColumns.map((function(t){var n=e.entityMetadata.columns.find((function(e){return e.propertyName===t.referencedColumnName}));if(!n)throw new Error("Referenced column "+t.referencedColumnName+" was not found in entity "+e.entityMetadata.name);return n}))},e.prototype.collectInverseReferencedColumns=function(e,t){var n=!!t.inverseJoinColumns,r=!!n&&t.inverseJoinColumns.find((function(e){return!!e.referencedColumnName}));return!n||n&&!r?e.inverseEntityMetadata.primaryColumns:t.inverseJoinColumns.map((function(t){var n=e.inverseEntityMetadata.ownColumns.find((function(e){return e.propertyName===t.referencedColumnName}));if(!n)throw new Error("Referenced column "+t.referencedColumnName+" was not found in entity "+e.inverseEntityMetadata.name);return n}))},e.prototype.changeDuplicatedColumnNames=function(e,t){var n=this;e.forEach((function(e){t.forEach((function(t){if(e.givenDatabaseName===t.givenDatabaseName){var r=n.connection.namingStrategy.joinTableColumnDuplicationPrefix(e.propertyName,1);e.propertyName=r,e.givenDatabaseName=r;var i=n.connection.namingStrategy.joinTableColumnDuplicationPrefix(t.propertyName,2);t.propertyName=i,t.givenDatabaseName=i}}))}))},e}(),Ht=function(){function e(e){this.connection=e}return e.prototype.build=function(e){var t=this,n=new se.a({parentClosureEntityMetadata:e,connection:this.connection,args:{target:"",name:e.treeOptions&&e.treeOptions.closureTableName?e.treeOptions.closureTableName:e.tableNameWithoutPrefix,type:"closure-junction"}});return n.build(),e.primaryColumns.forEach((function(r){n.ownColumns.push(new At.a({connection:t.connection,entityMetadata:n,closureType:"ancestor",referencedColumn:r,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.ancestorColumnName?e.treeOptions.ancestorColumnName(r):r.propertyName+"_ancestor",options:{primary:!0,length:r.length,type:r.type}}})),n.ownColumns.push(new At.a({connection:t.connection,entityMetadata:n,closureType:"descendant",referencedColumn:r,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.descendantColumnName?e.treeOptions.descendantColumnName(r):r.propertyName+"_descendant",options:{primary:!0,length:r.length,type:r.type}}}))})),n.ownIndices=[new jt({entityMetadata:n,columns:[n.ownColumns[0]],args:{target:n.target,synchronize:!0}}),new jt({entityMetadata:n,columns:[n.ownColumns[1]],args:{target:n.target,synchronize:!0}})],e.treeLevelColumn&&n.ownColumns.push(new At.a({connection:this.connection,entityMetadata:n,args:{target:"",mode:"virtual",propertyName:"level",options:{type:this.connection.driver.mappedDataTypes.treeLevel}}})),n.foreignKeys=[new Vt({entityMetadata:n,referencedEntityMetadata:e,columns:[n.ownColumns[0]],referencedColumns:e.primaryColumns,onDelete:this.connection.driver instanceof h.m?"NO ACTION":"CASCADE"}),new Vt({entityMetadata:n,referencedEntityMetadata:e,columns:[n.ownColumns[1]],referencedColumns:e.primaryColumns,onDelete:this.connection.driver instanceof h.m?"NO ACTION":"CASCADE"})],n},e}(),zt=function(){function e(e){this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,this.givenName=e.args.name,this.givenColumnNames=e.args.columns)}return e.prototype.build=function(e){var t=this,n={};if(this.givenColumnNames){var r=[];if(Array.isArray(this.givenColumnNames))(r=this.givenColumnNames.map((function(e){return t.embeddedMetadata?t.embeddedMetadata.propertyPath+"."+e:e.trim()}))).forEach((function(e){return n[e]=1}));else{var i=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(i)?(r=i.map((function(e){return String(e)}))).forEach((function(e){return n[e]=1})):(r=Object.keys(i).map((function(e){return String(e)})),Object.keys(i).forEach((function(e){return n[e]=i[e]})))}this.columns=r.map((function(e){var n=t.entityMetadata.columns.find((function(t){return t.propertyPath===e}));if(n)return[n];var r=t.entityMetadata.relations.find((function(t){return t.isWithJoinColumn&&t.propertyName===e}));if(r)return r.joinColumns;var i=t.givenName?'"'+t.givenName+'" ':"",o=t.entityMetadata.targetName;throw new Error("Unique constraint "+i+"contains column that is missing in the entity ("+o+"): "+e)})).reduce((function(e,t){return e.concat(t)}))}return this.columnNamesWithOrderingMap=Object.keys(n).reduce((function(e,r){var i=t.entityMetadata.columns.find((function(e){return e.propertyPath===r}));return i&&(e[i.databasePath]=n[r]),e}),{}),this.name=this.givenName?this.givenName:e.uniqueConstraintName(this.entityMetadata.tablePath,this.columns.map((function(e){return e.databaseName}))),this},e}(),Wt=function(){function e(e){this.connection=e}return e.prototype.build=function(e,t){var n=this.collectReferencedColumns(e,t),r=this.collectColumns(e,t,n);if(!n.length||!t.createForeignKeyConstraints)return{foreignKey:void 0,columns:r,uniqueConstraint:void 0};var i=new Vt({entityMetadata:t.entityMetadata,referencedEntityMetadata:t.inverseEntityMetadata,namingStrategy:this.connection.namingStrategy,columns:r,referencedColumns:n,onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable});if(this.connection.driver instanceof h.j&&r.every((function(e){return e.isPrimary})))return{foreignKey:i,columns:r,uniqueConstraint:void 0};if(n.length>0&&t.isOneToOne){var o=new zt({entityMetadata:t.entityMetadata,columns:i.columns,args:{name:this.connection.namingStrategy.relationConstraintName(t.entityMetadata.tablePath,i.columns.map((function(e){return e.databaseName}))),target:t.entityMetadata.target}});return o.build(this.connection.namingStrategy),{foreignKey:i,columns:r,uniqueConstraint:o}}return{foreignKey:i,columns:r,uniqueConstraint:void 0}},e.prototype.collectReferencedColumns=function(e,t){var n=e.find((function(e){return!!e.referencedColumnName})),r=0===e.length&&t.isManyToOne,i=e.length>0&&!n;return r||i?t.inverseEntityMetadata.primaryColumns:e.map((function(e){var n=t.inverseEntityMetadata.ownColumns.find((function(t){return t.propertyName===e.referencedColumnName}));if(!n)throw new Error("Referenced column "+e.referencedColumnName+" was not found in entity "+t.inverseEntityMetadata.name);return n}))},e.prototype.collectColumns=function(e,t,n){var r=this;return n.map((function(n){var i=e.find((function(e){return!(e.referencedColumnName&&e.referencedColumnName!==n.propertyName||!e.name)})),o=i?i.name:r.connection.namingStrategy.joinColumnName(t.propertyName,n.propertyName),a=t.entityMetadata.ownColumns.find((function(e){return e.databaseName===o}));return a||(a=new At.a({connection:r.connection,entityMetadata:t.entityMetadata,args:{target:"",mode:"virtual",propertyName:t.propertyName,options:{name:o,type:n.type,length:n.length||!(r.connection.driver instanceof h.i||r.connection.driver instanceof h.a)||"uuid"!==n.generationStrategy&&"uuid"!==n.type?n.length:"36",width:n.width,charset:n.charset,collation:n.collation,precision:n.precision,scale:n.scale,zerofill:n.zerofill,unsigned:n.unsigned,comment:n.comment,enum:n.enum,enumName:n.enumName,primary:t.isPrimary,nullable:t.isNullable}}}),t.entityMetadata.registerColumn(a)),a.referencedColumn=n,a.type=n.type,a.relationMetadata=t,a.build(r.connection),a}))},e}(),Yt=function(){function e(e){this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.type=e.args.type}return e.prototype.isAllowed=function(e){return this.entityMetadata.target===e.constructor||this.entityMetadata.target instanceof Function&&e.constructor.prototype instanceof this.entityMetadata.target},e.prototype.execute=function(e){if(!this.embeddedMetadata)return e[this.propertyName]();this.callEntityEmbeddedMethod(e,this.embeddedMetadata.propertyPath.split("."))},e.prototype.callEntityEmbeddedMethod=function(e,t){var n=this,r=t.shift();r&&e[r]&&(0===t.length?e[r]instanceof Array?e[r].map((function(e){return e[n.propertyName]()})):e[r][this.propertyName]():e[r]&&this.callEntityEmbeddedMethod(e[r],t))},e}(),Qt=function(){function e(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}return e.prototype.build=function(e){return this.name=this.givenName?this.givenName:e.checkConstraintName(this.entityMetadata.tablePath,this.expression),this},e}(),Gt=function(){function e(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}return e.prototype.build=function(e){return this.name=this.givenName?this.givenName:e.exclusionConstraintName(this.entityMetadata.tablePath,this.expression),this},e}(),Jt=function(){function e(e,t){this.connection=e,this.metadataArgsStorage=t,this.junctionEntityMetadataBuilder=new Ut(e),this.closureJunctionEntityMetadataBuilder=new Ht(e),this.relationJoinColumnBuilder=new Wt(e)}return e.prototype.build=function(e){var t=this,n=(e?this.metadataArgsStorage.filterTables(e):this.metadataArgsStorage.tables).filter((function(e){return"regular"===e.type||"closure"===e.type||"entity-child"===e.type||"view"===e.type})).map((function(e){return t.createEntityMetadata(e)}));return n.forEach((function(e){return t.computeParentEntityMetadata(n,e)})),n.forEach((function(e){e.childEntityMetadatas=n.filter((function(t){return e.target instanceof Function&&t.target instanceof Function&&qt.isInherited(t.target,e.target)}))})),n.filter((function(e){return"entity-child"!==e.tableType})).forEach((function(e){return e.build()})),n.filter((function(e){return"entity-child"===e.tableType})).forEach((function(e){return e.build()})),n.filter((function(e){return"entity-child"!==e.tableType})).forEach((function(e){return t.computeEntityMetadataStep1(n,e)})),n.filter((function(e){return"entity-child"===e.tableType})).forEach((function(e){return t.computeEntityMetadataStep1(n,e)})),n.forEach((function(e){return t.computeEntityMetadataStep2(e)})),n.forEach((function(e){return t.computeInverseProperties(e,n)})),n.filter((function(e){return"entity-child"!==e.tableType})).forEach((function(e){e.relations.filter((function(e){return e.isOneToOne||e.isManyToOne})).forEach((function(n){var r=t.metadataArgsStorage.filterJoinColumns(n.target,n.propertyName),i=t.relationJoinColumnBuilder.build(r,n),o=i.foreignKey,a=i.columns,s=i.uniqueConstraint;if(o&&(n.registerForeignKeys(o),e.foreignKeys.push(o)),a&&n.registerJoinColumns(a),s)if(t.connection.driver instanceof h.i||t.connection.driver instanceof h.a||t.connection.driver instanceof h.m||t.connection.driver instanceof h.l){var c=new jt({entityMetadata:s.entityMetadata,columns:s.columns,args:{target:s.target,name:s.name,unique:!0,synchronize:!0}});t.connection.driver instanceof h.m&&(c.where=c.columns.map((function(e){return t.connection.driver.escape(e.databaseName)+" IS NOT NULL"})).join(" AND ")),n.embeddedMetadata?n.embeddedMetadata.indices.push(c):n.entityMetadata.ownIndices.push(c),t.computeEntityMetadataStep2(e)}else n.embeddedMetadata?n.embeddedMetadata.uniques.push(s):n.entityMetadata.ownUniques.push(s),t.computeEntityMetadataStep2(e);if(o&&t.connection.driver instanceof h.d){c=new jt({entityMetadata:n.entityMetadata,columns:o.columns,args:{target:n.entityMetadata.target,synchronize:!0}});n.embeddedMetadata?n.embeddedMetadata.indices.push(c):n.entityMetadata.ownIndices.push(c),t.computeEntityMetadataStep2(e)}})),e.relations.filter((function(e){return e.isManyToMany})).forEach((function(e){var i=t.metadataArgsStorage.findJoinTable(e.target,e.propertyName);if(i){var o=t.junctionEntityMetadataBuilder.build(e,i);e.registerForeignKeys.apply(e,Object(r.f)([],Object(r.e)(o.foreignKeys))),e.registerJoinColumns(o.ownIndices[0].columns,o.ownIndices[1].columns),e.registerJunctionEntityMetadata(o),t.computeEntityMetadataStep2(o),t.computeInverseProperties(o,n),n.push(o)}}))})),n.forEach((function(e){e.relationsWithJoinColumns=e.relations.filter((function(e){return e.isWithJoinColumn})),e.hasNonNullableRelations=e.relationsWithJoinColumns.some((function(e){return!e.isNullable||e.isPrimary}))})),n.filter((function(e){return"closure-table"===e.treeType})).forEach((function(e){var r=t.closureJunctionEntityMetadataBuilder.build(e);e.closureJunctionTable=r,t.computeEntityMetadataStep2(r),t.computeInverseProperties(r,n),n.push(r)})),n.filter((function(e){return"STI"===e.inheritancePattern&&e.discriminatorColumn})).forEach((function(e){return t.createKeysForTableInheritance(e)})),n.forEach((function(e){e.indices.forEach((function(e){return e.build(t.connection.namingStrategy)}))})),n.forEach((function(e){e.uniques.forEach((function(e){return e.build(t.connection.namingStrategy)}))})),n.forEach((function(e){e.checks.forEach((function(e){return e.build(t.connection.namingStrategy)}))})),n.forEach((function(e){e.exclusions.forEach((function(e){return e.build(t.connection.namingStrategy)}))})),n.filter((function(e){return e.target instanceof Function})).forEach((function(e){e.relations.filter((function(e){return e.isLazy})).forEach((function(n){t.connection.relationLoader.enableLazyLoad(n,e.target.prototype)}))})),n.forEach((function(e){e.columns.forEach((function(n){var r=t.metadataArgsStorage.findGenerated(n.target,n.propertyName);r&&(n.isGenerated=!0,n.generationStrategy=r.strategy,"uuid"===r.strategy?n.type="uuid":"rowid"===r.strategy?n.type="int":n.type=n.type||Number,n.build(t.connection),t.computeEntityMetadataStep2(e))}))})),n},e.prototype.createEntityMetadata=function(e){var t,n=e.target instanceof Function?qt.getInheritanceTree(e.target):[e.target],i=this.metadataArgsStorage.findInheritanceType(e.target),o=this.metadataArgsStorage.findTree(e.target);return(i&&"STI"===i.pattern||"entity-child"===e.type)&&(t=this.metadataArgsStorage.filterSingleTableChildren(e.target).map((function(e){return e.target})).filter((function(e){return e instanceof Function})),n.push.apply(n,Object(r.f)([],Object(r.e)(t)))),new se.a({connection:this.connection,args:e,inheritanceTree:n,tableTree:o,inheritancePattern:i?i.pattern:void 0})},e.prototype.computeParentEntityMetadata=function(e,t){"entity-child"===t.tableType&&(t.parentEntityMetadata=e.find((function(e){return-1!==e.inheritanceTree.indexOf(t.target)&&"STI"===e.inheritancePattern})))},e.prototype.computeEntityMetadataStep1=function(e,t){var n,i,o,a=this,s=this.metadataArgsStorage.findInheritanceType(t.target),c=this.metadataArgsStorage.findDiscriminatorValue(t.target);if(t.discriminatorValue=void 0!==c?c.value:t.target.name,t.embeddeds=this.createEmbeddedsRecursively(t,this.metadataArgsStorage.filterEmbeddeds(t.inheritanceTree)).map((function(e){return"STI"===t.inheritancePattern&&(e.columns=e.columns.map((function(e){return e.isNullable=!0,e}))),e})),t.ownColumns=this.metadataArgsStorage.filterColumns(t.inheritanceTree).map((function(n){if("entity-child"===t.tableType)return t.parentEntityMetadata.ownColumns.find((function(e){return e.propertyName===n.propertyName}));var r=new At.a({connection:a.connection,entityMetadata:t,args:n});return e.find((function(e){return"entity-child"===e.tableType&&e.target===n.target}))&&(r.isNullable=!0),r})),s&&s.column){var u=s.column&&s.column.name?s.column.name:"type",l=t.ownColumns.find((function(e){return e.propertyName===u}));l?l.isDiscriminator=!0:((l=new At.a({connection:this.connection,entityMetadata:t,args:{target:t.target,mode:"virtual",propertyName:u,options:s.column||{name:u,type:"varchar",nullable:!1}}})).isVirtual=!0,l.isDiscriminator=!0,t.ownColumns.push(l))}if("entity-child"===t.tableType){var f=t.parentEntityMetadata.ownColumns.find((function(e){return e.isDiscriminator}));f&&!t.ownColumns.find((function(e){return e===f}))&&t.ownColumns.push(f)}var d=this.connection.namingStrategy;if("materialized-path"===t.treeType)t.ownColumns.push(new At.a({connection:this.connection,entityMetadata:t,materializedPath:!0,args:{target:t.target,mode:"virtual",propertyName:"mpath",options:{name:d.materializedPathColumnName,type:"varchar",nullable:!0,default:""}}}));else if("nested-set"===t.treeType){var p=d.nestedSetColumnNames,m=p.left,y=p.right;t.ownColumns.push(new At.a({connection:this.connection,entityMetadata:t,nestedSetLeft:!0,args:{target:t.target,mode:"virtual",propertyName:m,options:{name:m,type:"integer",nullable:!1,default:1}}})),t.ownColumns.push(new At.a({connection:this.connection,entityMetadata:t,nestedSetRight:!0,args:{target:t.target,mode:"virtual",propertyName:y,options:{name:y,type:"integer",nullable:!1,default:2}}}))}if(t.ownRelations=this.metadataArgsStorage.filterRelations(t.inheritanceTree).map((function(e){if("entity-child"===t.tableType){var n=t.parentEntityMetadata.ownRelations.find((function(t){return t.propertyName===e.propertyName})),r=e.type instanceof Function?e.type():e.type;if(n.type!==r){var i=Object.create(n);return i.type=r,i}return n}return new It({entityMetadata:t,args:e})})),t.relationIds=this.metadataArgsStorage.filterRelationIds(t.inheritanceTree).map((function(e){return"entity-child"===t.tableType?t.parentEntityMetadata.relationIds.find((function(t){return t.propertyName===e.propertyName})):new Lt({entityMetadata:t,args:e})})),t.relationCounts=this.metadataArgsStorage.filterRelationCounts(t.inheritanceTree).map((function(e){return"entity-child"===t.tableType?t.parentEntityMetadata.relationCounts.find((function(t){return t.propertyName===e.propertyName})):new Bt({entityMetadata:t,args:e})})),t.ownListeners=this.metadataArgsStorage.filterListeners(t.inheritanceTree).map((function(e){return new Yt({entityMetadata:t,args:e})})),t.checks=this.metadataArgsStorage.filterChecks(t.inheritanceTree).map((function(e){return new Qt({entityMetadata:t,args:e})})),this.connection.driver instanceof h.k&&(t.exclusions=this.metadataArgsStorage.filterExclusions(t.inheritanceTree).map((function(e){return new Gt({entityMetadata:t,args:e})}))),this.connection.driver instanceof h.d){t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter((function(e){return!e.unique})).map((function(e){return new jt({entityMetadata:t,args:e})}));var g=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter((function(e){return e.unique})).map((function(e){return new zt({entityMetadata:t,args:{target:e.target,name:e.name,columns:e.columns}})}));(n=t.ownUniques).push.apply(n,Object(r.f)([],Object(r.e)(g)))}else t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).map((function(e){return new jt({entityMetadata:t,args:e})}));if(this.connection.driver instanceof h.i||this.connection.driver instanceof h.a||this.connection.driver instanceof h.l){var b=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map((function(e){return new jt({entityMetadata:t,args:{target:e.target,name:e.name,columns:e.columns,unique:!0,synchronize:!0}})}));(i=t.ownIndices).push.apply(i,Object(r.f)([],Object(r.e)(b)))}else{g=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map((function(e){return new zt({entityMetadata:t,args:e})}));(o=t.ownUniques).push.apply(o,Object(r.f)([],Object(r.e)(g)))}},e.prototype.createEmbeddedsRecursively=function(e,t){var n=this;return t.map((function(t){var r=new Dt({entityMetadata:e,args:t}),i=qt.getInheritanceTree(r.type);return r.columns=n.metadataArgsStorage.filterColumns(i).map((function(t){return new At.a({connection:n.connection,entityMetadata:e,embeddedMetadata:r,args:t})})),r.relations=n.metadataArgsStorage.filterRelations(i).map((function(t){return new It({entityMetadata:e,embeddedMetadata:r,args:t})})),r.listeners=n.metadataArgsStorage.filterListeners(i).map((function(t){return new Yt({entityMetadata:e,embeddedMetadata:r,args:t})})),r.indices=n.metadataArgsStorage.filterIndices(i).map((function(t){return new jt({entityMetadata:e,embeddedMetadata:r,args:t})})),r.uniques=n.metadataArgsStorage.filterUniques(i).map((function(t){return new zt({entityMetadata:e,embeddedMetadata:r,args:t})})),r.relationIds=n.metadataArgsStorage.filterRelationIds(i).map((function(t){return new Lt({entityMetadata:e,args:t})})),r.relationCounts=n.metadataArgsStorage.filterRelationCounts(i).map((function(t){return new Bt({entityMetadata:e,args:t})})),r.embeddeds=n.createEmbeddedsRecursively(e,n.metadataArgsStorage.filterEmbeddeds(i)),r.embeddeds.forEach((function(e){return e.parentEmbeddedMetadata=r})),e.allEmbeddeds.push(r),r}))},e.prototype.computeEntityMetadataStep2=function(e){var t=this;e.embeddeds.forEach((function(e){return e.build(t.connection)})),e.embeddeds.forEach((function(e){e.columnsFromTree.forEach((function(e){return e.build(t.connection)})),e.relationsFromTree.forEach((function(e){return e.build()}))})),e.ownColumns.forEach((function(e){return e.build(t.connection)})),e.ownRelations.forEach((function(e){return e.build()})),e.relations=e.embeddeds.reduce((function(e,t){return e.concat(t.relationsFromTree)}),e.ownRelations),e.eagerRelations=e.relations.filter((function(e){return e.isEager})),e.lazyRelations=e.relations.filter((function(e){return e.isLazy})),e.oneToOneRelations=e.relations.filter((function(e){return e.isOneToOne})),e.oneToManyRelations=e.relations.filter((function(e){return e.isOneToMany})),e.manyToOneRelations=e.relations.filter((function(e){return e.isManyToOne})),e.manyToManyRelations=e.relations.filter((function(e){return e.isManyToMany})),e.ownerOneToOneRelations=e.relations.filter((function(e){return e.isOneToOneOwner})),e.ownerManyToManyRelations=e.relations.filter((function(e){return e.isManyToManyOwner})),e.treeParentRelation=e.relations.find((function(e){return e.isTreeParent})),e.treeChildrenRelation=e.relations.find((function(e){return e.isTreeChildren})),e.columns=e.embeddeds.reduce((function(e,t){return e.concat(t.columnsFromTree)}),e.ownColumns),e.listeners=e.embeddeds.reduce((function(e,t){return e.concat(t.listenersFromTree)}),e.ownListeners),e.afterLoadListeners=e.listeners.filter((function(e){return e.type===Ft.AFTER_LOAD})),e.afterInsertListeners=e.listeners.filter((function(e){return e.type===Ft.AFTER_INSERT})),e.afterUpdateListeners=e.listeners.filter((function(e){return e.type===Ft.AFTER_UPDATE})),e.afterRemoveListeners=e.listeners.filter((function(e){return e.type===Ft.AFTER_REMOVE})),e.beforeInsertListeners=e.listeners.filter((function(e){return e.type===Ft.BEFORE_INSERT})),e.beforeUpdateListeners=e.listeners.filter((function(e){return e.type===Ft.BEFORE_UPDATE})),e.beforeRemoveListeners=e.listeners.filter((function(e){return e.type===Ft.BEFORE_REMOVE})),e.indices=e.embeddeds.reduce((function(e,t){return e.concat(t.indicesFromTree)}),e.ownIndices),e.uniques=e.embeddeds.reduce((function(e,t){return e.concat(t.uniquesFromTree)}),e.ownUniques),e.primaryColumns=e.columns.filter((function(e){return e.isPrimary})),e.nonVirtualColumns=e.columns.filter((function(e){return!e.isVirtual})),e.ancestorColumns=e.columns.filter((function(e){return"ancestor"===e.closureType})),e.descendantColumns=e.columns.filter((function(e){return"descendant"===e.closureType})),e.hasMultiplePrimaryKeys=e.primaryColumns.length>1,e.generatedColumns=e.columns.filter((function(e){return e.isGenerated||e.isObjectId})),e.hasUUIDGeneratedColumns=e.columns.filter((function(e){return e.isGenerated||"uuid"===e.generationStrategy})).length>0,e.createDateColumn=e.columns.find((function(e){return e.isCreateDate})),e.updateDateColumn=e.columns.find((function(e){return e.isUpdateDate})),e.deleteDateColumn=e.columns.find((function(e){return e.isDeleteDate})),e.versionColumn=e.columns.find((function(e){return e.isVersion})),e.discriminatorColumn=e.columns.find((function(e){return e.isDiscriminator})),e.treeLevelColumn=e.columns.find((function(e){return e.isTreeLevel})),e.nestedSetLeftColumn=e.columns.find((function(e){return e.isNestedSetLeft})),e.nestedSetRightColumn=e.columns.find((function(e){return e.isNestedSetRight})),e.materializedPathColumn=e.columns.find((function(e){return e.isMaterializedPath})),e.objectIdColumn=e.columns.find((function(e){return e.isObjectId})),e.foreignKeys.forEach((function(e){return e.build(t.connection.namingStrategy)})),e.propertiesMap=e.createPropertiesMap(),e.relationIds.forEach((function(e){return e.build()})),e.relationCounts.forEach((function(e){return e.build()})),e.embeddeds.forEach((function(e){e.relationIdsFromTree.forEach((function(e){return e.build()})),e.relationCountsFromTree.forEach((function(e){return e.build()}))}))},e.prototype.computeInverseProperties=function(e,t){e.relations.forEach((function(n){var r=t.find((function(e){return e.target===n.type||"string"==typeof n.type&&(e.targetName===n.type||e.givenTableName===n.type)}));if(!r)throw new Error("Entity metadata for "+e.name+"#"+n.propertyPath+" was not found. Check if you specified a correct entity object and if it's connected in the connection options.");n.inverseEntityMetadata=r,n.inverseSidePropertyPath=n.buildInverseSidePropertyPath(),n.inverseRelation=r.relations.find((function(e){return e.propertyPath===n.inverseSidePropertyPath}))}))},e.prototype.createKeysForTableInheritance=function(e){e.indices.push(new jt({entityMetadata:e,columns:[e.discriminatorColumn],args:{target:e.target,unique:!1}}))},e}(),Kt=function(){function e(){this.tables=[],this.trees=[],this.entityRepositories=[],this.transactionEntityManagers=[],this.transactionRepositories=[],this.namingStrategies=[],this.entitySubscribers=[],this.indices=[],this.uniques=[],this.checks=[],this.exclusions=[],this.columns=[],this.generations=[],this.relations=[],this.joinColumns=[],this.joinTables=[],this.entityListeners=[],this.relationCounts=[],this.relationIds=[],this.embeddeds=[],this.inheritances=[],this.discriminatorValues=[]}return e.prototype.filterTables=function(e){return this.filterByTarget(this.tables,e)},e.prototype.filterColumns=function(e){return this.filterByTargetAndWithoutDuplicateProperties(this.columns,e)},e.prototype.findGenerated=function(e,t){return this.generations.find((function(n){return(Array.isArray(e)?-1!==e.indexOf(n.target):n.target===e)&&n.propertyName===t}))},e.prototype.findTree=function(e){return this.trees.find((function(t){return Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e}))},e.prototype.filterRelations=function(e){return this.filterByTargetAndWithoutDuplicateRelationProperties(this.relations,e)},e.prototype.filterRelationIds=function(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationIds,e)},e.prototype.filterRelationCounts=function(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationCounts,e)},e.prototype.filterIndices=function(e){return this.indices.filter((function(t){return Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e}))},e.prototype.filterUniques=function(e){return this.uniques.filter((function(t){return Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e}))},e.prototype.filterChecks=function(e){return this.checks.filter((function(t){return Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e}))},e.prototype.filterExclusions=function(e){return this.exclusions.filter((function(t){return Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e}))},e.prototype.filterListeners=function(e){return this.filterByTarget(this.entityListeners,e)},e.prototype.filterEmbeddeds=function(e){return this.filterByTargetAndWithoutDuplicateEmbeddedProperties(this.embeddeds,e)},e.prototype.findJoinTable=function(e,t){return this.joinTables.find((function(n){return n.target===e&&n.propertyName===t}))},e.prototype.filterJoinColumns=function(e,t){return this.joinColumns.filter((function(n){return n.target===e&&n.propertyName===t}))},e.prototype.filterSubscribers=function(e){return this.filterByTarget(this.entitySubscribers,e)},e.prototype.filterNamingStrategies=function(e){return this.filterByTarget(this.namingStrategies,e)},e.prototype.filterTransactionEntityManagers=function(e,t){return this.transactionEntityManagers.filter((function(n){return(Array.isArray(e)?-1!==e.indexOf(n.target):n.target===e)&&n.methodName===t}))},e.prototype.filterTransactionRepository=function(e,t){return this.transactionRepositories.filter((function(n){return(Array.isArray(e)?-1!==e.indexOf(n.target):n.target===e)&&n.methodName===t}))},e.prototype.filterSingleTableChildren=function(e){return this.tables.filter((function(t){return t.target instanceof Function&&e instanceof Function&&qt.isInherited(t.target,e)&&"entity-child"===t.type}))},e.prototype.findInheritanceType=function(e){return this.inheritances.find((function(t){return t.target===e}))},e.prototype.findDiscriminatorValue=function(e){return this.discriminatorValues.find((function(t){return t.target===e}))},e.prototype.filterByTarget=function(e,t){return e.filter((function(e){return Array.isArray(t)?-1!==t.indexOf(e.target):e.target===t}))},e.prototype.filterByTargetAndWithoutDuplicateProperties=function(e,t){var n=[];return e.forEach((function(e){(Array.isArray(t)?-1!==t.indexOf(e.target):e.target===t)&&(n.find((function(t){return t.propertyName===e.propertyName}))||n.push(e))})),n},e.prototype.filterByTargetAndWithoutDuplicateRelationProperties=function(e,t){var n=[];return e.forEach((function(e){if(t instanceof Array?-1!==t.indexOf(e.target):e.target===t){var r=n.findIndex((function(t){return t.propertyName===e.propertyName}));if(t instanceof Array&&-1!==r&&t.indexOf(e.target)<t.indexOf(n[r].target)){var i=Object.create(n[r]);i.type=e.type,n[r]=i}else-1===r&&n.push(e)}})),n},e.prototype.filterByTargetAndWithoutDuplicateEmbeddedProperties=function(e,t){var n=[];return e.forEach((function(e){(Array.isArray(t)?-1!==t.indexOf(e.target):e.target===t)&&(n.find((function(t){return t.prefix===e.prefix&&t.propertyName===e.propertyName}))||n.push(e))})),n},e}(),$t=function(){function e(){}return e.prototype.transform=function(e){var t=new Kt;return e.forEach((function(e){var n=e.options,i={target:n.target||n.name,name:n.tableName,database:n.database,schema:n.schema,type:n.type||"regular",orderBy:n.orderBy,synchronize:n.synchronize,expression:n.expression};t.tables.push(i),Object.keys(n.columns).forEach((function(e){var r=n.columns[e],i="regular";r.createDate&&(i="createDate"),r.updateDate&&(i="updateDate"),r.deleteDate&&(i="deleteDate"),r.version&&(i="version"),r.treeChildrenCount&&(i="treeChildrenCount"),r.treeLevel&&(i="treeLevel"),r.objectId&&(i="objectId");var o={target:n.target||n.name,mode:i,propertyName:e,options:{type:r.type,name:r.objectId?"_id":r.name,length:r.length,width:r.width,nullable:r.nullable,readonly:r.readonly,update:r.update,select:r.select,insert:r.insert,primary:r.primary,unique:r.unique,comment:r.comment,default:r.default,onUpdate:r.onUpdate,precision:r.precision,scale:r.scale,zerofill:r.zerofill,unsigned:r.unsigned,charset:r.charset,collation:r.collation,enum:r.enum,asExpression:r.asExpression,generatedType:r.generatedType,hstoreType:r.hstoreType,array:r.array,transformer:r.transformer,spatialFeatureType:r.spatialFeatureType,srid:r.srid}};if(t.columns.push(o),r.generated){var a={target:n.target||n.name,propertyName:e,strategy:"string"==typeof r.generated?r.generated:"increment"};t.generations.push(a)}r.unique&&t.uniques.push({target:n.target||n.name,columns:[e]})})),n.relations&&Object.keys(n.relations).forEach((function(e){var i,o,a=n.relations[e],s={target:n.target||n.name,propertyName:e,relationType:a.type,isLazy:a.lazy||!1,type:a.target,inverseSideProperty:a.inverseSide,isTreeParent:a.treeParent,isTreeChildren:a.treeChildren,options:{eager:a.eager||!1,cascade:a.cascade,nullable:a.nullable,onDelete:a.onDelete,onUpdate:a.onUpdate,deferrable:a.deferrable,primary:a.primary,persistence:a.persistence,orphanedRowAction:a.orphanedRowAction}};if(t.relations.push(s),a.joinColumn)if("boolean"==typeof a.joinColumn){var c={target:n.target||n.name,propertyName:e};t.joinColumns.push(c)}else{var u=Array.isArray(a.joinColumn)?a.joinColumn:[a.joinColumn];try{for(var l=Object(r.g)(u),f=l.next();!f.done;f=l.next()){var h=f.value;c={target:n.target||n.name,propertyName:e,name:h.name,referencedColumnName:h.referencedColumnName};t.joinColumns.push(c)}}catch(e){i={error:e}}finally{try{f&&!f.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}}if(a.joinTable)if("boolean"==typeof a.joinTable){var d={target:n.target||n.name,propertyName:e};t.joinTables.push(d)}else{d={target:n.target||n.name,propertyName:e,name:a.joinTable.name,database:a.joinTable.database,schema:a.joinTable.schema,joinColumns:a.joinTable.joinColumn?[a.joinTable.joinColumn]:a.joinTable.joinColumns,inverseJoinColumns:a.joinTable.inverseJoinColumn?[a.joinTable.inverseJoinColumn]:a.joinTable.inverseJoinColumns};t.joinTables.push(d)}})),n.indices&&n.indices.forEach((function(e){var r={target:n.target||n.name,name:e.name,unique:!0===e.unique,spatial:!0===e.spatial,fulltext:!0===e.fulltext,parser:e.parser,synchronize:!1!==e.synchronize,where:e.where,sparse:e.sparse,columns:e.columns};t.indices.push(r)})),n.uniques&&n.uniques.forEach((function(e){var r={target:n.target||n.name,name:e.name,columns:e.columns};t.uniques.push(r)})),n.checks&&n.checks.forEach((function(e){var r={target:n.target||n.name,name:e.name,expression:e.expression};t.checks.push(r)})),n.exclusions&&n.exclusions.forEach((function(e){var r={target:n.target||n.name,name:e.name,expression:e.expression};t.exclusions.push(r)}))})),t},e}(),Xt=n(86),Zt=function(){function e(e){this.connection=e}return e.prototype.buildMigrations=function(e){var t=Object(r.e)(Q.a.splitClassesAndStrings(e),2),n=t[0];t[1];return Object(r.f)(Object(r.f)([],Object(r.e)(n)),Object(r.e)(St(this.connection.logger))).map((function(e){return Mt(e)}))},e.prototype.buildSubscribers=function(e){var t=Object(r.e)(Q.a.splitClassesAndStrings(e||[]),2),n=t[0],i=(t[1],Object(r.f)(Object(r.f)([],Object(r.e)(n)),Object(r.e)(St(this.connection.logger))));return Pr().filterSubscribers(i).map((function(e){return Mt(e.target)}))},e.prototype.buildEntityMetadatas=function(e){var t=Object(r.e)(Q.a.splitClassesAndStrings(e||[]),2),n=t[0],i=(t[1],n.filter((function(e){return e instanceof Xt.a==!1}))),o=n.filter((function(e){return e instanceof Xt.a})),a=Object(r.f)(Object(r.f)([],Object(r.e)(i)),Object(r.e)(St(this.connection.logger)));a.forEach((function(e){e instanceof Xt.a&&o.push(e)}));var s=new Jt(this.connection,Pr()).build(a),c=(new $t).transform(o),u=new Jt(this.connection,c).build();return Object(r.f)(Object(r.f)([],Object(r.e)(s)),Object(r.e)(u))},e}(),en=n(127),tn=function(){function e(e){this.options=e}return e.prototype.logQuery=function(e,t,n){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("query")){var r=e+(t&&t.length?" -- PARAMETERS: "+this.stringifyParams(t):"");console.log("query: "+r)}},e.prototype.logQueryError=function(e,t,n,r){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("error")){var i=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");console.log("query failed: "+i),console.log("error:",e)}},e.prototype.logQuerySlow=function(e,t,n,r){var i=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");console.log("query is slow: "+i),console.log("execution time: "+e)},e.prototype.logSchemaBuild=function(e,t){("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("schema"))&&console.log(e)},e.prototype.logMigration=function(e,t){console.log(e)},e.prototype.log=function(e,t,n){switch(e){case"log":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("log"))&&console.log(t);break;case"info":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("info"))&&console.info(t);break;case"warn":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("warn"))&&console.warn(t)}},e.prototype.stringifyParams=function(e){try{return JSON.stringify(e)}catch(t){return e}},e}(),nn=function(){function e(e){this.options=e}return e.prototype.logQuery=function(e,t,n){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("query")){var r=e+(t&&t.length?" -- PARAMETERS: "+this.stringifyParams(t):"");Ie.a.logInfo("query:",Ie.a.highlightSql(r))}},e.prototype.logQueryError=function(e,t,n,r){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("error")){var i=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");Ie.a.logError("query failed:",Ie.a.highlightSql(i)),Ie.a.logError("error:",e)}},e.prototype.logQuerySlow=function(e,t,n,r){var i=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");Ie.a.logWarn("query is slow:",Ie.a.highlightSql(i)),Ie.a.logWarn("execution time:",e)},e.prototype.logSchemaBuild=function(e,t){("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("schema"))&&Ie.a.log(e)},e.prototype.logMigration=function(e,t){Ie.a.log(e)},e.prototype.log=function(e,t,n){switch(e){case"log":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("log"))&&Ie.a.log(t);break;case"info":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("info"))&&Ie.a.logInfo("INFO:",t);break;case"warn":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("warn"))&&console.warn(Ie.a.warn(t))}},e.prototype.stringifyParams=function(e){try{return JSON.stringify(e)}catch(t){return e}},e}(),rn=function(){function e(){}return e.prototype.logQuery=function(){throw new Error("This logger is not applicable in a browser context")},e.prototype.logQueryError=function(){throw new Error("This logger is not applicable in a browser context")},e.prototype.logQuerySlow=function(){throw new Error("This logger is not applicable in a browser context")},e.prototype.logSchemaBuild=function(){throw new Error("This logger is not applicable in a browser context")},e.prototype.logMigration=function(){throw new Error("This logger is not applicable in a browser context")},e.prototype.log=function(){throw new Error("This logger is not applicable in a browser context")},e}(),on=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.c)(t,e),t}(rn),an=n(90),sn=n.n(an),cn=function(){function e(){this.debugQueryLog=sn()("typeorm:query:log"),this.debugQueryError=sn()("typeorm:query:error"),this.debugQuerySlow=sn()("typeorm:query:slow"),this.debugSchemaBuild=sn()("typeorm:schema"),this.debugMigration=sn()("typeorm:migration"),this.debugLog=sn()("typeorm:log"),this.debugInfo=sn()("typeorm:info"),this.debugWarn=sn()("typeorm:warn")}return e.prototype.logQuery=function(e,t,n){this.debugQueryLog.enabled&&(this.debugQueryLog(Ie.a.highlightSql(e)+";"),t&&t.length&&this.debugQueryLog("parameters:",t))},e.prototype.logQueryError=function(e,t,n,r){this.debugQueryError.enabled&&(this.debugQueryError(Ie.a.highlightSql(t)+";"),n&&n.length&&this.debugQueryError("parameters:",n),this.debugQueryError("error: ",e))},e.prototype.logQuerySlow=function(e,t,n,r){this.debugQuerySlow.enabled&&(this.debugQuerySlow(Ie.a.highlightSql(t)+";"),n&&n.length&&this.debugQuerySlow("parameters:",n),this.debugQuerySlow("execution time:",e))},e.prototype.logSchemaBuild=function(e,t){this.debugSchemaBuild.enabled&&this.debugSchemaBuild(e)},e.prototype.logMigration=function(e,t){this.debugMigration.enabled&&this.debugMigration(e)},e.prototype.log=function(e,t,n){switch(e){case"log":this.debugLog.enabled&&this.debugLog(t);break;case"info":this.debugInfo.enabled&&this.debugInfo(t);break;case"warn":this.debugWarn.enabled&&this.debugWarn(t)}},e}(),un=function(){function e(){}return e.prototype.create=function(e,t){if(e instanceof Object)return e;if(e)switch(e){case"simple-console":return new tn(t);case"file":return new on(t);case"advanced-console":return new nn(t);case"debug":return new cn}return new nn(t)},e}(),ln=function(){function e(e,t){this.connection=e,this.clientType=t,this.redis=this.loadRedis()}return e.prototype.connect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(t){if(e=this.connection.options.cache,"redis"===this.clientType)e&&e.options?this.client=this.redis.createClient(e.options):this.client=this.redis.createClient();else if("ioredis"===this.clientType)e&&e.port?e.options?this.client=new this.redis(e.port,e.options):this.client=new this.redis(e.port):e&&e.options?this.client=new this.redis(e.options):this.client=new this.redis;else if("ioredis/cluster"===this.clientType)if(e&&e.options&&Array.isArray(e.options))this.client=new this.redis.Cluster(e.options);else{if(!(e&&e.options&&e.options.startupNodes))throw new Error("options.startupNodes required for "+this.clientType+".");this.client=new this.redis.Cluster(e.options.startupNodes,e.options.options)}return[2]}))}))},e.prototype.disconnect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){return[2,new Promise((function(t,n){e.client.quit((function(r,i){if(r)return n(r);t(),e.client=void 0}))}))]}))}))},e.prototype.synchronize=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2]}))}))},e.prototype.getFromCache=function(e,t){var n=this;return new Promise((function(t,r){e.identifier?n.client.get(e.identifier,(function(e,n){if(e)return r(e);t(JSON.parse(n))})):e.query?n.client.get(e.query,(function(e,n){if(e)return r(e);t(JSON.parse(n))})):t(void 0)}))},e.prototype.isExpired=function(e){return e.time+e.duration<(new Date).getTime()},e.prototype.storeInCache=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var t=this;return Object(r.d)(this,(function(n){return[2,new Promise((function(n,r){e.identifier?t.client.set(e.identifier,JSON.stringify(e),"PX",e.duration,(function(e,t){if(e)return r(e);n()})):e.query&&t.client.set(e.query,JSON.stringify(e),"PX",e.duration,(function(e,t){if(e)return r(e);n()}))}))]}))}))},e.prototype.clear=function(e){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){return[2,new Promise((function(t,n){e.client.flushdb((function(e,r){if(e)return n(e);t()}))}))]}))}))},e.prototype.remove=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var t=this;return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return t.deleteKey(e)})))];case 1:return n.sent(),[2]}}))}))},e.prototype.deleteKey=function(e){var t=this;return new Promise((function(n,r){t.client.del(e,(function(e,t){if(e)return r(e);n()}))}))},e.prototype.loadRedis=function(){try{return"ioredis/cluster"===this.clientType?Ie.a.load("ioredis"):Ie.a.load(this.clientType)}catch(e){throw new Error("Cannot use cache because "+this.clientType+' is not installed. Please run "npm i '+this.clientType+' --save".')}},e}(),fn=function(){function e(e){this.connection=e;var t=this.connection.driver.options,n=("object"==typeof this.connection.options.cache?this.connection.options.cache:{}).tableName||"query-result-cache";this.queryResultCacheTable=this.connection.driver.buildTableName(n,t.schema,t.database)}return e.prototype.connect=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2]}))}))},e.prototype.disconnect=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2]}))}))},e.prototype.synchronize=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return e=this.getQueryRunner(e),t=this.connection.driver,[4,e.hasTable(this.queryResultCacheTable)];case 1:return n.sent()?[2]:[4,e.createTable(new a.a({name:this.queryResultCacheTable,columns:[{name:"id",isPrimary:!0,isNullable:!1,type:t.normalizeType({type:t.mappedDataTypes.cacheId}),generationStrategy:"increment",isGenerated:!0},{name:"identifier",type:t.normalizeType({type:t.mappedDataTypes.cacheIdentifier}),isNullable:!0},{name:"time",type:t.normalizeType({type:t.mappedDataTypes.cacheTime}),isPrimary:!1,isNullable:!1},{name:"duration",type:t.normalizeType({type:t.mappedDataTypes.cacheDuration}),isPrimary:!1,isNullable:!1},{name:"query",type:t.normalizeType({type:t.mappedDataTypes.cacheQuery}),isPrimary:!1,isNullable:!1},{name:"result",type:t.normalizeType({type:t.mappedDataTypes.cacheResult}),isNullable:!1}]}))];case 2:return n.sent(),[2]}}))}))},e.prototype.getFromCache=function(e,t){t=this.getQueryRunner(t);var n=this.connection.createQueryBuilder(t).select().from(this.queryResultCacheTable,"cache");return e.identifier?n.where(n.escape("cache")+"."+n.escape("identifier")+" = :identifier").setParameters({identifier:this.connection.driver instanceof h.m?new d(e.identifier,"nvarchar"):e.identifier}).getRawOne():e.query?this.connection.driver instanceof h.j?n.where("dbms_lob.compare("+n.escape("cache")+"."+n.escape("query")+", :query) = 0",{query:e.query}).getRawOne():n.where(n.escape("cache")+"."+n.escape("query")+" = :query").setParameters({query:this.connection.driver instanceof h.m?new d(e.query,"nvarchar"):e.query}).getRawOne():Promise.resolve(void 0)},e.prototype.isExpired=function(e){var t="string"==typeof e.duration?parseInt(e.duration):e.duration;return("string"==typeof e.time?parseInt(e.time):e.time)+t<(new Date).getTime()},e.prototype.storeInCache=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=this.getQueryRunner(n),i=e,this.connection.driver instanceof h.m&&(i={identifier:new d(e.identifier,"nvarchar"),time:new d(e.time,"bigint"),duration:new d(e.duration,"int"),query:new d(e.query,"nvarchar"),result:new d(e.result,"nvarchar")}),t&&t.identifier?((o=n.manager.createQueryBuilder().update(this.queryResultCacheTable).set(i)).where(o.escape("identifier")+" = :condition",{condition:i.identifier}),[4,o.execute()]):[3,2];case 1:return r.sent(),[3,6];case 2:return t&&t.query?(o=n.manager.createQueryBuilder().update(this.queryResultCacheTable).set(i),this.connection.driver instanceof h.j?o.where('dbms_lob.compare("query", :condition) = 0',{condition:i.query}):o.where(o.escape("query")+" = :condition",{condition:i.query}),[4,o.execute()]):[3,4];case 3:return r.sent(),[3,6];case 4:return[4,n.manager.createQueryBuilder().insert().into(this.queryResultCacheTable).values(i).execute()];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))},e.prototype.clear=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){return[2,this.getQueryRunner(e).clearTable(this.queryResultCacheTable)]}))}))},e.prototype.remove=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,Promise.all(e.map((function(e){var r=n.getQueryRunner(t).manager.createQueryBuilder();return r.delete().from(n.queryResultCacheTable).where(r.escape("identifier")+" = :identifier",{identifier:e}).execute()})))];case 1:return r.sent(),[2]}}))}))},e.prototype.getQueryRunner=function(e){return e||this.connection.createQueryRunner()},e}(),hn=function(){function e(e){this.connection=e}return e.prototype.create=function(){if(!this.connection.options.cache)throw new Error("To use cache you need to enable it in connection options by setting cache: true or providing some caching options. Example: { host: ..., username: ..., cache: true }");var e=this.connection.options.cache;return e.provider&&"function"==typeof e.provider?e.provider(this.connection):"redis"===e.type||"ioredis"===e.type||"ioredis/cluster"===e.type?new ln(this.connection,e.type):new fn(this.connection)},e}(),dn=function(){function e(e){this.connection=e}return e.prototype.load=function(e,t,n){return n&&n.isReleased&&(n=void 0),e.isManyToOne||e.isOneToOneOwner?this.loadManyToOneOrOneToOneOwner(e,t,n):e.isOneToMany||e.isOneToOneNotOwner?this.loadOneToManyOrOneToOneNotOwner(e,t,n):e.isManyToManyOwner?this.loadManyToManyOwner(e,t,n):this.loadManyToManyNotOwner(e,t,n)},e.prototype.loadManyToOneOrOneToOneOwner=function(e,t,n){var r=Array.isArray(t)?t:[t],i=e.entityMetadata.primaryColumns,o=(e.isOwning?e.joinColumns:e.inverseRelation.joinColumns).map((function(t){return e.entityMetadata.name+"."+t.propertyName+" = "+e.propertyName+"."+t.referencedColumn.propertyName})).join(" AND "),a=e.entityMetadata.name,s=this.connection.createQueryBuilder(n).select(e.propertyName).from(e.type,e.propertyName).innerJoin(e.entityMetadata.target,a,o);if(1===i.length)s.where(a+"."+i[0].propertyPath+" IN (:..."+a+"_"+i[0].propertyName+")"),s.setParameter(a+"_"+i[0].propertyName,r.map((function(e){return i[0].getEntityValue(e)})));else{var c=r.map((function(e,t){return i.map((function(n,r){var i=a+"_entity_"+t+"_"+r;return s.setParameter(i,n.getEntityValue(e)),a+"."+n.propertyPath+" = :"+i})).join(" AND ")})).map((function(e){return"("+e+")"})).join(" OR ");s.where(c)}return s.getMany()},e.prototype.loadOneToManyOrOneToOneNotOwner=function(e,t,n){var r=Array.isArray(t)?t:[t],i=e.propertyName,o=e.inverseRelation.joinColumns,a=this.connection.createQueryBuilder(n).select(i).from(e.inverseRelation.entityMetadata.target,i);if(1===o.length)a.where(i+"."+o[0].propertyPath+" IN (:..."+i+"_"+o[0].propertyName+")"),a.setParameter(i+"_"+o[0].propertyName,r.map((function(e){return o[0].referencedColumn.getEntityValue(e)})));else{var s=r.map((function(e,t){return o.map((function(n,r){var o=i+"_entity_"+t+"_"+r;return a.setParameter(o,n.referencedColumn.getEntityValue(e)),i+"."+n.propertyPath+" = :"+o})).join(" AND ")})).map((function(e){return"("+e+")"})).join(" OR ");a.where(s)}return a.getMany()},e.prototype.loadManyToManyOwner=function(e,t,n){var i=Array.isArray(t)?t:[t],o=e.propertyName,a=e.junctionEntityMetadata.tableName,s=e.joinColumns.map((function(e){return a+"."+e.propertyName+" IN (:..."+e.propertyName+")"})),c=e.inverseJoinColumns.map((function(e){return a+"."+e.propertyName+"="+o+"."+e.referencedColumn.propertyName})),u=e.joinColumns.reduce((function(e,t){return e[t.propertyName]=i.map((function(e){return t.referencedColumn.getEntityValue(e)})),e}),{});return this.connection.createQueryBuilder(n).select(o).from(e.type,o).innerJoin(a,a,Object(r.f)(Object(r.f)([],Object(r.e)(s)),Object(r.e)(c)).join(" AND ")).setParameters(u).getMany()},e.prototype.loadManyToManyNotOwner=function(e,t,n){var i=Array.isArray(t)?t:[t],o=e.propertyName,a=e.junctionEntityMetadata.tableName,s=e.inverseRelation.joinColumns.map((function(e){return a+"."+e.propertyName+" = "+o+"."+e.referencedColumn.propertyName})),c=e.inverseRelation.inverseJoinColumns.map((function(e){return a+"."+e.propertyName+" IN (:..."+e.propertyName+")"})),u=e.inverseRelation.inverseJoinColumns.reduce((function(e,t){return e[t.propertyName]=i.map((function(e){return t.referencedColumn.getEntityValue(e)})),e}),{});return this.connection.createQueryBuilder(n).select(o).from(e.type,o).innerJoin(a,a,Object(r.f)(Object(r.f)([],Object(r.e)(s)),Object(r.e)(c)).join(" AND ")).setParameters(u).getMany()},e.prototype.enableLazyLoad=function(e,t,n){var r=this,i="__"+e.propertyName+"__",o="__promise_"+e.propertyName+"__",a="__has_"+e.propertyName+"__",s=function(e,t){return e[i]=t,e[a]=!0,delete e[o],t},c=function(e,t){return delete e[a],delete e[i],e[o]=t,t.then((function(n){return e[o]===t?s(e,n):n})),t};Object.defineProperty(t,e.propertyName,{get:function(){if(!0===this[a]||void 0!==this[i])return Promise.resolve(this[i]);if(this[o])return this[o];var t=r.load(e,this,n).then((function(t){return e.isOneToOne||e.isManyToOne?0===t.length?null:t[0]:t}));return c(this,t)},set:function(e){e instanceof Promise?c(this,e):s(this,e)},configurable:!0})},e}(),pn=function(){function e(e){this.connection=e}return e.prototype.load=function(e,t,n,i){return Object(r.b)(this,void 0,void 0,(function(){var o,a,s,c;return Object(r.d)(this,(function(r){if(e instanceof It)o=e,a=Array.isArray(t)?t:[t],s=Array.isArray(n)?n:n?[n]:void 0;else{if(c=this.connection.getMetadata(e),!(o=c.findRelationWithPropertyPath(t)))throw new Error('Relation "'+o+'" was not found in "'+c.name+'".');a=Array.isArray(n)?n:[n],s=Array.isArray(i)?i:i?[i]:void 0}return o.isManyToMany?[2,this.loadForManyToMany(o,a,s)]:o.isManyToOne||o.isOneToOneOwner?[2,this.loadForManyToOneAndOneToOneOwner(o,a,s)]:[2,this.loadForOneToManyAndOneToOneNotOwner(o,a,s)]}))}))},e.prototype.loadManyToManyRelationIdsAndGroup=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,a,s,c,u;return Object(r.d)(this,(function(r){switch(r.label){case 0:return i=e.isManyToMany||e.isOneToMany,o=Array.isArray(t)?t:[t],n?[3,2]:[4,this.connection.relationLoader.load(e,t)];case 1:if(!(n=r.sent()).length)return[2,o.map((function(e){return{entity:e,related:i?[]:void 0}}))];r.label=2;case 2:return[4,this.load(e,t,n)];case 3:return a=r.sent(),s=Array.isArray(n)?n:[n],e.isManyToManyOwner?(c=e.junctionEntityMetadata.inverseColumns.map((function(e){return e.referencedColumn})),u=e.junctionEntityMetadata.ownerColumns.map((function(e){return e.referencedColumn}))):e.isManyToManyNotOwner?(c=e.junctionEntityMetadata.ownerColumns.map((function(e){return e.referencedColumn})),u=e.junctionEntityMetadata.inverseColumns.map((function(e){return e.referencedColumn}))):e.isManyToOne||e.isOneToOneOwner?(c=e.joinColumns.map((function(e){return e.referencedColumn})),u=e.entityMetadata.primaryColumns):(e.isOneToMany||e.isOneToOneNotOwner)&&(c=e.inverseRelation.entityMetadata.primaryColumns,u=e.inverseRelation.joinColumns.map((function(e){return e.referencedColumn}))),[2,o.map((function(t){var n={entity:t,related:i?[]:void 0};return a.forEach((function(r){u.every((function(e){return e.getEntityValue(t)===r[e.entityMetadata.name+"_"+e.propertyPath.replace(".","_")]}))&&s.forEach((function(t){c.every((function(n){return n.getEntityValue(t)===r[n.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+n.propertyPath.replace(".","_")]}))&&(i?n.related.push(t):n.related=t)}))})),n}))]}}))}))},e.prototype.loadForManyToMany=function(e,t,n){var r=e.junctionEntityMetadata,i=r.name,o=e.isOwning?r.ownerColumns:r.inverseColumns,a=e.isOwning?r.inverseColumns:r.ownerColumns,s=this.connection.createQueryBuilder();r.ownerColumns.forEach((function(e){var t=e.referencedColumn.entityMetadata.name+"_"+e.referencedColumn.propertyPath.replace(".","_");s.addSelect(i+"."+e.propertyPath,t)})),r.inverseColumns.forEach((function(t){var n=t.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+t.referencedColumn.propertyPath.replace(".","_");s.addSelect(i+"."+t.propertyPath,n)}));var c="";1===o.length?(s.setParameter("values1",t.map((function(e){return o[0].referencedColumn.getEntityValue(e)}))),c=i+"."+o[0].propertyPath+" IN (:...values1)"):c="("+t.map((function(e,t){return o.map((function(n){var r="entity1_"+t+"_"+n.propertyName;return s.setParameter(r,n.referencedColumn.getEntityValue(e)),i+"."+n.propertyPath+" = :"+r})).join(" AND ")})).map((function(e){return"("+e+")"})).join(" OR ")+")";var u="";return n&&(1===a.length?(s.setParameter("values2",n.map((function(e){return a[0].referencedColumn.getEntityValue(e)}))),u=i+"."+a[0].propertyPath+" IN (:...values2)"):u="("+n.map((function(e,t){return a.map((function(n){var r="entity2_"+t+"_"+n.propertyName;return s.setParameter(r,n.referencedColumn.getEntityValue(e)),i+"."+n.propertyPath+" = :"+r})).join(" AND ")})).map((function(e){return"("+e+")"})).join(" OR ")+")"),s.from(r.target,i).where(c+(u?" AND "+u:"")).getRawMany()},e.prototype.loadForManyToOneAndOneToOneOwner=function(e,t,n){var r=e.entityMetadata.targetName,i=this.connection.createQueryBuilder();e.entityMetadata.primaryColumns.forEach((function(e){var t=e.entityMetadata.name+"_"+e.propertyPath.replace(".","_");i.addSelect(r+"."+e.propertyPath,t)})),e.joinColumns.forEach((function(t){var n=t.referencedColumn.entityMetadata.name+"_"+e.propertyPath.replace(".","_")+"_"+t.referencedColumn.propertyPath.replace(".","_");i.addSelect(r+"."+t.propertyPath,n)}));var o="";return 1===e.entityMetadata.primaryColumns.length?(i.setParameter("values",t.map((function(t){return e.entityMetadata.primaryColumns[0].getEntityValue(t)}))),o=r+"."+e.entityMetadata.primaryColumns[0].propertyPath+" IN (:...values)"):o=t.map((function(t,n){return e.entityMetadata.primaryColumns.map((function(e,o){var a="entity"+n+"_"+o;return i.setParameter(a,e.getEntityValue(t)),r+"."+e.propertyPath+" = :"+a})).join(" AND ")})).map((function(e){return"("+e+")"})).join(" OR "),i.from(e.entityMetadata.target,r).where(o).getRawMany()},e.prototype.loadForOneToManyAndOneToOneNotOwner=function(e,t,n){var r=(e=e.inverseRelation).entityMetadata.targetName,i=this.connection.createQueryBuilder();e.entityMetadata.primaryColumns.forEach((function(t){var n=t.entityMetadata.name+"_"+e.inverseRelation.propertyPath.replace(".","_")+"_"+t.propertyPath.replace(".","_");i.addSelect(r+"."+t.propertyPath,n)})),e.joinColumns.forEach((function(e){var t=e.referencedColumn.entityMetadata.name+"_"+e.referencedColumn.propertyPath.replace(".","_");i.addSelect(r+"."+e.propertyPath,t)}));var o="";return 1===e.joinColumns.length?(i.setParameter("values",t.map((function(t){return e.joinColumns[0].referencedColumn.getEntityValue(t)}))),o=r+"."+e.joinColumns[0].propertyPath+" IN (:...values)"):o=t.map((function(t,n){return e.joinColumns.map((function(e,o){var a="entity"+n+"_"+o;return i.setParameter(a,e.referencedColumn.getEntityValue(t)),r+"."+e.propertyPath+" = :"+a})).join(" AND ")})).map((function(e){return"("+e+")"})).join(" OR "),i.from(e.entityMetadata.target,r).where(o).getRawMany()},e}(),mn=function(){function e(e){this.migrations=[],this.subscribers=[],this.entityMetadatas=[],this.name=e.name||"default",this.options=e,this.logger=(new un).create(this.options.logger,this.options.logging),this.driver=(new xt).create(this),this.manager=this.createEntityManager(),this.namingStrategy=e.namingStrategy||new s,this.queryResultCache=e.cache?new hn(this).create():void 0,this.relationLoader=new dn(this),this.relationIdLoader=new pn(this),this.isConnected=!1}return Object.defineProperty(e.prototype,"mongoManager",{get:function(){if(!(this.manager instanceof h.f))throw new Error("MongoEntityManager is only available for MongoDB databases.");return this.manager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sqljsManager",{get:function(){if(!(this.manager instanceof ye))throw new Error("SqljsEntityManager is only available for Sqljs databases.");return this.manager},enumerable:!1,configurable:!0}),e.prototype.connect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(t){switch(t.label){case 0:if(this.isConnected)throw new u(this.name);return[4,this.driver.connect()];case 1:return t.sent(),this.queryResultCache?[4,this.queryResultCache.connect()]:[3,3];case 2:t.sent(),t.label=3;case 3:pe.a.assign(this,{isConnected:!0}),t.label=4;case 4:return t.trys.push([4,12,,14]),this.buildMetadatas(),[4,this.driver.afterConnect()];case 5:return t.sent(),this.options.dropSchema?[4,this.dropDatabase()]:[3,7];case 6:t.sent(),t.label=7;case 7:return this.options.synchronize?[4,this.synchronize()]:[3,9];case 8:t.sent(),t.label=9;case 9:return this.options.migrationsRun?[4,this.runMigrations({transaction:this.options.migrationsTransactionMode})]:[3,11];case 10:t.sent(),t.label=11;case 11:return[3,14];case 12:return e=t.sent(),[4,this.close()];case 13:throw t.sent(),e;case 14:return[2,this]}}))}))},e.prototype.close=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:if(!this.isConnected)throw new c(this.name);return[4,this.driver.disconnect()];case 1:return e.sent(),this.queryResultCache?[4,this.queryResultCache.disconnect()]:[3,3];case 2:e.sent(),e.label=3;case 3:return pe.a.assign(this,{isConnected:!1}),[2]}}))}))},e.prototype.synchronize=function(e){return void 0===e&&(e=!1),Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:if(!this.isConnected)throw new c(this.name);return e?[4,this.dropDatabase()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,this.driver.createSchemaBuilder().build()];case 3:return t.sent(),[2]}}))}))},e.prototype.dropDatabase=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:e=this.createQueryRunner(),u.label=1;case 1:if(u.trys.push([1,,13,15]),!(this.driver instanceof h.m||this.driver instanceof h.i||this.driver instanceof h.a))return[3,10];t=this.driver.database?[this.driver.database]:[],this.entityMetadatas.forEach((function(e){e.database&&-1===t.indexOf(e.database)&&t.push(e.database)})),u.label=2;case 2:u.trys.push([2,7,8,9]),n=Object(r.g)(t),i=n.next(),u.label=3;case 3:return i.done?[3,6]:(o=i.value,[4,e.clearDatabase(o)]);case 4:u.sent(),u.label=5;case 5:return i=n.next(),[3,3];case 6:return[3,9];case 7:return a=u.sent(),s={error:a},[3,9];case 8:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 9:return[3,12];case 10:return[4,e.clearDatabase()];case 11:u.sent(),u.label=12;case 12:return[3,15];case 13:return[4,e.release()];case 14:return u.sent(),[7];case 15:return[2]}}))}))},e.prototype.runMigrations=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(!this.isConnected)throw new c(this.name);return(t=new p(this)).transaction=e&&e.transaction||"all",[4,t.executePendingMigrations()];case 1:return[2,n.sent()]}}))}))},e.prototype.undoLastMigration=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(!this.isConnected)throw new c(this.name);return(t=new p(this)).transaction=e&&e.transaction||"all",[4,t.undoLastMigration()];case 1:return n.sent(),[2]}}))}))},e.prototype.showMigrations=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:if(!this.isConnected)throw new c(this.name);return[4,new p(this).showMigrations()];case 1:return[2,e.sent()]}}))}))},e.prototype.hasMetadata=function(e){return!!this.findMetadata(e)},e.prototype.getMetadata=function(e){var t=this.findMetadata(e);if(!t)throw new l(e);return t},e.prototype.getRepository=function(e){return this.manager.getRepository(e)},e.prototype.getTreeRepository=function(e){return this.manager.getTreeRepository(e)},e.prototype.getMongoRepository=function(e){if(!(this.driver instanceof h.e))throw new Error("You can use getMongoRepository only for MongoDB connections.");return this.manager.getRepository(e)},e.prototype.getCustomRepository=function(e){return this.manager.getCustomRepository(e)},e.prototype.transaction=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(n){return[2,this.manager.transaction(e,t)]}))}))},e.prototype.query=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(this instanceof h.f)throw new Error("Queries aren't supported by MongoDB.");if(n&&n.isReleased)throw new E;i=n||this.createQueryRunner(),r.label=1;case 1:return r.trys.push([1,,3,6]),[4,i.query(e,t)];case 2:return[2,r.sent()];case 3:return n?[3,5]:[4,i.release()];case 4:r.sent(),r.label=5;case 5:return[7];case 6:return[2]}}))}))},e.prototype.createQueryBuilder=function(e,t,n){if(this instanceof h.f)throw new Error("Query Builder is not supported by MongoDB.");if(t){var r=this.getMetadata(e);return new en.SelectQueryBuilder(this,n).select(t).from(r.target,t)}return new en.SelectQueryBuilder(this,e)},e.prototype.createQueryRunner=function(e){void 0===e&&(e="master");var t=this.driver.createQueryRunner(e),n=this.createEntityManager(t);return Object.assign(t,{manager:n}),t},e.prototype.getManyToManyMetadata=function(e,t){var n=this.getMetadata(e).findRelationWithPropertyPath(t);if(!n)throw new Error('Relation "'+t+'" was not found in '+e+" entity.");if(!n.isManyToMany)throw new Error('Relation "'+e+"#"+t+'" does not have a many-to-many relationship.You can use this method only on many-to-many relations.');return n.junctionEntityMetadata},e.prototype.createEntityManager=function(e){return(new be).create(this,e)},e.prototype.findMetadata=function(e){return this.entityMetadatas.find((function(t){return t.target===e||(e instanceof Xt.a?t.name===e.options.name:"string"==typeof e&&(-1!==e.indexOf(".")?t.tablePath===e:t.name===e||t.tableName===e))}))},e.prototype.buildMetadatas=function(){var e=new Zt(this),t=new k,n=e.buildSubscribers(this.options.subscribers||[]);pe.a.assign(this,{subscribers:n});var r=e.buildEntityMetadatas(this.options.entities||[]);pe.a.assign(this,{entityMetadatas:r});var i=e.buildMigrations(this.options.migrations||[]);pe.a.assign(this,{migrations:i}),this.driver.database=this.getDatabaseName(),t.validateMany(this.entityMetadatas.filter((function(e){return"view"!==e.tableType})),this.driver)},e.prototype.getDatabaseName=function(){var e=this.options;switch(e.type){case"mysql":case"mariadb":case"postgres":case"cockroachdb":case"mssql":case"oracle":return P.a.buildDriverOptions(e.replication?e.replication.master:e).database;case"mongodb":return P.a.buildMongoDBDriverOptions(e).database;default:return P.a.buildDriverOptions(e).database}},e}(),yn=function(){function e(){this.connections=[]}return e.prototype.has=function(e){return!!this.connections.find((function(t){return t.name===e}))},e.prototype.get=function(e){void 0===e&&(e="default");var t=this.connections.find((function(t){return t.name===e}));if(!t)throw new ft(e);return t},e.prototype.create=function(e){var t=this.connections.find((function(t){return t.name===(e.name||"default")}));if(t){if(t.isConnected)throw new Je(e.name||"default");this.connections.splice(this.connections.indexOf(t),1)}var n=new mn(e);return this.connections.push(n),n},e}(),gn=(function(){function e(){}e.prototype.read=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))}}(),function(){function e(){}e.prototype.read=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))}}(),function(){function e(){}e.prototype.read=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))}}(),function(){function e(){}return e.prototype.all=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))},e.prototype.get=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))},e.prototype.has=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))},e}());function bn(e,t){return function(n,r){var i;"string"==typeof e||e instanceof Function?i=e:e&&(t=e,i=e.type),t||(t={});var o=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",n,r):void 0;if(!i&&o&&(i=o),!t.type&&i&&(t.type=i),"hstore"!==t.type||t.hstoreType||(t.hstoreType=o===Object?"object":"string"),e instanceof Function)Pr().embeddeds.push({target:n.constructor,propertyName:r,isArray:o===Array||!0===t.array,prefix:void 0!==t.prefix?t.prefix:void 0,type:e});else{if(!t.type)throw new Et(n,r);!0===t.unique&&Pr().uniques.push({target:n.constructor,columns:[r]}),Pr().columns.push({target:n.constructor,propertyName:r,mode:"regular",options:t}),t.generated&&Pr().generations.push({target:n.constructor,propertyName:r,strategy:"string"==typeof t.generated?t.generated:"increment"})}}}function vn(e){return function(t,n){Pr().columns.push({target:t.constructor,propertyName:n,mode:"createDate",options:e||{}})}}function wn(e){return function(t,n){Pr().columns.push({target:t.constructor,propertyName:n,mode:"deleteDate",options:e||{}})}}function _n(e,t){var n,r={};return e?("string"==typeof e&&(n=e),e instanceof Object&&(n="increment",Object.assign(r,e))):n="increment",t instanceof Object&&Object.assign(r,t),function(e,t){r.type||("increment"===n?r.type=Number:"uuid"===n?r.type="uuid":"rowid"===n&&(r.type="int")),r.primary=!0,Pr().columns.push({target:e.constructor,propertyName:t,mode:"regular",options:r}),Pr().generations.push({target:e.constructor,propertyName:t,strategy:n})}}function kn(e,t){return function(n,r){var i;"string"==typeof e?i=e:t=Object.assign({},e),t||(t={});var o=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",n,r):void 0;if(!i&&o&&(i=o),!t.type&&i&&(t.type=i),!t.type)throw new Et(n,r);if(t.nullable)throw new rt(n,r);t.primary=!0,Pr().columns.push({target:n.constructor,propertyName:r,mode:"regular",options:t}),t.generated&&Pr().generations.push({target:n.constructor,propertyName:r,strategy:"string"==typeof t.generated?t.generated:"increment"})}}function En(e){return function(t,n){Pr().columns.push({target:t.constructor,propertyName:n,mode:"updateDate",options:e||{}})}}function On(e){return function(t,n){Pr().columns.push({target:t.constructor,propertyName:n,mode:"version",options:e||{}})}}function Tn(e){return function(t,n){Pr().columns.push({target:t.constructor,propertyName:n,mode:"regular",options:e||{}})}}function xn(e){return function(t,n){e||(e={}),e.primary=!0,e.name||(e.name="_id"),Pr().columns.push({target:t.constructor,propertyName:n,mode:"objectId",options:e})}}function Sn(){return function(e,t){Pr().entityListeners.push({target:e.constructor,propertyName:t,type:Ft.AFTER_INSERT})}}function Cn(){return function(e,t){Pr().entityListeners.push({target:e.constructor,propertyName:t,type:Ft.AFTER_LOAD})}}function Rn(){return function(e,t){Pr().entityListeners.push({target:e.constructor,propertyName:t,type:Ft.AFTER_REMOVE})}}function Pn(){return function(e,t){Pr().entityListeners.push({target:e.constructor,propertyName:t,type:Ft.AFTER_UPDATE})}}function Nn(){return function(e,t){Pr().entityListeners.push({target:e.constructor,propertyName:t,type:Ft.BEFORE_INSERT})}}function Mn(){return function(e,t){Pr().entityListeners.push({target:e.constructor,propertyName:t,type:Ft.BEFORE_REMOVE})}}function An(){return function(e,t){Pr().entityListeners.push({target:e.constructor,propertyName:t,type:Ft.BEFORE_UPDATE})}}function jn(){return function(e){Pr().entitySubscribers.push({target:e})}}function In(e){return function(t,n){(Array.isArray(e)?e:[e||{}]).forEach((function(e){Pr().joinColumns.push({target:t.constructor,propertyName:n,name:e.name,referencedColumnName:e.referencedColumnName})}))}}function Dn(e){return function(t,n){e=e||{},Pr().joinTables.push({target:t.constructor,propertyName:n,name:e.name,joinColumns:e&&e.joinColumn?[e.joinColumn]:e.joinColumns,inverseJoinColumns:e&&e.inverseJoinColumn?[e.inverseJoinColumn]:e.inverseJoinColumns,schema:e&&e.schema?e.schema:void 0,database:e&&e.database?e.database:void 0})}}function Ln(e,t,n){var r;return"object"==typeof t?n=t:r=t,function(t,i){n||(n={});var o=!0===n.lazy;if(!o&&Reflect&&Reflect.getMetadata){var a=Reflect.getMetadata("design:type",t,i);a&&"string"==typeof a.name&&"promise"===a.name.toLowerCase()&&(o=!0)}Pr().relations.push({target:t.constructor,propertyName:i,relationType:"many-to-many",isLazy:o,type:e,inverseSideProperty:r,options:n})}}function Bn(e,t,n){var r;return"object"==typeof t?n=t:r=t,function(t,i){n||(n={});var o=n&&!0===n.lazy;if(!o&&Reflect&&Reflect.getMetadata){var a=Reflect.getMetadata("design:type",t,i);a&&"string"==typeof a.name&&"promise"===a.name.toLowerCase()&&(o=!0)}Pr().relations.push({target:t.constructor,propertyName:i,relationType:"many-to-one",isLazy:o,type:e,inverseSideProperty:r,options:n})}}function Fn(e,t,n){return function(r,i){n||(n={});var o=n&&!0===n.lazy;if(!o&&Reflect&&Reflect.getMetadata){var a=Reflect.getMetadata("design:type",r,i);a&&"string"==typeof a.name&&"promise"===a.name.toLowerCase()&&(o=!0)}Pr().relations.push({target:r.constructor,propertyName:i,isLazy:o,relationType:"one-to-many",type:e,inverseSideProperty:t,options:n})}}function qn(e,t,n){var r;return"object"==typeof t?n=t:r=t,function(t,i){n||(n={});var o=!(!n||!0!==n.lazy);if(!o&&Reflect&&Reflect.getMetadata){var a=Reflect.getMetadata("design:type",t,i);a&&"string"==typeof a.name&&"promise"===a.name.toLowerCase()&&(o=!0)}Pr().relations.push({target:t.constructor,propertyName:i,isLazy:o,relationType:"one-to-one",type:e,inverseSideProperty:r,options:n})}}function Vn(e,t,n){return function(r,i){Pr().relationCounts.push({target:r.constructor,propertyName:i,relation:e,alias:t,queryBuilderFactory:n})}}function Un(e,t,n){return function(r,i){Pr().relationIds.push({target:r.constructor,propertyName:i,relation:e,alias:t,queryBuilderFactory:n})}}function Hn(e,t){var n=("object"==typeof e?e:t)||{},r="string"==typeof e?e:n.name;return function(e){Pr().tables.push({target:e,name:r,type:"regular",orderBy:n.orderBy?n.orderBy:void 0,engine:n.engine?n.engine:void 0,database:n.database?n.database:void 0,schema:n.schema?n.schema:void 0,synchronize:n.synchronize,withoutRowid:n.withoutRowid})}}function zn(e){return function(t){Pr().tables.push({target:t,type:"entity-child"}),void 0!==e&&Pr().discriminatorValues.push({target:t,value:e})}}function Wn(e){return function(t){Pr().inheritances.push({target:t,pattern:e&&e.pattern?e.pattern:"STI",column:e&&e.column?"string"==typeof e.column?{name:e.column}:e.column:void 0})}}function Yn(e,t){var n=("object"==typeof e?e:t)||{},r="string"==typeof e?e:n.name;return function(e){Pr().tables.push({target:e,name:r,expression:n.expression,type:"view",database:n.database?n.database:void 0,schema:n.schema?n.schema:void 0,synchronize:!1!==n.synchronize,materialized:!!n.materialized})}}function Qn(e){return function(t,n,i){var o=i.value;i.value=function(){for(var i=this,a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var c="default",u=void 0;e&&("string"==typeof e?c=e:(e.connectionName&&(c=e.connectionName),e.isolation&&(u=e.isolation)));var l=function(e){var s,c=Pr().filterTransactionEntityManagers(t.constructor,n).reverse(),u=Pr().filterTransactionRepository(t.constructor,n).reverse();return c.length>0?(s=Object(r.f)([],Object(r.e)(a)),c.forEach((function(t){s.splice(t.index,0,e)}))):s=0===u.length?Object(r.f)([e],Object(r.e)(a)):Object(r.f)([],Object(r.e)(a)),u.forEach((function(t){var n;switch(t.repositoryType){case x:n=e.getRepository(t.entityType);break;case h.h:n=e.getMongoRepository(t.entityType);break;case C:n=e.getTreeRepository(t.entityType);break;default:n=e.getCustomRepository(t.repositoryType)}s.splice(t.index,0,n)})),o.apply(i,s)};return u?Ir(c).manager.transaction(u,l):Ir(c).manager.transaction(l)}}}function Gn(){return function(e,t,n){Pr().transactionEntityManagers.push({target:e.constructor,methodName:t,index:n})}}function Jn(e){return function(t,n,r){var i;try{i=Reflect.getOwnMetadata("design:paramtypes",t,n)[r]}catch(e){throw new Ge(t.constructor,n)}Pr().transactionRepositories.push({target:t.constructor,methodName:n,index:r,repositoryType:i,entityType:e})}}function Kn(){return function(e,t){Pr().columns.push({target:e.constructor,propertyName:t,mode:"treeLevel",options:{}})}}function $n(e){return function(t,n){e||(e={});var r=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",t,n):void 0,i=r&&"string"==typeof r.name&&"promise"===r.name.toLowerCase()||!1;Pr().relations.push({isTreeParent:!0,target:t.constructor,propertyName:n,isLazy:i,relationType:"many-to-one",type:function(){return t.constructor},options:e})}}function Xn(e){return function(t,n){e||(e={});var r=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",t,n):void 0,i=r&&"string"==typeof r.name&&"promise"===r.name.toLowerCase()||!1;Pr().relations.push({isTreeChildren:!0,target:t.constructor,propertyName:n,isLazy:i,relationType:"one-to-many",type:function(){return t.constructor},options:e})}}function Zn(e,t){return function(n){Pr().trees.push({target:n,type:e,options:"closure-table"===e?t:void 0})}}function er(e,t,n){var r="string"==typeof e?e:void 0,i="string"==typeof e?t:e,o="object"!=typeof e||Array.isArray(e)?n:e;return o||(o="object"!=typeof t||Array.isArray(t)?n:t),function(e,t){Pr().indices.push({target:t?e.constructor:e,name:r,columns:t?[t]:i,synchronize:!o||!1!==o.synchronize,where:o?o.where:void 0,unique:!(!o||!o.unique),spatial:!(!o||!o.spatial),fulltext:!(!o||!o.fulltext),parser:o?o.parser:void 0,sparse:!(!o||!o.sparse),background:!(!o||!o.background),expireAfterSeconds:o?o.expireAfterSeconds:void 0})}}function tr(e,t){var n="string"==typeof e?e:void 0,r="string"==typeof e?t:e;return function(e,t){var i=r;if(void 0!==t)switch(typeof t){case"string":i=[t];break;case"symbol":i=[t.toString()]}var o={target:t?e.constructor:e,name:n,columns:i};Pr().uniques.push(o)}}function nr(e,t){var n=t?e:void 0,r=t||e;if(!r)throw new Error("Check expression is required");return function(e,t){Pr().checks.push({target:t?e.constructor:e,name:n,expression:r})}}function rr(e,t){var n=t?e:void 0,r=t||e;if(!r)throw new Error("Exclusion expression is required");return function(e,t){Pr().exclusions.push({target:t?e.constructor:e,name:n,expression:r})}}function ir(e){return void 0===e&&(e="increment"),function(t,n){Pr().generations.push({target:t.constructor,propertyName:n,strategy:e})}}function or(e){return function(t){Pr().entityRepositories.push({target:t,entity:e})}}var ar=n(14);function sr(e){return new ar.a("any",e)}function cr(e,t){return new ar.a("between",[e,t],!0,!0)}function ur(e){return new ar.a("equal",e)}var lr=n(163);function fr(){return new ar.a("isNull",void 0,!1)}function hr(e){return new ar.a("lessThan",e)}function dr(e){return new ar.a("lessThanOrEqual",e)}function pr(e){return new ar.a("ilike",e)}function mr(e){return new ar.a("like",e)}function yr(e){return new ar.a("moreThan",e)}function gr(e){return new ar.a("moreThanOrEqual",e)}function br(e){return new ar.a("not",e)}function vr(e,t){return"function"!=typeof e?new ar.a("raw",e,!1):new ar.a("raw",[],!0,!0,e,t)}var wr=function(){function e(){}return e.prototype.hasId=function(){return this.constructor.getRepository().hasId(this)},e.prototype.save=function(e){return this.constructor.getRepository().save(this,e)},e.prototype.remove=function(e){return this.constructor.getRepository().remove(this,e)},e.prototype.softRemove=function(e){return this.constructor.getRepository().softRemove(this,e)},e.prototype.recover=function(e){return this.constructor.getRepository().recover(this,e)},e.prototype.reload=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,(e=this.constructor).getRepository().findOneOrFail(e.getId(this))];case 1:return t=n.sent(),pe.a.assign(this,t),[2]}}))}))},e.useConnection=function(e){this.usedConnection=e},e.getRepository=function(){return(this.usedConnection||Ir()).getRepository(this)},Object.defineProperty(e,"target",{get:function(){return this.getRepository().target},enumerable:!1,configurable:!0}),e.hasId=function(e){return this.getRepository().hasId(e)},e.getId=function(e){return this.getRepository().getId(e)},e.createQueryBuilder=function(e){return this.getRepository().createQueryBuilder(e)},e.create=function(e){return this.getRepository().create(e)},e.merge=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return(t=this.getRepository()).merge.apply(t,Object(r.f)([e],Object(r.e)(n)))},e.preload=function(e){return this.getRepository().preload(e)},e.save=function(e,t){return this.getRepository().save(e,t)},e.remove=function(e,t){return this.getRepository().remove(e,t)},e.softRemove=function(e,t){return this.getRepository().softRemove(e,t)},e.insert=function(e,t){return this.getRepository().insert(e,t)},e.update=function(e,t,n){return this.getRepository().update(e,t,n)},e.delete=function(e,t){return this.getRepository().delete(e,t)},e.count=function(e){return this.getRepository().count(e)},e.find=function(e){return this.getRepository().find(e)},e.findAndCount=function(e){return this.getRepository().findAndCount(e)},e.findByIds=function(e,t){return this.getRepository().findByIds(e,t)},e.findOne=function(e,t){return this.getRepository().findOne(e,t)},e.findOneOrFail=function(e,t){return this.getRepository().findOneOrFail(e,t)},e.query=function(e,t){return this.getRepository().query(e,t)},e.clear=function(){return this.getRepository().clear()},e}(),_r=n(49),kr=n(199),Er=n(197),Or=n(198),Tr=n(210),xr=n(162),Sr=n(138),Cr=n(125),Rr=n(164);function Pr(){var e=Ie.a.getGlobalVariable();return e.typeormMetadataArgsStorage||(e.typeormMetadataArgsStorage=new Kt),e.typeormMetadataArgsStorage}function Nr(e){return void 0===e&&(e="default"),Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){return[2,(new gn).get(e)]}))}))}function Mr(){return Mt(yn)}function Ar(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t="string"==typeof e?e:"default",e instanceof Object?(i=e,[3,3]):[3,1];case 1:return[4,Nr(t)];case 2:i=r.sent(),r.label=3;case 3:return n=i,[2,Mr().create(n).connect()]}}))}))}function jr(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return e?[3,2]:[4,(new gn).all()];case 1:e=n.sent(),n.label=2;case 2:return t=e.map((function(e){return Mr().create(e)})),[2,Promise.all(t.map((function(e){return e.connect()})))]}}))}))}function Ir(e){return void 0===e&&(e="default"),Mr().get(e)}function Dr(e){return void 0===e&&(e="default"),Mr().get(e).manager}function Lr(e){return void 0===e&&(e="default"),Mr().get(e).manager}function Br(e){return void 0===e&&(e="default"),Mr().get(e).manager}function Fr(e,t){return void 0===t&&(t="default"),Mr().get(t).getRepository(e)}function qr(e,t){return void 0===t&&(t="default"),Mr().get(t).getTreeRepository(e)}function Vr(e,t){return void 0===t&&(t="default"),Mr().get(t).getCustomRepository(e)}function Ur(e,t){return void 0===t&&(t="default"),Mr().get(t).getMongoRepository(e)}function Hr(e,t,n){return void 0===n&&(n="default"),e?Fr(e,n).createQueryBuilder(t):Ir(n).createQueryBuilder()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e,t,n,r,i,o){void 0===n&&(n=!0),void 0===r&&(r=!1),this._type=e,this._value=t,this._useParameter=n,this._multipleParameters=r,this._getSql=i,this._objectLiteralParameters=o}return Object.defineProperty(e.prototype,"useParameter",{get:function(){return this._value instanceof e?this._value.useParameter:this._useParameter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multipleParameters",{get:function(){return this._value instanceof e?this._value.multipleParameters:this._multipleParameters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value instanceof e?this._value.value:this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"objectLiteralParameters",{get:function(){return this._value instanceof e?this._value.objectLiteralParameters:this._objectLiteralParameters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"child",{get:function(){if(this._value instanceof e)return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getSql",{get:function(){return this._value instanceof e?this._value.getSql:this._getSql},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var r=function(){function t(){}return t.getGlobalVariable=function(){return"undefined"!=typeof window?window:e},t.load=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: require("'+e+'").');return""},t.pathNormalize=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: path.normalize("'+e+'").');return""},t.pathExtname=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: path.extname("'+e+'").');return""},t.pathResolve=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: path.resolve("'+e+'").');return""},t.fileExist=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.existsSync("'+e+'").');return!1},t.dotenv=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: dotenv.config({ path: "'+e+'" }).')},t.getEnvVariable=function(e){},t.readFileSync=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.readFileSync("'+e+'").');return null},t.appendFileSync=function(e,t){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.appendFileSync("'+e+'").')},t.writeFile=function(e,t){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.writeFile("'+e+'").');return Promise.reject(null)},t.highlightSql=function(e){return e},t.highlightJson=function(e){return e},t.logInfo=function(e,t){console.info(e+" ",t)},t.logError=function(e,t){console.error(e+" ",t)},t.logWarn=function(e,t){console.warn(e+" ",t)},t.log=function(e){console.log(e)},t.warn=function(e){return e},t.type="browser",t}();"undefined"!=typeof window&&(window.Buffer=n(106).Buffer),void 0!==e&&(e.Buffer=n(106).Buffer)}).call(this,n(196))},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseDatabase=void 0;var o=n(13),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this._createConnectionOptions(t);this._connectionPromise=this._createConnection(n)}var t,n,a;return t=e,a=[{key:"_buildQuery",value:function(e,t,n,r,i){var o={};return e&&(o.where=e),t&&(o.order=t),n&&(o.take=n),r&&(o.skip=r),i&&(o.relations=i),o}},{key:"_setLoaded",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,o,a,s=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e;case 2:if(null!=(e=n.sent)){n.next=5;break}return n.abrupt("return",null);case 5:return(r=Array.isArray(e))||(e=[e]),i=t.getRelationDefinitions(),o=Object.keys(i),a=[],e.forEach((function(e){e.setLoaded(!0),o.forEach((function(t){if(e[t]){var n=s.getModel(i[t].target);a.push(s._setLoaded(e[t],n))}}))})),n.next=13,Promise.all(a);case 13:return n.abrupt("return",r?e:e[0]);case 14:case"end":return n.stop()}}),n)})))}},{key:"getInstance",value:function(){return this.instance||(this.instance=new this),this.instance}},{key:"addModel",value:function(t){e._models[t.getSchemaName()]=t}},{key:"getModel",value:function(e){return e?this._models[e]:this._models}}],(n=[{key:"_createConnection",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("sqljs"!==e.type){t.next=4;break}return t.next=3,window.initSqlJs();case 3:window.SQL=t.sent;case 4:return t.abrupt("return",o.createConnection(e).catch((function(e){return console.error(e),Promise.reject(e)})));case 5:case"end":return t.stop()}}),t)})))}},{key:"_createConnectionOptions",value:function(t){var n=e.CONNECTION_OPTIONS;return"undefined"==typeof device||"browser"!==device.platform?(n.type="cordova",n.database=t):(n.type="sqljs",n.location=t,n.autoSave=!0,n.useLocalForage=!0),n.entities=this.getEntityDefinitions(),n}},{key:"getEntityDefinitions",value:function(){var t=this,n=[];return Object.keys(e._models).forEach((function(r){e._models[r]._database=t,n.push(new o.EntitySchema(e._models[r].getSchemaDefinition()))})),n}},{key:"saveEntity",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,!Array.isArray(e)){t.next=9;break}if(0!==e.length){t.next=4;break}return t.abrupt("return",e);case 4:return t.next=6,this._getRepository(e[0].constructor);case 6:n=t.sent,t.next=12;break;case 9:return t.next=11,this._getRepository(e.constructor);case 11:n=t.sent;case 12:return t.abrupt("return",n.save(e));case 13:case"end":return t.stop()}}),t,this)})))}},{key:"findEntities",value:function(t,n,r,o,a,s){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){var c;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._getRepository(t);case 2:return c=i.sent,i.abrupt("return",e._setLoaded(c.find(e._buildQuery(n,r,o,a,s)),t));case 4:case"end":return i.stop()}}),i,this)})))}},{key:"findAndCountEntities",value:function(t,n,r,o,a,s){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){var c;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._getRepository(t);case 2:return c=i.sent,i.abrupt("return",e._setLoaded(c.findAndCount(e._buildQuery(n,r,o,a,s)),t));case 4:case"end":return i.stop()}}),i,this)})))}},{key:"findOneEntity",value:function(t,n,r,o,a){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){var s;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._getRepository(t);case 2:return s=i.sent,i.abrupt("return",e._setLoaded(s.findOne(e._buildQuery(n,r,void 0,o,a)),t));case 4:case"end":return i.stop()}}),i,this)})))}},{key:"findById",value:function(t,n,r){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){var o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._getRepository(t);case 2:return o=i.sent,i.abrupt("return",e._setLoaded(o.findOne(n,e._buildQuery(void 0,void 0,void 0,void 0,r)),t));case 4:case"end":return i.stop()}}),i,this)})))}},{key:"findByIds",value:function(t,n,r){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){var o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._getRepository(t);case 2:return o=i.sent,i.abrupt("return",e._setLoaded(o.findByIds(n,e._buildQuery(void 0,void 0,void 0,void 0,r)),t));case 4:case"end":return i.stop()}}),i,this)})))}},{key:"clearModel",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getRepository(e);case 2:return n=t.sent,t.abrupt("return",n.clear());case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_getRepository",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._connectionPromise;case 2:return n=t.sent,t.abrupt("return",n.getRepository(e));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"createQueryBuilder",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=7;break}return t.next=3,this._getRepository(e);case 3:return n=t.sent,t.abrupt("return",n.createQueryBuilder(e.getSchemaName()));case 7:return t.next=9,this._connectionPromise;case 9:return r=t.sent,t.abrupt("return",r.createQueryBuilder());case 11:case"end":return t.stop()}}),t,this)})))}},{key:"createQueryRunner",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._connectionPromise;case 2:return t=e.sent,e.abrupt("return",t.createQueryRunner());case 4:case"end":return e.stop()}}),e,this)})))}},{key:"deleteEntity",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!Array.isArray(e)){n.next=7;break}if(0!==e.length){n.next=3;break}return n.abrupt("return",e);case 3:t||(t=e[0].constructor),"number"!=typeof e[0]&&(r=[],e.forEach((function(e){return r.push(e.id)})),e=r),n.next=9;break;case 7:t||(t=e.constructor),"number"!=typeof e&&(e=e.id);case 9:return n.next=11,this._getRepository(t);case 11:return i=n.sent,n.abrupt("return",i.delete(e));case 13:case"end":return n.stop()}}),n,this)})))}},{key:"rawQuery",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this._connectionPromise;case 2:return n.abrupt("return",n.sent.query(e,t));case 3:case"end":return n.stop()}}),n,this)})))}},{key:"waitForConnection",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._connectionPromise);case 1:case"end":return e.stop()}}),e,this)})))}}])&&r(t.prototype,n),a&&r(t,a),e}();t.BaseDatabase=a,a._models={},a.CONNECTION_OPTIONS={location:"default",logging:["error","warn"],synchronize:!0},a.TYPES={INTEGER:"int",FLOAT:"float",DATE:"datetime",STRING:"varchar",TEXT:"text",MEDIUMTEXT:"mediumtext",BOOLEAN:"boolean",JSON:"json",SIMPLE_JSON:"simple-json",MY_JSON:"my-json"}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(20);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(0),i=n(27),o=n(1),a=n(8),s=n(32),c=n(58),u=n(48),l=n(131),f=n(40),h=n(52),d=n(70),p=n(72),m=function(){function e(e){this.connection=e}return e.prototype.build=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return this.queryRunner=this.connection.createQueryRunner(),this.connection.driver instanceof o.d?[3,2]:[4,this.queryRunner.startTransaction()];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,12,18,20]),e=this.entityToSyncMetadatas.map((function(e){return e.tablePath})),this.viewEntityToSyncMetadatas.length>0?[4,this.createTypeormMetadataTable()]:[3,4];case 3:n.sent(),n.label=4;case 4:return[4,this.queryRunner.getTables(e)];case 5:return n.sent(),[4,this.queryRunner.getViews([])];case 6:return n.sent(),[4,this.executeSchemaSyncOperationsInProperOrder()];case 7:return n.sent(),this.connection.queryResultCache?[4,this.connection.queryResultCache.synchronize(this.queryRunner)]:[3,9];case 8:n.sent(),n.label=9;case 9:return this.connection.driver instanceof o.d?[3,11]:[4,this.queryRunner.commitTransaction()];case 10:n.sent(),n.label=11;case 11:return[3,20];case 12:t=n.sent(),n.label=13;case 13:return n.trys.push([13,16,,17]),this.connection.driver instanceof o.d?[3,15]:[4,this.queryRunner.rollbackTransaction()];case 14:n.sent(),n.label=15;case 15:return[3,17];case 16:return n.sent(),[3,17];case 17:throw t;case 18:return[4,this.queryRunner.release()];case 19:return n.sent(),[7];case 20:return[2]}}))}))},e.prototype.log=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(t){switch(t.label){case 0:this.queryRunner=this.connection.createQueryRunner(),t.label=1;case 1:return t.trys.push([1,,9,11]),e=this.entityToSyncMetadatas.map((function(e){return e.tablePath})),this.viewEntityToSyncMetadatas.length>0?[4,this.createTypeormMetadataTable()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.queryRunner.getTables(e)];case 4:return t.sent(),[4,this.queryRunner.getViews([])];case 5:return t.sent(),this.queryRunner.enableSqlMemory(),[4,this.executeSchemaSyncOperationsInProperOrder()];case 6:return t.sent(),this.connection.queryResultCache?[4,this.connection.queryResultCache.synchronize(this.queryRunner)]:[3,8];case 7:t.sent(),t.label=8;case 8:return[2,this.queryRunner.getMemorySql()];case 9:return this.queryRunner.disableSqlMemory(),[4,this.queryRunner.release()];case 10:return t.sent(),[7];case 11:return[2]}}))}))},Object.defineProperty(e.prototype,"entityToSyncMetadatas",{get:function(){return this.connection.entityMetadatas.filter((function(e){return e.synchronize&&"entity-child"!==e.tableType&&"view"!==e.tableType}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewEntityToSyncMetadatas",{get:function(){return this.connection.entityMetadatas.filter((function(e){return"view"===e.tableType&&e.synchronize}))},enumerable:!1,configurable:!0}),e.prototype.executeSchemaSyncOperationsInProperOrder=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:return[4,this.dropOldViews()];case 1:return e.sent(),[4,this.dropOldForeignKeys()];case 2:return e.sent(),[4,this.dropOldIndices()];case 3:return e.sent(),[4,this.dropOldChecks()];case 4:return e.sent(),[4,this.dropOldExclusions()];case 5:return e.sent(),[4,this.dropCompositeUniqueConstraints()];case 6:return e.sent(),[4,this.renameColumns()];case 7:return e.sent(),[4,this.createNewTables()];case 8:return e.sent(),[4,this.dropRemovedColumns()];case 9:return e.sent(),[4,this.addNewColumns()];case 10:return e.sent(),[4,this.updatePrimaryKeys()];case 11:return e.sent(),[4,this.updateExistColumns()];case 12:return e.sent(),[4,this.createNewIndices()];case 13:return e.sent(),[4,this.createNewChecks()];case 14:return e.sent(),[4,this.createNewExclusions()];case 15:return e.sent(),[4,this.createCompositeUniqueConstraints()];case 16:return e.sent(),[4,this.createForeignKeys()];case 17:return e.sent(),[4,this.createViews()];case 18:return e.sent(),[2]}}))}))},e.prototype.dropOldForeignKeys=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:e=function(e){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=n.foreignKeys.filter((function(t){var n=e.foreignKeys.find((function(e){return y(t,e)}));return!n||n.onDelete&&n.onDelete!==t.onDelete||n.onUpdate&&n.onUpdate!==t.onUpdate}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("dropping old foreign keys of "+n.name+": "+i.map((function(e){return e.name})).join(", ")),[4,t.queryRunner.dropForeignKeys(n,i)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,u.label=1;case 1:u.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),u.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:u.sent(),u.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=u.sent(),s={error:a},[3,8];case 7:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},e.prototype.renameTables=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2]}))}))},e.prototype.renameColumns=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u=this;return Object(r.d)(this,(function(l){switch(l.label){case 0:e=function(e){var n,i,o,a;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?e.columns.length!==n.columns.length||0===(i=e.columns.filter((function(e){return!n.columns.find((function(t){return t.name===e.databaseName&&t.type===u.connection.driver.normalizeType(e)&&t.isNullable===e.isNullable&&t.isUnique===u.connection.driver.normalizeIsUnique(e)}))}))).length||i.length>1||0===(o=n.columns.filter((function(t){return!e.columns.find((function(e){return e.databaseName===t.name&&u.connection.driver.normalizeType(e)===t.type&&e.isNullable===t.isNullable&&u.connection.driver.normalizeIsUnique(e)===t.isUnique}))}))).length||o.length>1?[2,"continue"]:((a=o[0].clone()).name=i[0].databaseName,t.connection.logger.logSchemaBuild('renaming column "'+o[0].name+'" in to "'+a.name+'"'),[4,t.queryRunner.renameColumn(n,o[0],a)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,l.label=1;case 1:l.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),l.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=l.sent(),s={error:a},[3,8];case 7:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},e.prototype.dropOldIndices=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u=this;return Object(r.d)(this,(function(l){switch(l.label){case 0:e=function(e){var n,i;return Object(r.d)(this,(function(o){switch(o.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?(i=n.indices.filter((function(t){var n=e.indices.find((function(e){return e.name===t.name}));return!n||!1!==n.synchronize&&(n.isUnique!==t.isUnique||(n.isSpatial!==t.isSpatial||(!(!u.connection.driver.isFullTextColumnTypeSupported()||n.isFulltext===t.isFulltext)||(n.columns.length!==t.columnNames.length||!n.columns.every((function(e){return-1!==t.columnNames.indexOf(e.databaseName)}))))))})).map((function(e){return Object(r.b)(u,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return this.connection.logger.logSchemaBuild('dropping an index: "'+e.name+'" from table '+n.name),[4,this.queryRunner.dropIndex(n,e)];case 1:return t.sent(),[2]}}))}))})),[4,Promise.all(i)]):[2,"continue"];case 1:return o.sent(),[2]}}))},t=this,l.label=1;case 1:l.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),l.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=l.sent(),s={error:a},[3,8];case 7:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},e.prototype.dropOldChecks=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,a,s,c,u;return Object(r.d)(this,(function(l){switch(l.label){case 0:if(this.connection.driver instanceof o.i||this.connection.driver instanceof o.a)return[2];e=function(e){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=n.checks.filter((function(t){return!e.checks.find((function(e){return e.name===t.name}))}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("dropping old check constraint: "+i.map((function(e){return'"'+e.name+'"'})).join(", ")+' from table "'+n.name+'"'),[4,t.queryRunner.dropCheckConstraints(n,i)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,l.label=1;case 1:l.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),l.label=2;case 2:return i.done?[3,5]:(a=i.value,[5,e(a)]);case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return s=l.sent(),c={error:s},[3,8];case 7:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}return[7];case 8:return[2]}}))}))},e.prototype.dropCompositeUniqueConstraints=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:e=function(e){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=n.uniques.filter((function(t){return t.columnNames.length>1&&!e.uniques.find((function(e){return e.name===t.name}))}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("dropping old unique constraint: "+i.map((function(e){return'"'+e.name+'"'})).join(", ")+' from table "'+n.name+'"'),[4,t.queryRunner.dropUniqueConstraints(n,i)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,u.label=1;case 1:u.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),u.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:u.sent(),u.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=u.sent(),s={error:a},[3,8];case 7:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},e.prototype.dropOldExclusions=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,a,s,c,u;return Object(r.d)(this,(function(l){switch(l.label){case 0:if(!(this.connection.driver instanceof o.k))return[2];e=function(e){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=n.exclusions.filter((function(t){return!e.exclusions.find((function(e){return e.name===t.name}))}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("dropping old exclusion constraint: "+i.map((function(e){return'"'+e.name+'"'})).join(", ")+' from table "'+n.name+'"'),[4,t.queryRunner.dropExclusionConstraints(n,i)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,l.label=1;case 1:l.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),l.label=2;case 2:return i.done?[3,5]:(a=i.value,[5,e(a)]);case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return s=l.sent(),c={error:s},[3,8];case 7:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}return[7];case 8:return[2]}}))}))},e.prototype.createNewTables=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,s,c,u,l,f=this;return Object(r.d)(this,(function(h){switch(h.label){case 0:return[4,this.queryRunner.getCurrentSchema()];case 1:e=h.sent(),t=function(t){var i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n.queryRunner.loadedTables.find((function(n){var r=t.database&&t.database!==f.connection.driver.database?t.database:void 0,i=t.schema||f.connection.driver.options.schema;i=i===e?void 0:i;var o=f.connection.driver.buildTableName(t.tableName,i,r);return n.name===o}))?[2,"continue"]:(n.connection.logger.logSchemaBuild("creating a new table: "+t.tablePath),i=a.a.create(t,n.connection.driver),[4,n.queryRunner.createTable(i,!1,!1)]);case 1:return r.sent(),n.queryRunner.loadedTables.push(i),[2]}}))},n=this,h.label=2;case 2:h.trys.push([2,7,8,9]),i=Object(r.g)(this.entityToSyncMetadatas),o=i.next(),h.label=3;case 3:return o.done?[3,6]:(s=o.value,[5,t(s)]);case 4:h.sent(),h.label=5;case 5:return o=i.next(),[3,3];case 6:return[3,9];case 7:return c=h.sent(),u={error:c},[3,9];case 8:try{o&&!o.done&&(l=i.return)&&l.call(i)}finally{if(u)throw u.error}return[7];case 9:return[2]}}))}))},e.prototype.createViews=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u=this;return Object(r.d)(this,(function(l){switch(l.label){case 0:e=function(e){var n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t.queryRunner.loadedViews.find((function(t){var n=e.database&&e.database!==u.connection.driver.database?e.database:void 0,r=e.schema||u.connection.driver.options.schema,i=u.connection.driver.buildTableName(e.tableName,r,n),o="string"==typeof t.expression?t.expression.trim():t.expression(u.connection).getQuery(),a="string"==typeof e.expression?e.expression.trim():e.expression(u.connection).getQuery();return t.name===i&&o===a}))?[2,"continue"]:(t.connection.logger.logSchemaBuild("creating a new view: "+e.tablePath),n=p.a.create(e,t.connection.driver),[4,t.queryRunner.createView(n)]);case 1:return r.sent(),t.queryRunner.loadedViews.push(n),[2]}}))},t=this,l.label=1;case 1:l.trys.push([1,6,7,8]),n=Object(r.g)(this.viewEntityToSyncMetadatas),i=n.next(),l.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=l.sent(),s={error:a},[3,8];case 7:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},e.prototype.dropOldViews=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u,l=this;return Object(r.d)(this,(function(f){switch(f.label){case 0:e=new Set,t=function(t){return Object(r.d)(this,(function(r){switch(r.label){case 0:return n.viewEntityToSyncMetadatas.find((function(e){var n=e.database&&e.database!==l.connection.driver.database?e.database:void 0,r=e.schema||l.connection.driver.options.schema,i=l.connection.driver.buildTableName(e.tableName,r,n),o="string"==typeof t.expression?t.expression.trim():t.expression(l.connection).getQuery(),a="string"==typeof e.expression?e.expression.trim():e.expression(l.connection).getQuery();return t.name===i&&o===a}))?[2,"continue"]:(n.connection.logger.logSchemaBuild("dropping an old view: "+t.name),[4,n.queryRunner.dropView(t)]);case 1:return r.sent(),e.add(t),[2]}}))},n=this,f.label=1;case 1:f.trys.push([1,6,7,8]),i=Object(r.g)(this.queryRunner.loadedViews),o=i.next(),f.label=2;case 2:return o.done?[3,5]:(a=o.value,[5,t(a)]);case 3:f.sent(),f.label=4;case 4:return o=i.next(),[3,2];case 5:return[3,8];case 6:return s=f.sent(),c={error:s},[3,8];case 7:try{o&&!o.done&&(u=i.return)&&u.call(i)}finally{if(c)throw c.error}return[7];case 8:return this.queryRunner.loadedViews=this.queryRunner.loadedViews.filter((function(t){return!e.has(t)})),[2]}}))}))},e.prototype.dropRemovedColumns=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:e=function(e){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=n.columns.filter((function(t){return!e.columns.find((function(e){return e.databaseName===t.name}))}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("columns dropped in "+n.name+": "+i.map((function(e){return e.name})).join(", ")),[4,t.queryRunner.dropColumns(n,i)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,u.label=1;case 1:u.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),u.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:u.sent(),u.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=u.sent(),s={error:a},[3,8];case 7:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},e.prototype.addNewColumns=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,c,u;return Object(r.d)(this,(function(l){switch(l.label){case 0:e=function(e){var n,i,o,a;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=e.columns.filter((function(e){return!n.columns.find((function(t){return t.name===e.databaseName}))}))).length?[2,"continue"]:(o=t.metadataColumnsToTableColumnOptions(i),0===(a=o.map((function(e){return new s.a(e)}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("new columns added: "+i.map((function(e){return e.databaseName})).join(", ")),[4,t.queryRunner.addColumns(n,a)])):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,l.label=1;case 1:l.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),l.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=l.sent(),c={error:a},[3,8];case 7:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}return[7];case 8:return[2]}}))}))},e.prototype.updatePrimaryKeys=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,c,u,f=this;return Object(r.d)(this,(function(h){switch(h.label){case 0:e=function(e){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?(i=e.columns.filter((function(e){return e.isPrimary})),n.columns.filter((function(e){return e.isPrimary})).length!==i.length&&i.length>1?(o=i.map((function(e){return new s.a(l.a.createTableColumnOptions(e,f.connection.driver))})),[4,t.queryRunner.updatePrimaryKeys(n,o)]):[3,2]):[2,"continue"];case 1:r.sent(),r.label=2;case 2:return[2]}}))},t=this,h.label=1;case 1:h.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),h.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:h.sent(),h.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=h.sent(),c={error:a},[3,8];case 7:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}return[7];case 8:return[2]}}))}))},e.prototype.updateExistColumns=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,a,c,u,f,h=this;return Object(r.d)(this,(function(d){switch(d.label){case 0:e=function(e){var n,i,a,c,u,f,d,p,m,y,g,b,v,w,_,k,E,O,T;return Object(r.d)(this,(function(x){switch(x.label){case 0:if(!(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath}))))return[2,"continue"];if(0===(i=t.connection.driver.findChangedColumns(n.columns,e.columns)).length)return[2,"continue"];x.label=1;case 1:x.trys.push([1,6,7,8]),w=void 0,a=Object(r.g)(i),c=a.next(),x.label=2;case 2:return c.done?[3,5]:(g=c.value,[4,t.dropColumnReferencedForeignKeys(e.tablePath,g.databaseName)]);case 3:x.sent(),x.label=4;case 4:return c=a.next(),[3,2];case 5:return[3,8];case 6:return u=x.sent(),w={error:u},[3,8];case 7:try{c&&!c.done&&(_=a.return)&&_.call(a)}finally{if(w)throw w.error}return[7];case 8:x.trys.push([8,13,14,15]),k=void 0,f=Object(r.g)(i),d=f.next(),x.label=9;case 9:return d.done?[3,12]:(g=d.value,[4,t.dropColumnCompositeIndices(e.tablePath,g.databaseName)]);case 10:x.sent(),x.label=11;case 11:return d=f.next(),[3,9];case 12:return[3,15];case 13:return p=x.sent(),k={error:p},[3,15];case 14:try{d&&!d.done&&(E=f.return)&&E.call(f)}finally{if(k)throw k.error}return[7];case 15:if(t.connection.driver instanceof o.i||t.connection.driver instanceof o.a)return[3,23];x.label=16;case 16:x.trys.push([16,21,22,23]),O=void 0,m=Object(r.g)(i),y=m.next(),x.label=17;case 17:return y.done?[3,20]:(g=y.value,[4,t.dropColumnCompositeUniques(e.tablePath,g.databaseName)]);case 18:x.sent(),x.label=19;case 19:return y=m.next(),[3,17];case 20:return[3,23];case 21:return b=x.sent(),O={error:b},[3,23];case 22:try{y&&!y.done&&(T=m.return)&&T.call(m)}finally{if(O)throw O.error}return[7];case 23:return 0===(v=i.map((function(e){var t=n.columns.find((function(t){return t.name===e.databaseName})),r=l.a.createTableColumnOptions(e,h.connection.driver);return{oldColumn:t,newColumn:new s.a(r)}}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild('columns changed in "'+n.name+'". updating: '+i.map((function(e){return e.databaseName})).join(", ")),[4,t.queryRunner.changeColumns(n,v)]);case 24:return x.sent(),[2]}}))},t=this,d.label=1;case 1:d.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),d.label=2;case 2:return i.done?[3,5]:(a=i.value,[5,e(a)]);case 3:d.sent(),d.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return c=d.sent(),u={error:c},[3,8];case 7:try{i&&!i.done&&(f=n.return)&&f.call(n)}finally{if(u)throw u.error}return[7];case 8:return[2]}}))}))},e.prototype.createNewIndices=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c;return Object(r.d)(this,(function(l){switch(l.label){case 0:e=function(e){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=e.indices.filter((function(e){return!n.indices.find((function(t){return t.name===e.name}))&&!0===e.synchronize})).map((function(e){return u.a.create(e)}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("adding new indices "+i.map((function(e){return'"'+e.name+'"'})).join(", ")+' in table "'+n.name+'"'),[4,t.queryRunner.createIndices(n,i)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,l.label=1;case 1:l.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),l.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=l.sent(),s={error:a},[3,8];case 7:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},e.prototype.createNewChecks=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,a,s,c,u;return Object(r.d)(this,(function(l){switch(l.label){case 0:if(this.connection.driver instanceof o.i||this.connection.driver instanceof o.a)return[2];e=function(e){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=e.checks.filter((function(e){return!n.checks.find((function(t){return t.name===e.name}))})).map((function(e){return h.a.create(e)}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("adding new check constraints: "+i.map((function(e){return'"'+e.name+'"'})).join(", ")+' in table "'+n.name+'"'),[4,t.queryRunner.createCheckConstraints(n,i)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,l.label=1;case 1:l.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),l.label=2;case 2:return i.done?[3,5]:(a=i.value,[5,e(a)]);case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return s=l.sent(),c={error:s},[3,8];case 7:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}return[7];case 8:return[2]}}))}))},e.prototype.createCompositeUniqueConstraints=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:e=function(e){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=e.uniques.filter((function(e){return e.columns.length>1&&!n.uniques.find((function(t){return t.name===e.name}))})).map((function(e){return f.a.create(e)}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("adding new unique constraints: "+i.map((function(e){return'"'+e.name+'"'})).join(", ")+' in table "'+n.name+'"'),[4,t.queryRunner.createUniqueConstraints(n,i)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,u.label=1;case 1:u.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),u.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:u.sent(),u.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=u.sent(),s={error:a},[3,8];case 7:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},e.prototype.createNewExclusions=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,a,s,c,u;return Object(r.d)(this,(function(l){switch(l.label){case 0:if(!(this.connection.driver instanceof o.k))return[2];e=function(e){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=e.exclusions.filter((function(e){return!n.exclusions.find((function(t){return t.name===e.name}))})).map((function(e){return d.a.create(e)}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("adding new exclusion constraints: "+i.map((function(e){return'"'+e.name+'"'})).join(", ")+' in table "'+n.name+'"'),[4,t.queryRunner.createExclusionConstraints(n,i)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,l.label=1;case 1:l.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),l.label=2;case 2:return i.done?[3,5]:(a=i.value,[5,e(a)]);case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return s=l.sent(),c={error:s},[3,8];case 7:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(c)throw c.error}return[7];case 8:return[2]}}))}))},e.prototype.createForeignKeys=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,u;return Object(r.d)(this,(function(l){switch(l.label){case 0:e=function(e){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return t.name===e.tablePath})))?0===(i=e.foreignKeys.filter((function(e){return!n.foreignKeys.find((function(t){return y(t,e)}))}))).length?[2,"continue"]:(o=i.map((function(e){return c.a.create(e)})),t.connection.logger.logSchemaBuild("creating a foreign keys: "+i.map((function(e){return e.name})).join(", ")+' on table "'+n.name+'"'),[4,t.queryRunner.createForeignKeys(n,o)]):[2,"continue"];case 1:return r.sent(),[2]}}))},t=this,l.label=1;case 1:l.trys.push([1,6,7,8]),n=Object(r.g)(this.entityToSyncMetadatas),i=n.next(),l.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,e(o)]);case 3:l.sent(),l.label=4;case 4:return i=n.next(),[3,2];case 5:return[3,8];case 6:return a=l.sent(),s={error:a},[3,8];case 7:try{i&&!i.done&&(u=n.return)&&u.call(n)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},e.prototype.dropColumnReferencedForeignKeys=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,c,u,l,f,h;return Object(r.d)(this,(function(d){switch(d.label){case 0:if(!(n=this.queryRunner.loadedTables.find((function(t){return t.name===e}))))return[2];if(i=[],(o=n.foreignKeys.find((function(e){return-1!==e.columnNames.indexOf(t)})))&&((a=n.clone()).foreignKeys=[o],i.push(a),n.removeForeignKey(o)),this.queryRunner.loadedTables.forEach((function(n){var r=n.foreignKeys.filter((function(n){return n.referencedTableName===e&&-1!==n.referencedColumnNames.indexOf(t)}));if(r.length>0){var o=n.clone();o.foreignKeys=r,i.push(o),r.forEach((function(e){return n.removeForeignKey(e)}))}})),!(i.length>0))return[3,8];d.label=1;case 1:d.trys.push([1,6,7,8]),s=Object(r.g)(i),c=s.next(),d.label=2;case 2:return c.done?[3,5]:(u=c.value,this.connection.logger.logSchemaBuild("dropping related foreign keys of "+u.name+": "+u.foreignKeys.map((function(e){return e.name})).join(", ")),[4,this.queryRunner.dropForeignKeys(u,u.foreignKeys)]);case 3:d.sent(),d.label=4;case 4:return c=s.next(),[3,2];case 5:return[3,8];case 6:return l=d.sent(),f={error:l},[3,8];case 7:try{c&&!c.done&&(h=s.return)&&h.call(s)}finally{if(f)throw f.error}return[7];case 8:return[2]}}))}))},e.prototype.dropColumnCompositeIndices=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=this.queryRunner.loadedTables.find((function(t){return t.name===e})))?0===(i=n.indices.filter((function(e){return e.columnNames.length>1&&-1!==e.columnNames.indexOf(t)}))).length?[2]:(this.connection.logger.logSchemaBuild('dropping related indices of "'+e+'"."'+t+'": '+i.map((function(e){return e.name})).join(", ")),[4,this.queryRunner.dropIndices(n,i)]):[2];case 1:return r.sent(),[2]}}))}))},e.prototype.dropColumnCompositeUniques=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(n=this.queryRunner.loadedTables.find((function(t){return t.name===e})))?0===(i=n.uniques.filter((function(e){return e.columnNames.length>1&&-1!==e.columnNames.indexOf(t)}))).length?[2]:(this.connection.logger.logSchemaBuild('dropping related unique constraints of "'+e+'"."'+t+'": '+i.map((function(e){return e.name})).join(", ")),[4,this.queryRunner.dropUniqueConstraints(n,i)]):[2];case 1:return r.sent(),[2]}}))}))},e.prototype.metadataColumnsToTableColumnOptions=function(e){var t=this;return e.map((function(e){return l.a.createTableColumnOptions(e,t.connection.driver)}))},e.prototype.createTypeormMetadataTable=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return e=this.connection.driver.options,t=this.connection.driver.buildTableName("typeorm_metadata",e.schema,e.database),[4,this.queryRunner.createTable(new a.a({name:t,columns:[{name:"type",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataType}),isNullable:!1},{name:"database",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataDatabase}),isNullable:!0},{name:"schema",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataSchema}),isNullable:!0},{name:"table",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataTable}),isNullable:!0},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataName}),isNullable:!0},{name:"value",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataValue}),isNullable:!0}]}),!0)];case 1:return n.sent(),[2]}}))}))},e}();function y(e,t){return e.name===t.name&&e.referencedTableName===t.referencedTablePath}var g=n(9),b=n(71),v=function(){function e(e){this.isReplicated=!1,this.treeSupport=!0,this.supportedDataTypes=["int","integer","tinyint","smallint","mediumint","bigint","unsigned big int","int2","int8","integer","character","varchar","varying character","nchar","native character","nvarchar","text","clob","text","blob","real","double","double precision","float","real","numeric","decimal","boolean","date","time","datetime"],this.withLengthColumnTypes=["character","varchar","varying character","nchar","native character","nvarchar","text","blob","clob"],this.spatialTypes=[],this.withPrecisionColumnTypes=["real","double","double precision","float","real","numeric","decimal","date","time","datetime"],this.withScaleColumnTypes=["real","double","double precision","float","real","numeric","decimal"],this.mappedDataTypes={createDate:"datetime",createDateDefault:"datetime('now')",updateDate:"datetime",updateDateDefault:"datetime('now')",deleteDate:"datetime",deleteDateNullable:!0,version:"integer",treeLevel:"integer",migrationId:"integer",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.connection=e,this.options=e.options}return e.prototype.connect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(t){switch(t.label){case 0:return e=this,[4,this.createDatabaseConnection()];case 1:return e.databaseConnection=t.sent(),[2]}}))}))},e.prototype.afterConnect=function(){return Promise.resolve()},e.prototype.disconnect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){return[2,new Promise((function(t,n){e.queryRunner=void 0,e.databaseConnection.close((function(e){return e?n(e):t()}))}))]}))}))},e.prototype.createSchemaBuilder=function(){return new m(this.connection)},e.prototype.preparePersistentValue=function(e,t){return t.transformer&&(e=b.a.transformTo(t.transformer,e)),null==e?e:t.type===Boolean||"boolean"===t.type?!0===e?1:0:"date"===t.type?i.a.mixedDateToDateString(e):"time"===t.type?i.a.mixedDateToTimeString(e):"datetime"===t.type||t.type===Date?i.a.mixedDateToUtcDatetimeString(e):"simple-array"===t.type?i.a.simpleArrayToString(e):"simple-json"===t.type?i.a.simpleJsonToString(e):"simple-enum"===t.type?i.a.simpleEnumToString(e):e},e.prototype.prepareHydratedValue=function(e,t){return null==e?t.transformer?b.a.transformFrom(t.transformer,e):e:(t.type===Boolean||"boolean"===t.type?e=!!e:"datetime"===t.type||t.type===Date?(e&&"string"==typeof e&&(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d/.test(e)&&(e=e.replace(" ","T")),/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d\d\d)?)?$/.test(e)&&(e+="Z")),e=i.a.normalizeHydratedDate(e)):"date"===t.type?e=i.a.mixedDateToDateString(e):"time"===t.type?e=i.a.mixedTimeToString(e):"simple-array"===t.type?e=i.a.stringToSimpleArray(e):"simple-json"===t.type?e=i.a.stringToSimpleJson(e):"simple-enum"===t.type&&(e=i.a.stringToSimpleEnum(e,t)),t.transformer&&(e=b.a.transformFrom(t.transformer,e)),e)},e.prototype.escapeQueryWithParameters=function(e,t,n){var r=Object.keys(n).map((function(e){return"boolean"==typeof n[e]?!0===n[e]?1:0:n[e]}));if(!t||!Object.keys(t).length)return[e,r];var i=Object.keys(t).map((function(e){return"(:(\\.\\.\\.)?"+e+"\\b)"})).join("|");return[e=e.replace(new RegExp(i,"g"),(function(e){var n,i=!1;return":..."===e.substr(0,4)?(i=!0,n=t[e.substr(4)]):n=t[e.substr(1)],i?n.map((function(e){return r.push(e),"?"})).join(", "):n instanceof Function?n():(r.push(n),"?")})),r]},e.prototype.escape=function(e){return'"'+e+'"'},e.prototype.buildTableName=function(e,t,n){return e},e.prototype.normalizeType=function(e){return e.type===Number||"int"===e.type?"integer":e.type===String?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":"uuid"===e.type?"varchar":"simple-array"===e.type||"simple-json"===e.type?"text":"simple-enum"===e.type?"varchar":e.type||""},e.prototype.normalizeDefault=function(e){var t=e.default;return"number"==typeof t?""+t:"boolean"==typeof t?!0===t?"1":"0":"function"==typeof t?t():"string"==typeof t?"'"+t+"'":null===t?void 0:t},e.prototype.normalizeIsUnique=function(e){return e.entityMetadata.uniques.some((function(t){return 1===t.columns.length&&t.columns[0]===e}))},e.prototype.getColumnLength=function(e){return e.length?e.length.toString():""},e.prototype.createFullType=function(e){var t=e.type;return e.enum?"varchar":(e.length?t+="("+e.length+")":null!==e.precision&&void 0!==e.precision&&null!==e.scale&&void 0!==e.scale?t+="("+e.precision+","+e.scale+")":null!==e.precision&&void 0!==e.precision&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t)},e.prototype.obtainMasterConnection=function(){return Promise.resolve()},e.prototype.obtainSlaveConnection=function(){return Promise.resolve()},e.prototype.createGeneratedMap=function(e,t,n,r){var i=e.generatedColumns.reduce((function(e,i){var o;return"increment"===i.generationStrategy&&t&&(o=t-r+n+1),o?g.a.mergeDeep(e,i.createValueMap(o)):e}),{});return Object.keys(i).length>0?i:void 0},e.prototype.findChangedColumns=function(e,t){var n=this;return t.filter((function(t){var r=e.find((function(e){return e.name===t.databaseName}));return!!r&&(r.name!==t.databaseName||r.type!==n.normalizeType(t)||r.length!==t.length||r.precision!==t.precision||r.scale!==t.scale||n.normalizeDefault(t)!==r.default||r.isPrimary!==t.isPrimary||r.isNullable!==t.isNullable||r.isUnique!==n.normalizeIsUnique(t)||"uuid"!==t.generationStrategy&&r.isGenerated!==t.isGenerated)}))},e.prototype.isReturningSqlSupported=function(){return!1},e.prototype.isUUIDGenerationSupported=function(){return!1},e.prototype.isFullTextColumnTypeSupported=function(){return!1},e.prototype.createParameter=function(e,t){return"?"},e.prototype.createDatabaseConnection=function(){throw new Error("Do not use AbstractSqlite directly, it has to be used with one of the sqlite drivers")},e.prototype.loadDependencies=function(){},e}()},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Helper=void 0;var a=n(31),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,s=[{key:"isNull",value:function(e){return null==e}},{key:"isNotNull",value:function(t){return!e.isNull(t)}},{key:"nonNull",value:function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];for(var a=0;a<arguments.length;a++)if(e.isNotNull(arguments[a]))return arguments[a];return null}},{key:"isSet",value:function(t){if(e.isNotNull(t)){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return 0===r.length||e.isSet.apply(null,[t[r[0]]].concat(r.slice(1)))}return!1}},{key:"empty",value:function(t){return e.isNull(t)||"string"==typeof t&&""===t.trim()}},{key:"notEmpty",value:function(t){return!e.empty(t)}},{key:"strftime",value:function(t,n,r,i){r=e.nonNull(r,!1),i=e.nonNull(i,!0),(n=e.nonNull(n,new Date))instanceof Date||(n=new Date(n));var o=r?n.getUTCDay():n.getDay(),s=r?n.getUTCDate():n.getDate(),c=r?n.getUTCMonth():n.getMonth(),u=r?n.getUTCFullYear():n.getFullYear(),l=r?n.getUTCHours():n.getHours(),f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d=["January","February","March","April","May","June","July","August","September","October","November","December"],p=[0,31,59,90,120,151,181,212,243,273,304,334],m=function(){var e=new Date(n);return e.setDate(s-(o+6)%7+3),e},y=function(e,t){return(""+(Math.pow(10,t)+e)).slice(1)};return t.replace(/%[a-z]/gi,(function(e){return{"%a":i?a.Translator.makePersistentTranslation(h[o]).outerHTML:a.Translator.translate(h[o]),"%A":i?a.Translator.makePersistentTranslation(f[o]).outerHTML:a.Translator.translate(f[o]),"%b":i?a.Translator.makePersistentTranslation(d[c].slice(0,3)).outerHTML:a.Translator.translate(d[c].slice(0,3)),"%B":i?a.Translator.makePersistentTranslation(d[c]).outerHTML:a.Translator.translate(d[c]),"%c":n.toUTCString(),"%C":Math.floor(u/100),"%d":y(s,2),"%e":s,"%f":y(n.getTime()%1e3,4),"%F":n.toISOString().slice(0,10),"%G":m().getFullYear(),"%g":(""+m().getFullYear()).slice(2),"%H":y(l,2),"%I":y((l+11)%12+1,2),"%j":y(p[c]+s+(c>1&&0==(3&u)&&(u%100!=0||u%400==0)?1:0),3),"%k":""+l,"%l":(l+11)%12+1,"%m":y(c+1,2),"%M":y(n.getMinutes(),2),"%p":l<12?"AM":"PM","%P":l<12?"am":"pm","%s":Math.round(n.getTime()/1e3),"%S":y(n.getSeconds(),2),"%u":o||7,"%w":""+o,"%x":n.toLocaleDateString(),"%X":n.toLocaleTimeString(),"%y":(""+u).slice(2),"%Y":u,"%z":n.toTimeString().replace(/.+GMT([+-]\d+).+/,"$1"),"%Z":n.toTimeString().replace(/.+\((.+?)\)$/,"$1")}[e]||e}))}},{key:"arrayToObject",value:function(e,t){var n={};return e.forEach((function(e){n[t(e)]=e})),n}},{key:"cloneJson",value:function(t){var n;if(e.isNull(t)||"object"!==r(t))return t;if(t instanceof Array){var i=[];for(n=0;n<t.length;++n)i[n]=e.cloneJson(t[n]);return i}if(t instanceof Date)return new Date(t.getTime());var o={};for(n in t)o[n]=e.cloneJson(t[n]);return o}},{key:"formDataFromObject",value:function(e){var t=new FormData;for(var n in e)t.set(n,e[n]);return t}},{key:"removeAllChildren",value:function(e){if(e instanceof Node)for(;e.firstChild;)e.removeChild(e.firstChild);return e}},{key:"shuffleArray",value:function(e){for(var t,n,r=e.length;0!==r;)n=Math.floor(Math.random()*r),t=e[r-=1],e[r]=e[n],e[n]=t;return e}},{key:"padZero",value:function(t,n,r){return r=e.nonNull(r,"0"),t+="",n=e.nonNull(n,1),t.length>=n?t:new Array(n-t.length+1).join(r)+t}},{key:"deepEqual",value:function(t,n){if(t===n)return!0;if("object"===r(t)&&"object"===r(n)){var i=Object.keys(n);return Object.keys(t).every((function(r){var o=i.indexOf(r);return!(o<0)&&(i.splice(o,1),e.deepEqual(t[r],n[r]))}))&&0===i.length}return!1}},{key:"htmlspecialcharsDecode",value:function(t){var n={"&amp;":"&","&#038;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#039;":"'","&#8217;":"’","&#8216;":"‘","&#8211;":"–","&#8212;":"—","&#8230;":"…","&#8221;":"”"};return e.isNotNull(t)&&"function"==typeof t.replace?t.replace(/\&[\w\d\#]{2,5}\;/g,(function(e){return n[e]})):t}},{key:"invertKeyValues",value:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}},{key:"asyncForEach",value:function(t,n,r){return o(this,void 0,void 0,regeneratorRuntime.mark((function i(){var o,a,s,c;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:r=e.nonNull(r,!1),t instanceof Map&&(t=Array.from(t.values())),o=[],a=0;case 4:if(!(a<t.length)){i.next=14;break}if(s=a,c=Promise.resolve(n(t[s],s,t)),r){i.next=10;break}return i.next=10,c;case 10:o.push(c);case 11:a++,i.next=4;break;case 14:return i.abrupt("return",Promise.all(o));case 15:case"end":return i.stop()}}),i)})))}},{key:"escapeRegExp",value:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},{key:"objectForEach",value:function(e,t){Object.keys(e).forEach((function(n){t(e[n],n,e)}))}},{key:"toArray",value:function(e){var t=[];for(var n in e)t.push(e[n]);return t}},{key:"imageUrlIsEmpty",value:function(t){return e.isNull(t)||""===t.trim()||"data:"===t.trim()}},{key:"newPromiseWithResolve",value:function(){var e=null,t=null,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n}}],(n=null)&&i(t.prototype,n),s&&i(t,s),e}();t.Helper=s},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(66),o=function(){function e(){}return e.buildDriverOptions=function(e,t){var n,i;if(e.url){var o=this.parseConnectionUrl(e.url);t&&t.useSid&&o.database&&(o.sid=o.database);try{for(var a=Object(r.g)(Object.keys(o)),s=a.next();!s.done;s=a.next()){var c=s.value;void 0===o[c]&&delete o[c]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return Object.assign({},e,o)}return Object.assign({},e)},e.buildMongoDBDriverOptions=function(e,t){var n,i;if(e.url){var o=this.parseMongoDBConnectionUrl(e.url);t&&t.useSid&&o.database&&(o.sid=o.database);try{for(var a=Object(r.g)(Object.keys(o)),s=a.next();!s.done;s=a.next()){var c=s.value;void 0===o[c]&&delete o[c]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return Object.assign({},e,o)}return Object.assign({},e)},e.buildAlias=function(e,t){for(var n=e.maxAliasLength,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];"string"==typeof t?(r.unshift(t),t={shorten:!1,joiner:"_"}):t=Object.assign({shorten:!1,joiner:"_"},t);var a=1===r.length?r[0]:r.join(t.joiner);if(n&&n>0&&a.length>n){if(!0===t.shorten){var s=Object(i.c)(a);if(s.length<n)return s}return Object(i.b)(a,{length:n})}return a},e.buildColumnAlias=function(e,t){for(var n=e.maxAliasLength,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];return this.buildAlias.apply(this,Object(r.f)([{maxAliasLength:n},t],Object(r.e)(i)))},e.parseConnectionUrl=function(e){var t=e.split(":")[0],n=e.indexOf("//"),i=e.substr(n+2),o=i.indexOf("/"),a=-1!==o?i.substr(0,o):i,s=-1!==o?i.substr(o+1):void 0;s&&-1!==s.indexOf("?")&&(s=s.substr(0,s.indexOf("?")));var c=a.lastIndexOf("@"),u=a.substr(0,c),l=a.substr(c+1),f=u,h="",d=u.indexOf(":");-1!==d&&(f=u.substr(0,d),h=u.substr(d+1));var p=Object(r.e)(l.split(":"),2),m=p[0],y=p[1];return{type:t,host:m,username:decodeURIComponent(f),password:decodeURIComponent(h),port:y?parseInt(y):void 0,database:s||void 0}},e.parseMongoDBConnectionUrl=function(e){var t,n,i,o,a,s=e.split(":")[0],c=e.indexOf("//"),u=e.substr(c+2),l=u.indexOf("/"),f=-1!==l?u.substr(0,l):u,h=-1!==l?u.substr(l+1):void 0,d=void 0,p=void 0,m=void 0,y=void 0,g={};h&&-1!==h.indexOf("?")&&(h.substr(h.indexOf("?")+1,h.length).split("&").forEach((function(e){o=e.split("=")[0],a=e.split("=")[1],g[o]=a})),y=g.replicaSet,h=h.substr(0,h.indexOf("?")));var b=f.lastIndexOf("@"),v=f.substr(0,b),w=f.substr(b+1),_=v,k="",E=v.indexOf(":");-1!==E&&(_=v.substr(0,E),k=v.substr(E+1)),y?m=w:(d=(t=Object(r.e)(w.split(":"),2))[0],p=t[1]);var O={type:s,host:d,hostReplicaSet:m,username:decodeURIComponent(_),password:decodeURIComponent(k),port:p?parseInt(p):void 0,database:h||void 0};try{for(var T=Object(r.g)(Object.entries(g)),x=T.next();!x.done;x=T.next()){var S=Object(r.e)(x.value,2),C=S[0],R=S[1];O[C]=R}}catch(e){n={error:e}}finally{try{x&&!x.done&&(i=T.return)&&i.call(T)}finally{if(n)throw n.error}}return O},e}()},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MigrationHelper=void 0;const i=n(13),o=n(5);class a{static isServer(){return"object"!=typeof document}static addTableFromModelClass(e,t){return r(this,void 0,void 0,(function*(){return yield t.createTable(this.createTableFromModelClass(e))}))}static addManyToManyTable(e,t,n){return r(this,void 0,void 0,(function*(){return yield n.createTable(this.createManyToManyTable(e,t))}))}static createManyToManyTable(e,t){let n=e+"Id",r=t+"Id",o=e+t.substr(0,1).toUpperCase()+t.substr(1);return new i.Table({name:o,columns:[{name:n,isPrimary:!0,type:"integer"},{name:r,isPrimary:!0,type:"integer"}],indices:[{name:"IDX_"+o+"_"+n,columnNames:[n]},{name:"IDX_"+o+"_"+r,columnNames:[r]}],foreignKeys:[{name:"FK_"+o+"_"+n,columnNames:[n],referencedTableName:e.replace(/([A-Z])/,((e,t)=>"_"+t.toLowerCase())),referencedColumnNames:["id"],onDelete:"cascade"},{name:"FK_"+o+"_"+r,columnNames:[r],referencedTableName:t.replace(/([A-Z])/,((e,t)=>"_"+t.toLowerCase())),referencedColumnNames:["id"],onDelete:"cascade"}]})}static createTableFromModelClass(e,t){t=o.Helper.nonNull(t,"");let n=[],r=[],s=[],c=e.getSchemaDefinition(),u=t+o.Helper.toSnakeCase(c.name);return Object.keys(c.columns).forEach((t=>{let r={};Object.keys(c.columns[t]).forEach((e=>{r[e]=c.columns[t][e]})),r.name=t,c.columns[t].primary&&(r.isPrimary=!0),c.columns[t].nullable&&(r.isNullable=!0),c.columns[t].generated&&(o.Helper.isNull(e.CAN_BE_SYNCED)||this.isServer()||"clientId"===t)&&(r.isGenerated=!0,r.generationStrategy="increment",this.isServer()||(r.type="INTEGER")),"string"==typeof r.default?r.default="'"+r.default+"'":!0===r.default?r.default=1:!1===r.default&&(r.default=0),r.type===a.TYPES.SIMPLE_JSON&&(r.type=a.TYPES.TEXT),r.type!==a.TYPES.MEDIUMTEXT||this.isServer()||(r.type=a.TYPES.TEXT),r.type!==a.TYPES.SIMPLE_JSON||this.isServer()||(r.type=a.TYPES.TEXT),n.push(r)})),Object.keys(c.relations).forEach((e=>{if("many-to-one"===c.relations[e].type||c.relations[e].joinColumn){let t=e.substr(0,1).toLowerCase()+e.substr(1)+"Id",i={name:t,type:a.TYPES.INTEGER,isNullable:!0};n.push(i);let l={name:"IDX_"+u+"_"+t,columnNames:[t]};r.push(l);let f={name:"FK_"+u+"_"+t,columnNames:[t],referencedTableName:o.Helper.toSnakeCase(c.relations[e].target),referencedColumnNames:["id"]};s.push(f)}})),new i.Table({name:u,columns:n,indices:r,foreignKeys:s})}static updateModel(e,t){return r(this,void 0,void 0,(function*(){let n=t.getSchemaDefinition(),r=o.Helper.toSnakeCase(n.name),i=this.createTableFromModelClass(t),s=yield e.getTable(r);s.name="__temp__"+s.name,s.indices.forEach((e=>{e.name="__temp__"+e.name})),s.foreignKeys.forEach((e=>{e.name="__temp__"+e.name,e.columnNames=[e.columnNames[0]],e.referencedColumnNames=[e.referencedColumnNames[0]]})),a.isServer()&&s.columns.forEach((e=>{null!==e.default&&"string"==typeof e.default&&e.default.startsWith("'")&&e.default.endsWith("'")&&("varchar"!==e.type||e.default.startsWith("''"))&&(e.default=e.default.substring(1,e.default.length-1))})),yield e.createTable(s);let c=[];s.columns.forEach((e=>{c.push(e.name)})),yield e.query("INSERT INTO "+s.name+"(`"+c.join("`,`")+"`) SELECT `"+c.join("`,`")+"` FROM "+r+";"),yield e.query("DROP TABLE "+r+";"),yield e.createTable(i);let u=[];i.columns.forEach((e=>u.push(e.name))),c=[],s.columns.forEach((e=>{-1!==u.indexOf(e.name)&&c.push(e.name)})),yield e.query("INSERT INTO "+r+"(`"+c.join("`,`")+"`) SELECT `"+c.join("`,`")+"` FROM "+s.name+";"),yield e.query("DROP TABLE "+s.name+";")}))}}t.MigrationHelper=a,a.TYPES={INTEGER:"int",FLOAT:"float",DATE:"datetime",STRING:"varchar",TEXT:"text",MEDIUMTEXT:"mediumtext",BOOLEAN:"boolean",JSON:"json",SIMPLE_JSON:"simple-json",MY_JSON:"my-json"}},function(e,t,n){var r=n(140)("wks"),i=n(96),o=n(17).Symbol,a="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.AccessEasySyncModel=void 0;var AccessEasySyncModel=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(AccessEasySyncModel,e);var t=a(AccessEasySyncModel);function AccessEasySyncModel(){return i(this,AccessEasySyncModel),t.apply(this,arguments)}return AccessEasySyncModel}(n(10).EasySyncBaseModel);t.AccessEasySyncModel=AccessEasySyncModel,AccessEasySyncModel.ACCESS_READ=!0,AccessEasySyncModel.ACCESS_MODIFY=!1,AccessEasySyncModel.CAN_BE_SYNCED=!1},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(){function e(){}return e.normalizeHydratedDate=function(e){return e&&"string"==typeof e?new Date(e):e},e.mixedDateToDateString=function(e){return e instanceof Date?this.formatZerolessValue(e.getFullYear())+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate()):e},e.mixedDateToDate=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0);var r="string"==typeof e?new Date(e):e;return t&&(r=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())),n||r.setUTCMilliseconds(0),r},e.mixedDateToTimeString=function(e,t){return void 0===t&&(t=!1),e instanceof Date?this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+(t?"":":"+this.formatZerolessValue(e.getSeconds())):e},e.mixedTimeToDate=function(e){if("string"==typeof e){var t=Object(r.e)(e.split(":"),3),n=t[0],i=t[1],o=t[2],a=new Date;return n&&a.setHours(parseInt(n)),i&&a.setMinutes(parseInt(i)),o&&a.setSeconds(parseInt(o)),a}return e},e.mixedTimeToString=function(e,t){return void 0===t&&(t=!1),"string"==typeof(e=e instanceof Date?e.getHours()+":"+e.getMinutes()+(t?"":":"+e.getSeconds()):e)?e.split(":").map((function(e){return 1===e.length?"0"+e:e})).join(":"):e},e.mixedDateToDatetimeString=function(e,t){if("string"==typeof e&&(e=new Date(e)),e instanceof Date){var n=this.formatZerolessValue(e.getFullYear())+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate())+" "+this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+":"+this.formatZerolessValue(e.getSeconds());t&&(n+="."+this.formatMilliseconds(e.getMilliseconds())),e=n}return e},e.mixedDateToUtcDatetimeString=function(e){return"string"==typeof e&&(e=new Date(e)),e instanceof Date?this.formatZerolessValue(e.getUTCFullYear())+"-"+this.formatZerolessValue(e.getUTCMonth()+1)+"-"+this.formatZerolessValue(e.getUTCDate())+" "+this.formatZerolessValue(e.getUTCHours())+":"+this.formatZerolessValue(e.getUTCMinutes())+":"+this.formatZerolessValue(e.getUTCSeconds())+"."+this.formatMilliseconds(e.getUTCMilliseconds()):e},e.simpleArrayToString=function(e){return Array.isArray(e)?e.map((function(e){return String(e)})).join(","):e},e.stringToSimpleArray=function(e){return e instanceof String||"string"==typeof e?e.length>0?e.split(","):[]:e},e.simpleJsonToString=function(e){return JSON.stringify(e)},e.stringToSimpleJson=function(e){return"string"==typeof e?JSON.parse(e):e},e.simpleEnumToString=function(e){return""+e},e.stringToSimpleEnum=function(e,t){return t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0&&(e=parseInt(e)),e},e.formatZerolessValue=function(e){return e<10?"0"+e:String(e)},e.formatMilliseconds=function(e){return e<10?"00"+e:e<100?"0"+e:String(e)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DateHelper=void 0;const r=n(5);class i{static strftime(e,t,n){n=r.Helper.nonNull(n,!1),(t=r.Helper.nonNull(t,new Date))instanceof Date||(t=new Date(t));let i=n?t.getUTCDay():t.getDay(),o=n?t.getUTCDate():t.getDate(),a=n?t.getUTCMonth():t.getMonth(),s=n?t.getUTCFullYear():t.getFullYear(),c=n?t.getUTCHours():t.getHours(),u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],f=["January","February","March","April","May","June","July","August","September","October","November","December"],h=[0,31,59,90,120,151,181,212,243,273,304,334],d=function(){let e=new Date(t);return e.setDate(o-(i+6)%7+3),e},p=function(e,t){return(""+(Math.pow(10,t)+e)).slice(1)};return e.replace(/%[a-z]/gi,(e=>({"%a":this.translate(l[i]),"%A":this.translate(u[i]),"%b":this.translate(f[a].slice(0,3)),"%B":this.translate(f[a]),"%c":t.toUTCString(),"%C":Math.floor(s/100),"%d":p(o,2),"%e":o,"%f":p(t.getTime()%1e3,4),"%F":t.toISOString().slice(0,10),"%G":d().getFullYear(),"%g":(""+d().getFullYear()).slice(2),"%H":p(c,2),"%I":p((c+11)%12+1,2),"%j":p(h[a]+o+(a>1&&0==(3&s)&&(s%100!=0||s%400==0)?1:0),3),"%k":""+c,"%l":(c+11)%12+1,"%m":p(a+1,2),"%M":p(t.getMinutes(),2),"%p":c<12?"AM":"PM","%P":c<12?"am":"pm","%s":Math.round(t.getTime()/1e3),"%S":p(t.getSeconds(),2),"%u":i||7,"%w":""+i,"%x":t.toLocaleDateString(),"%X":t.toLocaleTimeString(),"%y":(""+s).slice(2),"%Y":s,"%z":t.toTimeString().replace(/.+GMT([+-]\d+).+/,"$1"),"%Z":t.toTimeString().replace(/.+\((.+?)\)$/,"$1")}[e]||e)))}static translate(e){return this.translationCallback?this.translationCallback(e):e}static setTranslationCallback(e){this.translationCallback=e}}t.DateHelper=i,i.FORMAT={ISO_TIME:"%Y-%m-%dT%H:%M%S"}},function(e,t,n){var r=n(77),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(){function e(){}return e.assign=function(e){for(var t,n,i,o,a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];try{for(var c=Object(r.g)(a),u=c.next();!u.done;u=c.next()){var l=u.value;try{for(var f=(i=void 0,Object(r.g)(Object.getOwnPropertyNames(l))),h=f.next();!h.done;h=f.next()){var d=h.value;e[d]=l[d]}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}},e}()},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Translator=void 0;var f=n(11),h=n(22),d=n(247),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(p,e);var t,n,r,c=s(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),t=c.call(this,e),e=h.Helper.nonNull(e,{}),t._currentLanguage=e.currentLanguage||t._fallbackLanguage,t._nativeStorageKey=e.nativeStorageKey||"language",t._translationClass=e.translationClass||"translation",t._initPromise=t.loadUserLanguage().then((function(e){return t.setLanguage(e.toLowerCase())})),t}return t=p,r=[{key:"getInstance",value:function(){return d.Translator.getInstance()}},{key:"setLanguage",value:function(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=p.getInstance())){t.next=3;break}return t.abrupt("return",n.setLanguage(e));case 3:case"end":return t.stop()}}),t)})))}},{key:"makePersistentTranslation",value:function(e,t,n,r){var i=p.getInstance();if(i)return i.makePersistentTranslation(e,t,n,r)}},{key:"addTranslationCallback",value:function(e,t){var n=p.getInstance();if(n)return n.addTranslationCallback(e,t)}},{key:"removeTranslationCallback",value:function(e){var t=p.getInstance();if(t)return t.removeTranslationCallback(e)}},{key:"updateTranslations",value:function(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=p.getInstance())){t.next=3;break}return t.abrupt("return",n.updateTranslations(e));case 3:case"end":return t.stop()}}),t)})))}},{key:"init",value:function(e){d.Translator.instance=new p(e)}}],(n=[{key:"setLanguage",value:function(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._currentLanguage!==e){t.next=4;break}return t.next=3,this.updateTranslations();case 3:return t.abrupt("return");case 4:if(this._translations[e]){t.next=6;break}return t.abrupt("return");case 6:return"undefined"!=typeof document&&document.getElementsByTagName("html")[0].setAttribute("lang",e),this._currentLanguage=e,t.next=10,this.updateTranslations();case 10:return t.next=12,f.NativeStoragePromise.setItem(this._nativeStorageKey,this._currentLanguage);case 12:case"end":return t.stop()}}),t,this)})))}},{key:"translate",value:function(e,t,n){return o(u(p.prototype),"translate",this).call(this,e,t,h.Helper.nonNull(n,this._currentLanguage))}},{key:"addTranslationCallback",value:function(e,t){return t=h.Helper.nonNull(t,!0),this._lastTranslationCallbackId++,this._translationCallbacks.set(this._lastTranslationCallbackId,e),t&&e(),this._lastTranslationCallbackId}},{key:"removeTranslationCallback",value:function(e){this._translationCallbacks.delete(e)}},{key:"updateTranslations",value:function(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o,a,s,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(e=h.Helper.nonNull(e,document)))for(n=e.getElementsByClassName(this._translationClass),r=0,i=n.length;r<i;r++){if(""!==(o=p._isValid(n[r].dataset.translation)?n[r].dataset.translation:n[r].innerText||"")&&!n[r].dataset.onlyTranslateAttributes)try{a=this.translate(o,void 0!==n[r].dataset.translationArgs?JSON.parse(n[r].dataset.translationArgs):void 0),"1"===n[r].dataset.translationUseText?n[r].innerText=a:n[r].innerHTML=a,n[r].dataset.translation=o}catch(e){console.error("wrong configured translation: "+e)}for(s in n[r].dataset)if(s.startsWith("translation")&&!s.endsWith("Args"))try{n[r][s.substr(11).toLowerCase()]=this.translate(n[r].dataset[s],void 0!==n[r].dataset[s+"Args"]?JSON.parse(n[r].dataset[s+"Args"]):void 0)}catch(e){console.error("wrong configured translation: "+e)}}return t.next=4,h.Helper.asyncForEach(this._translationCallbacks,(function(t){return l(c,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t(e));case 1:case"end":return n.stop()}}),n)})))}));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"loadUserLanguage",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.NativeStoragePromise.getItem(this._nativeStorageKey);case 2:if(t=e.sent,p._isValid(t)&&t in this._translations){e.next=16;break}n=[],void 0!==navigator.language&&n.push(navigator.language),"languages"in navigator&&(n=navigator.languages.slice(0)),n.push(this._fallbackLanguage),r=0,i=n.length;case 9:if(!(r<i)){e.next=16;break}if(!(n[r]in this._translations)){e.next=13;break}return t=n[r],e.abrupt("break",16);case 13:r++,e.next=9;break;case 16:return e.abrupt("return",t);case 17:case"end":return e.stop()}}),e,this)})))}},{key:"makePersistentTranslation",value:function(e,t,n,r){if(r=h.Helper.nonNull(r,n,t,!1),n=n||"span","undefined"!=typeof document){var i=document.createElement(n);return i.dataset.translation=e,i.classList.add(this._translationClass),void 0!==t&&(i.dataset.translationArgs=JSON.stringify(t)),!0===r?(i.innerText=this.translate(e,t),i.dataset.translationUseText="1"):i.innerHTML=this.translate(e,t),i}}},{key:"getTranslationClass",value:function(){return this._translationClass}},{key:"getCurrentLanguage",value:function(){return this._currentLanguage}}])&&i(t.prototype,n),r&&i(t,r),p}(d.Translator);t.Translator=p,p._translations={},p.logMissingTranslations=!0,p.instance=null},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e){this.isNullable=!1,this.isGenerated=!1,this.isPrimary=!1,this.isUnique=!1,this.isArray=!1,this.length="",this.zerofill=!1,this.unsigned=!1,e&&(this.name=e.name,this.type=e.type||"",this.length=e.length||"",this.width=e.width,this.charset=e.charset,this.collation=e.collation,this.precision=e.precision,this.scale=e.scale,this.zerofill=e.zerofill||!1,this.unsigned=!!this.zerofill||(e.unsigned||!1),this.default=e.default,this.onUpdate=e.onUpdate,this.isNullable=e.isNullable||!1,this.isGenerated=e.isGenerated||!1,this.generationStrategy=e.generationStrategy,this.isPrimary=e.isPrimary||!1,this.isUnique=e.isUnique||!1,this.isArray=e.isArray||!1,this.comment=e.comment,this.enum=e.enum,this.enumName=e.enumName,this.asExpression=e.asExpression,this.generatedType=e.generatedType,this.spatialFeatureType=e.spatialFeatureType,this.srid=e.srid)}return e.prototype.clone=function(){return new e({name:this.name,type:this.type,length:this.length,width:this.width,charset:this.charset,collation:this.collation,precision:this.precision,scale:this.scale,zerofill:this.zerofill,unsigned:this.unsigned,enum:this.enum,enumName:this.enumName,asExpression:this.asExpression,generatedType:this.generatedType,default:this.default,onUpdate:this.onUpdate,isNullable:this.isNullable,isGenerated:this.isGenerated,generationStrategy:this.generationStrategy,isPrimary:this.isPrimary,isUnique:this.isUnique,isArray:this.isArray,comment:this.comment,spatialFeatureType:this.spatialFeatureType,srid:this.srid})},e}()},function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UserManager=void 0;var o=n(2),a=n(208),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._defaultUserData={id:null,loggedIn:!1,online:!1,username:null,email:null,accesses:e.OFFLINE_ACCESSES},this._userData=this._defaultUserData,this._lastLoginChangeCallbackId=-1,this._loginChangeCallbacks={},this._getMePromise=null}var t,n,s;return t=e,s=[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}},{key:"updateHeaders",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=o.Helper,e.t1=sessionStorage.getItem("auth-token"),e.next=4,o.NativeStoragePromise.getItem("auth-token");case 4:e.t2=e.sent,(t=e.t0.nonNull.call(e.t0,e.t1,e.t2))&&o.DataManager.setHeader("Authorization","Bearer "+t);case 7:case"end":return e.stop()}}),e)})))}},{key:"syncParamFor",value:function(e){return{model:e,where:{user:{id:this.getInstance().getUserData().id}}}}},{key:"userSyncParam",value:function(){return{model:a.User,where:{id:this.getInstance().getUserData().id}}}}],(n=[{key:"addLoginChangeCallback",value:function(e,t){return this._lastLoginChangeCallbackId++,this._loginChangeCallbacks[this._lastLoginChangeCallbackId]=e,o.Helper.nonNull(t,!1)&&e(this._userData.loggedIn,this),this._lastLoginChangeCallbackId}},{key:"hasAccess",value:function(e){return-1!==this._userData.accesses.indexOf(e)}},{key:"_checkChangedLogin",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._userData.loggedIn===e.loggedIn&&(!0!==this._userData.loggedIn||this._userData.id===e.id)){t.next=3;break}return t.next=3,this._callLoginChangeCallbacks();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"_callLoginChangeCallbacks",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Helper.asyncForEach(Object.keys(this._loginChangeCallbacks),(function(e){t._loginChangeCallbacks[e](t._userData.loggedIn,t)}),!0);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"getUserData",value:function(){return this._userData}},{key:"getMe",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._getMePromise=new Promise((function(e){return i(t,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._userData,t.next=3,this._doGetMe();case 3:return r=t.sent,t.next=6,this._checkChangedLogin(n);case 6:e(r);case 7:case"end":return t.stop()}}),t,this)})))})),e.abrupt("return",this._getMePromise);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"waitForGetMe",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===this._getMePromise&&this.getMe(),e.next=3,this._getMePromise;case 3:case"end":return e.stop()}}),e,this)})))}},{key:"login",value:function(e,t,n){return i(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,o,a=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=this._userData,r.next=3,this._doLogin(e,t,n);case 3:return o=r.sent,setTimeout((function(){a._checkChangedLogin(i)}),1),r.abrupt("return",o);case 6:case"end":return r.stop()}}),r,this)})))}},{key:"logout",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._userData,e.next=3,this._doLogout();case 3:return n=e.sent,e.next=6,this._checkChangedLogin(t);case 6:if(this._userData.loggedIn){e.next=9;break}return e.next=9,new o.Toast("goodbye").show();case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})))}},{key:"register",value:function(e,t,n){return i(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,o,a=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=this._userData,r.next=3,this._doRegister(e,t,n);case 3:return o=r.sent,setTimeout((function(){a._checkChangedLogin(i)}),1),r.abrupt("return",o);case 6:case"end":return r.stop()}}),r,this)})))}},{key:"_doGetMe",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.updateHeaders();case 2:return t.next=4,o.DataManager.load("user");case 4:if(n=t.sent,!o.Helper.isSet(n,"userData")){t.next=11;break}return t.next=8,o.NativeStoragePromise.setItem("user-data",n.userData);case 8:this._userData=n.userData,t.next=12;break;case 11:this._userData=this._defaultUserData;case 12:if(this._updateAccessClasses(),!o.Helper.isSet(n,"token")){t.next=23;break}return o.DataManager.setHeader("Authorization","Bearer "+n.token),sessionStorage.setItem("auth-token",n.token),t.t0=o.Helper,t.next=19,o.NativeStoragePromise.getItem("auth-token");case 19:if(t.t1=t.sent,!t.t0.isNotNull.call(t.t0,t.t1)){t.next=23;break}return t.next=23,o.NativeStoragePromise.setItem("auth-token",n.token);case 23:case"end":return t.stop()}}),t,this)})))}},{key:"_doLogin",value:function(e,t,n){return i(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.DataManager.send("user/login",{email:e,password:t});case 2:if(!(i=r.sent).success){r.next=14;break}return o.DataManager.setHeader("Authorization","Bearer "+i.token),sessionStorage.setItem("auth-token",i.token),r.next=8,this._doGetMe();case 8:if(!n){r.next=11;break}return r.next=11,o.NativeStoragePromise.setItem("auth-token",i.token);case 11:return r.abrupt("return",!0);case 14:return o.DataManager.setHeader("Authorization",""),sessionStorage.setItem("auth-token",""),r.next=18,o.NativeStoragePromise.setItem("auth-token","");case 18:return r.next=20,new o.Toast(i.message).show();case 20:return r.abrupt("return",!1);case 21:case"end":return r.stop()}}),r,this)})))}},{key:"_doLogout",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.DataManager.setHeader("Authorization",""),sessionStorage.setItem("auth-token",""),e.next=4,o.NativeStoragePromise.setItem("auth-token","");case 4:return e.next=6,this._doGetMe();case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"_doRegister",value:function(e,t,n){return i(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.DataManager.send("user/register",{email:e,username:t,password:n});case 2:if(!(i=r.sent).success){r.next=11;break}return o.DataManager.setHeader("Authorization","Bearer "+i.token),sessionStorage.setItem("auth-token",i.token),r.next=8,this._doGetMe();case 8:return r.abrupt("return",!0);case 11:return o.DataManager.setHeader("Authorization",""),sessionStorage.setItem("auth-token",""),r.next=15,o.NativeStoragePromise.setItem("auth-token","");case 15:return r.next=17,new o.Toast(i.message).show();case 17:return r.abrupt("return",!1);case 18:case"end":return r.stop()}}),r,this)})))}},{key:"_updateAccessClasses",value:function(){document.body.classList.forEach((function(t){t.startsWith(e.ACCESS_CLASS_PREFIX)&&document.body.classList.remove(t)})),this._userData.accesses.forEach((function(t){document.body.classList.add(e.ACCESS_CLASS_PREFIX+t)}))}},{key:"hasOfflineAccess",value:function(t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isOnline()){n.next=2;break}return n.abrupt("return",!1);case 2:return n.t0=o.Helper,n.next=5,o.NativeStoragePromise.getItem("user-data");case 5:return n.t1=n.sent,n.t2={accesses:e.OFFLINE_ACCESSES},r=n.t0.nonNull.call(n.t0,n.t1,n.t2),n.abrupt("return",-1!==r.accesses.indexOf(t));case 9:case"end":return n.stop()}}),n,this)})))}},{key:"sendForgotPasswordEmail",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.DataManager.send("user/forgotPW",{email:e});case 2:return n=t.sent,t.abrupt("return",n.success);case 4:case"end":return t.stop()}}),t)})))}},{key:"resetPassword",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.DataManager.send("user/forgotPW/2",{token:e,password:t});case 2:return r=n.sent,n.abrupt("return",r.success);case 4:case"end":return n.stop()}}),n)})))}},{key:"isOnline",value:function(){return this._userData.online}},{key:"isLoggedIn",value:function(){return this._userData.loggedIn}}])&&r(t.prototype,n),s&&r(t,s),e}();t.UserManager=s,s.ACCESS_CLASS_PREFIX="access-",s.OFFLINE_ACCESSES=["offline"]},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="QueryRunnerAlreadyReleasedError",Object.setPrototypeOf(n,t.prototype),n.message="Query runner already released. Cannot run queries anymore.",n}return Object(r.c)(t,e),t}(Error)},function(e,t,n){e.exports=!n(18)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(19),i=n(214),o=n(91),a=Object.defineProperty;t.f=n(36)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;var o=n(22),a=n(253),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._resolver={resolve:null,reject:null},this._readyPromise=new Promise((function(e){return document.addEventListener("deviceready",e,!1)})),this._deepLinks={},this._siteManager=a.SiteManager.getInstance()}var t,n,s;return t=e,s=[{key:"setLogo",value:function(e){this._logo=e}},{key:"getLogo",value:function(){return this._logo}},{key:"addInitialization",value:function(t){if("function"==typeof t){var n=t;t=e._mainPromise.then((function(e){return n(e)}))}e._promises.push(t)}},{key:"_getStartParams",value:function(){return Object.assign(e._extractParams(window.location.search.substr(1)),e._startParams)}},{key:"_extractParams",value:function(e){if(o.Helper.isNull(e))return null;for(var t={},n=[],r=e.split("&"),i=0;i<r.length;i++)(n=r[i].split("="))[0].trim().length>0&&(t[n[0]]=decodeURIComponent(n[1]));return t}},{key:"setStartParam",value:function(e,t){this._startParams[e]=t}}],(n=[{key:"addDeepLink",value:function(e,t){this._deepLinks[e]=t}},{key:"startSite",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this._siteManager){n.next=2;break}return n.abrupt("return",this._siteManager.startSite(e,t));case 2:case"end":return n.stop()}}),n,this)})))}},{key:"start",value:function(t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.ready();case 2:r=t,i=e._getStartParams(),this.startingSite=r,this.startingSiteParameters=i,o.Helper.isNotNull(i.s)&&(t=o.Helper.nonNull(this._deepLinks[i.s],t),delete i.s),this.startingSiteParameters=null,(a=this._siteManager).init("site",this._deepLinks),o.Helper.removeAllChildren(document.getElementById("site")),a.startSite(t,i),a.setAppEndedListener((function(e){e.startSite(r)}));case 13:case"end":return n.stop()}}),n,this)})))}},{key:"startStartingSite",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.startingSite){e.next=2;break}return e.abrupt("return",this.startSite(this.startingSite,this.startingSiteParameters));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"ready",value:function(t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this._readyPromise.then((function(){return e._resolver.resolve(i),Promise.all(e._promises)})),!t){n.next=5;break}return n.abrupt("return",r.then(t));case 5:return n.abrupt("return",r);case 6:case"end":return n.stop()}}),n,this)})))}}])&&r(t.prototype,n),s&&r(t,s),e}();t.App=s,s._promises=[],s._resolver={resolve:null,reject:null},s._mainPromise=new Promise((function(e,t){s._resolver={resolve:e,reject:t}})),s._startParams={}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EasySyncBaseModel=void 0;var f=n(4),h=n(7),EasySyncBaseModel=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(EasySyncBaseModel,e);var t,n,r,c=s(EasySyncBaseModel);function EasySyncBaseModel(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EasySyncBaseModel),(e=c.call(this))._delegate=null,e.createdAt=new Date,e.updatedAt=new Date,e.version=1,e.deleted=!1,e}return t=EasySyncBaseModel,r=[{key:"getColumnDefinitions",value:function(){var e=o(u(EasySyncBaseModel),"getColumnDefinitions",this).call(this);return e.createdAt={type:f.BaseDatabase.TYPES.DATE},e.updatedAt={type:f.BaseDatabase.TYPES.DATE},e.version={type:f.BaseDatabase.TYPES.INTEGER},e.deleted={type:f.BaseDatabase.TYPES.BOOLEAN},e}},{key:"_fromJson",value:function(e,t,n){return l(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,o,a,s=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=t||[],(i=Array.isArray(e))||(e=[e]),Array.isArray(t)||(t=[t]),o=[],a=[],e.forEach((function(e,r){a.push(new Promise((function(i){return l(s,void 0,void 0,regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s=null,!(t.length>r)){a.next=5;break}s=t[r],a.next=9;break;case 5:if(!h.Helper.isNotNull(e.id)){a.next=9;break}return a.next=8,this.findById(e.id,this.getRelations());case 8:s=a.sent;case 9:null===s&&(s=new this),e.version||0===e.version||(e.version=1),t[r]=Object.assign(s,e),this._handleColumns(t[r]),this._handleRelations(t[r],n,o),i();case 15:case"end":return a.stop()}}),a,this)})))})))})),r.next=9,Promise.all(a);case 9:return r.next=11,Promise.all(o);case 11:return i||(t=t.length>0?t[0]:null),r.abrupt("return",t);case 13:case"end":return r.stop()}}),r)})))}},{key:"_handleRelations",value:function(e,t,n){var r=this.getRelationDefinitions();Object.keys(r).forEach((function(i){var o=e[i];if("number"==typeof o||Array.isArray(o)&&o.length>=1&&"number"==typeof o[0])if(!0===t){var a=null;a=Array.isArray(o)?f.BaseDatabase.getModel(r[i].target).findByIds(o):f.BaseDatabase.getModel(r[i].target).findById(o),n.push(a.then((function(t){e[i]=t})))}else!1===t&&("many-to-many"===r[i].type||"one-to-many"===r[i].type?e[i]=[]:e[i]=null)}))}},{key:"_handleColumns",value:function(e){var t=this.getSchemaDefinition().columns;Object.keys(t).forEach((function(n){t[n].escapeHTML&&(e[n]=h.XSSHelper.escapeHTML(e[n])),t[n].escapeJS&&(e[n]=h.XSSHelper.escapeJS(e[n])),t[n].type!==f.BaseDatabase.TYPES.DATE||e[n]instanceof Date||h.Helper.isNull(e[n])||(e[n]=new Date(e[n]))}))}},{key:"prepareSync",value:function(e){return e}}],(n=[{key:"toJSON",value:function(e){var t=this,n=this.constructor.getRelationDefinitions(),r=this.constructor.getColumnDefinitions(),i={};return Object.keys(r).forEach((function(e){i[e]=t[e]})),Object.keys(n).forEach((function(n){if(!0===e)i[n]=t[n];else if(Array.isArray(t[n])){var r=[];t[n].forEach((function(e){return e&&r.push(e.id)})),i[n]=r}else t[n]instanceof f.BaseModel?i[n]=t[n].id:i[n]=null})),i}}])&&i(t.prototype,n),r&&i(t,r),EasySyncBaseModel}(f.BaseModel);t.EasySyncBaseModel=EasySyncBaseModel,EasySyncBaseModel.delegateClass=null,EasySyncBaseModel.CAN_BE_SYNCED=!0},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(){function e(e){this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames}return e.prototype.clone=function(){return new e({name:this.name,columnNames:Object(r.f)([],Object(r.e)(this.columnNames))})},e.create=function(t){return new e({name:t.name,columnNames:t.columns.map((function(e){return e.databaseName}))})},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(9),o=n(1),a=n(14),s=n(71),c=function(){function e(e){this.length="",this.isPrimary=!1,this.isGenerated=!1,this.isNullable=!1,this.isSelect=!0,this.isInsert=!0,this.isUpdate=!0,this.zerofill=!1,this.unsigned=!1,this.isArray=!1,this.isVirtual=!1,this.isDiscriminator=!1,this.isTreeLevel=!1,this.isCreateDate=!1,this.isUpdateDate=!1,this.isDeleteDate=!1,this.isVersion=!1,this.isObjectId=!1,this.isNestedSetLeft=!1,this.isNestedSetRight=!1,this.isMaterializedPath=!1,this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.referencedColumn=e.referencedColumn,e.args.target&&(this.target=e.args.target),e.args.propertyName&&(this.propertyName=e.args.propertyName),e.args.options.name&&(this.givenDatabaseName=e.args.options.name),e.args.options.type&&(this.type=e.args.options.type),e.args.options.length&&(this.length=e.args.options.length?e.args.options.length.toString():""),e.args.options.width&&(this.width=e.args.options.width),e.args.options.charset&&(this.charset=e.args.options.charset),e.args.options.collation&&(this.collation=e.args.options.collation),e.args.options.primary&&(this.isPrimary=e.args.options.primary),null===e.args.options.default&&(this.isNullable=!0),void 0!==e.args.options.nullable&&(this.isNullable=e.args.options.nullable),void 0!==e.args.options.select&&(this.isSelect=e.args.options.select),void 0!==e.args.options.insert&&(this.isInsert=e.args.options.insert),void 0!==e.args.options.update&&(this.isUpdate=e.args.options.update),void 0!==e.args.options.readonly&&(this.isUpdate=!e.args.options.readonly),e.args.options.comment&&(this.comment=e.args.options.comment),void 0!==e.args.options.default&&(this.default=e.args.options.default),e.args.options.onUpdate&&(this.onUpdate=e.args.options.onUpdate),null!==e.args.options.scale&&void 0!==e.args.options.scale&&(this.scale=e.args.options.scale),e.args.options.zerofill&&(this.zerofill=e.args.options.zerofill,this.unsigned=!0),e.args.options.unsigned&&(this.unsigned=e.args.options.unsigned),null!==e.args.options.precision&&(this.precision=e.args.options.precision),e.args.options.enum&&(e.args.options.enum instanceof Object&&!Array.isArray(e.args.options.enum)?this.enum=Object.keys(e.args.options.enum).filter((function(t){return isNaN(+t)&&"function"!=typeof e.args.options.enum[t]})).map((function(t){return e.args.options.enum[t]})):this.enum=e.args.options.enum),e.args.options.enumName&&(this.enumName=e.args.options.enumName),e.args.options.asExpression&&(this.asExpression=e.args.options.asExpression,this.generatedType=e.args.options.generatedType?e.args.options.generatedType:"VIRTUAL"),e.args.options.hstoreType&&(this.hstoreType=e.args.options.hstoreType),e.args.options.array&&(this.isArray=e.args.options.array),e.args.mode&&(this.isVirtual="virtual"===e.args.mode,this.isTreeLevel="treeLevel"===e.args.mode,this.isCreateDate="createDate"===e.args.mode,this.isUpdateDate="updateDate"===e.args.mode,this.isDeleteDate="deleteDate"===e.args.mode,this.isVersion="version"===e.args.mode,this.isObjectId="objectId"===e.args.mode),e.args.options.transformer&&(this.transformer=e.args.options.transformer),e.args.options.spatialFeatureType&&(this.spatialFeatureType=e.args.options.spatialFeatureType),void 0!==e.args.options.srid&&(this.srid=e.args.options.srid),this.isTreeLevel&&(this.type=e.connection.driver.mappedDataTypes.treeLevel),this.isCreateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.createDate),this.default||(this.default=function(){return e.connection.driver.mappedDataTypes.createDateDefault}),void 0===this.precision&&void 0===e.args.options.precision&&e.connection.driver.mappedDataTypes.createDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.createDatePrecision)),this.isUpdateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.updateDate),this.default||(this.default=function(){return e.connection.driver.mappedDataTypes.updateDateDefault}),this.onUpdate||(this.onUpdate=e.connection.driver.mappedDataTypes.updateDateDefault),void 0===this.precision&&void 0===e.args.options.precision&&e.connection.driver.mappedDataTypes.updateDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.updateDatePrecision)),this.isDeleteDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.deleteDate),this.isNullable||(this.isNullable=e.connection.driver.mappedDataTypes.deleteDateNullable),void 0===this.precision&&void 0===e.args.options.precision&&e.connection.driver.mappedDataTypes.deleteDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.deleteDatePrecision)),this.isVersion&&(this.type=e.connection.driver.mappedDataTypes.version),e.closureType&&(this.closureType=e.closureType),e.nestedSetLeft&&(this.isNestedSetLeft=e.nestedSetLeft),e.nestedSetRight&&(this.isNestedSetRight=e.nestedSetRight),e.materializedPath&&(this.isMaterializedPath=e.materializedPath)}return e.prototype.createValueMap=function(e,t){var n,i=this;if(void 0===t&&(t=!1),this.embeddedMetadata){var o=Object(r.f)([],Object(r.e)(this.embeddedMetadata.parentPropertyNames)),a=function(n,r){var o=n.shift();return o?(r[o]={},a(n,r[o]),r):("increment"!==i.generationStrategy&&"rowid"!==i.generationStrategy||"bigint"!==i.type||null===e||(e=String(e)),r[t?i.databaseName:i.propertyName]=e,r)};return a(o,{})}return"increment"!==this.generationStrategy&&"rowid"!==this.generationStrategy||"bigint"!==this.type||null===e||(e=String(e)),(n={})[t?this.databaseName:this.propertyName]=e,n},e.prototype.getEntityValueMap=function(e,t){var n,o,a=this;if(this.embeddedMetadata){var s=Object(r.f)([],Object(r.e)(this.embeddedMetadata.parentPropertyNames)),c=function(e,t,n){var r=e.shift();if(void 0===t)return n;if(r){var i={};return c(e,t[r],i),Object.keys(i).length>0&&(n[r]=i),n}return void 0!==t[a.propertyName]&&(n[a.propertyName]=t[a.propertyName]),n};return c(s,e,u={}),Object.keys(u).length>0?u:void 0}if(this.relationMetadata&&e[this.relationMetadata.propertyName]&&e[this.relationMetadata.propertyName]instanceof Object){var u=this.relationMetadata.joinColumns.reduce((function(t,n){var r=n.referencedColumn.getEntityValueMap(e[a.relationMetadata.propertyName]);return void 0===r?t:i.a.mergeDeep(t,r)}),{});return Object.keys(u).length>0?((n={})[this.propertyName]=u,n):void 0}return void 0!==e[this.propertyName]?((o={})[this.propertyName]=e[this.propertyName],o):void 0},e.prototype.getEntityValue=function(e,t){if(void 0===t&&(t=!1),null!=e){var n=void 0;if(this.embeddedMetadata){var i=Object(r.f)([],Object(r.e)(this.embeddedMetadata.parentPropertyNames)),o=function(e,t){var n=e.shift();return n&&t?o(e,t[n]):t},c=o(i,e);if(c)if(this.relationMetadata&&this.referencedColumn)n=(u=this.relationMetadata.getEntityValue(c))&&u instanceof Object&&!(u instanceof a.a)?this.referencedColumn.getEntityValue(u):c[this.propertyName]&&c[this.propertyName]instanceof Object&&!(c[this.propertyName]instanceof a.a)?this.referencedColumn.getEntityValue(c[this.propertyName]):c[this.propertyName];else n=this.referencedColumn?this.referencedColumn.getEntityValue(c[this.propertyName]):c[this.propertyName]}else{var u;if(this.relationMetadata&&this.referencedColumn)n=!((u=this.relationMetadata.getEntityValue(e))&&u instanceof Object)||u instanceof a.a||u instanceof Function?!(e[this.propertyName]&&e[this.propertyName]instanceof Object)||e[this.propertyName]instanceof a.a||e[this.propertyName]instanceof Function?e[this.propertyName]:this.referencedColumn.getEntityValue(e[this.propertyName]):this.referencedColumn.getEntityValue(u);else n=this.referencedColumn?this.referencedColumn.getEntityValue(e[this.propertyName]):e[this.propertyName]}return t&&this.transformer&&(n=s.a.transformTo(this.transformer,n)),n}},e.prototype.setEntityValue=function(e,t){var n=this;if(this.embeddedMetadata){var i=function(e,r){var o=e.shift();return o?(r[o.propertyName]||(r[o.propertyName]=o.create()),i(e,r[o.propertyName]),r):(r[n.propertyName]=t,r)};return i(Object(r.f)([],Object(r.e)(this.embeddedMetadata.embeddedMetadataTree)),e)}!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName?(this.propertyName in e||(e[this.propertyName]={}),e[this.propertyName][this.referencedColumn.propertyName]=t):e[this.propertyName]=t},e.prototype.build=function(e){return this.propertyPath=this.buildPropertyPath(),this.propertyAliasName=this.propertyPath.replace(".","_"),this.databaseName=this.buildDatabaseName(e),this.databasePath=this.buildDatabasePath(),this.databaseNameWithoutPrefixes=e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,[]),this},e.prototype.buildPropertyPath=function(){var e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.propertyName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName&&(e+="."+this.referencedColumn.propertyName),e},e.prototype.buildDatabasePath=function(){var e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.databaseName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.databaseName!==this.databaseName&&(e+="."+this.referencedColumn.databaseName),e},e.prototype.buildDatabaseName=function(e){var t=this.embeddedMetadata?this.embeddedMetadata.parentPrefixes:[];return e.driver instanceof o.e&&(t=[]),e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,t)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonHelper=void 0;const r=n(5);class i{static deepEqual(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e instanceof Array&&t instanceof Array&&e.length===t.length)return e.every(((e,n)=>i.deepEqual(e,t[n])));if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if("object"==typeof e&&"object"==typeof t){let n=Object.keys(e),o=Object.keys(t);return n.length===o.length&&n.every((n=>r.Helper.isNotNull(t[n])&&i.deepEqual(e[n],t[n])))}return!1}static deepCopy(e){let t;if(r.Helper.isNull(e)||"object"!=typeof e)return e;if(e instanceof Array){let n=[];for(t=0;t<e.length;++t)n[t]=i.deepCopy(e[t]);return n}if(e instanceof Date)return new Date(e.getTime());let n={};for(t in e)n[t]=i.deepCopy(e[t]);return n}static deepAssign(...e){if(e.length>0&&Array.isArray(e)){const t=[];return e.forEach((e=>t.push(...e))),t}const t={};return e.forEach((e=>{for(let n in e)t[n]&&"object"==typeof e[n]&&"object"==typeof t[n]?t[n]=i.deepAssign(t[n],e[n]):t[n]=e[n]})),t}static getDiff(e,t){const n={changed:{},added:{},removed:[]};if(!("object"==typeof e&&"object"==typeof t||Array.isArray(e)||Array.isArray(t)))return e===t?null:{value:t};let r=!1,o=!1,a=!1;for(let a in e)if(a in t){const o=i.getDiff(e[a],t[a]);null!==o&&(n.changed[a]=o,r=!0)}else n.removed.push(a),o=!0;for(let r in t)r in e||(n.added[r]=t[r],a=!0);return o||a||r?n:null}static applyDiff(e,t){return Array.isArray(t.removed),Object.keys(t.changed).forEach((n=>{"value"in t.changed[n]?e[n]=t.changed[n].value:e[n]=i.applyDiff(e[n],t.changed[n])})),Object.keys(t.added).forEach((n=>e[n]=t.added[n])),Array.isArray(e)?t.removed.sort(((e,t)=>parseInt(t)-parseInt(e))).forEach((t=>{e.splice(parseInt(t),1)})):t.removed.forEach((t=>delete e[t])),e}}t.JsonHelper=i},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.ViewInflater=void 0;var i=n(85),o=n(7),a=n(63),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingPromises={}}var t,n,s;return t=e,s=[{key:"getInstance",value:function(){return o.Helper.isNull(e.instance)&&(e.instance=new e),e.instance}},{key:"inflateElementsFromString",value:function(e){var t=document.createElement("template");return t.innerHTML=e,t.content.childNodes}},{key:"createLoadingSymbol",value:function(e){var t="http://www.w3.org/2000/svg",n=document.createElement("div");n.classList.add("loader"),e&&n.classList.add(e);var r=document.createElementNS(t,"svg");r.setAttribute("viewBox","0 0 32 32"),r.setAttribute("width","32"),r.setAttribute("height","32");var i=document.createElementNS(t,"circle");return i.setAttribute("class","spinner"),i.setAttribute("cx","16"),i.setAttribute("cy","16"),i.setAttribute("r","14"),i.setAttribute("fill","none"),r.appendChild(i),n.appendChild(r),n}},{key:"moveChildren",value:function(e,t){return i.ViewHelper.moveChildren(e,t)}},{key:"replaceWithChildren",value:function(e){var t=[];e.childNodes.forEach((function(e){t.push(e)}));var n=e.parentElement;t.forEach((function(t){e.removeChild(t),n.insertBefore(t,e)})),e.remove()}}],(n=[{key:"load",value:function(t,n){var r=this;if(-1!==(n=o.JsonHelper.deepCopy(o.Helper.nonNull(n,[]))).indexOf(t))return Promise.reject("views are in a circuit! cannot resolve view for url "+n[0]+"! url "+t+" is in stack before!");if(n.push(t),o.Helper.isNotNull(this.loadingPromises[t]))return this.loadingPromises[t].then((function(e){return e.cloneNode(!0)}));var i=Promise.resolve(void 0);return i=t instanceof Element?Promise.resolve(t):a.DataManager.loadAsset(t).then((function(t){var n=(new DOMParser).parseFromString(t,"text/html");o.Helper.isNull(n)&&((n=document.implementation.createHTMLDocument("")).body.innerHTML=t);var r=document.createElement("span");return r.classList.add("injected-span"),e.moveChildren(n.body,r)})),this.loadingPromises[t]=i.then((function(t){var r=[];return t.querySelectorAll("[data-view]").forEach((function(t){r.push(e.getInstance().load(t.dataset.view,n).then((function(n){t.replaceWith(n),e.replaceWithChildren(n)})))})),Promise.all(r).then((function(){return t}))})).catch((function(e){throw console.error(e),r.loadingPromises[t]=null,e})),this.loadingPromises[t].then((function(e){return e.cloneNode(!0)}))}}])&&r(t.prototype,n),s&&r(t,s),e}();t.ViewInflater=s,s.instance=null},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1),o=n(156),a=n(9),s=n(66),c=function(){function e(e){this.childEntityMetadatas=[],this.inheritanceTree=[],this.tableType="regular",this.withoutRowid=!1,this.synchronize=!0,this.hasNonNullableRelations=!1,this.isJunction=!1,this.isClosureJunction=!1,this.hasMultiplePrimaryKeys=!1,this.hasUUIDGeneratedColumns=!1,this.ownColumns=[],this.columns=[],this.ancestorColumns=[],this.descendantColumns=[],this.nonVirtualColumns=[],this.ownerColumns=[],this.inverseColumns=[],this.generatedColumns=[],this.primaryColumns=[],this.ownRelations=[],this.relations=[],this.eagerRelations=[],this.lazyRelations=[],this.oneToOneRelations=[],this.ownerOneToOneRelations=[],this.oneToManyRelations=[],this.manyToOneRelations=[],this.manyToManyRelations=[],this.ownerManyToManyRelations=[],this.relationsWithJoinColumns=[],this.relationIds=[],this.relationCounts=[],this.foreignKeys=[],this.embeddeds=[],this.allEmbeddeds=[],this.ownIndices=[],this.indices=[],this.uniques=[],this.ownUniques=[],this.checks=[],this.exclusions=[],this.ownListeners=[],this.listeners=[],this.afterLoadListeners=[],this.beforeInsertListeners=[],this.afterInsertListeners=[],this.beforeUpdateListeners=[],this.afterUpdateListeners=[],this.beforeRemoveListeners=[],this.afterRemoveListeners=[],this.connection=e.connection,this.inheritanceTree=e.inheritanceTree||[],this.inheritancePattern=e.inheritancePattern,this.treeType=e.tableTree?e.tableTree.type:void 0,this.treeOptions=e.tableTree?e.tableTree.options:void 0,this.parentClosureEntityMetadata=e.parentClosureEntityMetadata,this.tableMetadataArgs=e.args,this.target=this.tableMetadataArgs.target,this.tableType=this.tableMetadataArgs.type,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=this.tableMetadataArgs.withoutRowid}return e.prototype.create=function(e){var t,n=this;if(this.target instanceof Function)return t=new this.target,this.lazyRelations.forEach((function(r){return n.connection.relationLoader.enableLazyLoad(r,t,e)})),t;var r={};return this.lazyRelations.forEach((function(t){return n.connection.relationLoader.enableLazyLoad(t,r,e)})),r},e.prototype.hasId=function(e){return!!e&&this.primaryColumns.every((function(t){var n=t.getEntityValue(e);return null!=n&&""!==n}))},e.prototype.hasAllPrimaryKeys=function(e){return this.primaryColumns.every((function(t){var n=t.getEntityValue(e);return null!=n}))},e.prototype.ensureEntityIdMap=function(e){if(e instanceof Object)return e;if(this.hasMultiplePrimaryKeys)throw new o.a(this,e);return this.primaryColumns[0].createValueMap(e)},e.prototype.getEntityIdMap=function(t){if(t)return e.getValueMap(t,this.primaryColumns,{skipNulls:!0})},e.prototype.getEntityIdMixedMap=function(e){if(!e)return e;var t=this.getEntityIdMap(e);return this.hasMultiplePrimaryKeys?t:t?this.primaryColumns[0].getEntityValue(t):t},e.prototype.compareEntities=function(e,t){var n=this.getEntityIdMap(e);if(!n)return!1;var r=this.getEntityIdMap(t);return!!r&&a.a.compareIds(n,r)},e.prototype.findColumnWithPropertyName=function(e){return this.columns.find((function(t){return t.propertyName===e}))},e.prototype.findColumnWithDatabaseName=function(e){return this.columns.find((function(t){return t.databaseName===e}))},e.prototype.findColumnWithPropertyPath=function(e){var t=this.columns.find((function(t){return t.propertyPath===e}));if(t)return t;var n=this.relations.find((function(t){return t.propertyPath===e}));return n&&1===n.joinColumns.length?n.joinColumns[0]:void 0},e.prototype.findColumnsWithPropertyPath=function(e){var t=this.columns.find((function(t){return t.propertyPath===e}));if(t)return[t];var n=this.relations.find((function(t){return t.propertyPath===e}));return n&&n.joinColumns?n.joinColumns:[]},e.prototype.findRelationWithPropertyPath=function(e){return this.relations.find((function(t){return t.propertyPath===e}))},e.prototype.hasEmbeddedWithPropertyPath=function(e){return this.allEmbeddeds.some((function(t){return t.propertyPath===e}))},e.prototype.findEmbeddedWithPropertyPath=function(e){return this.allEmbeddeds.find((function(t){return t.propertyPath===e}))},e.prototype.extractRelationValuesFromEntity=function(e,t){var n=this,r=[];return t.forEach((function(t){var i=t.getEntityValue(e);Array.isArray(i)?i.forEach((function(e){return r.push([t,e,n.getInverseEntityMetadata(e,t)])})):i&&r.push([t,i,n.getInverseEntityMetadata(i,t)])})),r},e.prototype.getInverseEntityMetadata=function(e,t){var n=t.inverseEntityMetadata.childEntityMetadatas.find((function(t){return t.target===e.constructor}));return n||t.inverseEntityMetadata},e.createPropertyPath=function(e,t,n){var i=this;void 0===n&&(n="");var o=[];return Object.keys(t).forEach((function(a){var s=n?n+"."+a:a;if(e.hasEmbeddedWithPropertyPath(s)){var c=i.createPropertyPath(e,t[a],s);o.push.apply(o,Object(r.f)([],Object(r.e)(c)))}else{var u=n?n+"."+a:a;o.push(u)}})),o},e.difference=function(e,t){return e.filter((function(e){return!t.find((function(t){return a.a.compareIds(e,t)}))}))},e.getValueMap=function(e,t,n){return t.reduce((function(t,r){var i=r.getEntityValueMap(e,n);if(void 0!==t&&null!=i)return r.isObjectId?Object.assign(t,i):a.a.mergeDeep(t,i)}),{})},e.prototype.build=function(){var e=this.connection.namingStrategy,t=this.connection.options.entityPrefix;this.engine=this.tableMetadataArgs.engine,this.database="entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.parentEntityMetadata.database:this.tableMetadataArgs.database,this.tableMetadataArgs.schema?this.schema=this.tableMetadataArgs.schema:"entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.schema=this.parentEntityMetadata.schema:this.schema=this.connection.options.schema,this.givenTableName="entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.parentEntityMetadata.givenTableName:this.tableMetadataArgs.name,this.synchronize=!1!==this.tableMetadataArgs.synchronize,this.targetName=this.tableMetadataArgs.target instanceof Function?this.tableMetadataArgs.target.name:this.tableMetadataArgs.target,"closure-junction"===this.tableMetadataArgs.type?this.tableNameWithoutPrefix=e.closureJunctionTableName(this.givenTableName):"entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.tableNameWithoutPrefix=e.tableName(this.parentEntityMetadata.targetName,this.parentEntityMetadata.givenTableName):(this.tableNameWithoutPrefix=e.tableName(this.targetName,this.givenTableName),this.connection.driver.maxAliasLength&&this.connection.driver.maxAliasLength>0&&this.tableNameWithoutPrefix.length>this.connection.driver.maxAliasLength&&(this.tableNameWithoutPrefix=Object(s.c)(this.tableNameWithoutPrefix,{separator:"_",segmentLength:3}))),this.tableName=t?e.prefixTableName(t,this.tableNameWithoutPrefix):this.tableNameWithoutPrefix,this.target=this.target?this.target:this.tableName,this.name=this.targetName?this.targetName:this.tableName,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=!0===this.tableMetadataArgs.withoutRowid,this.tablePath=this.buildTablePath(),this.schemaPath=this.buildSchemaPath(),this.orderBy=this.tableMetadataArgs.orderBy instanceof Function?this.tableMetadataArgs.orderBy(this.propertiesMap):this.tableMetadataArgs.orderBy,this.isJunction="closure-junction"===this.tableMetadataArgs.type||"junction"===this.tableMetadataArgs.type,this.isClosureJunction="closure-junction"===this.tableMetadataArgs.type},e.prototype.registerColumn=function(e){-1===this.ownColumns.indexOf(e)&&(this.ownColumns.push(e),this.columns=this.embeddeds.reduce((function(e,t){return e.concat(t.columnsFromTree)}),this.ownColumns),this.primaryColumns=this.columns.filter((function(e){return e.isPrimary})),this.hasMultiplePrimaryKeys=this.primaryColumns.length>1,this.hasUUIDGeneratedColumns=this.columns.filter((function(e){return e.isGenerated||"uuid"===e.generationStrategy})).length>0,this.propertiesMap=this.createPropertiesMap(),this.childEntityMetadatas&&this.childEntityMetadatas.forEach((function(t){return t.registerColumn(e)})))},e.prototype.createPropertiesMap=function(){var e={};return this.columns.forEach((function(t){return a.a.mergeDeep(e,t.createValueMap(t.propertyPath))})),this.relations.forEach((function(t){return a.a.mergeDeep(e,t.createValueMap(t.propertyPath))})),e},e.prototype.buildTablePath=function(){var e=this.tableName;return this.schema&&(this.connection.driver instanceof i.j||this.connection.driver instanceof i.k||this.connection.driver instanceof i.m||this.connection.driver instanceof i.l)&&(e=this.schema+"."+e),!this.database||this.connection.driver instanceof i.k||(e=!this.schema&&this.connection.driver instanceof i.m?this.database+".."+e:this.database+"."+e),e},e.prototype.buildSchemaPath=function(){if(this.schema)return!this.database||this.connection.driver instanceof i.k?this.schema:this.database+"."+this.schema},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(30),o=function(e){function t(n,o,a){var s=e.call(this)||this;return Object.setPrototypeOf(s,t.prototype),s.message=a.toString().replace(/^error: /,"").replace(/^Error: /,"").replace(/^Request/,""),i.a.assign(s,Object(r.a)(Object(r.a)({},a),{name:"QueryFailedError",query:n,parameters:o||[]})),s}return Object(r.c)(t,e),t}(Error)},function(e,t,n){var r=n(88);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(n){var r=e.call(this)||this;return r.name="DriverOptionNotSetError",Object.setPrototypeOf(r,t.prototype),r.message="Driver option ("+n+") is not set. Please set it to perform connection to the database.",r}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(){function e(e){this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.isUnique=!!e.isUnique,this.isSpatial=!!e.isSpatial,this.isFulltext=!!e.isFulltext,this.parser=e.parser,this.where=e.where?e.where:""}return e.prototype.clone=function(){return new e({name:this.name,columnNames:Object(r.f)([],Object(r.e)(this.columnNames)),isUnique:this.isUnique,isSpatial:this.isSpatial,isFulltext:this.isFulltext,parser:this.parser,where:this.where})},e.create=function(t){return new e({name:t.name,columnNames:t.columns.map((function(e){return e.databaseName})),isUnique:t.isUnique,isSpatial:t.isSpatial,isFulltext:t.isFulltext,parser:t.parser,where:t.where})},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),i=n(30),o=function(){function e(e){i.a.assign(this,e||{})}return Object.defineProperty(e.prototype,"target",{get:function(){return this.metadata.target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasMetadata",{get:function(){return!!this._metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){if(!this._metadata)throw new Error('Cannot get entity metadata for the given alias "'+this.name+'"');return this._metadata},set:function(e){this._metadata=e},enumerable:!1,configurable:!0}),e}(),a=n(166),s=n(128),c=n(129),u=function(){function e(e){this.connection=e,this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.cache=!1,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={}}return Object.defineProperty(e.prototype,"allOrderBys",{get:function(){var e=this;if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&-1===this.options.indexOf("disable-global-order")){var t=this.mainAlias.metadata.orderBy||{};return Object.keys(t).reduce((function(n,r){return n[e.mainAlias.name+"."+r]=t[r],n}),{})}return this.orderBys},enumerable:!1,configurable:!0}),e.prototype.setMainAlias=function(e){return this.mainAlias=e,e},e.prototype.createAlias=function(e){var t=e.name;!t&&e.tablePath&&(t=e.tablePath),!t&&e.target instanceof Function&&(t=e.target.name),t||"string"!=typeof e.target||(t=e.target);var n=new o;return n.type=e.type,t&&(n.name=t),e.metadata&&(n.metadata=e.metadata),e.target&&!n.hasMetadata&&(n.metadata=this.connection.getMetadata(e.target)),e.tablePath&&(n.tablePath=e.tablePath),e.subQuery&&(n.subQuery=e.subQuery),this.aliases.push(n),n},e.prototype.findAliasByName=function(e){var t=this.aliases.find((function(t){return t.name===e}));if(!t)throw new Error('"'+e+'" alias was not found. Maybe you forgot to join it?');return t},e.prototype.findColumnByAliasExpression=function(e){var t=Object(r.e)(e.split("."),2),n=t[0],i=t[1];return this.findAliasByName(n).metadata.findColumnWithPropertyName(i)},Object.defineProperty(e.prototype,"relationMetadata",{get:function(){if(!this.mainAlias)throw new Error("Entity to work with is not specified!");var e=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new Error("Relation "+this.relationPropertyPath+" was not found in entity "+this.mainAlias.name);return e},enumerable:!1,configurable:!0}),e.prototype.clone=function(){var t=this,n=new e(this.connection);return n.queryType=this.queryType,n.selects=this.selects.map((function(e){return e})),n.maxExecutionTime=this.maxExecutionTime,n.selectDistinct=this.selectDistinct,n.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach((function(e){return n.aliases.push(new o(e))})),n.mainAlias=this.mainAlias,n.valuesSet=this.valuesSet,n.returning=this.returning,n.onConflict=this.onConflict,n.onIgnore=this.onIgnore,n.onUpdate=this.onUpdate,n.joinAttributes=this.joinAttributes.map((function(e){return new a.a(t.connection,t,e)})),n.relationIdAttributes=this.relationIdAttributes.map((function(e){return new s.a(t,e)})),n.relationCountAttributes=this.relationCountAttributes.map((function(e){return new c.a(t,e)})),n.wheres=this.wheres.map((function(e){return Object(r.a)({},e)})),n.havings=this.havings.map((function(e){return Object(r.a)({},e)})),n.orderBys=Object.assign({},this.orderBys),n.groupBys=this.groupBys.map((function(e){return e})),n.limit=this.limit,n.offset=this.offset,n.skip=this.skip,n.take=this.take,n.lockMode=this.lockMode,n.lockVersion=this.lockVersion,n.lockTables=this.lockTables,n.withDeleted=this.withDeleted,n.parameters=Object.assign({},this.parameters),n.disableEscaping=this.disableEscaping,n.enableRelationIdValues=this.enableRelationIdValues,n.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,n.subQuery=this.subQuery,n.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,n.cache=this.cache,n.cacheId=this.cacheId,n.cacheDuration=this.cacheDuration,n.relationPropertyPath=this.relationPropertyPath,n.of=this.of,n.insertColumns=this.insertColumns,n.whereEntities=this.whereEntities,n.updateEntity=this.updateEntity,n.callListeners=this.callListeners,n.useTransaction=this.useTransaction,n.nativeParameters=Object.assign({},this.nativeParameters),n.comment=this.comment,n},e}(),l=n(162),f=n(44),h=n(50),d=n(1),p=n(13),m=n(14),y=n(163),g=n(124),b=function(){function e(t,n){t instanceof e?(this.connection=t.connection,this.queryRunner=t.queryRunner,this.expressionMap=t.expressionMap.clone()):(this.connection=t,this.queryRunner=n,this.expressionMap=new u(this.connection))}return Object.defineProperty(e.prototype,"alias",{get:function(){if(!this.expressionMap.mainAlias)throw new Error("Main alias is not set");return this.expressionMap.mainAlias.name},enumerable:!1,configurable:!0}),e.prototype.select=function(e,t){this.expressionMap.queryType="select",Array.isArray(e)?this.expressionMap.selects=e.map((function(e){return{selection:e}})):e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);var r=n(127).SelectQueryBuilder;return this instanceof r?this:new r(this)},e.prototype.insert=function(){this.expressionMap.queryType="insert";var e=n(197).InsertQueryBuilder;return this instanceof e?this:new e(this)},e.prototype.update=function(e,t){var r=t||e;if((e=e instanceof p.EntitySchema?e.options.name:e)instanceof Function||"string"==typeof e){var i=this.createFromAlias(e);this.expressionMap.setMainAlias(i)}this.expressionMap.queryType="update",this.expressionMap.valuesSet=r;var o=n(198).UpdateQueryBuilder;return this instanceof o?this:new o(this)},e.prototype.delete=function(){this.expressionMap.queryType="delete";var e=n(199).DeleteQueryBuilder;return this instanceof e?this:new e(this)},e.prototype.softDelete=function(){this.expressionMap.queryType="soft-delete";var e=n(251).SoftDeleteQueryBuilder;return this instanceof e?this:new e(this)},e.prototype.restore=function(){this.expressionMap.queryType="restore";var e=n(251).SoftDeleteQueryBuilder;return this instanceof e?this:new e(this)},e.prototype.relation=function(e,t){var r=2===arguments.length?e:void 0,i=2===arguments.length?t:e;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=i,r){var o=this.createFromAlias(r);this.expressionMap.setMainAlias(o)}var a=n(210).RelationQueryBuilder;return this instanceof a?this:new a(this)},e.prototype.hasRelation=function(e,t){var n=this.connection.getMetadata(e);return(Array.isArray(t)?t:[t]).every((function(e){return!!n.findRelationWithPropertyPath(e)}))},e.prototype.setParameter=function(e,t){return this.expressionMap.parameters[e]=t,this},e.prototype.setParameters=function(e){var t=this;return Object.keys(e).forEach((function(t){if(e[t]instanceof Function)throw new Error("Function parameter isn't supported in the parameters. Please check \""+t+'" parameter.')})),this.expressionMap.parentQueryBuilder&&this.expressionMap.parentQueryBuilder.setParameters(e),Object.keys(e).forEach((function(n){return t.setParameter(n,e[n])})),this},e.prototype.setNativeParameters=function(e){var t=this;return this.expressionMap.parentQueryBuilder&&this.expressionMap.parentQueryBuilder.setNativeParameters(e),Object.keys(e).forEach((function(n){t.expressionMap.nativeParameters[n]=e[n]})),this},e.prototype.getParameters=function(){var e=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){var t=this.expressionMap.mainAlias.metadata;if(t.discriminatorColumn&&t.parentEntityMetadata){var n=t.childEntityMetadatas.filter((function(e){return e.discriminatorColumn})).map((function(e){return e.discriminatorValue}));n.push(t.discriminatorValue),e.discriminatorColumnValues=n}}return e},e.prototype.printSql=function(){var e=Object(r.e)(this.getQueryAndParameters(),2),t=e[0],n=e[1];return this.connection.logger.logQuery(t,n),this},e.prototype.getSql=function(){return this.getQueryAndParameters()[0]},e.prototype.getQueryAndParameters=function(){var e=this.getQuery(),t=this.getParameters();return this.connection.driver.escapeQueryWithParameters(e,t,this.expressionMap.nativeParameters)},e.prototype.execute=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i;return Object(r.d)(this,(function(o){switch(o.label){case 0:e=Object(r.e)(this.getQueryAndParameters(),2),t=e[0],n=e[1],i=this.obtainQueryRunner(),o.label=1;case 1:return o.trys.push([1,,3,8]),[4,i.query(t,n)];case 2:return[2,o.sent()];case 3:return i===this.queryRunner?[3,5]:[4,i.release()];case 4:o.sent(),o.label=5;case 5:return this.connection.driver instanceof h.a?[4,this.connection.driver.autoSave()]:[3,7];case 6:o.sent(),o.label=7;case 7:return[7];case 8:return[2]}}))}))},e.prototype.createQueryBuilder=function(){return new this.constructor(this.connection,this.queryRunner)},e.prototype.clone=function(){return new this.constructor(this)},e.prototype.comment=function(e){return this.expressionMap.comment=e,this},e.prototype.disableEscaping=function(){return this.expressionMap.disableEscaping=!1,this},e.prototype.escape=function(e){return this.expressionMap.disableEscaping?this.connection.driver.escape(e):e},e.prototype.setQueryRunner=function(e){return this.queryRunner=e,this},e.prototype.callListeners=function(e){return this.expressionMap.callListeners=e,this},e.prototype.useTransaction=function(e){return this.expressionMap.useTransaction=e,this},e.prototype.getTableName=function(e){var t=this;return e.split(".").map((function(e){return""===e?e:t.escape(e)})).join(".")},e.prototype.getMainTableName=function(){if(!this.expressionMap.mainAlias)throw new Error('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath},e.prototype.createFromAlias=function(e,t){if(this.connection.hasMetadata(e)){var n=this.connection.getMetadata(e);return this.expressionMap.createAlias({type:"from",name:t,metadata:this.connection.getMetadata(e),tablePath:n.tablePath})}if("string"==typeof e){var r="("===e.substr(0,1)&&")"===e.substr(-1);return this.expressionMap.createAlias({type:"from",name:t,tablePath:r?void 0:e,subQuery:r?e:void 0})}var i=e(this.subQuery());this.setParameters(i.getParameters());var o=i.getQuery();return this.expressionMap.createAlias({type:"from",name:t,subQuery:o})},e.prototype.replacePropertyNames=function(e){var t,n,i=this,o=function(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")},a=function(t){var n,a,c,u,l,f,h,d,p,m,y,g;if(!t.hasMetadata)return"continue";var b=s.expressionMap.aliasNamePrefixingEnabled?t.name+".":"",v=s.expressionMap.aliasNamePrefixingEnabled?s.escape(t.name)+".":"",w={};try{for(var _=(n=void 0,Object(r.g)(t.metadata.relations)),k=_.next();!k.done;k=_.next()){(T=k.value).joinColumns.length>0&&(w[T.propertyPath]=T.joinColumns[0].databaseName)}}catch(e){n={error:e}}finally{try{k&&!k.done&&(a=_.return)&&a.call(_)}finally{if(n)throw n.error}}try{for(var E=(c=void 0,Object(r.g)(t.metadata.relations)),O=E.next();!O.done;O=E.next()){var T=O.value;try{for(var x=(l=void 0,Object(r.g)(Object(r.f)(Object(r.f)([],Object(r.e)(T.joinColumns)),Object(r.e)(T.inverseJoinColumns)))),S=x.next();!S.done;S=x.next()){var C=S.value,R=T.propertyPath+"."+C.referencedColumn.propertyPath;w[R]=C.databaseName}}catch(e){l={error:e}}finally{try{S&&!S.done&&(f=x.return)&&f.call(x)}finally{if(l)throw l.error}}}}catch(e){c={error:e}}finally{try{O&&!O.done&&(u=E.return)&&u.call(E)}finally{if(c)throw c.error}}try{for(var P=(h=void 0,Object(r.g)(t.metadata.columns)),N=P.next();!N.done;N=P.next()){var M=N.value;w[M.databaseName]=M.databaseName}}catch(e){h={error:e}}finally{try{N&&!N.done&&(d=P.return)&&d.call(P)}finally{if(h)throw h.error}}try{for(var A=(p=void 0,Object(r.g)(t.metadata.columns)),j=A.next();!j.done;j=A.next()){M=j.value;w[M.propertyName]=M.databaseName}}catch(e){p={error:e}}finally{try{j&&!j.done&&(m=A.return)&&m.call(A)}finally{if(p)throw p.error}}try{for(var I=(y=void 0,Object(r.g)(t.metadata.columns)),D=I.next();!D.done;D=I.next()){M=D.value;w[M.propertyPath]=M.databaseName}}catch(e){y={error:e}}finally{try{D&&!D.done&&(g=I.return)&&g.call(I)}finally{if(y)throw y.error}}var L=Object.keys(w);L.length&&(e=e.replace(new RegExp("([ =(]|^.{0})"+o(b)+"("+L.map(o).join("|")+")(?=[ =),]|.{0}$)","gm"),(function(e,t,n){return""+t+v+i.escape(w[n])})))},s=this;try{for(var c=Object(r.g)(this.expressionMap.aliases),u=c.next();!u.done;u=c.next()){a(u.value)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return e},e.prototype.createComment=function(){return this.expressionMap.comment?"/* "+this.expressionMap.comment.replace("*/","")+" */ ":""},e.prototype.createWhereExpression=function(){var e=[];if(this.createWhereExpressionString().trim()&&e.push(this.createWhereExpressionString()),this.expressionMap.mainAlias.hasMetadata){var t=this.expressionMap.mainAlias.metadata;if("select"===this.expressionMap.queryType&&!this.expressionMap.withDeleted&&t.deleteDateColumn){var n=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+t.deleteDateColumn.propertyName:t.deleteDateColumn.propertyName,r=this.replacePropertyNames(n)+" IS NULL";e.push(r)}if(t.discriminatorColumn&&t.parentEntityMetadata){n=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+t.discriminatorColumn.databaseName:t.discriminatorColumn.databaseName,r=this.replacePropertyNames(n)+" IN (:...discriminatorColumnValues)";e.push(r)}}if(this.expressionMap.extraAppendedAndWhereCondition){r=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);e.push(r)}return e.length?1===e.length?" WHERE "+e[0]:" WHERE ( "+e.join(" ) AND ( ")+" )":""},e.prototype.createReturningExpression=function(){var e=this,t=this.getReturningColumns(),n=this.connection.driver;if("string"!=typeof this.expressionMap.returning&&this.expressionMap.extraReturningColumns.length>0&&n.isReturningSqlSupported()&&t.push.apply(t,Object(r.f)([],Object(r.e)(this.expressionMap.extraReturningColumns.filter((function(e){return-1===t.indexOf(e)}))))),t.length){var i=t.map((function(t){var r=e.escape(t.databaseName);return n instanceof d.m?"insert"===e.expressionMap.queryType||"update"===e.expressionMap.queryType||"soft-delete"===e.expressionMap.queryType||"restore"===e.expressionMap.queryType?"INSERTED."+r:e.escape(e.getMainTableName())+"."+r:r})).join(", ");return n instanceof d.j&&(i+=" INTO "+t.map((function(t){var r="output_"+t.databaseName;return e.expressionMap.nativeParameters[r]={type:n.columnTypeToNativeParameter(t.type),dir:n.oracle.BIND_OUT},e.connection.driver.createParameter(r,Object.keys(e.expressionMap.nativeParameters).length)})).join(", ")),n instanceof d.m&&("insert"!==this.expressionMap.queryType&&"update"!==this.expressionMap.queryType||(i+=" INTO @OutputTable")),i}return"string"==typeof this.expressionMap.returning?this.expressionMap.returning:""},e.prototype.getReturningColumns=function(){var e=this,t=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach((function(n){e.expressionMap.mainAlias.hasMetadata&&t.push.apply(t,Object(r.f)([],Object(r.e)(e.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n))))})),t},e.prototype.createWhereExpressionString=function(){var e=this;return this.expressionMap.wheres.map((function(t,n){switch(t.type){case"and":return(n>0?"AND ":"")+e.replacePropertyNames(t.condition);case"or":return(n>0?"OR ":"")+e.replacePropertyNames(t.condition);default:return e.replacePropertyNames(t.condition)}})).join(" ")},e.prototype.createWhereIdsExpression=function(e){var t,n=this,r=this.expressionMap.mainAlias.metadata,i=(Array.isArray(e)?e:[e]).map((function(e){return r.ensureEntityIdMap(e)}));if(!r.hasMultiplePrimaryKeys&&0===r.embeddeds.length){var o=r.primaryColumns[0];if(!o.transformer)return this.computeWhereParameter(((t={})[o.propertyName]=Object(y.a)(i.map((function(e){return o.getEntityValue(e,!1)}))),t))}var a=this.expressionMap.aliasNamePrefixingEnabled?this.escape(this.expressionMap.mainAlias.name)+".":"",s=Object.keys(this.expressionMap.nativeParameters).length,c=i.map((function(e,t){var i=[];return r.primaryColumns.forEach((function(r,o){var c="id_"+t+"_"+o;i.push(a+n.escape(r.databaseName)+" = "+n.connection.driver.createParameter(c,s)),n.expressionMap.nativeParameters[c]=r.getEntityValue(e,!0),s++})),i.join(" AND ")}));return c.length>1?"("+c.map((function(e){return"("+e+")"})).join(" OR ")+")":c[0]},e.prototype.computeWhereParameter=function(e){var t=this;if("string"==typeof e)return e;if(e instanceof l.a){var n=this.createQueryBuilder();n.expressionMap.mainAlias=this.expressionMap.mainAlias,n.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,n.expressionMap.nativeParameters=this.expressionMap.nativeParameters,e.whereFactory(n);var r=n.createWhereExpressionString();return this.setParameters(n.getParameters()),r?"("+r+")":""}if(e instanceof Function)return e(this);if(e instanceof Object){var i=Array.isArray(e)?e:[e],o=void 0,a=Object.keys(this.expressionMap.nativeParameters).length;return(o=this.expressionMap.mainAlias.hasMetadata?i.map((function(e,n){return f.a.createPropertyPath(t.expressionMap.mainAlias.metadata,e).map((function(r,i){var o=t.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(r);if(!o.length)throw new g.a(r);return o.map((function(o,s){var c=t.expressionMap.aliasNamePrefixingEnabled?t.alias+"."+r:o.propertyPath,u=o.getEntityValue(e,!0),l="where_"+n+"_"+i+"_"+s,f=Object.keys(t.expressionMap.nativeParameters).filter((function(e){return e.startsWith(l)})).length;if(null===u)return c+" IS NULL";if(u instanceof m.a){var h=[];if(u.useParameter)if(u.objectLiteralParameters)t.setParameters(u.objectLiteralParameters);else(u.multipleParameters?u.value:[u.value]).forEach((function(e,n){t.expressionMap.nativeParameters[l+(f+n)]=e,a++,h.push(t.connection.driver.createParameter(l+(f+n),a-1))}));return t.computeFindOperatorExpression(u,c,h)}return t.expressionMap.nativeParameters[l]=u,a++,c+" = "+t.connection.driver.createParameter(l,a-1)})).filter((function(e){return!!e})).join(" AND ")})).filter((function(e){return!!e})).join(" AND ")})):i.map((function(e,n){return Object.keys(e).map((function(r,i){var o=e[r],a=t.expressionMap.aliasNamePrefixingEnabled?t.alias+"."+r:r;if(null===o)return a+" IS NULL";var s="where_"+n+"_"+i;return t.expressionMap.nativeParameters[s]=o,i++,a+" = "+t.connection.driver.createParameter(s,i-1)})).join(" AND ")}))).length>1?o.map((function(e){return"("+e+")"})).join(" OR "):o.join("")}return""},e.prototype.computeFindOperatorExpression=function(e,t,n){var r=this.connection.driver;switch(e.type){case"not":return e.child?"NOT("+this.computeFindOperatorExpression(e.child,t,n)+")":t+" != "+n[0];case"lessThan":return t+" < "+n[0];case"lessThanOrEqual":return t+" <= "+n[0];case"moreThan":return t+" > "+n[0];case"moreThanOrEqual":return t+" >= "+n[0];case"equal":return t+" = "+n[0];case"ilike":return r instanceof d.k||r instanceof d.d?t+" ILIKE "+n[0]:"UPPER("+t+") LIKE UPPER("+n[0]+")";case"like":return t+" LIKE "+n[0];case"between":return t+" BETWEEN "+n[0]+" AND "+n[1];case"in":return 0===n.length?"0=1":t+" IN ("+n.join(", ")+")";case"any":return t+" = ANY("+n[0]+")";case"isNull":return t+" IS NULL";case"raw":return e.getSql?e.getSql(t):t+" = "+e.value}throw new TypeError("Unsupported FindOperator "+m.a.constructor.name)},e.prototype.obtainQueryRunner=function(){return this.queryRunner||this.connection.createQueryRunner()},e}()},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r=n(0),i=n(21),o=n(287),a=n(83),s=n(47),c=n(15),u=n(9),l=function(t){function n(e){var n=t.call(this,e)||this;if(n.options.autoSave&&!n.options.location&&!n.options.autoSaveCallback)throw new s.a("location or autoSaveCallback");return n.loadDependencies(),n}return Object(r.c)(n,t),n.prototype.connect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(t){switch(t.label){case 0:return e=this,[4,this.createDatabaseConnection()];case 1:return e.databaseConnection=t.sent(),[2]}}))}))},n.prototype.disconnect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){return[2,new Promise((function(t,n){try{e.queryRunner=void 0,e.databaseConnection.close(),t()}catch(e){n(e)}}))]}))}))},n.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new o.a(this)),this.queryRunner},n.prototype.load=function(e,t){return void 0===t&&(t=!0),Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:if("string"!=typeof e)return[3,8];if("node"!==c.a.type)return[3,1];if(c.a.fileExist(e))return n=c.a.readFileSync(e),[2,this.createDatabaseConnectionWithImport(n)];if(t)throw new Error("File "+e+" does not exist");return[2,this.createDatabaseConnectionWithImport()];case 1:return i=null,this.options.useLocalForage?window.localforage?[4,window.localforage.getItem(e)]:[3,3]:[3,5];case 2:return i=r.sent(),[3,4];case 3:throw new Error("localforage is not defined - please import localforage.js into your site");case 4:return[3,6];case 5:i=c.a.getGlobalVariable().localStorage.getItem(e),r.label=6;case 6:if(null!=i)return[2,this.createDatabaseConnectionWithImport(JSON.parse(i))];if(t)throw new Error("File "+e+" does not exist");return[2,this.createDatabaseConnectionWithImport()];case 7:return[3,9];case 8:return[2,this.createDatabaseConnectionWithImport(e)];case 9:return[2]}}))}))},n.prototype.save=function(t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(!t&&!this.options.location)throw new Error("No location is set, specify a location parameter or add the location option to your configuration");if(n="",t?n=t:this.options.location&&(n=this.options.location),"node"!==c.a.type)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),i=e.from(this.databaseConnection.export()),[4,c.a.writeFile(n,i)];case 2:return r.sent(),[3,4];case 3:throw o=r.sent(),new Error("Could not save database, error: "+o);case 4:return[3,10];case 5:return a=this.databaseConnection.export(),s=[].slice.call(a),this.options.useLocalForage?window.localforage?[4,window.localforage.setItem(n,JSON.stringify(s))]:[3,7]:[3,9];case 6:return r.sent(),[3,8];case 7:throw new Error("localforage is not defined - please import localforage.js into your site");case 8:return[3,10];case 9:c.a.getGlobalVariable().localStorage.setItem(n,JSON.stringify(s)),r.label=10;case 10:return[2]}}))}))},n.prototype.autoSave=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:return this.options.autoSave?this.options.autoSaveCallback?[4,this.options.autoSaveCallback(this.export())]:[3,2]:[3,4];case 1:return e.sent(),[3,4];case 2:return[4,this.save()];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))},n.prototype.export=function(){return this.databaseConnection.export()},n.prototype.createGeneratedMap=function(e,t){var n=this,r=e.generatedColumns.reduce((function(e,t){if(t.isPrimary&&"increment"===t.generationStrategy){var r="SELECT last_insert_rowid()";try{var i=n.databaseConnection.exec(r);return n.connection.logger.logQuery(r),u.a.mergeDeep(e,t.createValueMap(i[0].values[0][0]))}catch(e){n.connection.logger.logQueryError(e,r,[])}}return e}),{});return Object.keys(r).length>0?r:void 0},n.prototype.createDatabaseConnection=function(){return this.options.location?this.load(this.options.location,!1):this.createDatabaseConnectionWithImport(this.options.database)},n.prototype.createDatabaseConnectionWithImport=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return"function"==typeof this.sqlite.Database?(n=this.sqlite,[3,3]):[3,1];case 1:return[4,this.sqlite(this.options.sqlJsConfig)];case 2:n=r.sent(),r.label=3;case 3:return t=n,e&&e.length>0?this.databaseConnection=new t.Database(e):this.databaseConnection=new t.Database,[2,new Promise((function(e,t){try{i.databaseConnection.exec("PRAGMA foreign_keys = ON;"),e(i.databaseConnection)}catch(e){t(e)}}))]}}))}))},n.prototype.loadDependencies=function(){if("browser"===c.a.type)this.sqlite=window.SQL;else try{this.sqlite=c.a.load("sql.js")}catch(e){throw new a.a("sql.js","sql.js")}},n}(i.a)}).call(this,n(106).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e){this.queryRunner=e}return e.prototype.broadcastBeforeInsertEvent=function(e,t,n){var r=this;n&&t.beforeInsertListeners.length&&t.beforeInsertListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(i){if(r.isAllowedSubscriber(i,t.target)&&i.beforeInsert){var o=i.beforeInsert({connection:r.queryRunner.connection,queryRunner:r.queryRunner,manager:r.queryRunner.manager,entity:n,metadata:t});o instanceof Promise&&e.promises.push(o),e.count++}}))},e.prototype.broadcastBeforeUpdateEvent=function(e,t,n,r,i,o){var a=this;n&&t.beforeUpdateListeners.length&&t.beforeUpdateListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(s){if(a.isAllowedSubscriber(s,t.target)&&s.beforeUpdate){var c=s.beforeUpdate({connection:a.queryRunner.connection,queryRunner:a.queryRunner,manager:a.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,updatedColumns:i||[],updatedRelations:o||[]});c instanceof Promise&&e.promises.push(c),e.count++}}))},e.prototype.broadcastBeforeRemoveEvent=function(e,t,n,r){var i=this;n&&t.beforeRemoveListeners.length&&t.beforeRemoveListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(o){if(i.isAllowedSubscriber(o,t.target)&&o.beforeRemove){var a=o.beforeRemove({connection:i.queryRunner.connection,queryRunner:i.queryRunner,manager:i.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,entityId:t.getEntityIdMixedMap(r)});a instanceof Promise&&e.promises.push(a),e.count++}}))},e.prototype.broadcastAfterInsertEvent=function(e,t,n){var r=this;n&&t.afterInsertListeners.length&&t.afterInsertListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(i){if(r.isAllowedSubscriber(i,t.target)&&i.afterInsert){var o=i.afterInsert({connection:r.queryRunner.connection,queryRunner:r.queryRunner,manager:r.queryRunner.manager,entity:n,metadata:t});o instanceof Promise&&e.promises.push(o),e.count++}}))},e.prototype.broadcastBeforeTransactionStartEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.beforeTransactionStart){var r=n.beforeTransactionStart({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastAfterTransactionStartEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.afterTransactionStart){var r=n.afterTransactionStart({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastBeforeTransactionCommitEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.beforeTransactionCommit){var r=n.beforeTransactionCommit({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastAfterTransactionCommitEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.afterTransactionCommit){var r=n.afterTransactionCommit({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastBeforeTransactionRollbackEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.beforeTransactionRollback){var r=n.beforeTransactionRollback({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastAfterTransactionRollbackEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.afterTransactionRollback){var r=n.afterTransactionRollback({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastAfterUpdateEvent=function(e,t,n,r,i,o){var a=this;n&&t.afterUpdateListeners.length&&t.afterUpdateListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(s){if(a.isAllowedSubscriber(s,t.target)&&s.afterUpdate){var c=s.afterUpdate({connection:a.queryRunner.connection,queryRunner:a.queryRunner,manager:a.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,updatedColumns:i||[],updatedRelations:o||[]});c instanceof Promise&&e.promises.push(c),e.count++}}))},e.prototype.broadcastAfterRemoveEvent=function(e,t,n,r){var i=this;n&&t.afterRemoveListeners.length&&t.afterRemoveListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(o){if(i.isAllowedSubscriber(o,t.target)&&o.afterRemove){var a=o.afterRemove({connection:i.queryRunner.connection,queryRunner:i.queryRunner,manager:i.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,entityId:t.getEntityIdMixedMap(r)});a instanceof Promise&&e.promises.push(a),e.count++}}))},e.prototype.broadcastLoadEventsForAll=function(e,t,n){var r=this;n.forEach((function(n){n instanceof Promise||(t.relations.length&&t.relations.forEach((function(t){if(!t.isLazy||n.hasOwnProperty(t.propertyName)){var i=t.getEntityValue(n);i instanceof Object&&r.broadcastLoadEventsForAll(e,t.inverseEntityMetadata,Array.isArray(i)?i:[i])}})),t.afterLoadListeners.length&&t.afterLoadListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),r.queryRunner.connection.subscribers.length&&r.queryRunner.connection.subscribers.forEach((function(i){if(r.isAllowedSubscriber(i,t.target)&&i.afterLoad){var o=i.afterLoad(n,{connection:r.queryRunner.connection,queryRunner:r.queryRunner,manager:r.queryRunner.manager,entity:n,metadata:t});o instanceof Promise&&e.promises.push(o),e.count++}})))}))},e.prototype.isAllowedSubscriber=function(e,t){return!e.listenTo||!e.listenTo()||e.listenTo()===Object||e.listenTo()===t||e.listenTo().isPrototypeOf(t)},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(){function e(e){this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.expression=e.expression}return e.prototype.clone=function(){return new e({name:this.name,columnNames:this.columnNames?Object(r.f)([],Object(r.e)(this.columnNames)):[],expression:this.expression})},e.create=function(t){return new e({name:t.name,expression:t.expression})},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="TransactionNotStartedError",Object.setPrototypeOf(n,t.prototype),n.message="Transaction is not started yet, start transaction before committing or rolling it back.",n}return Object(r.c)(t,e),t}(Error)},function(e,t,n){var r=n(17),i=n(61),o=n(60),a=n(96)("src"),s=n(314),c="toString",u=(""+s).split(c);n(33).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var c="function"==typeof n;c&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(c&&(o(n,a)||i(n,a,e[t]?""+e[t]:u.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,c,(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,n){var r=n(6),i=n(18),o=n(88),a=/"/g,s=function(e,t,n,r){var i=String(o(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UserSite=void 0;var f=n(7),h=n(2),d=n(34),p=n(154),m=n(280),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(y,e);var t,n,r,c=s(y);function y(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(r=c.call(this,e))._access=t,r._allowOfflineAccess=f.Helper.nonNull(n,!1),r}return t=y,(n=[{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return o(u(y.prototype),"onConstruct",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.UserManager.getInstance().waitForGetMe();case 2:return t.next=4,this._checkRights();case 4:if(!t.sent){t.next=10;break}return t.next=7,n.onConstruct.call(this,e);case 7:return r=t.sent,d.UserManager.getInstance().addLoginChangeCallback((function(){return l(i,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._checkRights();case 2:case"end":return e.stop()}}),e,this)})))}),!1),t.abrupt("return",r);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"_checkRights",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=d.UserManager.getInstance().hasAccess(this._access),e.t0){e.next=8;break}if(e.t1=this._allowOfflineAccess,!e.t1){e.next=7;break}return e.next=6,d.UserManager.getInstance().hasOfflineAccess(this._access);case 6:e.t1=e.sent;case 7:e.t0=e.t1;case 8:if(e.t0){e.next=21;break}if(!d.UserManager.getInstance().isOnline()||d.UserManager.getInstance().isLoggedIn()||this._site instanceof p.LoginSite){e.next=13;break}this.startSite(p.LoginSite,{deepLink:this._site._siteManager.getDeepLinkFor(this._site),args:this._site.getParameters()}),e.next=17;break;case 13:if(this._site._siteManager.getCurrentSite()!==this._site||this.isDestroying()){e.next=17;break}return new h.Toast("wrong rights").show(),e.next=17,this.startSite(m.NotAllowedSite);case 17:if(this.isDestroying()){e.next=20;break}return e.next=20,this.finish();case 20:return e.abrupt("return",!1);case 21:return e.abrupt("return",!0);case 22:case"end":return e.stop()}}),e,this)})))}},{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return o(u(y.prototype),"onStart",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._checkRights();case 2:if(!t.sent){t.next=5;break}return t.next=5,n.onStart.call(this,e);case 5:case"end":return t.stop()}}),t,this)})))}}])&&i(t.prototype,n),r&&i(t,r),y}(h.DelegateSite);t.UserSite=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewHelper=void 0;t.ViewHelper=class{static removeAllChildren(e){if(e instanceof Node)for(;e.firstChild;)e.removeChild(e.firstChild);return e}static moveChildren(e,t){let n=[];return e.childNodes.forEach((e=>{n.push(e)})),n.forEach((n=>{e.removeChild(n),t.appendChild(n)})),t}static insertAfter(e,t){const n=t.parentNode;return!!n&&(n.lastChild===t?n.appendChild(e):n.insertBefore(e,t.nextSibling),!0)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(){function e(e){this.columnNames=[],this.referencedColumnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.referencedColumnNames=e.referencedColumnNames,this.referencedTableName=e.referencedTableName,this.onDelete=e.onDelete,this.onUpdate=e.onUpdate,this.deferrable=e.deferrable}return e.prototype.clone=function(){return new e({name:this.name,columnNames:Object(r.f)([],Object(r.e)(this.columnNames)),referencedColumnNames:Object(r.f)([],Object(r.e)(this.referencedColumnNames)),referencedTableName:this.referencedTableName,onDelete:this.onDelete,onUpdate:this.onUpdate,deferrable:this.deferrable})},e.create=function(t){return new e({name:t.name,columnNames:t.columnNames,referencedColumnNames:t.referencedColumnNames,referencedTableName:t.referencedTablePath,onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable})},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(){function e(){}return e.isAliasProperty=function(e){if("string"!=typeof e||-1===e.indexOf("."))return!1;var t=Object(r.e)(e.split("."),2),n=t[0],i=t[1];return!(!n||!i)&&(-1===e.indexOf("(")&&-1===e.indexOf(")"))},e}()},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(37),i=n(95);e.exports=n(36)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(133),i=n(88);e.exports=function(e){return r(i(e))}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataManager=void 0;var a=n(22),s=n(255),c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,c;return t=e,c=[{key:"fetch",value:function(t,n){return o(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,i){var o=new XMLHttpRequest;(n=a.Helper.nonNull(n,!1))&&(o.responseType="arraybuffer"),o.onload=function(){r(new Response(n?o.response:o.responseText,{status:0===o.status?200:o.status}))},o.onerror=function(e){console.error(e),i(new s.NotOnlineError("not-online",t))},o.open("GET",t),Object.keys(e._additionalHeaders).forEach((function(t){o.setRequestHeader(t,e._additionalHeaders[t])})),o.send(null)})).then((function(t){return e.onlineCallback&&e.onlineCallback(!0),t})).catch((function(t){throw e.onlineCallback&&e.onlineCallback(!1),t})));case 1:case"end":return r.stop()}}),r)})))}},{key:"fetchBlob",value:function(t){return o(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){var i=new XMLHttpRequest;i.onload=function(e){n(i.response)},i.onerror=function(e){console.error(e),r(new s.NotOnlineError("not-online",t))},i.open("GET",t),i.responseType="blob",Object.keys(e._additionalHeaders).forEach((function(t){i.setRequestHeader(t,e._additionalHeaders[t])})),i.send(null)})).then((function(t){return e.onlineCallback&&e.onlineCallback(!0),t})).catch((function(t){throw e.onlineCallback&&e.onlineCallback(!1),t})));case 1:case"end":return n.stop()}}),n)})))}},{key:"load",value:function(t,n,r){return o(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return!0===(n=a.Helper.nonNull(n,!0))?n="json":!1===n?n="text":"json"!==n&&"text"!==n&&(n="raw"),!0===(r=a.Helper.nonNull(r,!0))?r=e._basePath:"string"!=typeof r&&(r=""),t=e.basePath(t,r),i.abrupt("return",e.fetch(t,"raw"===n).catch((function(n){throw e.onlineCallback&&e.onlineCallback(!1),new s.NotOnlineError(n,t)})).then((function(t){return e.onlineCallback&&e.onlineCallback(!0),"json"===n?t.json():"text"===n?t.text():t})));case 6:case"end":return i.stop()}}),i)})))}},{key:"loadAsset",value:function(t,n){return o(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=e._assetBasePath,!t.startsWith("/")&&i.length>0&&!i.endsWith("/")&&(i+="/"),r.abrupt("return",this.load(t,a.Helper.nonNull(n,"text"),i));case 3:case"end":return r.stop()}}),r,this)})))}},{key:"buildQuery",value:function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return"?"+t.join("&")}},{key:"buildQueryWithoutNullValues",value:function(e){var t={};for(var n in e)a.Helper.isNotNull(e[n])&&(t[n]=e[n]);return this.buildQuery(t)}},{key:"send",value:function(t,n){return o(this,void 0,void 0,regeneratorRuntime.mark((function i(){var o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.basePath(t),o={},n instanceof FormData||"object"!==r(n)||(n=JSON.stringify(n),o={"Content-Type":"application/json"}),Object.keys(e._additionalHeaders).forEach((function(t){o[t]=e._additionalHeaders[t]})),i.abrupt("return",fetch(t,{credentials:"same-origin",method:"POST",headers:o,body:n}).then((function(e){return e.json()})).catch((function(t){return console.error("error",t),e.onlineCallback&&e.onlineCallback(!1),{success:!1,errors:["not-online"]}})));case 5:case"end":return i.stop()}}),i)})))}},{key:"basePath",value:function(t,n){return(n=a.Helper.nonNull(n,e._basePath))+(t||"")}},{key:"setHeader",value:function(t,n){e._additionalHeaders[t]=n}}],(n=null)&&i(t.prototype,n),c&&i(t,c),e}();t.DataManager=c,c.onlineCallback=null,c._additionalHeaders={},c._basePath="",c._assetBasePath=""},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Dialog=void 0;var o=n(22),a=n(31),s=n(43),c=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._resolver=null,this._content=null,this._backgroundElement=null,this._cancelable=!0,this._title=o.Helper.nonNull(n,""),this._translatable=!0,this._additionalClasses="",this._buttons=[],this._result=null,this._contentPromise=null,this._addedToDomePromise=new Promise((function(e){r._addedToDomePromiseResolver=e})),o.Helper.isNotNull(t)&&this.setContent(t)}var t,n,c;return t=e,(n=[{key:"setTitle",value:function(e){return this._title=e,this}},{key:"setTranslatable",value:function(e){this._translatable=e}},{key:"setAdditionalClasses",value:function(e){this._additionalClasses=e}},{key:"getTitle",value:function(){return this._title}},{key:"setCancelable",value:function(e){return this._cancelable=!0===e,this}},{key:"setContent",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"string"==typeof e&&e.endsWith(".html")&&(e=s.ViewInflater.getInstance().load(e)),this._contentPromise=Promise.resolve(e),t.next=4,this._contentPromise;case 4:return this._content=t.sent,t.abrupt("return",this);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"addButton",value:function(e,t,n){n=o.Helper.nonNull(n,!0);var r=null;"string"==typeof e?((r=document.createElement("button")).classList.add("button"),r.classList.add("right"),r.appendChild(a.Translator.makePersistentTranslation(e))):r=e;var i=this;if("function"!=typeof t){var s=t;t=function(){i._result=s}}var c=null;c=n?function(e){o.Helper.isNotNull(t)&&t(e),i.close()}:t,o.Helper.isNotNull(c)&&r.addEventListener("click",c),this._buttons.push(r)}},{key:"show",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._contentPromise;case 2:return this._backgroundElement=this.createModalDialogElement(),this._backgroundElement.addEventListener("keyup",(function(e){"Escape"===e.key&&t._cancelable&&t.close()})),document.body.appendChild(this._backgroundElement),e.next=7,a.Translator.getInstance().updateTranslations();case 7:return this._addedToDomePromiseResolver(),e.abrupt("return",new Promise((function(e){t._resolver=e})));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"createModalDialogElement",value:function(){var e=this,t=document.createElement("span");t.classList.add("title"),this._translatable&&""!==this._title?t.appendChild(a.Translator.makePersistentTranslation(this._title)):t.innerHTML=this._title;var n=document.createElement("div");n.appendChild(t);var r=document.createElement("div");r.classList.add("content-container");var i=document.createElement("div");i.className=this._additionalClasses,i.classList.add("modal"),i.appendChild(n),i.appendChild(r);var o=document.createElement("div");o.classList.add("modal-button-container");for(var s=0,c=this._buttons.length;s<c;s++)o.appendChild(this._buttons[s]);if(this._content instanceof Node||(this._content=this._translatable?a.Translator.makePersistentTranslation(this._content):document.createTextNode(this._content)),r.appendChild(this._content),this._backgroundElement=document.createElement("div"),this._backgroundElement.classList.add("background"),this._backgroundElement.style.display="block",this._backgroundElement.appendChild(i),this._backgroundElement.querySelector(".modal").appendChild(o),this._cancelable){var u=document.createElement("span");u.classList.add("close"),u.innerHTML="&times;",n.appendChild(u),u.addEventListener("click",(function(){e.close()})),window.addEventListener("click",(function(t){t.target===e._backgroundElement&&e.close()}))}return this._backgroundElement}},{key:"waitForAddedToDom",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._addedToDomePromise);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){var e=this;this.waitForAddedToDom().then((function(){o.Helper.isNotNull(e._backgroundElement)&&(e._backgroundElement.style.display="none",e._backgroundElement.remove(),e._backgroundElement=null)})),o.Helper.isNotNull(this._resolver)&&this._resolver(this._result)}}])&&r(t.prototype,n),c&&r(t,c),e}();t.Dialog=c},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),i=n(82),o=n(53),a=n(32),s=n(41),c=n(8),u=n(48),l=n(58),f=n(72),h=n(12),d=n(3),p=n(40),m=n(167),y=n(9),g=n(52),b=function(e){function t(){return e.call(this)||this}return Object(r.c)(t,e),t.prototype.connect=function(){return Promise.resolve(this.driver.databaseConnection)},t.prototype.release=function(){return this.loadedTables=[],this.clearSqlMemory(),Promise.resolve()},t.prototype.startTransaction=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:if(this.isTransactionActive)throw new i.a;if(!e)return[3,4];if("READ UNCOMMITTED"!==e&&"SERIALIZABLE"!==e)throw new Error("SQLite only supports SERIALIZABLE and READ UNCOMMITTED isolation");return"READ UNCOMMITTED"!==e?[3,2]:[4,this.query("PRAGMA read_uncommitted = true")];case 1:return r.sent(),[3,4];case 2:return[4,this.query("PRAGMA read_uncommitted = false")];case 3:r.sent(),r.label=4;case 4:return t=new h.a,this.broadcaster.broadcastBeforeTransactionStartEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,6];case 5:r.sent(),r.label=6;case 6:return this.isTransactionActive=!0,[4,this.query("BEGIN TRANSACTION")];case 7:return r.sent(),n=new h.a,this.broadcaster.broadcastAfterTransactionStartEvent(n),n.promises.length>0?[4,Promise.all(n.promises)]:[3,9];case 8:r.sent(),r.label=9;case 9:return[2]}}))}))},t.prototype.commitTransaction=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new o.a;return e=new h.a,this.broadcaster.broadcastBeforeTransactionCommitEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.query("COMMIT")];case 3:return n.sent(),this.isTransactionActive=!1,t=new h.a,this.broadcaster.broadcastAfterTransactionCommitEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.rollbackTransaction=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new o.a;return e=new h.a,this.broadcaster.broadcastBeforeTransactionRollbackEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.query("ROLLBACK")];case 3:return n.sent(),this.isTransactionActive=!1,t=new h.a,this.broadcaster.broadcastAfterTransactionRollbackEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.stream=function(e,t,n,r){throw new Error("Stream is not supported by sqlite driver.")},t.prototype.getDatabases=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve([])]}))}))},t.prototype.getSchemas=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve([])]}))}))},t.prototype.hasDatabase=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve(!1)]}))}))},t.prototype.getCurrentDatabase=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve(void 0)]}))}))},t.prototype.hasSchema=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("This driver does not support table schemas")}))}))},t.prototype.getCurrentSchema=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve(void 0)]}))}))},t.prototype.hasTable=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t=e instanceof c.a?e.name:e,n='SELECT * FROM "sqlite_master" WHERE "type" = \'table\' AND "name" = \''+t+"'",[4,this.query(n)];case 1:return[2,!!r.sent().length]}}))}))},t.prototype.hasColumn=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=e instanceof c.a?e.name:e,i='PRAGMA table_info("'+n+'")',[4,this.query(i)];case 1:return[2,!!r.sent().find((function(e){return e.name===t}))]}}))}))},t.prototype.createDatabase=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve()]}))}))},t.prototype.dropDatabase=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve()]}))}))},t.prototype.createSchema=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve()]}))}))},t.prototype.dropSchema=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,Promise.resolve()]}))}))},t.prototype.createTable=function(e,t,n,i){return void 0===t&&(t=!1),void 0===n&&(n=!0),void 0===i&&(i=!0),Object(r.b)(this,void 0,void 0,(function(){var o,a,s=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return o=[],a=[],t?[4,this.hasTable(e)]:[3,2];case 1:if(r.sent())return[2,Promise.resolve()];r.label=2;case 2:return o.push(this.createTableSql(e,n)),a.push(this.dropTableSql(e)),i&&e.indices.forEach((function(t){t.name||(t.name=s.connection.namingStrategy.indexName(e.name,t.columnNames,t.where)),o.push(s.createIndexSql(e,t)),a.push(s.dropIndexSql(t))})),[4,this.executeQueries(o,a)];case 3:return r.sent(),[2]}}))}))},t.prototype.dropTable=function(e,t,n,i){return void 0===n&&(n=!0),void 0===i&&(i=!0),Object(r.b)(this,void 0,void 0,(function(){var o,a,s,u,l,f=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t?[4,this.hasTable(e)]:[3,2];case 1:if(!r.sent())return[2,Promise.resolve()];r.label=2;case 2:return o=n,e instanceof c.a?(s=e,[3,5]):[3,3];case 3:return[4,this.getCachedTable(e)];case 4:s=r.sent(),r.label=5;case 5:return a=s,u=[],l=[],i&&a.indices.forEach((function(e){u.push(f.dropIndexSql(e)),l.push(f.createIndexSql(a,e))})),u.push(this.dropTableSql(a,t)),l.push(this.createTableSql(a,o)),[4,this.executeQueries(u,l)];case 6:return r.sent(),[2]}}))}))},t.prototype.createView=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=[],(t=[]).push(this.createViewSql(e)),t.push(this.insertViewDefinitionSql(e)),n.push(this.dropViewSql(e)),n.push(this.deleteViewDefinitionSql(e)),[4,this.executeQueries(t,n)];case 1:return r.sent(),[2]}}))}))},t.prototype.dropView=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t=e instanceof f.a?e.name:e,[4,this.getCachedView(t)];case 1:return n=r.sent(),o=[],(i=[]).push(this.deleteViewDefinitionSql(n)),i.push(this.dropViewSql(n)),o.push(this.insertViewDefinitionSql(n)),o.push(this.createViewSql(n)),[4,this.executeQueries(i,o)];case 2:return r.sent(),[2]}}))}))},t.prototype.renameTable=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s,u=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return(o=(n=i).clone()).name=t,a=new d.a('ALTER TABLE "'+n.name+'" RENAME TO "'+t+'"'),s=new d.a('ALTER TABLE "'+t+'" RENAME TO "'+n.name+'"'),[4,this.executeQueries(a,s)];case 4:return r.sent(),n.name=o.name,o.uniques.forEach((function(e){e.name=u.connection.namingStrategy.uniqueConstraintName(o,e.columnNames)})),o.foreignKeys.forEach((function(e){e.name=u.connection.namingStrategy.foreignKeyName(o,e.columnNames,e.referencedTableName,e.referencedColumnNames)})),o.indices.forEach((function(e){e.name=u.connection.namingStrategy.indexName(o,e.columnNames,e.where)})),[4,this.recreateTable(o,n)];case 5:return r.sent(),[2]}}))}))},t.prototype.addColumn=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return n=i,[2,this.addColumns(n,[t])]}}))}))},t.prototype.addColumns=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),t.forEach((function(e){return o.addColumn(e)})),[4,this.recreateTable(o,n)];case 4:return r.sent(),[2]}}))}))},t.prototype.renameColumn=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s,u;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(o=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:o=r.sent(),r.label=3;case 3:if(i=o,!(s=t instanceof a.a?t:i.columns.find((function(e){return e.name===t}))))throw new Error('Column "'+t+'" was not found in the "'+i.name+'" table.');return u=void 0,n instanceof a.a?u=n:(u=s.clone()).name=n,[2,this.changeColumn(i,s,u)]}}))}))},t.prototype.changeColumn=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,o,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(o=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:o=r.sent(),r.label=3;case 3:if(i=o,!(s=t instanceof a.a?t:i.columns.find((function(e){return e.name===t}))))throw new Error('Column "'+t+'" was not found in the "'+i.name+'" table.');return[4,this.changeColumns(i,[{oldColumn:s,newColumn:n}])];case 4:return r.sent(),[2]}}))}))},t.prototype.changeColumns=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),t.forEach((function(e){e.newColumn.name!==e.oldColumn.name&&(o.findColumnUniques(e.oldColumn).forEach((function(t){t.columnNames.splice(t.columnNames.indexOf(e.oldColumn.name),1),t.columnNames.push(e.newColumn.name),t.name=a.connection.namingStrategy.uniqueConstraintName(o,t.columnNames)})),o.findColumnForeignKeys(e.oldColumn).forEach((function(t){t.columnNames.splice(t.columnNames.indexOf(e.oldColumn.name),1),t.columnNames.push(e.newColumn.name),t.name=a.connection.namingStrategy.foreignKeyName(o,t.columnNames,t.referencedTableName,t.referencedColumnNames)})),o.findColumnIndices(e.oldColumn).forEach((function(t){t.columnNames.splice(t.columnNames.indexOf(e.oldColumn.name),1),t.columnNames.push(e.newColumn.name),t.name=a.connection.namingStrategy.indexName(o,t.columnNames,t.where)})));var t=o.columns.find((function(t){return t.name===e.oldColumn.name}));t&&(o.columns[o.columns.indexOf(t)]=e.newColumn)})),[4,this.recreateTable(o,n)];case 4:return r.sent(),[2]}}))}))},t.prototype.dropColumn=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof a.a?t:n.findColumnByName(t)))throw new Error('Column "'+t+'" was not found in table "'+n.name+'"');return[4,this.dropColumns(n,[o])];case 4:return r.sent(),[2]}}))}))},t.prototype.dropColumns=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),t.forEach((function(e){o.removeColumn(e),o.findColumnUniques(e).forEach((function(e){return o.removeUniqueConstraint(e)})),o.findColumnIndices(e).forEach((function(e){return o.removeIndex(e)})),o.findColumnForeignKeys(e).forEach((function(e){return o.removeForeignKey(e)}))})),[4,this.recreateTable(o,n)];case 4:return r.sent(),t.forEach((function(e){n.removeColumn(e),n.findColumnUniques(e).forEach((function(e){return n.removeUniqueConstraint(e)})),n.findColumnIndices(e).forEach((function(e){return n.removeIndex(e)})),n.findColumnForeignKeys(e).forEach((function(e){return n.removeForeignKey(e)}))})),[2]}}))}))},t.prototype.createPrimaryKey=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return(o=(n=i).clone()).columns.forEach((function(e){t.find((function(t){return t===e.name}))&&(e.isPrimary=!0)})),[4,this.recreateTable(o,n)];case 4:return r.sent(),n.columns.forEach((function(e){t.find((function(t){return t===e.name}))&&(e.isPrimary=!0)})),[2]}}))}))},t.prototype.updatePrimaryKeys=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve()];case 1:return e.sent(),[2]}}))}))},t.prototype.dropPrimaryKey=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(n=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:n=r.sent(),r.label=3;case 3:return(i=(t=n).clone()).primaryColumns.forEach((function(e){e.isPrimary=!1})),[4,this.recreateTable(i,t)];case 4:return r.sent(),t.primaryColumns.forEach((function(e){e.isPrimary=!1})),[2]}}))}))},t.prototype.createUniqueConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,this.createUniqueConstraints(e,[t])];case 1:return n.sent(),[2]}}))}))},t.prototype.createUniqueConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),t.forEach((function(e){return o.addUniqueConstraint(e)})),[4,this.recreateTable(o,n)];case 4:return r.sent(),[2]}}))}))},t.prototype.dropUniqueConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof p.a?t:n.uniques.find((function(e){return e.name===t}))))throw new Error("Supplied unique constraint was not found in table "+n.name);return[4,this.dropUniqueConstraints(n,[o])];case 4:return r.sent(),[2]}}))}))},t.prototype.dropUniqueConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),t.forEach((function(e){return o.removeUniqueConstraint(e)})),[4,this.recreateTable(o,n)];case 4:return r.sent(),[2]}}))}))},t.prototype.createCheckConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,this.createCheckConstraints(e,[t])];case 1:return n.sent(),[2]}}))}))},t.prototype.createCheckConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),t.forEach((function(e){return o.addCheckConstraint(e)})),[4,this.recreateTable(o,n)];case 4:return r.sent(),[2]}}))}))},t.prototype.dropCheckConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof g.a?t:n.checks.find((function(e){return e.name===t}))))throw new Error("Supplied check constraint was not found in table "+n.name);return[4,this.dropCheckConstraints(n,[o])];case 4:return r.sent(),[2]}}))}))},t.prototype.dropCheckConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),t.forEach((function(e){return o.removeCheckConstraint(e)})),[4,this.recreateTable(o,n)];case 4:return r.sent(),[2]}}))}))},t.prototype.createExclusionConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("Sqlite does not support exclusion constraints.")}))}))},t.prototype.createExclusionConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("Sqlite does not support exclusion constraints.")}))}))},t.prototype.dropExclusionConstraint=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("Sqlite does not support exclusion constraints.")}))}))},t.prototype.dropExclusionConstraints=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){throw new Error("Sqlite does not support exclusion constraints.")}))}))},t.prototype.createForeignKey=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,this.createForeignKeys(e,[t])];case 1:return n.sent(),[2]}}))}))},t.prototype.createForeignKeys=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),t.forEach((function(e){return o.addForeignKey(e)})),[4,this.recreateTable(o,n)];case 4:return r.sent(),[2]}}))}))},t.prototype.dropForeignKey=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof l.a?t:n.foreignKeys.find((function(e){return e.name===t}))))throw new Error("Supplied foreign key was not found in table "+n.name);return[4,this.dropForeignKeys(e,[o])];case 4:return r.sent(),[2]}}))}))},t.prototype.dropForeignKeys=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return o=(n=i).clone(),t.forEach((function(e){return o.removeForeignKey(e)})),[4,this.recreateTable(o,n)];case 4:return r.sent(),[2]}}))}))},t.prototype.createIndex=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:return n=i,t.name||(t.name=this.connection.namingStrategy.indexName(n.name,t.columnNames,t.where)),o=this.createIndexSql(n,t),a=this.dropIndexSql(t),[4,this.executeQueries(o,a)];case 4:return r.sent(),n.addIndex(t),[2]}}))}))},t.prototype.createIndices=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=t.map((function(t){return i.createIndex(e,t)})),[4,Promise.all(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.dropIndex=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i,o,a,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e instanceof c.a?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=r.sent(),r.label=3;case 3:if(n=i,!(o=t instanceof u.a?t:n.indices.find((function(e){return e.name===t}))))throw new Error("Supplied index was not found in table "+n.name);return a=this.dropIndexSql(o),s=this.createIndexSql(n,o),[4,this.executeQueries(a,s)];case 4:return r.sent(),n.removeIndex(o),[2]}}))}))},t.prototype.dropIndices=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=t.map((function(t){return i.dropIndex(e,t)})),[4,Promise.all(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.clearTable=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.query('DELETE FROM "'+e+'"')];case 1:return t.sent(),[2]}}))}))},t.prototype.clearDatabase=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.query("PRAGMA foreign_keys = OFF;")];case 1:return r.sent(),[4,this.startTransaction()];case 2:r.sent(),r.label=3;case 3:return r.trys.push([3,9,14,16]),"SELECT 'DROP VIEW \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'view'",[4,this.query("SELECT 'DROP VIEW \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'view'")];case 4:return e=r.sent(),[4,Promise.all(e.map((function(e){return i.query(e.query)})))];case 5:return r.sent(),"SELECT 'DROP TABLE \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'table' AND \"name\" != 'sqlite_sequence'",[4,this.query("SELECT 'DROP TABLE \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'table' AND \"name\" != 'sqlite_sequence'")];case 6:return t=r.sent(),[4,Promise.all(t.map((function(e){return i.query(e.query)})))];case 7:return r.sent(),[4,this.commitTransaction()];case 8:return r.sent(),[3,16];case 9:n=r.sent(),r.label=10;case 10:return r.trys.push([10,12,,13]),[4,this.rollbackTransaction()];case 11:return r.sent(),[3,13];case 12:return r.sent(),[3,13];case 13:throw n;case 14:return[4,this.query("PRAGMA foreign_keys = ON;")];case 15:return r.sent(),[7];case 16:return[2]}}))}))},t.prototype.loadViews=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.hasTable(this.getTypeormMetadataTableName())];case 1:return r.sent()?(t=e.map((function(e){return"'"+e+"'"})).join(", "),n='SELECT "t".* FROM "'+this.getTypeormMetadataTableName()+'" "t" INNER JOIN "sqlite_master" s ON "s"."name" = "t"."name" AND "s"."type" = \'view\' WHERE "t"."type" = \'VIEW\'',t.length>0&&(n+=' AND "t"."name" IN ('+t+")"),[4,this.query(n)]):[2,Promise.resolve([])];case 2:return[2,r.sent().map((function(e){var t=new f.a;return t.name=e.name,t.expression=e.value,t}))]}}))}))},t.prototype.loadTables=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o=this;return Object(r.d)(this,(function(s){switch(s.label){case 0:return e&&e.length?(t=e.map((function(e){return"'"+e+"'"})).join(", "),[4,this.query('SELECT * FROM "sqlite_master" WHERE "type" = \'table\' AND "name" IN ('+t+")")]):[2,[]];case 1:return n=s.sent(),[4,this.query('SELECT * FROM "sqlite_master" WHERE "type" = \'index\' AND "tbl_name" IN ('+t+")")];case 2:return i=s.sent(),n&&n.length?[2,Promise.all(n.map((function(e){return Object(r.b)(o,void 0,void 0,(function(){var t,n,o,s,f,h,d,m,b,v,w,_,k,E,O,T,x,S,C,R,P,N=this;return Object(r.d)(this,(function(M){switch(M.label){case 0:return t=new c.a({name:e.name}),n=e.sql,[4,Promise.all([this.query('PRAGMA table_info("'+e.name+'")'),this.query('PRAGMA index_list("'+e.name+'")'),this.query('PRAGMA foreign_key_list("'+e.name+'")')])];case 1:for(o=r.e.apply(void 0,[M.sent(),3]),s=o[0],f=o[1],h=o[2],d=void 0,m=e.sql,-1!==(b=m.toUpperCase().indexOf("AUTOINCREMENT"))&&(d=m.substr(0,b),v=d.lastIndexOf(","),w=d.lastIndexOf("("),-1!==v?d=(d=(d=d.substr(v)).substr(0,d.lastIndexOf('"'))).substr(d.indexOf('"')+1):-1!==w&&(d=(d=(d=d.substr(w)).substr(0,d.lastIndexOf('"'))).substr(d.indexOf('"')+1))),t.columns=s.map((function(e){var t=new a.a;if(t.name=e.name,t.type=e.type.toLowerCase(),t.default=null!==e.dflt_value&&void 0!==e.dflt_value?e.dflt_value:void 0,t.isNullable=0===e.notnull,t.isPrimary=e.pk>0,t.comment="",t.isGenerated=d===e.name,t.isGenerated&&(t.generationStrategy="increment"),"varchar"===t.type){var r=n.match(new RegExp('"('+t.name+")\" varchar CHECK\\s*\\(\\s*\\1\\s+IN\\s*\\(('[^']+'(?:\\s*,\\s*'[^']+')+)\\s*\\)\\s*\\)"));r&&(t.enum=r[2].substr(1,r[2].length-2).split("','"))}var i=t.type.indexOf("(");if(-1!==i){var o=t.type,s=o.substr(0,i);if(N.driver.withLengthColumnTypes.find((function(e){return e===s}))){var c=parseInt(o.substring(i+1,o.length-1));c&&(t.length=c.toString(),t.type=s)}if(N.driver.withPrecisionColumnTypes.find((function(e){return e===s}))){var u=new RegExp("^"+s+"\\((\\d+),?\\s?(\\d+)?\\)"),l=o.match(u);l&&l[1]&&(t.precision=+l[1]),N.driver.withScaleColumnTypes.find((function(e){return e===s}))&&l&&l[2]&&(t.scale=+l[2]),t.type=s}}return t})),_=y.a.uniq(h,(function(e){return e.id})),t.foreignKeys=_.map((function(e){var n=h.filter((function(t){return t.id===e.id&&t.table===e.table})),r=n.map((function(e){return e.from})),i=n.map((function(e){return e.to})),o=N.connection.namingStrategy.foreignKeyName(t,r,e.referencedTableName,e.referencedColumnNames);return new l.a({name:o,columnNames:r,referencedTableName:e.table,referencedColumnNames:i,onDelete:e.on_delete,onUpdate:e.on_update})})),E=[],O=/CONSTRAINT "([^"]*)" UNIQUE \((.*?)\)/g;null!==(k=O.exec(n));)E.push({name:k[1],columns:k[2].substr(1,k[2].length-2).split('", "')});return T=f.filter((function(e){return"u"===e.origin})).map((function(e){return e.name})).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e){return Object(r.b)(N,void 0,void 0,(function(){var n,i,o,a,s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=f.find((function(t){return t.name===e})),[4,this.query('PRAGMA index_info("'+n.name+'")')];case 1:return i=r.sent(),1===(o=i.sort((function(e,t){return parseInt(e.seqno)-parseInt(t.seqno)})).map((function(e){return e.name}))).length&&(a=t.columns.find((function(e){return!!o.find((function(t){return t===e.name}))})))&&(a.isUnique=!0),s=E.find((function(e){return e.columns.every((function(e){return-1!==o.indexOf(e)}))})),[2,new p.a({name:s?s.name:this.connection.namingStrategy.uniqueConstraintName(t,o),columnNames:o})]}}))}))})),x=t,[4,Promise.all(T)];case 2:for(x.uniques=M.sent(),C=/CONSTRAINT "([^"]*)" CHECK (\(.*?\))([,]|[)]$)/g;null!==(S=C.exec(n));)t.checks.push(new g.a({name:S[1],expression:S[2]}));return R=f.filter((function(e){return"c"===e.origin})).map((function(e){return e.name})).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e){return Object(r.b)(N,void 0,void 0,(function(){var n,o,a,s,c,l;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=i.find((function(t){return t.name===e})),o=/WHERE (.*)/.exec(n.sql),a=f.find((function(t){return t.name===e})),[4,this.query('PRAGMA index_info("'+a.name+'")')];case 1:return s=r.sent(),c=s.sort((function(e,t){return parseInt(e.seqno)-parseInt(t.seqno)})).map((function(e){return e.name})),l="1"===a.unique||1===a.unique,[2,new u.a({table:t,name:a.name,columnNames:c,isUnique:l,where:o?o[1]:void 0})]}}))}))})),[4,Promise.all(R)];case 3:return P=M.sent(),t.indices=P.filter((function(e){return!!e})),[2,t]}}))}))})))]:[2,[]]}}))}))},t.prototype.createTableSql=function(e,t){var n=this,r=e.columns.filter((function(e){return e.isPrimary})),i=r.find((function(e){return e.isGenerated&&"increment"===e.generationStrategy})),o=r.length>1;if(o&&i)throw new Error("Sqlite does not support AUTOINCREMENT on composite primary key");var a=e.columns.map((function(e){return n.buildCreateColumnSql(e,o)})).join(", "),s='CREATE TABLE "'+e.name+'" ('+a;(e.columns.filter((function(e){return e.isUnique})).forEach((function(t){e.uniques.some((function(e){return 1===e.columnNames.length&&e.columnNames[0]===t.name}))||e.uniques.push(new p.a({name:n.connection.namingStrategy.uniqueConstraintName(e.name,[t.name]),columnNames:[t.name]}))})),e.uniques.length>0)&&(s+=", "+e.uniques.map((function(t){return'CONSTRAINT "'+(t.name?t.name:n.connection.namingStrategy.uniqueConstraintName(e.name,t.columnNames))+'" UNIQUE ('+t.columnNames.map((function(e){return'"'+e+'"'})).join(", ")+")"})).join(", "));e.checks.length>0&&(s+=", "+e.checks.map((function(t){return'CONSTRAINT "'+(t.name?t.name:n.connection.namingStrategy.checkConstraintName(e.name,t.expression))+'" CHECK ('+t.expression+")"})).join(", "));e.foreignKeys.length>0&&t&&(s+=", "+e.foreignKeys.map((function(t){var r=t.columnNames.map((function(e){return'"'+e+'"'})).join(", ");t.name||(t.name=n.connection.namingStrategy.foreignKeyName(e.name,t.columnNames,t.referencedTableName,t.referencedColumnNames));var i=t.referencedColumnNames.map((function(e){return'"'+e+'"'})).join(", "),o='CONSTRAINT "'+t.name+'" FOREIGN KEY ('+r+') REFERENCES "'+t.referencedTableName+'" ('+i+")";return t.onDelete&&(o+=" ON DELETE "+t.onDelete),t.onUpdate&&(o+=" ON UPDATE "+t.onUpdate),o})).join(", "));r.length>1&&(s+=", PRIMARY KEY ("+r.map((function(e){return'"'+e.name+'"'})).join(", ")+")");s+=")";var c=this.connection.entityMetadatas.find((function(t){return t.tableName===e.name}));return c&&c.withoutRowid&&(s+=" WITHOUT ROWID"),new d.a(s)},t.prototype.dropTableSql=function(e,t){var n=e instanceof c.a?e.name:e,r=t?'DROP TABLE IF EXISTS "'+n+'"':'DROP TABLE "'+n+'"';return new d.a(r)},t.prototype.createViewSql=function(e){return"string"==typeof e.expression?new d.a('CREATE VIEW "'+e.name+'" AS '+e.expression):new d.a('CREATE VIEW "'+e.name+'" AS '+e.expression(this.connection).getQuery())},t.prototype.insertViewDefinitionSql=function(e){var t="string"==typeof e.expression?e.expression.trim():e.expression(this.connection).getQuery(),n=Object(r.e)(this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({type:"VIEW",name:e.name,value:t}).getQueryAndParameters(),2),i=n[0],o=n[1];return new d.a(i,o)},t.prototype.dropViewSql=function(e){var t=e instanceof f.a?e.name:e;return new d.a('DROP VIEW "'+t+'"')},t.prototype.deleteViewDefinitionSql=function(e){var t=e instanceof f.a?e.name:e,n=this.connection.createQueryBuilder(),i=Object(r.e)(n.delete().from(this.getTypeormMetadataTableName()).where(n.escape("type")+" = 'VIEW'").andWhere(n.escape("name")+" = :name",{name:t}).getQueryAndParameters(),2),o=i[0],a=i[1];return new d.a(o,a)},t.prototype.createIndexSql=function(e,t){var n=t.columnNames.map((function(e){return'"'+e+'"'})).join(", ");return new d.a("CREATE "+(t.isUnique?"UNIQUE ":"")+'INDEX "'+t.name+'" ON "'+e.name+'" ('+n+") "+(t.where?"WHERE "+t.where:""))},t.prototype.dropIndexSql=function(e){var t=e instanceof u.a?e.name:e;return new d.a('DROP INDEX "'+t+'"')},t.prototype.buildCreateColumnSql=function(e,t){var n='"'+e.name+'"';return e instanceof s.a?n+=" "+this.driver.normalizeType(e):n+=" "+this.connection.driver.createFullType(e),e.enum&&(n+=" CHECK( "+e.name+" IN ("+e.enum.map((function(e){return"'"+e+"'"})).join(",")+") )"),e.isPrimary&&!t&&(n+=" PRIMARY KEY"),!0===e.isGenerated&&"increment"===e.generationStrategy&&(n+=" AUTOINCREMENT"),e.collation&&(n+=" COLLATE "+e.collation),!0!==e.isNullable&&(n+=" NOT NULL"),void 0!==e.default&&null!==e.default&&(n+=" DEFAULT ("+e.default+")"),n},t.prototype.recreateTable=function(e,t,n){return void 0===n&&(n=!0),Object(r.b)(this,void 0,void 0,(function(){var i,o,a,s,c=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return i=[],o=[],t.indices.forEach((function(e){i.push(c.dropIndexSql(e)),o.push(c.createIndexSql(t,e))})),e.name="temporary_"+e.name,i.push(this.createTableSql(e,!0)),o.push(this.dropTableSql(e)),n&&(a=e.columns.map((function(e){return'"'+e.name+'"'})).join(", "),s=t.columns.map((function(e){return'"'+e.name+'"'})).join(", "),t.columns.length<e.columns.length?a=e.columns.filter((function(e){return t.columns.find((function(t){return t.name===e.name}))})).map((function(e){return'"'+e.name+'"'})).join(", "):t.columns.length>e.columns.length&&(s=t.columns.filter((function(t){return e.columns.find((function(e){return e.name===t.name}))})).map((function(e){return'"'+e.name+'"'})).join(", ")),i.push(new d.a('INSERT INTO "'+e.name+'"('+a+") SELECT "+s+' FROM "'+t.name+'"')),o.push(new d.a('INSERT INTO "'+t.name+'"('+s+") SELECT "+a+' FROM "'+e.name+'"'))),i.push(this.dropTableSql(t)),o.push(this.createTableSql(t,!0)),i.push(new d.a('ALTER TABLE "'+e.name+'" RENAME TO "'+t.name+'"')),o.push(new d.a('ALTER TABLE "'+t.name+'" RENAME TO "'+e.name+'"')),e.name=t.name,e.indices.forEach((function(t){t.name||(t.name=c.connection.namingStrategy.indexName(e.name,t.columnNames,t.where)),i.push(c.createIndexSql(e,t)),o.push(c.dropIndexSql(t))})),[4,this.executeQueries(i,o)];case 1:return r.sent(),this.replaceCachedTable(t,e),[2]}}))}))},t}(m.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(286),i=n.n(r);function o(e,t){return void 0===t&&(t=!1),e.replace(/^([A-Z])|[\s-_](\w)/g,(function(e,n,r,i){return!0===t&&0===i?n:r?r.toUpperCase():n.toLowerCase()}))}function a(e){return e.replace(/(?:([a-z])([A-Z]))|(?:((?!^)[A-Z])([a-z]))/g,"$1_$3$2$4").toLowerCase()}function s(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))}function c(e,t){void 0===t&&(t={});var n=t.segmentLength,r=void 0===n?4:n,i=t.separator,o=void 0===i?"__":i,a=t.termLength,s=void 0===a?2:a;return e.split(o).reduce((function(e,t){var n=t.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),i=n.length>1?s:r,o=n.map((function(e){return e.substr(0,i)})).join("");return e.push(o),e}),[]).join(o)}function u(e,t){void 0===t&&(t={});var n=i()("sha256");n.update(e,"utf8");var r=n.digest("hex");return t.length?r.slice(0,t.length):r}},function(e,t,n){"use strict";var r=n(18);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractFragment=void 0;var l=n(120),f=n(22),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,n,r,s=a(c);function c(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=s.call(this,t))._site=e,n._viewQuery=null,n._active=!0,n}return t=c,(n=[{key:"getSite",value:function(){return this._site instanceof c?this._site.getSite():this._site}},{key:"startSite",value:function(e,t){return u(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this._site.startSite(e,t));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"isActive",value:function(){return this._active}},{key:"setViewQuery",value:function(e){this._viewQuery=e}},{key:"getViewQuery",value:function(){return this._viewQuery}},{key:"setActive",value:function(e){this._active=e,f.Helper.isNotNull(this._view)&&(e?this._view.classList.remove("hidden"):this._view.classList.add("hidden"))}}])&&i(t.prototype,n),r&&i(t,r),c}(l.Context);t.AbstractFragment=h},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Toast=void 0;var o=n(22),a=n(260),s=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._message=t,this._duration=o.Helper.nonNull(n,e.DEFAULT_DURATION),this._shouldTranslate=!1!==r,this._translationArgs=o.Helper.nonNull(r,[]),this._id=e.LAST_ID++,this._toastElement=null}var t,n,s;return t=e,(n=[{key:"getId",value:function(){return this._id}},{key:"getMessage",value:function(){return this._message}},{key:"getDuration",value:function(){return this._duration}},{key:"isShouldTranslate",value:function(){return this._shouldTranslate}},{key:"getTranslationArgs",value:function(){return this._translationArgs}},{key:"setToastElement",value:function(e){this._toastElement=e}},{key:"getToastElement",value:function(){return this._toastElement}},{key:"show",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.ToastManager.getInstance().showToast(this));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"hide",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.ToastManager.getInstance().hideToast(this));case 1:case"end":return e.stop()}}),e,this)})))}}])&&r(t.prototype,n),s&&r(t,s),e}();t.Toast=s,s.LAST_ID=0,s.DEFAULT_DURATION=2500},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e){this.name=e.name,this.expression=e.expression}return e.prototype.clone=function(){return new e({name:this.name,expression:this.expression})},e.create=function(t){return new e({name:t.name,expression:t.expression})},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.transformFrom=function(e,t){return Array.isArray(e)?e.slice().reverse().reduce((function(e,t){return t.from(e)}),t):e.from(t)},e.transformTo=function(e,t){return Array.isArray(e)?e.reduce((function(e,t){return t.to(e)}),t):e.to(t)},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e){e&&(this.name=e.name,this.expression=e.expression,this.materialized=!!e.materialized)}return e.prototype.clone=function(){return new e({name:this.name,expression:this.expression,materialized:this.materialized})},e.create=function(t,n){return new e({name:n.buildTableName(t.tableName,t.schema,t.database),expression:t.expression,materialized:t.tableMetadataArgs.materialized})},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.sha1=function(e){var t,n,r,i,o,a,s,c,u,l=function(e,t){return e<<t|e>>>32-t},f=function(e){var t,n="";for(t=7;t>=0;t--)n+=(e>>>4*t&15).toString(16);return n},h=new Array(80),d=1732584193,p=4023233417,m=2562383102,y=271733878,g=3285377520,b=(e=encodeURIComponent(e)).length,v=[];for(n=0;n<b-3;n+=4)r=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),v.push(r);switch(b%4){case 0:n=2147483648;break;case 1:n=e.charCodeAt(b-1)<<24|8388608;break;case 2:n=e.charCodeAt(b-2)<<24|e.charCodeAt(b-1)<<16|32768;break;case 3:n=e.charCodeAt(b-3)<<24|e.charCodeAt(b-2)<<16|e.charCodeAt(b-1)<<8|128}for(v.push(n);v.length%16!=14;)v.push(0);for(v.push(b>>>29),v.push(b<<3&4294967295),t=0;t<v.length;t+=16){for(n=0;n<16;n++)h[n]=v[t+n];for(n=16;n<=79;n++)h[n]=l(h[n-3]^h[n-8]^h[n-14]^h[n-16],1);for(i=d,o=p,a=m,s=y,c=g,n=0;n<=19;n++)u=l(i,5)+(o&a|~o&s)+c+h[n]+1518500249&4294967295,c=s,s=a,a=l(o,30),o=i,i=u;for(n=20;n<=39;n++)u=l(i,5)+(o^a^s)+c+h[n]+1859775393&4294967295,c=s,s=a,a=l(o,30),o=i,i=u;for(n=40;n<=59;n++)u=l(i,5)+(o&a|o&s|a&s)+c+h[n]+2400959708&4294967295,c=s,s=a,a=l(o,30),o=i,i=u;for(n=60;n<=79;n++)u=l(i,5)+(o^a^s)+c+h[n]+3395469782&4294967295,c=s,s=a,a=l(o,30),o=i,i=u;d=d+i&4294967295,p=p+o&4294967295,m=m+a&4294967295,y=y+s&4294967295,g=g+c&4294967295}return(u=f(d)+f(p)+f(m)+f(y)+f(g)).toLowerCase()},e.uuid4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},e}()},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(56),t),i(n(281),t),i(n(209),t),i(n(155),t),i(n(557),t),i(n(558),t),i(n(279),t),i(n(154),t),i(n(280),t),i(n(560),t),i(n(34),t),i(n(282),t)},function(e,t,n){var r=n(76);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(134),i=n(95),o=n(62),a=n(91),s=n(60),c=n(214),u=Object.getOwnPropertyDescriptor;t.f=n(36)?u:function(e,t){if(e=o(e),t=a(t,!0),c)try{return u(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(6),i=n(33),o=n(18);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},function(e,t,n){var r=n(75),i=n(133),o=n(46),a=n(29),s=n(230);e.exports=function(e,t){var n=1==e,c=2==e,u=3==e,l=4==e,f=6==e,h=5==e||f,d=t||s;return function(t,s,p){for(var m,y,g=o(t),b=i(g),v=r(s,p,3),w=a(b.length),_=0,k=n?d(t,w):c?d(t,0):void 0;w>_;_++)if((h||_ in b)&&(y=v(m=b[_],_,g),e))if(n)k[_]=y;else if(y)switch(e){case 3:return!0;case 5:return m;case 6:return _;case 2:k.push(m)}else if(l)return!1;return f?-1:u||l?l:k}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.FileMedium=void 0;var f=n(39),h=n(16),d=n(5),FileMedium=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(FileMedium,e);var t,n,r,u=c(FileMedium);function FileMedium(){var e;return i(this,FileMedium),(e=u.apply(this,arguments)).saveOffline=!0,e._isDownloaded=!1,e}return t=FileMedium,r=[{key:"getColumnDefinitions",value:function(){var e=a(l(FileMedium),"getColumnDefinitions",this).call(this);return e.src=h.BaseDatabase.TYPES.MEDIUMTEXT,e.saveOffline={type:h.BaseDatabase.TYPES.BOOLEAN,default:1},e}}],(n=[{key:"getServerUrl",value:function(e){if(e=d.Helper.nonNull(e,!0),!(d.Helper.imageUrlIsEmpty(this.src)||this.src.startsWith("http")||this.src.startsWith("//")||this.src.startsWith("data"))){var t=FileMedium.PUBLIC_PATH+this.src;return e&&(t+="?t="+new Date(this.updatedAt).getTime()),t}return this.src}},{key:"getUrlWithoutDownload",value:function(){return"browser"!==device.platform&&this.saveOffline&&this._isDownloaded&&d.Helper.isNotNull(this.id)&&!this.src.startsWith("data")&&!this.src.startsWith("http")?"cdvfile://localhost/persistent/"+this.src:this.getServerUrl()}},{key:"getUrl",value:function(){return"function"==typeof a(l(FileMedium.prototype),"getUrl",this)?a(l(FileMedium.prototype),"getUrl",this).call(this):this.getUrlWithoutDownload()}},{key:"setSrc",value:function(e){this.src=e}},{key:"getSrc",value:function(){return this.src}},{key:"toString",value:function(){return console.warn("to string called on FileMedium. Only for dependency. Please look inside your sourcecode"),this.getUrl()}}])&&o(t.prototype,n),r&&o(t,r),FileMedium}(f.EasySyncBaseModel);t.FileMedium=FileMedium,FileMedium.PUBLIC_PATH="./",FileMedium.SCHEMA_NAME="FileMedium",h.BaseDatabase.addModel(FileMedium)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="TransactionAlreadyStartedError",Object.setPrototypeOf(n,t.prototype),n.message="Transaction already started for the given connection, commit current transaction before starting a new one.",n}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(n,r){var i=e.call(this)||this;return i.name="DriverPackageNotInstalledError",Object.setPrototypeOf(i,t.prototype),i.message=n+" package has not been found installed. Try to install it: npm install "+r+" --save",i}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="ReturningStatementNotSupportedError",Object.setPrototypeOf(n,t.prototype),n.message="OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL databases.",n}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(510),t),i(n(254),t),i(n(511),t),i(n(512),t),i(n(165),t),i(n(57),t)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){this.options=e}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";if(n(36)){var r=n(97),i=n(17),o=n(18),a=n(6),s=n(151),c=n(192),u=n(75),l=n(116),f=n(95),h=n(61),d=n(117),p=n(77),m=n(29),y=n(241),g=n(99),b=n(91),v=n(60),w=n(135),_=n(20),k=n(46),E=n(184),O=n(100),T=n(102),x=n(101).f,S=n(186),C=n(96),R=n(25),P=n(80),N=n(141),M=n(136),A=n(188),j=n(114),I=n(144),D=n(115),L=n(187),B=n(232),F=n(37),q=n(78),V=F.f,U=q.f,H=i.RangeError,z=i.TypeError,W=i.Uint8Array,Y="ArrayBuffer",Q="SharedArrayBuffer",G="BYTES_PER_ELEMENT",J=Array.prototype,K=c.ArrayBuffer,$=c.DataView,X=P(0),Z=P(2),ee=P(3),te=P(4),ne=P(5),re=P(6),ie=N(!0),oe=N(!1),ae=A.values,se=A.keys,ce=A.entries,ue=J.lastIndexOf,le=J.reduce,fe=J.reduceRight,he=J.join,de=J.sort,pe=J.slice,me=J.toString,ye=J.toLocaleString,ge=R("iterator"),be=R("toStringTag"),ve=C("typed_constructor"),we=C("def_constructor"),_e=s.CONSTR,ke=s.TYPED,Ee=s.VIEW,Oe="Wrong length!",Te=P(1,(function(e,t){return Pe(M(e,e[we]),t)})),xe=o((function(){return 1===new W(new Uint16Array([1]).buffer)[0]})),Se=!!W&&!!W.prototype.set&&o((function(){new W(1).set({})})),Ce=function(e,t){var n=p(e);if(n<0||n%t)throw H("Wrong offset!");return n},Re=function(e){if(_(e)&&ke in e)return e;throw z(e+" is not a typed array!")},Pe=function(e,t){if(!_(e)||!(ve in e))throw z("It is not a typed array constructor!");return new e(t)},Ne=function(e,t){return Me(M(e,e[we]),t)},Me=function(e,t){for(var n=0,r=t.length,i=Pe(e,r);r>n;)i[n]=t[n++];return i},Ae=function(e,t,n){V(e,t,{get:function(){return this._d[n]}})},je=function(e){var t,n,r,i,o,a,s=k(e),c=arguments.length,l=c>1?arguments[1]:void 0,f=void 0!==l,h=S(s);if(null!=h&&!E(h)){for(a=h.call(s),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);s=r}for(f&&c>2&&(l=u(l,arguments[2],2)),t=0,n=m(s.length),i=Pe(this,n);n>t;t++)i[t]=f?l(s[t],t):s[t];return i},Ie=function(){for(var e=0,t=arguments.length,n=Pe(this,t);t>e;)n[e]=arguments[e++];return n},De=!!W&&o((function(){ye.call(new W(1))})),Le=function(){return ye.apply(De?pe.call(Re(this)):Re(this),arguments)},Be={copyWithin:function(e,t){return B.call(Re(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return te(Re(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return L.apply(Re(this),arguments)},filter:function(e){return Ne(this,Z(Re(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return ne(Re(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return re(Re(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){X(Re(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return oe(Re(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return ie(Re(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return he.apply(Re(this),arguments)},lastIndexOf:function(e){return ue.apply(Re(this),arguments)},map:function(e){return Te(Re(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return le.apply(Re(this),arguments)},reduceRight:function(e){return fe.apply(Re(this),arguments)},reverse:function(){for(var e,t=this,n=Re(t).length,r=Math.floor(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t},some:function(e){return ee(Re(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return de.call(Re(this),e)},subarray:function(e,t){var n=Re(this),r=n.length,i=g(e,r);return new(M(n,n[we]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,m((void 0===t?r:g(t,r))-i))}},Fe=function(e,t){return Ne(this,pe.call(Re(this),e,t))},qe=function(e){Re(this);var t=Ce(arguments[1],1),n=this.length,r=k(e),i=m(r.length),o=0;if(i+t>n)throw H(Oe);for(;o<i;)this[t+o]=r[o++]},Ve={entries:function(){return ce.call(Re(this))},keys:function(){return se.call(Re(this))},values:function(){return ae.call(Re(this))}},Ue=function(e,t){return _(e)&&e[ke]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},He=function(e,t){return Ue(e,t=b(t,!0))?f(2,e[t]):U(e,t)},ze=function(e,t,n){return!(Ue(e,t=b(t,!0))&&_(n)&&v(n,"value"))||v(n,"get")||v(n,"set")||n.configurable||v(n,"writable")&&!n.writable||v(n,"enumerable")&&!n.enumerable?V(e,t,n):(e[t]=n.value,e)};_e||(q.f=He,F.f=ze),a(a.S+a.F*!_e,"Object",{getOwnPropertyDescriptor:He,defineProperty:ze}),o((function(){me.call({})}))&&(me=ye=function(){return he.call(this)});var We=d({},Be);d(We,Ve),h(We,ge,Ve.values),d(We,{slice:Fe,set:qe,constructor:function(){},toString:me,toLocaleString:Le}),Ae(We,"buffer","b"),Ae(We,"byteOffset","o"),Ae(We,"byteLength","l"),Ae(We,"length","e"),V(We,be,{get:function(){return this[ke]}}),e.exports=function(e,t,n,c){var u=e+((c=!!c)?"Clamped":"")+"Array",f="get"+e,d="set"+e,p=i[u],g=p||{},b=p&&T(p),v=!p||!s.ABV,k={},E=p&&p.prototype,S=function(e,n){V(e,n,{get:function(){return function(e,n){var r=e._d;return r.v[f](n*t+r.o,xe)}(this,n)},set:function(e){return function(e,n,r){var i=e._d;c&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[d](n*t+i.o,r,xe)}(this,n,e)},enumerable:!0})};v?(p=n((function(e,n,r,i){l(e,p,u,"_d");var o,a,s,c,f=0,d=0;if(_(n)){if(!(n instanceof K||(c=w(n))==Y||c==Q))return ke in n?Me(p,n):je.call(p,n);o=n,d=Ce(r,t);var g=n.byteLength;if(void 0===i){if(g%t)throw H(Oe);if((a=g-d)<0)throw H(Oe)}else if((a=m(i)*t)+d>g)throw H(Oe);s=a/t}else s=y(n),o=new K(a=s*t);for(h(e,"_d",{b:o,o:d,l:a,e:s,v:new $(o)});f<s;)S(e,f++)})),E=p.prototype=O(We),h(E,"constructor",p)):o((function(){p(1)}))&&o((function(){new p(-1)}))&&I((function(e){new p,new p(null),new p(1.5),new p(e)}),!0)||(p=n((function(e,n,r,i){var o;return l(e,p,u),_(n)?n instanceof K||(o=w(n))==Y||o==Q?void 0!==i?new g(n,Ce(r,t),i):void 0!==r?new g(n,Ce(r,t)):new g(n):ke in n?Me(p,n):je.call(p,n):new g(y(n))})),X(b!==Function.prototype?x(g).concat(x(b)):x(g),(function(e){e in p||h(p,e,g[e])})),p.prototype=E,r||(E.constructor=p));var C=E[ge],R=!!C&&("values"==C.name||null==C.name),P=Ve.values;h(p,ve,!0),h(E,ke,u),h(E,Ee,!0),h(E,we,p),(c?new p(1)[be]==u:be in E)||V(E,be,{get:function(){return u}}),k[u]=p,a(a.G+a.W+a.F*(p!=g),k),a(a.S,u,{BYTES_PER_ELEMENT:t}),a(a.S+a.F*o((function(){g.of.call(p,1)})),u,{from:je,of:Ie}),G in E||h(E,G,t),a(a.P,u,Be),D(u),a(a.P+a.F*Se,u,{set:qe}),a(a.P+a.F*!R,u,Ve),r||E.toString==me||(E.toString=me),a(a.P+a.F*o((function(){new p(1).slice()})),u,{slice:Fe}),a(a.P+a.F*(o((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!o((function(){E.toLocaleString.call([1,2])}))),u,{toLocaleString:Le}),j[u]=R?C:P,r||R||h(E,ge,P)}}else e.exports=function(){}},function(e,t,n){(function(r){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(505)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(248))},function(e,t,n){var r=n(20);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(96)("meta"),i=n(20),o=n(60),a=n(37).f,s=0,c=Object.isExtensible||function(){return!0},u=!n(18)((function(){return c(Object.preventExtensions({}))})),l=function(e){a(e,r,{value:{i:"O"+ ++s,w:{}}})},f=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!c(e))return"F";if(!t)return"E";l(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!c(e))return!0;if(!t)return!1;l(e)}return e[r].w},onFreeze:function(e){return u&&f.NEED&&c(e)&&!o(e,r)&&l(e),e}}},function(e,t,n){var r;(r=window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={})).en=Object.assign(r.en||{},{a:"Cannot upload file:",b:"Image toolbar",c:"Table toolbar",d:"Italic",e:"Choose heading",f:"Heading",g:"Insert image or file",h:"Block quote",i:"image widget",j:"Insert image",k:"Increase indent",l:"Decrease indent",m:"Insert table",n:"Header column",o:"Insert column left",p:"Insert column right",q:"Delete column",r:"Column",s:"Header row",t:"Insert row below",u:"Insert row above",v:"Delete row",w:"Row",x:"Merge cell up",y:"Merge cell right",z:"Merge cell down",aa:"Merge cell left",ab:"Split cell vertically",ac:"Split cell horizontally",ad:"Merge cells",ae:"Numbered List",af:"Bulleted List",ag:"Bold",ah:"Full size image",ai:"Side image",aj:"Left aligned image",ak:"Centered image",al:"Right aligned image",am:"Enter image caption",an:"Upload failed",ao:"Insert media",ap:"The URL must not be empty.",aq:"This media URL is not supported.",ar:"media widget",as:"Link",at:"Could not obtain resized image URL.",au:"Selecting resized image failed",av:"Could not insert image at the current position.",aw:"Inserting image failed",ax:"Widget toolbar",ay:"Upload in progress",az:"Open in a new tab",ba:"Downloadable",bb:"Unlink",bc:"Edit link",bd:"Open link in new tab",be:"This link has no URL",bf:"Save",bg:"Cancel",bh:"Paste the media URL in the input.",bi:"Tip: Paste the URL into the content to embed faster.",bj:"Media URL",bk:"Link URL",bl:"Rich Text Editor",bm:"Dropdown toolbar",bn:"%0 of %1",bo:"Previous",bp:"Next",bq:"Editor toolbar",br:"Show more items",bs:"Undo",bt:"Redo",bu:"Rich Text Editor, %0",bv:"Change image text alternative",bw:"Paragraph",bx:"Heading 1",by:"Heading 2",bz:"Heading 3",ca:"Heading 4",cb:"Heading 5",cc:"Heading 6",cd:"Text alternative"}),window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}([function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));const r="https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html";class i extends Error{constructor(e,t,n){e=o(e),n&&(e+=" "+JSON.stringify(n)),super(e),this.name="CKEditorError",this.context=t,this.data=n}is(e){return"CKEditorError"===e}static rethrowUnexpectedError(e,t){if(e.is&&e.is("CKEditorError"))throw e;const n=new i(e.message,t);throw n.stack=e.stack,n}}function o(e){const t=e.match(/^([^:]+):/);return t?e+` Read more: ${r}#error-${t[1]}\n`:e}},function(e,t,n){"use strict";var r,i={},o=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}();function s(e,t){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function c(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=i[r.id],a=0;if(o){for(o.refs++;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(y(r.parts[a],t))}else{for(var s=[];a<r.parts.length;a++)s.push(y(r.parts[a],t));i[r.id]={id:r.id,refs:1,parts:s}}}}function u(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var r=n.nc;r&&(e.attributes.nonce=r)}if(Object.keys(e.attributes).forEach((function(n){t.setAttribute(n,e.attributes[n])})),"function"==typeof e.insert)e.insert(t);else{var i=a(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var l,f=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function h(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=f(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function d(e,t,n){var r=n.css,i=n.media,o=n.sourceMap;if(i&&e.setAttribute("media",i),o&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,m=0;function y(e,t){var n,r,i;if(t.singleton){var o=m++;n=p||(p=u(t)),r=h.bind(null,n,o,!1),i=h.bind(null,n,o,!0)}else n=u(t),r=d.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o());var n=s(e,t);return c(n,t),function(e){for(var r=[],o=0;o<n.length;o++){var a=n[o],u=i[a.id];u&&(u.refs--,r.push(u))}e&&c(s(e,t),t);for(var l=0;l<r.length;l++){var f=r[l];if(0===f.refs){for(var h=0;h<f.parts.length;h++)f.parts[h]();delete i[f.id]}}}}},,function(e,t,n){"use strict";var r=n(7),i="object"==typeof self&&self&&self.Object===Object&&self,o=r.a||i||Function("return this")();t.a=o},function(e,n,r){"use strict";(function(e){var i=r(7),o=t&&!t.nodeType&&t,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===o&&i.a.process,c=function(){try{return a&&a.require&&a.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();n.a=c}).call(this,r(8)(e))},function(e,n,r){"use strict";(function(e){var i=r(3),o=r(11),a=t&&!t.nodeType&&t,s=a&&"object"==typeof e&&e&&!e.nodeType&&e,c=s&&s.exports===a?i.a.Buffer:void 0,u=(c?c.isBuffer:void 0)||o.a;n.a=u}).call(this,r(8)(e))},function(e,t,n){"use strict";(function(e){var t=n(0);const r="object"==typeof window?window:e;if(r.CKEDITOR_VERSION)throw new t.b("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.",null);r.CKEDITOR_VERSION="16.0.0"}).call(this,n(9))},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(9))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(69);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t,n){"use strict";t.a=function(){return!1}},function(e,n,r){"use strict";(function(e){var i=r(3),o=t&&!t.nodeType&&t,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===o?i.a.Buffer:void 0,c=s?s.allocUnsafe:void 0;n.a=function(e,t){if(t)return e.slice();var n=e.length,r=c?c(n):new e.constructor(n);return e.copy(r),r}}).call(this,r(8)(e))},function(e,t,n){var r=n(14);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-placeholder:before,.ck .ck-placeholder:before{content:attr(data-placeholder);pointer-events:none}.ck.ck-read-only .ck-placeholder:before{display:none}.ck.ck-placeholder:before,.ck .ck-placeholder:before{cursor:text;color:var(--ck-color-engine-placeholder-text)}"},function(e,t,n){var r=n(16);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck-hidden{display:none!important}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{box-sizing:border-box;width:auto;height:auto;position:static}:root{--ck-z-default:1;--ck-z-modal:calc(var(--ck-z-default) + 999);--ck-color-base-foreground:#fafafa;--ck-color-base-background:#fff;--ck-color-base-border:#c4c4c4;--ck-color-base-action:#61b045;--ck-color-base-focus:#6cb5f9;--ck-color-base-text:#333;--ck-color-base-active:#198cf0;--ck-color-base-active-focus:#0e7fe1;--ck-color-base-error:#db3700;--ck-color-focus-border:#1f89e5;--ck-color-focus-outer-shadow:#bcdefb;--ck-color-focus-disabled-shadow:rgba(119,186,248,0.3);--ck-color-focus-error-shadow:rgba(255,64,31,0.3);--ck-color-text:var(--ck-color-base-text);--ck-color-shadow-drop:rgba(0,0,0,0.15);--ck-color-shadow-drop-active:rgba(0,0,0,0.2);--ck-color-shadow-inner:rgba(0,0,0,0.1);--ck-color-button-default-background:transparent;--ck-color-button-default-hover-background:#e6e6e6;--ck-color-button-default-active-background:#d9d9d9;--ck-color-button-default-active-shadow:#bfbfbf;--ck-color-button-default-disabled-background:transparent;--ck-color-button-on-background:#dedede;--ck-color-button-on-hover-background:#c4c4c4;--ck-color-button-on-active-background:#bababa;--ck-color-button-on-active-shadow:#a1a1a1;--ck-color-button-on-disabled-background:#dedede;--ck-color-button-action-background:var(--ck-color-base-action);--ck-color-button-action-hover-background:#579e3d;--ck-color-button-action-active-background:#53973b;--ck-color-button-action-active-shadow:#498433;--ck-color-button-action-disabled-background:#7ec365;--ck-color-button-action-text:var(--ck-color-base-background);--ck-color-button-save:#008a00;--ck-color-button-cancel:#db3700;--ck-color-switch-button-off-background:#b0b0b0;--ck-color-switch-button-off-hover-background:#a3a3a3;--ck-color-switch-button-on-background:var(--ck-color-button-action-background);--ck-color-switch-button-on-hover-background:#579e3d;--ck-color-switch-button-inner-background:var(--ck-color-base-background);--ck-color-switch-button-inner-shadow:rgba(0,0,0,0.1);--ck-color-dropdown-panel-background:var(--ck-color-base-background);--ck-color-dropdown-panel-border:var(--ck-color-base-border);--ck-color-input-background:var(--ck-color-base-background);--ck-color-input-border:#c7c7c7;--ck-color-input-error-border:var(--ck-color-base-error);--ck-color-input-text:var(--ck-color-base-text);--ck-color-input-disabled-background:#f2f2f2;--ck-color-input-disabled-border:#c7c7c7;--ck-color-input-disabled-text:#5c5c5c;--ck-color-list-background:var(--ck-color-base-background);--ck-color-list-button-hover-background:var(--ck-color-button-default-hover-background);--ck-color-list-button-on-background:var(--ck-color-base-active);--ck-color-list-button-on-background-focus:var(--ck-color-base-active-focus);--ck-color-list-button-on-text:var(--ck-color-base-background);--ck-color-panel-background:var(--ck-color-base-background);--ck-color-panel-border:var(--ck-color-base-border);--ck-color-toolbar-background:var(--ck-color-base-foreground);--ck-color-toolbar-border:var(--ck-color-base-border);--ck-color-tooltip-background:var(--ck-color-base-text);--ck-color-tooltip-text:var(--ck-color-base-background);--ck-color-engine-placeholder-text:#707070;--ck-color-upload-bar-background:#6cb5f9;--ck-color-link-default:#0000f0;--ck-color-link-selected-background:rgba(31,177,255,0.1);--ck-disabled-opacity:.5;--ck-focus-outer-shadow-geometry:0 0 0 3px;--ck-focus-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-outer-shadow);--ck-focus-disabled-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-disabled-shadow);--ck-focus-error-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-error-shadow);--ck-focus-ring:1px solid var(--ck-color-focus-border);--ck-font-size-base:13px;--ck-line-height-base:1.84615;--ck-font-face:Helvetica,Arial,Tahoma,Verdana,Sans-Serif;--ck-font-size-tiny:0.7em;--ck-font-size-small:0.75em;--ck-font-size-normal:1em;--ck-font-size-big:1.4em;--ck-font-size-large:1.8em;--ck-ui-component-min-height:2.3em}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{margin:0;padding:0;border:0;background:transparent;text-decoration:none;vertical-align:middle;transition:none;word-wrap:break-word}.ck.ck-reset_all,.ck.ck-reset_all *{border-collapse:collapse;font:normal normal normal var(--ck-font-size-base)/var(--ck-line-height-base) var(--ck-font-face);color:var(--ck-color-text);text-align:left;white-space:nowrap;cursor:auto;float:none}.ck.ck-reset_all .ck-rtl *{text-align:right}.ck.ck-reset_all iframe{vertical-align:inherit}.ck.ck-reset_all textarea{white-space:pre-wrap}.ck.ck-reset_all input[type=password],.ck.ck-reset_all input[type=text],.ck.ck-reset_all textarea{cursor:text}.ck.ck-reset_all input[type=password][disabled],.ck.ck-reset_all input[type=text][disabled],.ck.ck-reset_all textarea[disabled]{cursor:default}.ck.ck-reset_all fieldset{padding:10px;border:2px groove #dfdee3}.ck.ck-reset_all button::-moz-focus-inner{padding:0;border:0}.ck[dir=rtl],.ck[dir=rtl] .ck{text-align:right}:root{--ck-border-radius:2px;--ck-inner-shadow:2px 2px 3px var(--ck-color-shadow-inner) inset;--ck-drop-shadow:0 1px 2px 1px var(--ck-color-shadow-drop);--ck-drop-shadow-active:0 3px 6px 1px var(--ck-color-shadow-drop-active);--ck-spacing-unit:0.6em;--ck-spacing-large:calc(var(--ck-spacing-unit)*1.5);--ck-spacing-standard:var(--ck-spacing-unit);--ck-spacing-medium:calc(var(--ck-spacing-unit)*0.8);--ck-spacing-small:calc(var(--ck-spacing-unit)*0.5);--ck-spacing-tiny:calc(var(--ck-spacing-unit)*0.3);--ck-spacing-extra-tiny:calc(var(--ck-spacing-unit)*0.16)}"},function(e,t,n){var r=n(18);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-editor__editable:not(.ck-editor__nested-editable){border-radius:0}.ck-rounded-corners .ck.ck-editor__editable:not(.ck-editor__nested-editable),.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-focused{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0}.ck.ck-editor__editable_inline{overflow:auto;padding:0 var(--ck-spacing-standard);border:1px solid transparent}.ck.ck-editor__editable_inline[dir=ltr]{text-align:left}.ck.ck-editor__editable_inline[dir=rtl]{text-align:right}.ck.ck-editor__editable_inline>:first-child{margin-top:var(--ck-spacing-large)}.ck.ck-editor__editable_inline>:last-child{margin-bottom:var(--ck-spacing-large)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_n]:after{border-bottom-color:var(--ck-color-base-foreground)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_s]:after{border-top-color:var(--ck-color-base-foreground)}"},function(e,t,n){var r=n(20);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-label{display:block}.ck.ck-voice-label{display:none}.ck.ck-label{font-weight:700}"},function(e,t,n){var r=n(22);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-sticky-panel .ck-sticky-panel__content_sticky{z-index:var(--ck-z-modal);position:fixed;top:0}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky_bottom-limit{top:auto;position:absolute}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky{box-shadow:var(--ck-drop-shadow),0 0;border-width:0 1px 1px;border-top-left-radius:0;border-top-right-radius:0}"},function(e,t,n){var r=n(24);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-dropdown{display:inline-block;position:relative}.ck.ck-dropdown .ck-dropdown__arrow{pointer-events:none;z-index:var(--ck-z-default)}.ck.ck-dropdown .ck-button.ck-dropdown__button{width:100%}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on .ck-tooltip{display:none}.ck.ck-dropdown .ck-dropdown__panel{-webkit-backface-visibility:hidden;display:none;z-index:var(--ck-z-modal);position:absolute}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel-visible{display:inline-block}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw{bottom:100%}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{top:100%;bottom:auto}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se{left:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{right:0}:root{--ck-dropdown-arrow-size:calc(0.5*var(--ck-icon-size))}.ck.ck-dropdown{font-size:inherit}.ck.ck-dropdown .ck-dropdown__arrow{width:var(--ck-dropdown-arrow-size)}[dir=ltr] .ck.ck-dropdown .ck-dropdown__arrow{right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}[dir=rtl] .ck.ck-dropdown .ck-dropdown__arrow{left:var(--ck-spacing-standard);margin-right:var(--ck-spacing-small)}.ck.ck-dropdown.ck-disabled .ck-dropdown__arrow{opacity:var(--ck-disabled-opacity)}[dir=ltr] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-left:var(--ck-spacing-small)}[dir=rtl] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-right:var(--ck-spacing-small)}.ck.ck-dropdown .ck-button.ck-dropdown__button .ck-button__label{width:7em;overflow:hidden;text-overflow:ellipsis}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on{border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown__panel{box-shadow:var(--ck-drop-shadow),0 0;border-radius:0}.ck-rounded-corners .ck.ck-dropdown__panel,.ck.ck-dropdown__panel.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0}.ck.ck-dropdown__panel{background:var(--ck-color-dropdown-panel-background);border:1px solid var(--ck-color-dropdown-panel-border);bottom:0;min-width:100%}"},function(e,t,n){var r=n(26);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-icon{vertical-align:middle}:root{--ck-icon-size:calc(var(--ck-line-height-base)*var(--ck-font-size-normal))}.ck.ck-icon{width:var(--ck-icon-size);height:var(--ck-icon-size);font-size:.8333350694em;will-change:transform}.ck.ck-icon,.ck.ck-icon *{color:inherit;cursor:inherit}.ck.ck-icon :not([fill]){fill:currentColor}"},function(e,t,n){var r=n(28);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports='.ck.ck-tooltip,.ck.ck-tooltip .ck-tooltip__text:after{position:absolute;pointer-events:none;-webkit-backface-visibility:hidden}.ck.ck-tooltip{visibility:hidden;opacity:0;display:none;z-index:var(--ck-z-modal)}.ck.ck-tooltip .ck-tooltip__text{display:inline-block}.ck.ck-tooltip .ck-tooltip__text:after{content:"";width:0;height:0}:root{--ck-tooltip-arrow-size:5px}.ck.ck-tooltip{left:50%;top:0;transition:opacity .2s ease-in-out .2s}.ck.ck-tooltip .ck-tooltip__text{border-radius:0}.ck-rounded-corners .ck.ck-tooltip .ck-tooltip__text,.ck.ck-tooltip .ck-tooltip__text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-tooltip .ck-tooltip__text{font-size:.9em;line-height:1.5;color:var(--ck-color-tooltip-text);padding:var(--ck-spacing-small) var(--ck-spacing-medium);background:var(--ck-color-tooltip-background);position:relative;left:-50%}.ck.ck-tooltip .ck-tooltip__text:after{transition:opacity .2s ease-in-out .2s;border-style:solid;left:50%}.ck.ck-tooltip.ck-tooltip_s{bottom:calc(-1*var(--ck-tooltip-arrow-size));transform:translateY(100%)}.ck.ck-tooltip.ck-tooltip_s .ck-tooltip__text:after{top:calc(-1*var(--ck-tooltip-arrow-size));transform:translateX(-50%);border-left-color:transparent;border-bottom-color:var(--ck-color-tooltip-background);border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:0}.ck.ck-tooltip.ck-tooltip_n{top:calc(-1*var(--ck-tooltip-arrow-size));transform:translateY(-100%)}.ck.ck-tooltip.ck-tooltip_n .ck-tooltip__text:after{bottom:calc(-1*var(--ck-tooltip-arrow-size));transform:translateX(-50%);border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;border-top-color:var(--ck-color-tooltip-background);border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:0;border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}'},function(e,t,n){var r=n(30);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-button,a.ck.ck-button{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:block}@media (hover:none){.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:none}}.ck.ck-button,a.ck.ck-button{position:relative;display:inline-flex;align-items:center;justify-content:left}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{display:none}.ck.ck-button.ck-button_with-text .ck-button__label,a.ck.ck-button.ck-button_with-text .ck-button__label{display:inline-block}.ck.ck-button:not(.ck-button_with-text),a.ck.ck-button:not(.ck-button_with-text){justify-content:center}.ck.ck-button:hover .ck-tooltip,a.ck.ck-button:hover .ck-tooltip{visibility:visible;opacity:1}.ck.ck-button:focus:not(:hover) .ck-tooltip,a.ck.ck-button:focus:not(:hover) .ck-tooltip{display:none}.ck.ck-button,a.ck.ck-button{background:var(--ck-color-button-default-background)}.ck.ck-button:not(.ck-disabled):hover,a.ck.ck-button:not(.ck-disabled):hover{background:var(--ck-color-button-default-hover-background)}.ck.ck-button:not(.ck-disabled):active,a.ck.ck-button:not(.ck-disabled):active{background:var(--ck-color-button-default-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-default-active-shadow)}.ck.ck-button.ck-disabled,a.ck.ck-button.ck-disabled{background:var(--ck-color-button-default-disabled-background)}.ck.ck-button,a.ck.ck-button{border-radius:0}.ck-rounded-corners .ck.ck-button,.ck-rounded-corners a.ck.ck-button,.ck.ck-button.ck-rounded-corners,a.ck.ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-button,a.ck.ck-button{white-space:nowrap;cursor:default;vertical-align:middle;padding:var(--ck-spacing-tiny);text-align:center;min-width:var(--ck-ui-component-min-height);min-height:var(--ck-ui-component-min-height);line-height:1;font-size:inherit;border:1px solid transparent;transition:box-shadow .2s ease-in-out,border .2s ease-in-out;-webkit-appearance:none}.ck.ck-button:active,.ck.ck-button:focus,a.ck.ck-button:active,a.ck.ck-button:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-button .ck-button__icon use,.ck.ck-button .ck-button__icon use *,a.ck.ck-button .ck-button__icon use,a.ck.ck-button .ck-button__icon use *{color:inherit}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{font-size:inherit;font-weight:inherit;color:inherit;cursor:inherit;vertical-align:middle}[dir=ltr] .ck.ck-button .ck-button__label,[dir=ltr] a.ck.ck-button .ck-button__label{text-align:left}[dir=rtl] .ck.ck-button .ck-button__label,[dir=rtl] a.ck.ck-button .ck-button__label{text-align:right}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{color:inherit}[dir=ltr] .ck.ck-button .ck-button__keystroke,[dir=ltr] a.ck.ck-button .ck-button__keystroke{margin-left:var(--ck-spacing-large)}[dir=rtl] .ck.ck-button .ck-button__keystroke,[dir=rtl] a.ck.ck-button .ck-button__keystroke{margin-right:var(--ck-spacing-large)}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{font-weight:700;opacity:.7}.ck.ck-button.ck-disabled:active,.ck.ck-button.ck-disabled:focus,a.ck.ck-button.ck-disabled:active,a.ck.ck-button.ck-disabled:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-button.ck-disabled .ck-button__icon,a.ck.ck-button.ck-disabled .ck-button__icon{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__label,a.ck.ck-button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__keystroke,a.ck.ck-button.ck-disabled .ck-button__keystroke{opacity:.3}.ck.ck-button.ck-button_with-text,a.ck.ck-button.ck-button_with-text{padding:var(--ck-spacing-tiny) var(--ck-spacing-standard)}[dir=ltr] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=ltr] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-left:calc(-1*var(--ck-spacing-small));margin-right:var(--ck-spacing-small)}[dir=rtl] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=rtl] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-right:calc(-1*var(--ck-spacing-small));margin-left:var(--ck-spacing-small)}.ck.ck-button.ck-button_with-keystroke .ck-button__label,a.ck.ck-button.ck-button_with-keystroke .ck-button__label{flex-grow:1}.ck.ck-button.ck-on,a.ck.ck-button.ck-on{background:var(--ck-color-button-on-background)}.ck.ck-button.ck-on:not(.ck-disabled):hover,a.ck.ck-button.ck-on:not(.ck-disabled):hover{background:var(--ck-color-button-on-hover-background)}.ck.ck-button.ck-on:not(.ck-disabled):active,a.ck.ck-button.ck-on:not(.ck-disabled):active{background:var(--ck-color-button-on-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-on-active-shadow)}.ck.ck-button.ck-on.ck-disabled,a.ck.ck-button.ck-on.ck-disabled{background:var(--ck-color-button-on-disabled-background)}.ck.ck-button.ck-button-save,a.ck.ck-button.ck-button-save{color:var(--ck-color-button-save)}.ck.ck-button.ck-button-cancel,a.ck.ck-button.ck-button-cancel{color:var(--ck-color-button-cancel)}.ck.ck-button-action,a.ck.ck-button-action{background:var(--ck-color-button-action-background)}.ck.ck-button-action:not(.ck-disabled):hover,a.ck.ck-button-action:not(.ck-disabled):hover{background:var(--ck-color-button-action-hover-background)}.ck.ck-button-action:not(.ck-disabled):active,a.ck.ck-button-action:not(.ck-disabled):active{background:var(--ck-color-button-action-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-action-active-shadow)}.ck.ck-button-action.ck-disabled,a.ck.ck-button-action.ck-disabled{background:var(--ck-color-button-action-disabled-background)}.ck.ck-button-action,a.ck.ck-button-action{color:var(--ck-color-button-action-text)}.ck.ck-button-bold,a.ck.ck-button-bold{font-weight:700}"},function(e,t,n){var r=n(32);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-list{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-direction:column}.ck.ck-list .ck-list__item,.ck.ck-list .ck-list__separator{display:block}.ck.ck-list .ck-list__item>:focus{position:relative;z-index:var(--ck-z-default)}.ck.ck-list{border-radius:0}.ck-rounded-corners .ck.ck-list,.ck.ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-list{list-style-type:none;background:var(--ck-color-list-background)}.ck.ck-list__item{cursor:default;min-width:12em}.ck.ck-list__item .ck-button{min-height:unset;width:100%;text-align:left;border-radius:0;padding:calc(0.2*var(--ck-line-height-base)*var(--ck-font-size-base)) calc(0.4*var(--ck-line-height-base)*var(--ck-font-size-base))}.ck.ck-list__item .ck-button .ck-button__label{line-height:calc(1.2*var(--ck-line-height-base)*var(--ck-font-size-base))}.ck.ck-list__item .ck-button:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on{background:var(--ck-color-list-button-on-background);color:var(--ck-color-list-button-on-text)}.ck.ck-list__item .ck-button.ck-on:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-on-background-focus)}.ck.ck-list__item .ck-button.ck-on:focus:not(.ck-disabled){border-color:var(--ck-color-base-background)}.ck.ck-list__item .ck-button:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background)}.ck.ck-list__item .ck-switchbutton.ck-on{background:var(--ck-color-list-background);color:inherit}.ck.ck-list__item .ck-switchbutton.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background);color:inherit}.ck.ck-list__separator{height:1px;width:100%;background:var(--ck-color-base-border)}"},function(e,t,n){var r=n(34);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{display:block}:root{--ck-switch-button-toggle-width:2.6153846154em;--ck-switch-button-toggle-inner-size:1.0769230769em;--ck-switch-button-toggle-spacing:1px;--ck-switch-button-translation:1.3846153847em}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__label{margin-right:calc(2*var(--ck-spacing-large))}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__label{margin-left:calc(2*var(--ck-spacing-large))}.ck.ck-button.ck-switchbutton .ck-button__toggle{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle.ck-rounded-corners{border-radius:var(--ck-border-radius)}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-left:auto}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-right:auto}.ck.ck-button.ck-switchbutton .ck-button__toggle{transition:background .4s ease;width:var(--ck-switch-button-toggle-width);background:var(--ck-color-switch-button-off-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:calc(0.5*var(--ck-border-radius))}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{margin:var(--ck-switch-button-toggle-spacing);width:var(--ck-switch-button-toggle-inner-size);height:var(--ck-switch-button-toggle-inner-size);background:var(--ck-color-switch-button-inner-background);transition:all .3s ease}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover{background:var(--ck-color-switch-button-off-hover-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover .ck-button__toggle__inner{box-shadow:0 0 0 5px var(--ck-color-switch-button-inner-shadow)}.ck.ck-button.ck-switchbutton.ck-disabled .ck-button__toggle{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle{background:var(--ck-color-switch-button-on-background)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle:hover{background:var(--ck-color-switch-button-on-hover-background)}[dir=ltr] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(var(--ck-switch-button-translation))}[dir=rtl] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(calc(-1*var(--ck-switch-button-translation)))}"},function(e,t,n){var r=n(36);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-toolbar-dropdown .ck.ck-toolbar .ck.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar-dropdown .ck-dropdown__panel .ck-button:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-toolbar-dropdown .ck-toolbar{border:0}"},function(e,t,n){var r=n(38);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-dropdown .ck-dropdown__panel .ck-list{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list,.ck.ck-dropdown .ck-dropdown__panel .ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}"},function(e,t,n){var r=n(40);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-toolbar{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-flow:row nowrap;align-items:center}.ck.ck-toolbar>.ck-toolbar__items{display:flex;flex-flow:row wrap;align-items:center;flex-grow:1}.ck.ck-toolbar .ck.ck-toolbar__separator{display:inline-block}.ck.ck-toolbar .ck.ck-toolbar__separator:first-child,.ck.ck-toolbar .ck.ck-toolbar__separator:last-child{display:none}.ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items{flex-direction:column}.ck.ck-toolbar.ck-toolbar_floating>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck-dropdown__button .ck-dropdown__arrow{display:none}.ck.ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-toolbar,.ck.ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-toolbar{background:var(--ck-color-toolbar-background);padding:0 var(--ck-spacing-small);border:1px solid var(--ck-color-toolbar-border)}.ck.ck-toolbar>.ck-toolbar__items>*{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small);margin-right:var(--ck-spacing-small)}.ck.ck-toolbar.ck-toolbar_vertical{padding:0}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items>.ck{width:100%;margin:0;border-radius:0;border:0}.ck.ck-toolbar>.ck-toolbar__items>*,.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck.ck-button.ck-dropdown__button{padding-left:var(--ck-spacing-tiny)}.ck.ck-toolbar .ck.ck-toolbar__separator{align-self:stretch;width:1px;min-width:1px;margin-top:0;margin-bottom:0;background:var(--ck-color-toolbar-border)}.ck-toolbar-container .ck.ck-toolbar{border:0}.ck.ck-toolbar[dir=rtl]>.ck.ck-toolbar__grouped-dropdown,[dir=rtl] .ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown{padding-right:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl]>.ck.ck-toolbar__items>*,[dir=rtl] .ck.ck-toolbar>.ck.ck-toolbar__items>*{margin-left:var(--ck-spacing-small);margin-right:0}.ck.ck-toolbar[dir=rtl]>.ck.ck-toolbar__items>:last-child,[dir=rtl] .ck.ck-toolbar>.ck.ck-toolbar__items>:last-child{margin-left:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_grouping>.ck-toolbar__items,[dir=rtl] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr]>.ck.ck-toolbar__grouped-dropdown,[dir=ltr] .ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown{padding-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr]>.ck.ck-toolbar__items>:last-child,[dir=ltr] .ck.ck-toolbar>.ck.ck-toolbar__items>:last-child{margin-right:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_grouping>.ck-toolbar__items,[dir=ltr] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items{margin-right:var(--ck-spacing-small)}"},function(e,t,n){var r=n(42);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-editor{position:relative}.ck.ck-editor .ck-editor__top .ck-sticky-panel .ck-toolbar{z-index:var(--ck-z-modal)}.ck.ck-editor__top .ck-sticky-panel .ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-editor__top .ck-sticky-panel .ck-toolbar,.ck.ck-editor__top .ck-sticky-panel .ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius);border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-editor__top .ck-sticky-panel .ck-toolbar{border-bottom-width:0}.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar{border-bottom-width:1px;border-radius:0}.ck-rounded-corners .ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar,.ck.ck-editor__top .ck-sticky-panel .ck-sticky-panel__content_sticky .ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:0}.ck.ck-editor__main>.ck-editor__editable{background:var(--ck-color-base-background);border-radius:0}.ck-rounded-corners .ck.ck-editor__main>.ck-editor__editable,.ck.ck-editor__main>.ck-editor__editable.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}.ck.ck-editor__main>.ck-editor__editable:not(.ck-focused){border-color:var(--ck-color-base-border)}"},function(e,t,n){var r=n(44);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck-content blockquote{overflow:hidden;padding-right:1.5em;padding-left:1.5em;margin-left:0;margin-right:0;font-style:italic;border-left:5px solid #ccc}.ck-content[dir=rtl] blockquote{border-left:0;border-right:5px solid #ccc}"},function(e,t,n){var r=n(46);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck .ck-link_selected{background:var(--ck-color-link-selected-background)}"},function(e,t,n){var r=n(48);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=":root{--ck-color-resizer:var(--ck-color-focus-border);--ck-resizer-size:10px;--ck-resizer-border-width:1px;--ck-resizer-border-radius:2px;--ck-resizer-offset:calc(var(--ck-resizer-size)/-2 - 2px);--ck-resizer-tooltip-offset:10px;--ck-color-resizer-tooltip-background:#262626;--ck-color-resizer-tooltip-text:#f2f2f2}.ck .ck-widget.ck-widget_with-selection-handle{position:relative}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{position:absolute}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{display:block}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle:hover .ck-widget__selection-handle{visibility:visible}.ck .ck-size-view{background:var(--ck-color-resizer-tooltip-background);color:var(--ck-color-resizer-tooltip-text);border:1px solid var(--ck-color-resizer-tooltip-text);border-radius:var(--ck-resizer-border-radius);font-size:var(--ck-font-size-tiny);display:block;padding:var(--ck-spacing-small)}.ck .ck-size-view.ck-orientation-bottom-left,.ck .ck-size-view.ck-orientation-bottom-right,.ck .ck-size-view.ck-orientation-top-left,.ck .ck-size-view.ck-orientation-top-right{position:absolute}.ck .ck-size-view.ck-orientation-top-left{top:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-top-right{top:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-right{bottom:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-left{bottom:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}:root{--ck-widget-outline-thickness:3px;--ck-widget-handler-icon-size:16px;--ck-widget-handler-animation-duration:200ms;--ck-widget-handler-animation-curve:ease;--ck-color-widget-blurred-border:#dedede;--ck-color-widget-hover-border:#ffc83d;--ck-color-widget-editable-focus-background:var(--ck-color-base-background);--ck-color-widget-drag-handler-icon-color:var(--ck-color-base-background)}.ck .ck-widget{outline-width:var(--ck-widget-outline-thickness);outline-style:solid;outline-color:transparent;transition:outline-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_selected,.ck .ck-widget.ck-widget_selected:hover{outline:var(--ck-widget-outline-thickness) solid var(--ck-color-focus-border)}.ck .ck-widget:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-editor__nested-editable{border:1px solid transparent}.ck .ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck .ck-editor__nested-editable:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0;background-color:var(--ck-color-widget-editable-focus-background)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{padding:4px;box-sizing:border-box;background-color:transparent;opacity:0;transition:background-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),visibility var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);border-radius:var(--ck-border-radius) var(--ck-border-radius) 0 0;transform:translateY(-100%);left:calc(0px - var(--ck-widget-outline-thickness))}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{width:var(--ck-widget-handler-icon-size);height:var(--ck-widget-handler-icon-size);color:var(--ck-color-widget-drag-handler-icon-color)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:0;transition:opacity .3s var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover .ck-icon .ck-icon__selected-indicator{opacity:1}.ck .ck-widget.ck-widget_with-selection-handle:hover .ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-widget-hover-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover .ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-focus-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:1}.ck-editor__editable>.ck-widget.ck-widget_with-selection-handle:first-child,.ck-editor__editable blockquote>.ck-widget.ck-widget_with-selection-handle:first-child{margin-top:calc(1em + var(--ck-widget-handler-icon-size))}.ck[dir=rtl] .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{left:auto;right:calc(0px - var(--ck-widget-outline-thickness))}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover{outline-color:var(--ck-color-widget-blurred-border)}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle .ck-widget__selection-handle:hover,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle .ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck-editor__editable.ck-read-only .ck-widget{--ck-widget-outline-thickness:0}"},function(e,t,n){var r=n(50);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-labeled-input .ck-labeled-input__status{font-size:var(--ck-font-size-small);margin-top:var(--ck-spacing-small);white-space:normal}.ck.ck-labeled-input .ck-labeled-input__status_error{color:var(--ck-color-base-error)}"},function(e,t,n){var r=n(52);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=":root{--ck-input-text-width:18em}.ck.ck-input-text{border-radius:0}.ck-rounded-corners .ck.ck-input-text,.ck.ck-input-text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-input-text{box-shadow:var(--ck-inner-shadow),0 0;background:var(--ck-color-input-background);border:1px solid var(--ck-color-input-border);padding:var(--ck-spacing-extra-tiny) var(--ck-spacing-medium);min-width:var(--ck-input-text-width);min-height:var(--ck-ui-component-min-height);transition:box-shadow .2s ease-in-out,border .2s ease-in-out}.ck.ck-input-text:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),var(--ck-inner-shadow)}.ck.ck-input-text[readonly]{border:1px solid var(--ck-color-input-disabled-border);background:var(--ck-color-input-disabled-background);color:var(--ck-color-input-disabled-text)}.ck.ck-input-text[readonly]:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),var(--ck-inner-shadow)}.ck.ck-input-text.ck-error{border-color:var(--ck-color-input-error-border);animation:ck-text-input-shake .3s ease both}.ck.ck-input-text.ck-error:focus{box-shadow:var(--ck-focus-error-outer-shadow),var(--ck-inner-shadow)}@keyframes ck-text-input-shake{20%{transform:translateX(-2px)}40%{transform:translateX(2px)}60%{transform:translateX(-1px)}80%{transform:translateX(1px)}}"},function(e,t,n){var r=n(54);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-text-alternative-form{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-text-alternative-form .ck-labeled-input{display:inline-block}.ck.ck-text-alternative-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-text-alternative-form{flex-wrap:wrap}.ck.ck-text-alternative-form .ck-labeled-input{flex-basis:100%}.ck.ck-text-alternative-form .ck-button{flex-basis:50%}}.ck.ck-text-alternative-form{padding:var(--ck-spacing-standard)}.ck.ck-text-alternative-form:focus{outline:none}[dir=ltr] .ck.ck-text-alternative-form>:not(:first-child),[dir=rtl] .ck.ck-text-alternative-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-text-alternative-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-text-alternative-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-text-alternative-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-text-alternative-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-text-alternative-form .ck-button{margin-left:0}[dir=ltr] .ck.ck-text-alternative-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-text-alternative-form .ck-button{margin-left:0}[dir=rtl] .ck.ck-text-alternative-form .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}}"},function(e,t,n){var r=n(56);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=':root{--ck-balloon-panel-arrow-z-index:calc(var(--ck-z-default) - 3)}.ck.ck-balloon-panel{display:none;position:absolute;z-index:var(--ck-z-modal)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{content:"";position:absolute}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_n]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_n]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_s]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_s]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel.ck-balloon-panel_visible{display:block}:root{--ck-balloon-arrow-offset:2px;--ck-balloon-arrow-height:10px;--ck-balloon-arrow-half-width:8px}.ck.ck-balloon-panel{border-radius:0}.ck-rounded-corners .ck.ck-balloon-panel,.ck.ck-balloon-panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-balloon-panel{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{width:0;height:0;border-style:solid}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:var(--ck-balloon-arrow-height);border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:0}.ck.ck-balloon-panel[class*=arrow_n]:before{border-bottom-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-color:transparent;border-right-color:transparent;border-top-color:transparent}.ck.ck-balloon-panel[class*=arrow_n]:after{border-bottom-color:var(--ck-color-panel-background);margin-top:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:0;border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:var(--ck-balloon-arrow-height)}.ck.ck-balloon-panel[class*=arrow_s]:before{border-top-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent}.ck.ck-balloon-panel[class*=arrow_s]:after{border-top-color:var(--ck-color-panel-background);margin-bottom:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:before{left:50%;margin-left:calc(-1*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:before{left:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:before{right:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:before{left:50%;margin-left:calc(-1*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:before{left:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:before{right:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}'},function(e,t,n){var r=n(58);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck .ck-balloon-rotator__navigation{display:flex;align-items:center;justify-content:center}.ck .ck-balloon-rotator__content .ck-toolbar{justify-content:center}.ck .ck-balloon-rotator__navigation{background:var(--ck-color-toolbar-background);border-bottom:1px solid var(--ck-color-toolbar-border);padding:0 var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation>*{margin-right:var(--ck-spacing-small);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation .ck-balloon-rotator__counter{margin-right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}.ck .ck-balloon-rotator__content .ck.ck-annotation-wrapper{box-shadow:none}"},function(e,t,n){var r=n(60);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck .ck-fake-panel{position:absolute;z-index:calc(var(--ck-z-modal) - 1)}.ck .ck-fake-panel div{position:absolute}.ck .ck-fake-panel div:first-child{z-index:2}.ck .ck-fake-panel div:nth-child(2){z-index:1}:root{--ck-balloon-fake-panel-offset-horizontal:6px;--ck-balloon-fake-panel-offset-vertical:6px}.ck .ck-fake-panel div{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border);border-radius:var(--ck-border-radius);width:100%;height:100%}.ck .ck-fake-panel div:first-child{margin-left:var(--ck-balloon-fake-panel-offset-horizontal);margin-top:var(--ck-balloon-fake-panel-offset-vertical)}.ck .ck-fake-panel div:nth-child(2){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*2);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*2)}.ck .ck-fake-panel div:nth-child(3){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*3);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*3)}.ck .ck-balloon-panel_arrow_s+.ck-fake-panel,.ck .ck-balloon-panel_arrow_se+.ck-fake-panel,.ck .ck-balloon-panel_arrow_sw+.ck-fake-panel{--ck-balloon-fake-panel-offset-vertical:-6px}"},function(e,t,n){var r=n(62);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck-content .image{display:table;clear:both;text-align:center;margin:1em auto}.ck-content .image>img{display:block;margin:0 auto;max-width:100%;min-width:50px}"},function(e,t,n){var r=n(64);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-editor__editable .image{position:relative}.ck.ck-editor__editable .image .ck-progress-bar{position:absolute;top:0;left:0}.ck.ck-editor__editable .image.ck-appear{animation:fadeIn .7s}.ck.ck-editor__editable .image .ck-progress-bar{height:2px;width:0;background:var(--ck-color-upload-bar-background);transition:width .1s}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}"},function(e,t,n){var r=n(66);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports='.ck-image-upload-complete-icon{display:block;position:absolute;top:10px;right:10px;border-radius:50%}.ck-image-upload-complete-icon:after{content:"";position:absolute}:root{--ck-color-image-upload-icon:#fff;--ck-color-image-upload-icon-background:#008a00;--ck-image-upload-icon-size:20px;--ck-image-upload-icon-width:2px}.ck-image-upload-complete-icon{width:var(--ck-image-upload-icon-size);height:var(--ck-image-upload-icon-size);opacity:0;background:var(--ck-color-image-upload-icon-background);animation-name:ck-upload-complete-icon-show,ck-upload-complete-icon-hide;animation-fill-mode:forwards,forwards;animation-duration:.5s,.5s;font-size:var(--ck-image-upload-icon-size);animation-delay:0ms,3s}.ck-image-upload-complete-icon:after{left:25%;top:50%;opacity:0;height:0;width:0;transform:scaleX(-1) rotate(135deg);transform-origin:left top;border-top:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);border-right:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);animation-name:ck-upload-complete-icon-check;animation-duration:.5s;animation-delay:.5s;animation-fill-mode:forwards;box-sizing:border-box}@keyframes ck-upload-complete-icon-show{0%{opacity:0}to{opacity:1}}@keyframes ck-upload-complete-icon-hide{0%{opacity:1}to{opacity:0}}@keyframes ck-upload-complete-icon-check{0%{opacity:1;width:0;height:0}33%{width:.3em;height:0}to{opacity:1;width:.3em;height:.45em}}'},function(e,t,n){var r=n(68);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports='.ck .ck-upload-placeholder-loader{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0}.ck .ck-upload-placeholder-loader:before{content:"";position:relative}:root{--ck-color-upload-placeholder-loader:#b3b3b3;--ck-upload-placeholder-loader-size:32px}.ck .ck-image-upload-placeholder{width:100%;margin:0}.ck .ck-upload-placeholder-loader{width:100%;height:100%}.ck .ck-upload-placeholder-loader:before{width:var(--ck-upload-placeholder-loader-size);height:var(--ck-upload-placeholder-loader-size);border-radius:50%;border-top:3px solid var(--ck-color-upload-placeholder-loader);border-right:2px solid transparent;animation:ck-upload-placeholder-loader 1s linear infinite}@keyframes ck-upload-placeholder-loader{to{transform:rotate(1turn)}}'},function(e,t){e.exports=".ck.ck-heading_heading1{font-size:20px}.ck.ck-heading_heading2{font-size:17px}.ck.ck-heading_heading3{font-size:14px}.ck[class*=ck-heading_heading]{font-weight:700}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__button .ck-button__label{width:8em}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__panel .ck-list__item{min-width:18em}"},function(e,t,n){var r=n(71);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck-content .image>figcaption{display:table-caption;caption-side:bottom;word-break:break-word;color:#333;background-color:#f7f7f7;padding:.6em;font-size:.75em;outline-offset:-1px}"},function(e,t,n){var r=n(73);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=":root{--ck-image-style-spacing:1.5em}.ck-content .image-style-align-center,.ck-content .image-style-align-left,.ck-content .image-style-align-right,.ck-content .image-style-side{max-width:50%}.ck-content .image-style-side{float:right;margin-left:var(--ck-image-style-spacing)}.ck-content .image-style-align-left{float:left;margin-right:var(--ck-image-style-spacing)}.ck-content .image-style-align-center{margin-left:auto;margin-right:auto}.ck-content .image-style-align-right{float:right;margin-left:var(--ck-image-style-spacing)}"},function(e,t,n){var r=n(75);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-link-form{display:flex}.ck.ck-link-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-link-form{flex-wrap:wrap}.ck.ck-link-form .ck-labeled-input{flex-basis:100%}.ck.ck-link-form .ck-button{flex-basis:50%}}.ck.ck-link-form_layout-vertical{display:block}.ck.ck-link-form{padding:var(--ck-spacing-standard)}.ck.ck-link-form:focus{outline:none}[dir=ltr] .ck.ck-link-form>:not(:first-child),[dir=rtl] .ck.ck-link-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-link-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-link-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-link-form .ck-button{margin-left:0}[dir=ltr] .ck.ck-link-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-link-form .ck-button{margin-left:0}[dir=rtl] .ck.ck-link-form .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}}.ck.ck-link-form_layout-vertical{padding:0;min-width:var(--ck-input-text-width)}.ck.ck-link-form_layout-vertical .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) var(--ck-spacing-small)}.ck.ck-link-form_layout-vertical .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-link-form_layout-vertical .ck-button{padding:var(--ck-spacing-standard);margin:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border);width:50%}[dir=ltr] .ck.ck-link-form_layout-vertical .ck-button{margin-left:0}[dir=ltr] .ck.ck-link-form_layout-vertical .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button{margin-left:0}[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}.ck.ck-link-form_layout-vertical .ck.ck-list{margin-left:0}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton{border:0;width:100%}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton:hover{background:none}"},function(e,t,n){var r=n(77);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-link-actions{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-link-actions .ck-link-actions__preview{display:inline-block}.ck.ck-link-actions .ck-link-actions__preview .ck-button__label{overflow:hidden}@media screen and (max-width:600px){.ck.ck-link-actions{flex-wrap:wrap}.ck.ck-link-actions .ck-link-actions__preview{flex-basis:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){flex-basis:50%}}.ck.ck-link-actions{padding:var(--ck-spacing-standard)}.ck.ck-link-actions .ck-button.ck-link-actions__preview{padding-left:0;padding-right:0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{padding:0 var(--ck-spacing-medium);color:var(--ck-color-link-default);text-overflow:ellipsis;cursor:pointer;max-width:var(--ck-input-text-width);min-width:3em;text-align:center}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label:hover{text-decoration:underline}.ck.ck-link-actions .ck-button.ck-link-actions__preview,.ck.ck-link-actions .ck-button.ck-link-actions__preview:active,.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus,.ck.ck-link-actions .ck-button.ck-link-actions__preview:hover{background:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:active{box-shadow:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus .ck-button__label{text-decoration:underline}.ck.ck-link-actions:focus{outline:none}[dir=ltr] .ck.ck-link-actions .ck-button:not(:first-child),[dir=rtl] .ck.ck-link-actions .ck-button:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-actions{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-link-actions .ck-button.ck-link-actions__preview{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{min-width:0;max-width:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){margin-left:0}[dir=ltr] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview):first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){margin-left:0}[dir=rtl] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview):last-of-type{border-right:1px solid var(--ck-color-base-border)}}"},function(e,t,n){var r=n(79);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports='.ck-media__wrapper .ck-media__placeholder{display:flex;flex-direction:column;align-items:center}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:block}@media (hover:none){.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:none}}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url{max-width:100%;position:relative}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url:hover .ck-tooltip{visibility:visible;opacity:1}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-media__placeholder__url__text{overflow:hidden;display:block}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck-media__placeholder__icon *{display:none}.ck-editor__editable:not(.ck-read-only) .ck-media__wrapper>:not(.ck-media__placeholder),.ck-editor__editable:not(.ck-read-only) .ck-widget:not(.ck-widget_selected) .ck-media__placeholder{pointer-events:none}:root{--ck-media-embed-placeholder-icon-size:3em;--ck-color-media-embed-placeholder-url-text:#757575;--ck-color-media-embed-placeholder-url-text-hover:var(--ck-color-base-text)}.ck-media__wrapper{margin:0 auto}.ck-media__wrapper .ck-media__placeholder{padding:calc(3*var(--ck-spacing-standard));background:var(--ck-color-base-foreground)}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon{min-width:var(--ck-media-embed-placeholder-icon-size);height:var(--ck-media-embed-placeholder-icon-size);margin-bottom:var(--ck-spacing-large);background-position:50%;background-size:cover}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon .ck-icon{width:100%;height:100%}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text{color:var(--ck-color-media-embed-placeholder-url-text);white-space:nowrap;text-align:center;font-style:italic;text-overflow:ellipsis}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:var(--ck-color-media-embed-placeholder-url-text-hover);cursor:pointer;text-decoration:underline}.ck-media__wrapper[data-oembed-url*="open.spotify.com"]{max-width:300px;max-height:380px}.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTAuMzc4IiBoZWlnaHQ9IjI1NC4xNjciIHZpZXdCb3g9IjAgMCA2Ni4yNDYgNjcuMjQ4Ij48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcyLjUzMSAtMjE4LjQ1NSkgc2NhbGUoLjk4MDEyKSI+PHJlY3Qgcnk9IjUuMjM4IiByeD0iNS4yMzgiIHk9IjIzMS4zOTkiIHg9IjE3Ni4wMzEiIGhlaWdodD0iNjAuMDk5IiB3aWR0aD0iNjAuMDk5IiBmaWxsPSIjMzRhNjY4IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0yMDYuNDc3IDI2MC45bC0yOC45ODcgMjguOTg3YTUuMjE4IDUuMjE4IDAgMDAzLjc4IDEuNjFoNDkuNjIxYzEuNjk0IDAgMy4xOS0uNzk4IDQuMTQ2LTIuMDM3eiIgZmlsbD0iIzVjODhjNSIvPjxwYXRoIGQ9Ik0yMjYuNzQyIDIyMi45ODhjLTkuMjY2IDAtMTYuNzc3IDcuMTctMTYuNzc3IDE2LjAxNC4wMDcgMi43NjIuNjYzIDUuNDc0IDIuMDkzIDcuODc1LjQzLjcwMy44MyAxLjQwOCAxLjE5IDIuMTA3LjMzMy41MDIuNjUgMS4wMDUuOTUgMS41MDguMzQzLjQ3Ny42NzMuOTU3Ljk4OCAxLjQ0IDEuMzEgMS43NjkgMi41IDMuNTAyIDMuNjM3IDUuMTY4Ljc5MyAxLjI3NSAxLjY4MyAyLjY0IDIuNDY2IDMuOTkgMi4zNjMgNC4wOTQgNC4wMDcgOC4wOTIgNC42IDEzLjkxNHYuMDEyYy4xODIuNDEyLjUxNi42NjYuODc5LjY2Ny40MDMtLjAwMS43NjgtLjMxNC45My0uNzk5LjYwMy01Ljc1NiAyLjIzOC05LjcyOSA0LjU4NS0xMy43OTQuNzgyLTEuMzUgMS42NzMtMi43MTUgMi40NjUtMy45OSAxLjEzNy0xLjY2NiAyLjMyOC0zLjQgMy42MzgtNS4xNjkuMzE1LS40ODIuNjQ1LS45NjIuOTg4LTEuNDM5LjMtLjUwMy42MTctMS4wMDYuOTUtMS41MDguMzU5LS43Ljc2LTEuNDA0IDEuMTktMi4xMDcgMS40MjYtMi40MDIgMi01LjExNCAyLjAwNC03Ljg3NSAwLTguODQ0LTcuNTExLTE2LjAxNC0xNi43NzYtMTYuMDE0eiIgZmlsbD0iI2RkNGIzZSIgcGFpbnQtb3JkZXI9Im1hcmtlcnMgc3Ryb2tlIGZpbGwiLz48ZWxsaXBzZSByeT0iNS41NjQiIHJ4PSI1LjgyOCIgY3k9IjIzOS4wMDIiIGN4PSIyMjYuNzQyIiBmaWxsPSIjODAyZDI3IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0xOTAuMzAxIDIzNy4yODNjLTQuNjcgMC04LjQ1NyAzLjg1My04LjQ1NyA4LjYwNnMzLjc4NiA4LjYwNyA4LjQ1NyA4LjYwN2MzLjA0MyAwIDQuODA2LS45NTggNi4zMzctMi41MTYgMS41My0xLjU1NyAyLjA4Ny0zLjkxMyAyLjA4Ny02LjI5IDAtLjM2Mi0uMDIzLS43MjItLjA2NC0xLjA3OWgtOC4yNTd2My4wNDNoNC44NWMtLjE5Ny43NTktLjUzMSAxLjQ1LTEuMDU4IDEuOTg2LS45NDIuOTU4LTIuMDI4IDEuNTQ4LTMuOTAxIDEuNTQ4LTIuODc2IDAtNS4yMDgtMi4zNzItNS4yMDgtNS4yOTkgMC0yLjkyNiAyLjMzMi01LjI5OSA1LjIwOC01LjI5OSAxLjM5OSAwIDIuNjE4LjQwNyAzLjU4NCAxLjI5M2wyLjM4MS0yLjM4YzAtLjAwMi0uMDAzLS4wMDQtLjAwNC0uMDA1LTEuNTg4LTEuNTI0LTMuNjItMi4yMTUtNS45NTUtMi4yMTV6bTQuNDMgNS42NmwuMDAzLjAwNnYtLjAwM3oiIGZpbGw9IiNmZmYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxNS4xODQgMjUxLjkyOWwtNy45OCA3Ljk3OSAyOC40NzcgMjguNDc1YTUuMjMzIDUuMjMzIDAgMDAuNDQ5LTIuMTIzdi0zMS4xNjVjLS40NjkuNjc1LS45MzQgMS4zNDktMS4zODIgMi4wMDUtLjc5MiAxLjI3NS0xLjY4MiAyLjY0LTIuNDY1IDMuOTktMi4zNDcgNC4wNjUtMy45ODIgOC4wMzgtNC41ODUgMTMuNzk0LS4xNjIuNDg1LS41MjcuNzk4LS45My43OTktLjM2My0uMDAxLS42OTctLjI1NS0uODc5LS42Njd2LS4wMTJjLS41OTMtNS44MjItMi4yMzctOS44Mi00LjYtMTMuOTE0LS43ODMtMS4zNS0xLjY3My0yLjcxNS0yLjQ2Ni0zLjk5LTEuMTM3LTEuNjY2LTIuMzI3LTMuNC0zLjYzNy01LjE2OWwtLjAwMi0uMDAzeiIgZmlsbD0iI2MzYzNjMyIvPjxwYXRoIGQ9Ik0yMTIuOTgzIDI0OC40OTVsLTM2Ljk1MiAzNi45NTN2LjgxMmE1LjIyNyA1LjIyNyAwIDAwNS4yMzggNS4yMzhoMS4wMTVsMzUuNjY2LTM1LjY2NmExMzYuMjc1IDEzNi4yNzUgMCAwMC0yLjc2NC0zLjkgMzcuNTc1IDM3LjU3NSAwIDAwLS45ODktMS40NCAzNS4xMjcgMzUuMTI3IDAgMDAtLjk1LTEuNTA4Yy0uMDgzLS4xNjItLjE3Ni0uMzI2LS4yNjQtLjQ4OXoiIGZpbGw9IiNmZGRjNGYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxMS45OTggMjYxLjA4M2wtNi4xNTIgNi4xNTEgMjQuMjY0IDI0LjI2NGguNzgxYTUuMjI3IDUuMjI3IDAgMDA1LjIzOS01LjIzOHYtMS4wNDV6IiBmaWxsPSIjZmZmIiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjwvZz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder{background:#4268b3}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSIxMDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik05NjcuNDg0IDBINTYuNTE3QzI1LjMwNCAwIDAgMjUuMzA0IDAgNTYuNTE3djkxMC45NjZDMCA5OTguNjk0IDI1LjI5NyAxMDI0IDU2LjUyMiAxMDI0SDU0N1Y2MjhINDE0VjQ3M2gxMzNWMzU5LjAyOWMwLTEzMi4yNjIgODAuNzczLTIwNC4yODIgMTk4Ljc1Ni0yMDQuMjgyIDU2LjUxMyAwIDEwNS4wODYgNC4yMDggMTE5LjI0NCA2LjA4OVYyOTlsLTgxLjYxNi4wMzdjLTYzLjk5MyAwLTc2LjM4NCAzMC40OTItNzYuMzg0IDc1LjIzNlY0NzNoMTUzLjQ4N2wtMTkuOTg2IDE1NUg3MDd2Mzk2aDI2MC40ODRjMzEuMjEzIDAgNTYuNTE2LTI1LjMwMyA1Ni41MTYtNTYuNTE2VjU2LjUxNUMxMDI0IDI1LjMwMyA5OTguNjk3IDAgOTY3LjQ4NCAwIiBmaWxsPSIjRkZGRkZFIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#cdf}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder{background:linear-gradient(-135deg,#1400c8,#b900b4,#f50000)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTA0IiBoZWlnaHQ9IjUwNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0wIC4xNTloNTAzLjg0MVY1MDMuOTRIMHoiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48cGF0aCBkPSJNMjUxLjkyMS4xNTljLTY4LjQxOCAwLTc2Ljk5Ny4yOS0xMDMuODY3IDEuNTE2LTI2LjgxNCAxLjIyMy00NS4xMjcgNS40ODItNjEuMTUxIDExLjcxLTE2LjU2NiA2LjQzNy0zMC42MTUgMTUuMDUxLTQ0LjYyMSAyOS4wNTYtMTQuMDA1IDE0LjAwNi0yMi42MTkgMjguMDU1LTI5LjA1NiA0NC42MjEtNi4yMjggMTYuMDI0LTEwLjQ4NyAzNC4zMzctMTEuNzEgNjEuMTUxQy4yOSAxNzUuMDgzIDAgMTgzLjY2MiAwIDI1Mi4wOGMwIDY4LjQxNy4yOSA3Ni45OTYgMS41MTYgMTAzLjg2NiAxLjIyMyAyNi44MTQgNS40ODIgNDUuMTI3IDExLjcxIDYxLjE1MSA2LjQzNyAxNi41NjYgMTUuMDUxIDMwLjYxNSAyOS4wNTYgNDQuNjIxIDE0LjAwNiAxNC4wMDUgMjguMDU1IDIyLjYxOSA0NC42MjEgMjkuMDU3IDE2LjAyNCA2LjIyNyAzNC4zMzcgMTAuNDg2IDYxLjE1MSAxMS43MDkgMjYuODcgMS4yMjYgMzUuNDQ5IDEuNTE2IDEwMy44NjcgMS41MTYgNjguNDE3IDAgNzYuOTk2LS4yOSAxMDMuODY2LTEuNTE2IDI2LjgxNC0xLjIyMyA0NS4xMjctNS40ODIgNjEuMTUxLTExLjcwOSAxNi41NjYtNi40MzggMzAuNjE1LTE1LjA1MiA0NC42MjEtMjkuMDU3IDE0LjAwNS0xNC4wMDYgMjIuNjE5LTI4LjA1NSAyOS4wNTctNDQuNjIxIDYuMjI3LTE2LjAyNCAxMC40ODYtMzQuMzM3IDExLjcwOS02MS4xNTEgMS4yMjYtMjYuODcgMS41MTYtMzUuNDQ5IDEuNTE2LTEwMy44NjYgMC02OC40MTgtLjI5LTc2Ljk5Ny0xLjUxNi0xMDMuODY3LTEuMjIzLTI2LjgxNC01LjQ4Mi00NS4xMjctMTEuNzA5LTYxLjE1MS02LjQzOC0xNi41NjYtMTUuMDUyLTMwLjYxNS0yOS4wNTctNDQuNjIxLTE0LjAwNi0xNC4wMDUtMjguMDU1LTIyLjYxOS00NC42MjEtMjkuMDU2LTE2LjAyNC02LjIyOC0zNC4zMzctMTAuNDg3LTYxLjE1MS0xMS43MUMzMjguOTE3LjQ0OSAzMjAuMzM4LjE1OSAyNTEuOTIxLjE1OXptMCA0NS4zOTFjNjcuMjY1IDAgNzUuMjMzLjI1NyAxMDEuNzk3IDEuNDY5IDI0LjU2MiAxLjEyIDM3LjkwMSA1LjIyNCA0Ni43NzggOC42NzQgMTEuNzU5IDQuNTcgMjAuMTUxIDEwLjAyOSAyOC45NjYgMTguODQ1IDguODE2IDguODE1IDE0LjI3NSAxNy4yMDcgMTguODQ1IDI4Ljk2NiAzLjQ1IDguODc3IDcuNTU0IDIyLjIxNiA4LjY3NCA0Ni43NzggMS4yMTIgMjYuNTY0IDEuNDY5IDM0LjUzMiAxLjQ2OSAxMDEuNzk4IDAgNjcuMjY1LS4yNTcgNzUuMjMzLTEuNDY5IDEwMS43OTctMS4xMiAyNC41NjItNS4yMjQgMzcuOTAxLTguNjc0IDQ2Ljc3OC00LjU3IDExLjc1OS0xMC4wMjkgMjAuMTUxLTE4Ljg0NSAyOC45NjYtOC44MTUgOC44MTYtMTcuMjA3IDE0LjI3NS0yOC45NjYgMTguODQ1LTguODc3IDMuNDUtMjIuMjE2IDcuNTU0LTQ2Ljc3OCA4LjY3NC0yNi41NiAxLjIxMi0zNC41MjcgMS40NjktMTAxLjc5NyAxLjQ2OS02Ny4yNzEgMC03NS4yMzctLjI1Ny0xMDEuNzk4LTEuNDY5LTI0LjU2Mi0xLjEyLTM3LjkwMS01LjIyNC00Ni43NzgtOC42NzQtMTEuNzU5LTQuNTctMjAuMTUxLTEwLjAyOS0yOC45NjYtMTguODQ1LTguODE1LTguODE1LTE0LjI3NS0xNy4yMDctMTguODQ1LTI4Ljk2Ni0zLjQ1LTguODc3LTcuNTU0LTIyLjIxNi04LjY3NC00Ni43NzgtMS4yMTItMjYuNTY0LTEuNDY5LTM0LjUzMi0xLjQ2OS0xMDEuNzk3IDAtNjcuMjY2LjI1Ny03NS4yMzQgMS40NjktMTAxLjc5OCAxLjEyLTI0LjU2MiA1LjIyNC0zNy45MDEgOC42NzQtNDYuNzc4IDQuNTctMTEuNzU5IDEwLjAyOS0yMC4xNTEgMTguODQ1LTI4Ljk2NiA4LjgxNS04LjgxNiAxNy4yMDctMTQuMjc1IDI4Ljk2Ni0xOC44NDUgOC44NzctMy40NSAyMi4yMTYtNy41NTQgNDYuNzc4LTguNjc0IDI2LjU2NC0xLjIxMiAzNC41MzItMS40NjkgMTAxLjc5OC0xLjQ2OXoiIGZpbGw9IiNGRkYiIG1hc2s9InVybCgjYikiLz48cGF0aCBkPSJNMjUxLjkyMSAzMzYuMDUzYy00Ni4zNzggMC04My45NzQtMzcuNTk2LTgzLjk3NC04My45NzMgMC00Ni4zNzggMzcuNTk2LTgzLjk3NCA4My45NzQtODMuOTc0IDQ2LjM3NyAwIDgzLjk3MyAzNy41OTYgODMuOTczIDgzLjk3NCAwIDQ2LjM3Ny0zNy41OTYgODMuOTczLTgzLjk3MyA4My45NzN6bTAtMjEzLjMzOGMtNzEuNDQ3IDAtMTI5LjM2NSA1Ny45MTgtMTI5LjM2NSAxMjkuMzY1IDAgNzEuNDQ2IDU3LjkxOCAxMjkuMzY0IDEyOS4zNjUgMTI5LjM2NCA3MS40NDYgMCAxMjkuMzY0LTU3LjkxOCAxMjkuMzY0LTEyOS4zNjQgMC03MS40NDctNTcuOTE4LTEyOS4zNjUtMTI5LjM2NC0xMjkuMzY1ek00MTYuNjI3IDExNy42MDRjMCAxNi42OTYtMTMuNTM1IDMwLjIzLTMwLjIzMSAzMC4yMy0xNi42OTUgMC0zMC4yMy0xMy41MzQtMzAuMjMtMzAuMjMgMC0xNi42OTYgMTMuNTM1LTMwLjIzMSAzMC4yMy0zMC4yMzEgMTYuNjk2IDAgMzAuMjMxIDEzLjUzNSAzMC4yMzEgMzAuMjMxIiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg==)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#ffe0fe}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder{background:linear-gradient(90deg,#71c6f4,#0d70a5)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0MDAgNDAwIj48cGF0aCBkPSJNNDAwIDIwMGMwIDExMC41LTg5LjUgMjAwLTIwMCAyMDBTMCAzMTAuNSAwIDIwMCA4OS41IDAgMjAwIDBzMjAwIDg5LjUgMjAwIDIwMHpNMTYzLjQgMzA1LjVjODguNyAwIDEzNy4yLTczLjUgMTM3LjItMTM3LjIgMC0yLjEgMC00LjItLjEtNi4yIDkuNC02LjggMTcuNi0xNS4zIDI0LjEtMjUtOC42IDMuOC0xNy45IDYuNC0yNy43IDcuNiAxMC02IDE3LjYtMTUuNCAyMS4yLTI2LjctOS4zIDUuNS0xOS42IDkuNS0zMC42IDExLjctOC44LTkuNC0yMS4zLTE1LjItMzUuMi0xNS4yLTI2LjYgMC00OC4yIDIxLjYtNDguMiA0OC4yIDAgMy44LjQgNy41IDEuMyAxMS00MC4xLTItNzUuNi0yMS4yLTk5LjQtNTAuNC00LjEgNy4xLTYuNSAxNS40LTYuNSAyNC4yIDAgMTYuNyA4LjUgMzEuNSAyMS41IDQwLjEtNy45LS4yLTE1LjMtMi40LTIxLjgtNnYuNmMwIDIzLjQgMTYuNiA0Mi44IDM4LjcgNDcuMy00IDEuMS04LjMgMS43LTEyLjcgMS43LTMuMSAwLTYuMS0uMy05LjEtLjkgNi4xIDE5LjIgMjMuOSAzMy4xIDQ1IDMzLjUtMTYuNSAxMi45LTM3LjMgMjAuNi01OS45IDIwLjYtMy45IDAtNy43LS4yLTExLjUtLjcgMjEuMSAxMy44IDQ2LjUgMjEuOCA3My43IDIxLjgiIGZpbGw9IiNmZmYiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text{color:#b8e6ff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}'},function(e,t,n){var r=n(81);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck.ck-media-form{display:flex;align-items:flex-start;flex-direction:row;flex-wrap:nowrap}.ck.ck-media-form .ck-labeled-input{display:inline-block}.ck.ck-media-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-media-form{flex-wrap:wrap}.ck.ck-media-form .ck-labeled-input{flex-basis:100%}.ck.ck-media-form .ck-button{flex-basis:50%}}.ck.ck-media-form{padding:var(--ck-spacing-standard)}.ck.ck-media-form:focus{outline:none}[dir=ltr] .ck.ck-media-form>:not(:first-child),[dir=rtl] .ck.ck-media-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-media-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-media-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-media-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-media-form .ck-labeled-input .ck-labeled-input__error{white-space:normal}.ck.ck-media-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-media-form .ck-button{margin-left:0}[dir=ltr] .ck.ck-media-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-media-form .ck-button{margin-left:0}[dir=rtl] .ck.ck-media-form .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}}"},function(e,t,n){var r=n(83);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck-content .media{clear:both;margin:1em 0;display:block;min-width:15em}"},function(e,t,n){var r=n(85);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=":root{--ck-color-table-focused-cell-background:#f5fafe}.ck-widget.table td.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table th.ck-editor__nested-editable.ck-editor__nested-editable_focused{background:var(--ck-color-table-focused-cell-background);border-style:none;outline:1px solid var(--ck-color-focus-border);outline-offset:-1px}"},function(e,t,n){var r=n(87);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck .ck-insert-table-dropdown__grid{display:flex;flex-direction:row;flex-wrap:wrap}:root{--ck-insert-table-dropdown-padding:10px;--ck-insert-table-dropdown-box-height:11px;--ck-insert-table-dropdown-box-width:12px;--ck-insert-table-dropdown-box-margin:1px}.ck .ck-insert-table-dropdown__grid{width:calc(var(--ck-insert-table-dropdown-box-width)*10 + var(--ck-insert-table-dropdown-box-margin)*20 + var(--ck-insert-table-dropdown-padding)*2);padding:var(--ck-insert-table-dropdown-padding) var(--ck-insert-table-dropdown-padding) 0}.ck .ck-insert-table-dropdown__label{text-align:center}.ck .ck-insert-table-dropdown-grid-box{width:var(--ck-insert-table-dropdown-box-width);height:var(--ck-insert-table-dropdown-box-height);margin:var(--ck-insert-table-dropdown-box-margin);border:1px solid var(--ck-color-base-border);border-radius:1px}.ck .ck-insert-table-dropdown-grid-box.ck-on{border-color:var(--ck-color-focus-border);background:var(--ck-color-focus-outer-shadow)}"},function(e,t,n){var r=n(89);"string"==typeof r&&(r=[[e.i,r,""]]);var i={injectType:"singletonStyleTag",insert:"head",singleton:!0};n(1)(r,i),r.locals&&(e.exports=r.locals)},function(e,t){e.exports=".ck-content .table{margin:1em auto;display:table}.ck-content .table table{border-collapse:collapse;border-spacing:0;border:1px double #b3b3b3}.ck-content .table table td,.ck-content .table table th{min-width:2em;padding:.4em;border-color:#d9d9d9}.ck-content .table table th{font-weight:700;background:#fafafa}"},function(e,t,n){"use strict";n.r(t);var r=n(3),i=r.a.Symbol,o=Object.prototype,a=o.hasOwnProperty,s=o.toString,c=i?i.toStringTag:void 0,u=function(e){var t=a.call(e,c),n=e[c];try{e[c]=void 0;var r=!0}catch(e){}var i=s.call(e);return r&&(t?e[c]=n:delete e[c]),i},l=Object.prototype.toString,f=function(e){return l.call(e)},h="[object Null]",d="[object Undefined]",p=i?i.toStringTag:void 0,m=function(e){return null==e?void 0===e?d:h:p&&p in Object(e)?u(e):f(e)},y=function(e,t){return function(n){return e(t(n))}},g=y(Object.getPrototypeOf,Object),b=function(e){return null!=e&&"object"==typeof e},v="[object Object]",w=Function.prototype,_=Object.prototype,k=w.toString,E=_.hasOwnProperty,O=k.call(Object),T=function(e){if(!b(e)||m(e)!=v)return!1;var t=g(e);if(null===t)return!0;var n=E.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&k.call(n)==O},x=function(){this.__data__=[],this.size=0},S=function(e,t){return e===t||e!=e&&t!=t},C=function(e,t){for(var n=e.length;n--;)if(S(e[n][0],t))return n;return-1},R=Array.prototype.splice,P=function(e){var t=this.__data__,n=C(t,e);return!(n<0||(n==t.length-1?t.pop():R.call(t,n,1),--this.size,0))},N=function(e){var t=this.__data__,n=C(t,e);return n<0?void 0:t[n][1]},M=function(e){return C(this.__data__,e)>-1},A=function(e,t){var n=this.__data__,r=C(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function j(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}j.prototype.clear=x,j.prototype.delete=P,j.prototype.get=N,j.prototype.has=M,j.prototype.set=A;var I,D=j,L=function(){this.__data__=new D,this.size=0},B=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},F=function(e){return this.__data__.get(e)},q=function(e){return this.__data__.has(e)},V=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},U="[object AsyncFunction]",H="[object Function]",z="[object GeneratorFunction]",W="[object Proxy]",Y=function(e){if(!V(e))return!1;var t=m(e);return t==H||t==z||t==U||t==W},Q=r.a["__core-js_shared__"],G=(I=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||""))?"Symbol(src)_1."+I:"",J=function(e){return!!G&&G in e},K=Function.prototype.toString,$=function(e){if(null!=e){try{return K.call(e)}catch(e){}try{return e+""}catch(e){}}return""},X=/^\[object .+?Constructor\]$/,Z=Function.prototype,ee=Object.prototype,te=Z.toString,ne=ee.hasOwnProperty,re=RegExp("^"+te.call(ne).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ie=function(e){return!(!V(e)||J(e))&&(Y(e)?re:X).test($(e))},oe=function(e,t){return null==e?void 0:e[t]},ae=function(e,t){var n=oe(e,t);return ie(n)?n:void 0},se=ae(r.a,"Map"),ce=ae(Object,"create"),ue=function(){this.__data__=ce?ce(null):{},this.size=0},le=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},fe="__lodash_hash_undefined__",he=Object.prototype.hasOwnProperty,de=function(e){var t=this.__data__;if(ce){var n=t[e];return n===fe?void 0:n}return he.call(t,e)?t[e]:void 0},pe=Object.prototype.hasOwnProperty,me=function(e){var t=this.__data__;return ce?void 0!==t[e]:pe.call(t,e)},ye="__lodash_hash_undefined__",ge=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ce&&void 0===t?ye:t,this};function be(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}be.prototype.clear=ue,be.prototype.delete=le,be.prototype.get=de,be.prototype.has=me,be.prototype.set=ge;var ve=be,we=function(){this.size=0,this.__data__={hash:new ve,map:new(se||D),string:new ve}},_e=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},ke=function(e,t){var n=e.__data__;return _e(t)?n["string"==typeof t?"string":"hash"]:n.map},Ee=function(e){var t=ke(this,e).delete(e);return this.size-=t?1:0,t},Oe=function(e){return ke(this,e).get(e)},Te=function(e){return ke(this,e).has(e)},xe=function(e,t){var n=ke(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function Se(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Se.prototype.clear=we,Se.prototype.delete=Ee,Se.prototype.get=Oe,Se.prototype.has=Te,Se.prototype.set=xe;var Ce=Se,Re=200,Pe=function(e,t){var n=this.__data__;if(n instanceof D){var r=n.__data__;if(!se||r.length<Re-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Ce(r)}return n.set(e,t),this.size=n.size,this};function Ne(e){var t=this.__data__=new D(e);this.size=t.size}Ne.prototype.clear=L,Ne.prototype.delete=B,Ne.prototype.get=F,Ne.prototype.has=q,Ne.prototype.set=Pe;var Me=Ne,Ae=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},je=function(){try{var e=ae(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ie=function(e,t,n){"__proto__"==t&&je?je(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},De=Object.prototype.hasOwnProperty,Le=function(e,t,n){var r=e[t];De.call(e,t)&&S(r,n)&&(void 0!==n||t in e)||Ie(e,t,n)},Be=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?Ie(n,s,c):Le(n,s,c)}return n},Fe=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},qe="[object Arguments]",Ve=function(e){return b(e)&&m(e)==qe},Ue=Object.prototype,He=Ue.hasOwnProperty,ze=Ue.propertyIsEnumerable,We=Ve(function(){return arguments}())?Ve:function(e){return b(e)&&He.call(e,"callee")&&!ze.call(e,"callee")},Ye=Array.isArray,Qe=n(5),Ge=9007199254740991,Je=/^(?:0|[1-9]\d*)$/,Ke=function(e,t){var n=typeof e;return!!(t=null==t?Ge:t)&&("number"==n||"symbol"!=n&&Je.test(e))&&e>-1&&e%1==0&&e<t},$e=9007199254740991,Xe=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=$e},Ze={};Ze["[object Float32Array]"]=Ze["[object Float64Array]"]=Ze["[object Int8Array]"]=Ze["[object Int16Array]"]=Ze["[object Int32Array]"]=Ze["[object Uint8Array]"]=Ze["[object Uint8ClampedArray]"]=Ze["[object Uint16Array]"]=Ze["[object Uint32Array]"]=!0,Ze["[object Arguments]"]=Ze["[object Array]"]=Ze["[object ArrayBuffer]"]=Ze["[object Boolean]"]=Ze["[object DataView]"]=Ze["[object Date]"]=Ze["[object Error]"]=Ze["[object Function]"]=Ze["[object Map]"]=Ze["[object Number]"]=Ze["[object Object]"]=Ze["[object RegExp]"]=Ze["[object Set]"]=Ze["[object String]"]=Ze["[object WeakMap]"]=!1;var et=function(e){return b(e)&&Xe(e.length)&&!!Ze[m(e)]},tt=function(e){return function(t){return e(t)}},nt=n(4),rt=nt.a&&nt.a.isTypedArray,it=rt?tt(rt):et,ot=Object.prototype.hasOwnProperty,at=function(e,t){var n=Ye(e),r=!n&&We(e),i=!n&&!r&&Object(Qe.a)(e),o=!n&&!r&&!i&&it(e),a=n||r||i||o,s=a?Fe(e.length,String):[],c=s.length;for(var u in e)!t&&!ot.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ke(u,c))||s.push(u);return s},st=Object.prototype,ct=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||st)},ut=y(Object.keys,Object),lt=Object.prototype.hasOwnProperty,ft=function(e){if(!ct(e))return ut(e);var t=[];for(var n in Object(e))lt.call(e,n)&&"constructor"!=n&&t.push(n);return t},ht=function(e){return null!=e&&Xe(e.length)&&!Y(e)},dt=function(e){return ht(e)?at(e):ft(e)},pt=function(e,t){return e&&Be(t,dt(t),e)},mt=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},yt=Object.prototype.hasOwnProperty,gt=function(e){if(!V(e))return mt(e);var t=ct(e),n=[];for(var r in e)("constructor"!=r||!t&&yt.call(e,r))&&n.push(r);return n},bt=function(e){return ht(e)?at(e,!0):gt(e)},vt=function(e,t){return e&&Be(t,bt(t),e)},wt=n(12),_t=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},kt=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o},Et=function(){return[]},Ot=Object.prototype.propertyIsEnumerable,Tt=Object.getOwnPropertySymbols,xt=Tt?function(e){return null==e?[]:(e=Object(e),kt(Tt(e),(function(t){return Ot.call(e,t)})))}:Et,St=function(e,t){return Be(e,xt(e),t)},Ct=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},Rt=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Ct(t,xt(e)),e=g(e);return t}:Et,Pt=function(e,t){return Be(e,Rt(e),t)},Nt=function(e,t,n){var r=t(e);return Ye(e)?r:Ct(r,n(e))},Mt=function(e){return Nt(e,dt,xt)},At=function(e){return Nt(e,bt,Rt)},jt=ae(r.a,"DataView"),It=ae(r.a,"Promise"),Dt=ae(r.a,"Set"),Lt=ae(r.a,"WeakMap"),Bt=$(jt),Ft=$(se),qt=$(It),Vt=$(Dt),Ut=$(Lt),Ht=m;(jt&&"[object DataView]"!=Ht(new jt(new ArrayBuffer(1)))||se&&"[object Map]"!=Ht(new se)||It&&"[object Promise]"!=Ht(It.resolve())||Dt&&"[object Set]"!=Ht(new Dt)||Lt&&"[object WeakMap]"!=Ht(new Lt))&&(Ht=function(e){var t=m(e),n="[object Object]"==t?e.constructor:void 0,r=n?$(n):"";if(r)switch(r){case Bt:return"[object DataView]";case Ft:return"[object Map]";case qt:return"[object Promise]";case Vt:return"[object Set]";case Ut:return"[object WeakMap]"}return t});var zt=Ht,Wt=Object.prototype.hasOwnProperty,Yt=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Wt.call(e,"index")&&(n.index=e.index,n.input=e.input),n},Qt=r.a.Uint8Array,Gt=function(e){var t=new e.constructor(e.byteLength);return new Qt(t).set(new Qt(e)),t},Jt=function(e,t){var n=t?Gt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},Kt=/\w*$/,$t=function(e){var t=new e.constructor(e.source,Kt.exec(e));return t.lastIndex=e.lastIndex,t},Xt=i?i.prototype:void 0,Zt=Xt?Xt.valueOf:void 0,en=function(e){return Zt?Object(Zt.call(e)):{}},tn=function(e,t){var n=t?Gt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)},nn="[object Boolean]",rn="[object Date]",on="[object Map]",an="[object Number]",sn="[object RegExp]",cn="[object Set]",un="[object String]",ln="[object Symbol]",fn="[object ArrayBuffer]",hn="[object DataView]",dn="[object Float32Array]",pn="[object Float64Array]",mn="[object Int8Array]",yn="[object Int16Array]",gn="[object Int32Array]",bn="[object Uint8Array]",vn="[object Uint8ClampedArray]",wn="[object Uint16Array]",_n="[object Uint32Array]",kn=function(e,t,n){var r=e.constructor;switch(t){case fn:return Gt(e);case nn:case rn:return new r(+e);case hn:return Jt(e,n);case dn:case pn:case mn:case yn:case gn:case bn:case vn:case wn:case _n:return tn(e,n);case on:return new r;case an:case un:return new r(e);case sn:return $t(e);case cn:return new r;case ln:return en(e)}},En=Object.create,On=function(){function e(){}return function(t){if(!V(t))return{};if(En)return En(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),Tn=function(e){return"function"!=typeof e.constructor||ct(e)?{}:On(g(e))},xn="[object Map]",Sn=function(e){return b(e)&&zt(e)==xn},Cn=nt.a&&nt.a.isMap,Rn=Cn?tt(Cn):Sn,Pn="[object Set]",Nn=function(e){return b(e)&&zt(e)==Pn},Mn=nt.a&&nt.a.isSet,An=Mn?tt(Mn):Nn,jn=1,In=2,Dn=4,Ln="[object Arguments]",Bn="[object Function]",Fn="[object GeneratorFunction]",qn="[object Object]",Vn={};Vn[Ln]=Vn["[object Array]"]=Vn["[object ArrayBuffer]"]=Vn["[object DataView]"]=Vn["[object Boolean]"]=Vn["[object Date]"]=Vn["[object Float32Array]"]=Vn["[object Float64Array]"]=Vn["[object Int8Array]"]=Vn["[object Int16Array]"]=Vn["[object Int32Array]"]=Vn["[object Map]"]=Vn["[object Number]"]=Vn[qn]=Vn["[object RegExp]"]=Vn["[object Set]"]=Vn["[object String]"]=Vn["[object Symbol]"]=Vn["[object Uint8Array]"]=Vn["[object Uint8ClampedArray]"]=Vn["[object Uint16Array]"]=Vn["[object Uint32Array]"]=!0,Vn["[object Error]"]=Vn[Bn]=Vn["[object WeakMap]"]=!1;var Un=function e(t,n,r,i,o,a){var s,c=n&jn,u=n&In,l=n&Dn;if(r&&(s=o?r(t,i,o,a):r(t)),void 0!==s)return s;if(!V(t))return t;var f=Ye(t);if(f){if(s=Yt(t),!c)return _t(t,s)}else{var h=zt(t),d=h==Bn||h==Fn;if(Object(Qe.a)(t))return Object(wt.a)(t,c);if(h==qn||h==Ln||d&&!o){if(s=u||d?{}:Tn(t),!c)return u?Pt(t,vt(s,t)):St(t,pt(s,t))}else{if(!Vn[h])return o?t:{};s=kn(t,h,c)}}a||(a=new Me);var p=a.get(t);if(p)return p;a.set(t,s),An(t)?t.forEach((function(i){s.add(e(i,n,r,i,t,a))})):Rn(t)&&t.forEach((function(i,o){s.set(o,e(i,n,r,o,t,a))}));var m=l?u?At:Mt:u?keysIn:dt,y=f?void 0:m(t);return Ae(y||t,(function(i,o){y&&(i=t[o=i]),Le(s,o,e(i,n,r,o,t,a))})),s},Hn=1,zn=4,Wn=function(e,t){return Un(e,Hn|zn,t="function"==typeof t?t:void 0)},Yn=function(e){return b(e)&&1===e.nodeType&&!T(e)};class Qn{constructor(e,t){this._config={},t&&this.define(t),e&&this._setObjectToTarget(this._config,e)}set(e,t){this._setToTarget(this._config,e,t)}define(e,t){this._setToTarget(this._config,e,t,!0)}get(e){return this._getFromSource(this._config,e)}_setToTarget(e,t,n,r=!1){if(T(t))return void this._setObjectToTarget(e,t,r);const i=t.split(".");t=i.pop();for(const t of i)T(e[t])||(e[t]={}),e=e[t];if(T(n))return T(e[t])||(e[t]={}),e=e[t],void this._setObjectToTarget(e,n,r);r&&void 0!==e[t]||(e[t]=n)}_getFromSource(e,t){const n=t.split(".");t=n.pop();for(const t of n){if(!T(e[t])){e=null;break}e=e[t]}return e?function(e){return Wn(e,Gn)}(e[t]):void 0}_setObjectToTarget(e,t,n){Object.keys(t).forEach((r=>{this._setToTarget(e,r,t[r],n)}))}}function Gn(e){return Yn(e)?e:void 0}var Jn=n(0),Kn=function(){return function e(){e.called=!0}};class $n{constructor(e,t){this.source=e,this.name=t,this.path=[],this.stop=Kn(),this.off=Kn()}}function Xn(){let e="e";for(let t=0;t<8;t++)e+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e}var Zn={get(e){return"number"!=typeof e?this[e]||this.normal:e},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};n(6);const er=Symbol("listeningTo"),tr=Symbol("emitterId");var nr={on(e,t,n={}){this.listenTo(this,e,t,n)},once(e,t,n){let r=!1;this.listenTo(this,e,(function(e,...n){r||(r=!0,e.off(),t.call(this,e,...n))}),n)},off(e,t){this.stopListening(this,e,t)},listenTo(e,t,n,r={}){let i,o;this[er]||(this[er]={});const a=this[er];ir(e)||rr(e);const s=ir(e);(i=a[s])||(i=a[s]={emitter:e,callbacks:{}}),(o=i.callbacks[t])||(o=i.callbacks[t]=[]),o.push(n),function(e,t){const n=or(e);if(n[t])return;let r=t,i=null;const o=[];for(;""!==r&&!n[r];)n[r]={callbacks:[],childEvents:[]},o.push(n[r]),i&&n[r].childEvents.push(i),i=r,r=r.substr(0,r.lastIndexOf(":"));if(""!==r){for(const e of o)e.callbacks=n[r].callbacks.slice();n[r].childEvents.push(i)}}(e,t);const c=ar(e,t),u=Zn.get(r.priority),l={callback:n,priority:u};for(const e of c){let t=!1;for(let n=0;n<e.length;n++)if(e[n].priority<u){e.splice(n,0,l),t=!0;break}t||e.push(l)}},stopListening(e,t,n){const r=this[er];let i=e&&ir(e);const o=r&&i&&r[i],a=o&&t&&o.callbacks[t];if(!(!r||e&&!o||t&&!a))if(n)cr(e,t,n);else if(a){for(;n=a.pop();)cr(e,t,n);delete o.callbacks[t]}else if(o){for(t in o.callbacks)this.stopListening(e,t);delete r[i]}else{for(i in r)this.stopListening(r[i].emitter);delete this[er]}},fire(e,...t){try{const n=e instanceof $n?e:new $n(this,e),r=n.name;let i=function e(t,n){let r;return t._events&&(r=t._events[n])&&r.callbacks.length?r.callbacks:n.indexOf(":")>-1?e(t,n.substr(0,n.lastIndexOf(":"))):null}(this,r);if(n.path.push(this),i){const e=[n,...t];i=Array.from(i);for(let t=0;t<i.length&&(i[t].callback.apply(this,e),n.off.called&&(delete n.off.called,cr(this,r,i[t].callback)),!n.stop.called);t++);}if(this._delegations){const e=this._delegations.get(r),i=this._delegations.get("*");e&&sr(e,n,t),i&&sr(i,n,t)}return n.return}catch(e){Jn.b.rethrowUnexpectedError(e,this)}},delegate(...e){return{to:(t,n)=>{this._delegations||(this._delegations=new Map),e.forEach((e=>{const r=this._delegations.get(e);r?r.set(t,n):this._delegations.set(e,new Map([[t,n]]))}))}}},stopDelegating(e,t){if(this._delegations)if(e)if(t){const n=this._delegations.get(e);n&&n.delete(t)}else this._delegations.delete(e);else this._delegations.clear()}};function rr(e,t){e[tr]||(e[tr]=t||Xn())}function ir(e){return e[tr]}function or(e){return e._events||Object.defineProperty(e,"_events",{value:{}}),e._events}function ar(e,t){const n=or(e)[t];if(!n)return[];let r=[n.callbacks];for(let t=0;t<n.childEvents.length;t++){const i=ar(e,n.childEvents[t]);r=r.concat(i)}return r}function sr(e,t,n){for(let[r,i]of e){i?"function"==typeof i&&(i=i(t.name)):i=t.name;const e=new $n(t.source,i);e.path=[...t.path],r.fire(e,...n)}}function cr(e,t,n){const r=ar(e,t);for(const e of r)for(let t=0;t<e.length;t++)e[t].callback==n&&(e.splice(t,1),t--)}function ur(e,...t){t.forEach((t=>{Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t)).forEach((n=>{if(n in e.prototype)return;const r=Object.getOwnPropertyDescriptor(t,n);r.enumerable=!1,Object.defineProperty(e.prototype,n,r)}))}))}function lr(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++)if(e[r]!=t[r])return r;return e.length==t.length?"same":e.length<t.length?"prefix":"extension"}var fr=4,hr=function(e){return Un(e,fr)};class dr{constructor(){this.parent=null}get index(){let e;if(!this.parent)return null;if(-1==(e=this.parent.getChildIndex(this)))throw new Jn.b("view-node-not-found-in-parent: The node's parent does not contain this node.",this);return e}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}get document(){return this.parent instanceof dr?this.parent.document:null}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.index),t=t.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}getCommonAncestor(e,t={}){const n=this.getAncestors(t),r=e.getAncestors(t);let i=0;for(;n[i]==r[i]&&n[i];)i++;return 0===i?null:n[i-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),n=e.getPath(),r=lr(t,n);switch(r){case"prefix":return!0;case"extension":return!1;default:return t[r]<n[r]}}isAfter(e){return this!=e&&this.root===e.root&&!this.isBefore(e)}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,t){this.fire("change:"+e,t),this.parent&&this.parent._fireChange(e,t)}toJSON(){const e=hr(this);return delete e.parent,e}is(e){return"node"==e||"view:node"==e}}ur(dr,nr);class pr extends dr{constructor(e){super(),this._textData=e}is(e){return"text"==e||"view:text"==e||super.is(e)}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof pr&&(this===e||this.data===e.data)}_clone(){return new pr(this.data)}}class mr{constructor(e,t,n){if(this.textNode=e,t<0||t>e.data.length)throw new Jn.b("view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||t+n>e.data.length)throw new Jn.b("view-textproxy-wrong-length: Given length value is incorrect.",this);this.data=e.data.substring(t,t+n),this.offsetInText=t}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(e){return"textProxy"==e||"view:textProxy"==e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let n=e.includeSelf?this.textNode:this.parent;for(;null!==n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}}function yr(e){const t=new Map;for(const n in e)t.set(n,e[n]);return t}function gr(e){return!(!e||!e[Symbol.iterator])}class br{constructor(...e){this._patterns=[],this.add(...e)}add(...e){for(let t of e)("string"==typeof t||t instanceof RegExp)&&(t={name:t}),t.classes&&("string"==typeof t.classes||t.classes instanceof RegExp)&&(t.classes=[t.classes]),this._patterns.push(t)}match(...e){for(const t of e)for(const e of this._patterns){const n=vr(t,e);if(n)return{element:t,pattern:e,match:n}}return null}matchAll(...e){const t=[];for(const n of e)for(const e of this._patterns){const r=vr(n,e);r&&t.push({element:n,pattern:e,match:r})}return t.length>0?t:null}getElementName(){if(1!==this._patterns.length)return null;const e=this._patterns[0],t=e.name;return"function"==typeof e||!t||t instanceof RegExp?null:t}}function vr(e,t){if("function"==typeof t)return t(e);const n={};return t.name&&(n.name=function(e,t){return e instanceof RegExp?e.test(t):e===t}(t.name,e.name),!n.name)||t.attributes&&(n.attributes=function(e,t){const n=[];for(const r in e){const i=e[r];if(!t.hasAttribute(r))return null;{const e=t.getAttribute(r);if(!0===i)n.push(r);else if(i instanceof RegExp){if(!i.test(e))return null;n.push(r)}else{if(e!==i)return null;n.push(r)}}}return n}(t.attributes,e),!n.attributes)?null:!(t.classes&&(n.classes=function(e,t){const n=[];for(const r of e)if(r instanceof RegExp){const e=t.getClassNames();for(const t of e)r.test(t)&&n.push(t);if(0===n.length)return null}else{if(!t.hasClass(r))return null;n.push(r)}return n}(t.classes,e),!n.classes))&&!(t.styles&&(n.styles=function(e,t){const n=[];for(const r in e){const i=e[r];if(!t.hasStyle(r))return null;{const e=t.getStyle(r);if(i instanceof RegExp){if(!i.test(e))return null;n.push(r)}else{if(e!==i)return null;n.push(r)}}}return n}(t.styles,e),!n.styles))&&n}class wr extends dr{constructor(e,t,n){if(super(),this.name=e,this._attrs=function(e){e=T(e)?yr(e):new Map(e);for(const[t,n]of e)null===n?e.delete(t):"string"!=typeof n&&e.set(t,String(n));return e}(t),this._children=[],n&&this._insertChild(0,n),this._classes=new Set,this._attrs.has("class")){const e=this._attrs.get("class");kr(this._classes,e),this._attrs.delete("class")}this._styles=new Map,this._attrs.has("style")&&(_r(this._styles,this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}is(e,t=null){const n=e.replace(/^view:/,"");return t?"element"==n&&t==this.name:"element"==n||n==this.name||super.is(e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.size>0&&(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.size>0&&(yield["style",this.getAttribute("style")])}getAttribute(e){if("class"==e)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"!=e)return this._attrs.get(e);if(this._styles.size>0){let e="";for(const[t,n]of this._styles)e+=`${t}:${n};`;return e}}hasAttribute(e){return"class"==e?this._classes.size>0:"style"==e?this._styles.size>0:this._attrs.has(e)}isSimilar(e){if(!(e instanceof wr))return!1;if(this===e)return!0;if(this.name!=e.name)return!1;if(this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[t,n]of this._attrs)if(!e._attrs.has(t)||e._attrs.get(t)!==n)return!1;for(const t of this._classes)if(!e._classes.has(t))return!1;for(const[t,n]of this._styles)if(!e._styles.has(t)||e._styles.get(t)!==n)return!1;return!0}hasClass(...e){for(const t of e)if(!this._classes.has(t))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.get(e)}getStyleNames(){return this._styles.keys()}hasStyle(...e){for(const t of e)if(!this._styles.has(t))return!1;return!0}findAncestor(...e){const t=new br(...e);let n=this.parent;for(;n;){if(t.match(n))return n;n=n.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),t=Array.from(this._styles).map((e=>`${e[0]}:${e[1]}`)).sort().join(";"),n=Array.from(this._attrs).map((e=>`${e[0]}="${e[1]}"`)).sort().join(" ");return this.name+(""==e?"":` class="${e}"`)+(""==t?"":` style="${t}"`)+(""==n?"":` ${n}`)}_clone(e=!1){const t=[];if(e)for(const n of this.getChildren())t.push(n._clone(e));const n=new this.constructor(this.name,this._attrs,t);return n._classes=new Set(this._classes),n._styles=new Map(this._styles),n._customProperties=new Map(this._customProperties),n.getFillerOffset=this.getFillerOffset,n}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,t){this._fireChange("children",this);let n=0;const r=function(e){return"string"==typeof e?[new pr(e)]:(gr(e)||(e=[e]),Array.from(e).map((e=>"string"==typeof e?new pr(e):e instanceof mr?new pr(e.data):e)))}(t);for(const t of r)null!==t.parent&&t._remove(),t.parent=this,this._children.splice(e,0,t),e++,n++;return n}_removeChildren(e,t=1){this._fireChange("children",this);for(let n=e;n<e+t;n++)this._children[n].parent=null;return this._children.splice(e,t)}_setAttribute(e,t){t=String(t),this._fireChange("attributes",this),"class"==e?kr(this._classes,t):"style"==e?_r(this._styles,t):this._attrs.set(e,t)}_removeAttribute(e){return this._fireChange("attributes",this),"class"==e?this._classes.size>0&&(this._classes.clear(),!0):"style"==e?this._styles.size>0&&(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this),(e=Array.isArray(e)?e:[e]).forEach((e=>this._classes.add(e)))}_removeClass(e){this._fireChange("attributes",this),(e=Array.isArray(e)?e:[e]).forEach((e=>this._classes.delete(e)))}_setStyle(e,t){if(this._fireChange("attributes",this),T(e)){const t=Object.keys(e);for(const n of t)this._styles.set(n,e[n])}else this._styles.set(e,t)}_removeStyle(e){this._fireChange("attributes",this),(e=Array.isArray(e)?e:[e]).forEach((e=>this._styles.delete(e)))}_setCustomProperty(e,t){this._customProperties.set(e,t)}_removeCustomProperty(e){return this._customProperties.delete(e)}}function _r(e,t){let n=null,r=0,i=0,o=null;if(e.clear(),""!==t){";"!=t.charAt(t.length-1)&&(t+=";");for(let a=0;a<t.length;a++){const s=t.charAt(a);if(null===n)switch(s){case":":o||(o=t.substr(r,a-r),i=a+1);break;case'"':case"'":n=s;break;case";":{const n=t.substr(i,a-i);o&&e.set(o.trim(),n.trim()),o=null,r=a+1;break}}else s===n&&(n=null)}}}function kr(e,t){const n=t.split(/\s+/);e.clear(),n.forEach((t=>e.add(t)))}class Er extends wr{constructor(e,t,n){super(e,t,n),this.getFillerOffset=Or}is(e,t=null){const n=e&&e.replace(/^view:/,"");return t?"containerElement"==n&&t==this.name||super.is(e,t):"containerElement"==n||super.is(e)}}function Or(){const e=[...this.getChildren()],t=e[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const t of e)if(!t.is("uiElement"))return null;return this.childCount}var Tr=function(e){return e},xr=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},Sr=Math.max,Cr=function(e,t,n){return t=Sr(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=Sr(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),xr(e,this,s)}},Rr=function(e){return function(){return e}},Pr=je?function(e,t){return je(e,"toString",{configurable:!0,enumerable:!1,value:Rr(t),writable:!0})}:Tr,Nr=800,Mr=16,Ar=Date.now,jr=function(e){var t=0,n=0;return function(){var r=Ar(),i=Mr-(r-n);if(n=r,i>0){if(++t>=Nr)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Pr),Ir=function(e,t){return jr(Cr(e,t,Tr),e+"")},Dr=function(e,t,n){if(!V(n))return!1;var r=typeof t;return!!("number"==r?ht(n)&&Ke(t,n.length):"string"==r&&t in n)&&S(n[t],e)},Lr=function(e){return Ir((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&Dr(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t}))}((function(e,t){Be(t,bt(t),e)}));const Br=Symbol("observableProperties"),Fr=Symbol("boundObservables"),qr=Symbol("boundProperties"),Vr={set(e,t){if(V(e))return void Object.keys(e).forEach((t=>{this.set(t,e[t])}),this);Hr(this);const n=this[Br];if(e in this&&!n.has(e))throw new Jn.b("observable-set-cannot-override: Cannot override an existing property.",this);Object.defineProperty(this,e,{enumerable:!0,configurable:!0,get:()=>n.get(e),set(t){const r=n.get(e);let i=this.fire("set:"+e,e,t,r);void 0===i&&(i=t),r===i&&n.has(e)||(n.set(e,i),this.fire("change:"+e,e,i,r))}}),this[e]=t},bind(...e){if(!e.length||!Yr(e))throw new Jn.b("observable-bind-wrong-properties: All properties must be strings.",this);if(new Set(e).size!==e.length)throw new Jn.b("observable-bind-duplicate-properties: Properties must be unique.",this);Hr(this);const t=this[qr];e.forEach((e=>{if(t.has(e))throw new Jn.b("observable-bind-rebind: Cannot bind the same property more than once.",this)}));const n=new Map;return e.forEach((e=>{const r={property:e,to:[]};t.set(e,r),n.set(e,r)})),{to:zr,toMany:Wr,_observable:this,_bindProperties:e,_to:[],_bindings:n}},unbind(...e){if(!(Br in this))return;const t=this[qr],n=this[Fr];if(e.length){if(!Yr(e))throw new Jn.b("observable-unbind-wrong-properties: Properties must be strings.",this);e.forEach((e=>{const r=t.get(e);if(!r)return;let i,o,a,s;r.to.forEach((e=>{i=e[0],o=e[1],a=n.get(i),s=a[o],s.delete(r),s.size||delete a[o],Object.keys(a).length||(n.delete(i),this.stopListening(i,"change"))})),t.delete(e)}))}else n.forEach(((e,t)=>{this.stopListening(t,"change")})),n.clear(),t.clear()},decorate(e){const t=this[e];if(!t)throw new Jn.b("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.",this,{object:this,methodName:e});this.on(e,((e,n)=>{e.return=t.apply(this,n)})),this[e]=function(...t){return this.fire(e,t)}}};Lr(Vr,nr);var Ur=Vr;function Hr(e){Br in e||(Object.defineProperty(e,Br,{value:new Map}),Object.defineProperty(e,Fr,{value:new Map}),Object.defineProperty(e,qr,{value:new Map}))}function zr(...e){const t=function(...e){if(!e.length)throw new Jn.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);const t={to:[]};let n;return"function"==typeof e[e.length-1]&&(t.callback=e.pop()),e.forEach((e=>{if("string"==typeof e)n.properties.push(e);else{if("object"!=typeof e)throw new Jn.b("observable-bind-to-parse-error: Invalid argument syntax in `to()`.",null);n={observable:e,properties:[]},t.to.push(n)}})),t}(...e),n=Array.from(this._bindings.keys()),r=n.length;if(!t.callback&&t.to.length>1)throw new Jn.b("observable-bind-to-no-callback: Binding multiple observables only possible with callback.",this);if(r>1&&t.callback)throw new Jn.b("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.",this);var i;t.to.forEach((e=>{if(e.properties.length&&e.properties.length!==r)throw new Jn.b("observable-bind-to-properties-length: The number of properties must match.",this);e.properties.length||(e.properties=this._bindProperties)})),this._to=t.to,t.callback&&(this._bindings.get(n[0]).callback=t.callback),i=this._observable,this._to.forEach((e=>{const t=i[Fr];let n;t.get(e.observable)||i.listenTo(e.observable,"change",((r,o)=>{n=t.get(e.observable)[o],n&&n.forEach((e=>{Qr(i,e.property)}))}))})),function(e){let t;e._bindings.forEach(((n,r)=>{e._to.forEach((i=>{t=i.properties[n.callback?0:e._bindProperties.indexOf(r)],n.to.push([i.observable,t]),function(e,t,n,r){const i=e[Fr],o=i.get(n),a=o||{};a[r]||(a[r]=new Set),a[r].add(t),o||i.set(n,a)}(e._observable,n,i.observable,t)}))}))}(this),this._bindProperties.forEach((e=>{Qr(this._observable,e)}))}function Wr(e,t,n){if(this._bindings.size>1)throw new Jn.b("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().",this);this.to(...function(e,t){const n=e.map((e=>[e,t]));return Array.prototype.concat.apply([],n)}(e,t),n)}function Yr(e){return e.every((e=>"string"==typeof e))}function Qr(e,t){const n=e[qr].get(t);let r;n.callback?r=n.callback.apply(e,n.to.map((e=>e[0][e[1]]))):(r=n.to[0],r=r[0][r[1]]),e.hasOwnProperty(t)?e[t]=r:e.set(t,r)}const Gr=Symbol("document");class Jr extends Er{constructor(e,t,n){super(e,t,n),this.set("isReadOnly",!1),this.set("isFocused",!1)}is(e,t=null){const n=e&&e.replace(/^view:/,"");return t?"editableElement"==n&&t==this.name||super.is(e,t):"editableElement"==n||super.is(e)}destroy(){this.stopListening()}get document(){return this.getCustomProperty(Gr)}set _document(e){if(this.getCustomProperty(Gr))throw new Jn.b("view-editableelement-document-already-set: View document is already set.",this);this._setCustomProperty(Gr,e),this.bind("isReadOnly").to(e),this.bind("isFocused").to(e,"isFocused",(t=>t&&e.selection.editableElement==this)),this.listenTo(e.selection,"change",(()=>{this.isFocused=e.isFocused&&e.selection.editableElement==this}))}}ur(Jr,Ur);const Kr=Symbol("rootName");class $r extends Jr{constructor(e){super(e),this.rootName="main"}is(e,t=null){const n=e.replace(/^view:/,"");return t?"rootElement"==n&&t==this.name||super.is(e,t):"rootElement"==n||super.is(e)}get rootName(){return this.getCustomProperty(Kr)}set rootName(e){this._setCustomProperty(Kr,e)}set _name(e){this.name=e}}class Xr{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new Jn.b("view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);if(e.direction&&"forward"!=e.direction&&"backward"!=e.direction)throw new Jn.b("view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this.position=Zr._createAt(e.startPosition):this.position=Zr._createAt(e.boundaries["backward"==e.direction?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(e){let t,n,r;do{r=this.position,({done:t,value:n}=this.next())}while(!t&&e(n));t||(this.position=r)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let e=this.position.clone();const t=this.position,n=e.parent;if(null===n.parent&&e.offset===n.childCount)return{done:!0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};let r;if(n instanceof pr){if(e.isAtEnd)return this.position=Zr._createAfter(n),this._next();r=n.data[e.offset]}else r=n.getChild(e.offset);if(r instanceof wr)return this.shallow?e.offset++:e=new Zr(r,0),this.position=e,this._formatReturnValue("elementStart",r,t,e,1);if(r instanceof pr){if(this.singleCharacters)return e=new Zr(r,0),this.position=e,this._next();{let n,i=r.data.length;return r==this._boundaryEndParent?(i=this.boundaries.end.offset,n=new mr(r,0,i),e=Zr._createAfter(n)):(n=new mr(r,0,r.data.length),e.offset++),this.position=e,this._formatReturnValue("text",n,t,e,i)}}if("string"==typeof r){let r;r=this.singleCharacters?1:(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-e.offset;const i=new mr(n,e.offset,r);return e.offset+=r,this.position=e,this._formatReturnValue("text",i,t,e,r)}return e=Zr._createAfter(n),this.position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,t,e)}_previous(){let e=this.position.clone();const t=this.position,n=e.parent;if(null===n.parent&&0===e.offset)return{done:!0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};let r;if(n instanceof pr){if(e.isAtStart)return this.position=Zr._createBefore(n),this._previous();r=n.data[e.offset-1]}else r=n.getChild(e.offset-1);if(r instanceof wr)return this.shallow?(e.offset--,this.position=e,this._formatReturnValue("elementStart",r,t,e,1)):(e=new Zr(r,r.childCount),this.position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",r,t,e));if(r instanceof pr){if(this.singleCharacters)return e=new Zr(r,r.data.length),this.position=e,this._previous();{let n,i=r.data.length;if(r==this._boundaryStartParent){const t=this.boundaries.start.offset;n=new mr(r,t,r.data.length-t),i=n.data.length,e=Zr._createBefore(n)}else n=new mr(r,0,r.data.length),e.offset--;return this.position=e,this._formatReturnValue("text",n,t,e,i)}}if("string"==typeof r){let r;if(this.singleCharacters)r=1;else{const t=n===this._boundaryStartParent?this.boundaries.start.offset:0;r=e.offset-t}e.offset-=r;const i=new mr(n,e.offset,r);return this.position=e,this._formatReturnValue("text",i,t,e,r)}return e=Zr._createBefore(n),this.position=e,this._formatReturnValue("elementStart",n,t,e,1)}_formatReturnValue(e,t,n,r,i){return t instanceof mr&&(t.offsetInText+t.data.length==t.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?n=Zr._createAfter(t.textNode):(r=Zr._createAfter(t.textNode),this.position=r)),0===t.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?n=Zr._createBefore(t.textNode):(r=Zr._createBefore(t.textNode),this.position=r))),{done:!1,value:{type:e,item:t,previousPosition:n,nextPosition:r,length:i}}}}class Zr{constructor(e,t){this.parent=e,this.offset=t}get nodeAfter(){return this.parent.is("text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const e=this.parent.is("text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof Jr);){if(!e.parent)return null;e=e.parent}return e}getShiftedBy(e){const t=Zr._createAt(this),n=t.offset+e;return t.offset=n<0?0:n,t}getLastMatchingPosition(e,t={}){t.startPosition=this;const n=new Xr(t);return n.skip(e),n.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const t=this.getAncestors(),n=e.getAncestors();let r=0;for(;t[r]==n[r]&&t[r];)r++;return 0===r?null:t[r-1]}is(e){return"position"==e||"view:position"==e}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return"before"==this.compareWith(e)}isAfter(e){return"after"==this.compareWith(e)}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const t=this.parent.is("node")?this.parent.getPath():[],n=e.parent.is("node")?e.parent.getPath():[];t.push(this.offset),n.push(e.offset);const r=lr(t,n);switch(r){case"prefix":return"before";case"extension":return"after";default:return t[r]<n[r]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new Xr(e)}clone(){return new Zr(this.parent,this.offset)}static _createAt(e,t){if(e instanceof Zr)return new this(e.parent,e.offset);{const n=e;if("end"==t)t=n.is("text")?n.data.length:n.childCount;else{if("before"==t)return this._createBefore(n);if("after"==t)return this._createAfter(n);if(0!==t&&!t)throw new Jn.b("view-createPositionAt-offset-required: View#createPositionAt() requires the offset when the first parameter is a view item.",n)}return new Zr(n,t)}}static _createAfter(e){if(e.is("textProxy"))return new Zr(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new Jn.b("view-position-after-root: You can not make position after root.",e,{root:e});return new Zr(e.parent,e.index+1)}static _createBefore(e){if(e.is("textProxy"))return new Zr(e.textNode,e.offsetInText);if(!e.parent)throw new Jn.b("view-position-before-root: You can not make position before root.",e,{root:e});return new Zr(e.parent,e.index)}}class ei{constructor(e,t=null){this.start=e.clone(),this.end=t?t.clone():e.clone()}*[Symbol.iterator](){yield*new Xr({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(ti,{direction:"backward"}),t=this.end.getLastMatchingPosition(ti);return e.parent.is("text")&&e.isAtStart&&(e=Zr._createBefore(e.parent)),t.parent.is("text")&&t.isAtEnd&&(t=Zr._createAfter(t.parent)),new ei(e,t)}getTrimmed(){let e=this.start.getLastMatchingPosition(ti);if(e.isAfter(this.end)||e.isEqual(this.end))return new ei(e,e);let t=this.end.getLastMatchingPosition(ti,{direction:"backward"});const n=e.nodeAfter,r=t.nodeBefore;return n&&n.is("text")&&(e=new Zr(n,0)),r&&r.is("text")&&(t=new Zr(r,r.data.length)),new ei(e,t)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const n=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),r=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return n&&r}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new ei(this.start,e.start)),this.containsPosition(e.end)&&t.push(new ei(e.end,this.end))):t.push(this.clone()),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,n=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(n=e.end),new ei(t,n)}return null}getWalker(e={}){return e.boundaries=this,new Xr(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}clone(){return new ei(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Xr(e);for(const e of t)yield e.item}*getPositions(e={}){e.boundaries=this;const t=new Xr(e);yield t.position;for(const e of t)yield e.nextPosition}is(e){return"range"==e||"view:range"==e}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,t,n,r){return new this(new Zr(e,t),new Zr(n,r))}static _createFromPositionAndShift(e,t){const n=e,r=e.getShiftedBy(t);return t>0?new this(n,r):new this(r,n)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const t=e.is("textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(Zr._createBefore(e),t)}}function ti(e){return!(!e.item.is("attributeElement")&&!e.item.is("uiElement"))}function ni(e){let t=0;for(const n of e)t++;return t}class ri{constructor(e=null,t,n){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(e,t,n)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?e.clone():null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel)return!1;if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let n=!1;for(const r of e._ranges)if(t.isEqual(r)){n=!0;break}if(!n)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const t=ni(this.getRanges());if(t!=ni(e.getRanges()))return!1;if(0==t)return!0;for(let t of this.getRanges()){t=t.getTrimmed();let n=!1;for(let r of e.getRanges())if(r=r.getTrimmed(),t.start.isEqual(r.start)&&t.end.isEqual(r.end)){n=!0;break}if(!n)return!1}return!0}getSelectedElement(){if(1!==this.rangeCount)return null;const e=this.getFirstRange();let t=e.start.nodeAfter,n=e.end.nodeBefore;return e.start.parent.is("text")&&e.start.isAtEnd&&e.start.parent.nextSibling&&(t=e.start.parent.nextSibling),e.end.parent.is("text")&&e.end.isAtStart&&e.end.parent.previousSibling&&(n=e.end.parent.previousSibling),t instanceof wr&&t==n?t:null}setTo(e,t,n){if(null===e)this._setRanges([]),this._setFakeOptions(t);else if(e instanceof ri||e instanceof ii)this._setRanges(e.getRanges(),e.isBackward),this._setFakeOptions({fake:e.isFake,label:e.fakeSelectionLabel});else if(e instanceof ei)this._setRanges([e],t&&t.backward),this._setFakeOptions(t);else if(e instanceof Zr)this._setRanges([new ei(e)]),this._setFakeOptions(t);else if(e instanceof dr){const r=!!n&&!!n.backward;let i;if(void 0===t)throw new Jn.b("view-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",this);i="in"==t?ei._createIn(e):"on"==t?ei._createOn(e):new ei(Zr._createAt(e,t)),this._setRanges([i],r),this._setFakeOptions(n)}else{if(!gr(e))throw new Jn.b("view-selection-setTo-not-selectable: Cannot set selection to given place.",this);this._setRanges(e,t&&t.backward),this._setFakeOptions(t)}this.fire("change")}setFocus(e,t){if(null===this.anchor)throw new Jn.b("view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",this);const n=Zr._createAt(e,t);if("same"==n.compareWith(this.focus))return;const r=this.anchor;this._ranges.pop(),"before"==n.compareWith(r)?this._addRange(new ei(n,r),!0):this._addRange(new ei(r,n)),this.fire("change")}is(e){return"selection"==e||"view:selection"==e}_setRanges(e,t=!1){e=Array.from(e),this._ranges=[];for(const t of e)this._addRange(t);this._lastRangeBackward=!!t}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,t=!1){if(!(e instanceof ei))throw new Jn.b("view-selection-add-range-not-range: Selection range set to an object that is not an instance of view.Range",this);this._pushRange(e),this._lastRangeBackward=!!t}_pushRange(e){for(const t of this._ranges)if(e.isIntersecting(t))throw new Jn.b("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.",this,{addedRange:e,intersectingRange:t});this._ranges.push(new ei(e.start,e.end))}}ur(ri,nr);class ii{constructor(e=null,t,n){this._selection=new ri,this._selection.delegate("change").to(this),this._selection.setTo(e,t,n)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}is(e){return"selection"==e||"documentSelection"==e||"view:selection"==e||"view:documentSelection"==e}_setTo(e,t,n){this._selection.setTo(e,t,n)}_setFocus(e,t){this._selection.setFocus(e,t)}}ur(ii,nr);class oi{constructor(e={}){this._items=[],this._itemMap=new Map,this._idProperty=e.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[]}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,t){let n;const r=this._idProperty;if(r in e){if(n=e[r],"string"!=typeof n)throw new Jn.b("collection-add-invalid-id",this);if(this.get(n))throw new Jn.b("collection-add-item-already-exists",this)}else e[r]=n=Xn();if(void 0===t)t=this._items.length;else if(t>this._items.length||t<0)throw new Jn.b("collection-add-item-invalid-index",this);return this._items.splice(t,0,e),this._itemMap.set(n,e),this.fire("add",e,t),this}get(e){let t;if("string"==typeof e)t=this._itemMap.get(e);else{if("number"!=typeof e)throw new Jn.b("collection-get-invalid-arg: Index or id must be given.",this);t=this._items[e]}return t||null}has(e){if("string"==typeof e)return this._itemMap.has(e);{const t=e[this._idProperty];return this._itemMap.has(t)}}getIndex(e){let t;return t="string"==typeof e?this._itemMap.get(e):e,this._items.indexOf(t)}remove(e){let t,n,r,i=!1;const o=this._idProperty;if("string"==typeof e?(n=e,r=this._itemMap.get(n),i=!r,r&&(t=this._items.indexOf(r))):"number"==typeof e?(t=e,r=this._items[t],i=!r,r&&(n=r[o])):(r=e,n=r[o],t=this._items.indexOf(r),i=-1==t||!this._itemMap.get(n)),i)throw new Jn.b("collection-remove-404: Item not found.",this);this._items.splice(t,1),this._itemMap.delete(n);const a=this._bindToInternalToExternalMap.get(r);return this._bindToInternalToExternalMap.delete(r),this._bindToExternalToInternalMap.delete(a),this.fire("remove",r,t),r}map(e,t){return this._items.map(e,t)}find(e,t){return this._items.find(e,t)}filter(e,t){return this._items.filter(e,t)}clear(){for(this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);this.length;)this.remove(0)}bindTo(e){if(this._bindToCollection)throw new Jn.b("collection-bind-to-rebind: The collection cannot be bound more than once.",this);return this._bindToCollection=e,{as:e=>{this._setUpBindToBinding((t=>new e(t)))},using:e=>{"function"==typeof e?this._setUpBindToBinding((t=>e(t))):this._setUpBindToBinding((t=>t[e]))}}}_setUpBindToBinding(e){const t=this._bindToCollection,n=(n,r,i)=>{const o=t._bindToCollection==this,a=t._bindToInternalToExternalMap.get(r);if(o&&a)this._bindToExternalToInternalMap.set(r,a),this._bindToInternalToExternalMap.set(a,r);else{const n=e(r);if(!n)return void this._skippedIndexesFromExternal.push(i);let o=i;for(const e of this._skippedIndexesFromExternal)i>e&&o--;for(const e of t._skippedIndexesFromExternal)o>=e&&o++;this._bindToExternalToInternalMap.set(r,n),this._bindToInternalToExternalMap.set(n,r),this.add(n,o);for(let e=0;e<t._skippedIndexesFromExternal.length;e++)o<=t._skippedIndexesFromExternal[e]&&t._skippedIndexesFromExternal[e]++}};for(const e of t)n(0,e,t.getIndex(e));this.listenTo(t,"add",n),this.listenTo(t,"remove",((e,t,n)=>{const r=this._bindToExternalToInternalMap.get(t);r&&this.remove(r),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce(((e,t)=>(n<t&&e.push(t-1),n>t&&e.push(t),e)),[])}))}[Symbol.iterator](){return this._items[Symbol.iterator]()}}ur(oi,nr);class ai{constructor(){this.selection=new ii,this.roots=new oi({idProperty:"rootName"}),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isComposing",!1),this._postFixers=new Set}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.map((e=>e.destroy())),this.stopListening()}_callPostFixers(e){let t=!1;do{for(const n of this._postFixers)if(t=n(e),t)break}while(t)}}ur(ai,Ur);const si=10;class ci extends wr{constructor(e,t,n){super(e,t,n),this.getFillerOffset=ui,this._priority=si,this._id=null,this._clonesGroup=null}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(null===this.id)throw new Jn.b("attribute-element-get-elements-with-same-id-no-id: Cannot get elements with the same id for an attribute element without id.",this);return new Set(this._clonesGroup)}is(e,t=null){const n=e&&e.replace(/^view:/,"");return t?"attributeElement"==n&&t==this.name||super.is(e,t):"attributeElement"==n||super.is(e)}isSimilar(e){return null!==this.id||null!==e.id?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e){const t=super._clone(e);return t._priority=this._priority,t._id=this._id,t}}function ui(){if(li(this))return null;let e=this.parent;for(;e&&e.is("attributeElement");){if(li(e)>1)return null;e=e.parent}return!e||li(e)>1?null:this.childCount}function li(e){return Array.from(e.getChildren()).filter((e=>!e.is("uiElement"))).length}ci.DEFAULT_PRIORITY=si;class fi extends wr{constructor(e,t,n){super(e,t,n),this.getFillerOffset=hi}is(e,t=null){const n=e.replace(/^view:/,"");return t?"emptyElement"==n&&t==this.name||super.is(e,t):"emptyElement"==n||super.is(e)}_insertChild(e,t){if(t&&(t instanceof dr||Array.from(t).length>0))throw new Jn.b("view-emptyelement-cannot-add: Cannot add child nodes to EmptyElement instance.",[this,t])}}function hi(){return null}const di=navigator.userAgent.toLowerCase();var pi={isMac:function(e){return e.indexOf("macintosh")>-1}(di),isEdge:function(e){return!!e.match(/edge\/(\d+.?\d*)/)}(di),isGecko:function(e){return!!e.match(/gecko\/\d+/)}(di),isSafari:function(e){return e.indexOf(" applewebkit/")>-1&&-1===e.indexOf("chrome")}(di),isAndroid:function(e){return e.indexOf("android")>-1}(di),features:{isRegExpUnicodePropertySupported:function(){let e=!1;try{e=0==="ć".search(new RegExp("[\\p{L}]","u"))}catch(e){}return e}()}};const mi={"⌘":"ctrl","⇧":"shift","⌥":"alt"},yi={ctrl:"⌘",shift:"⇧",alt:"⌥"},gi=function(){const e={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,cmd:1114112,shift:2228224,alt:4456448};for(let t=65;t<=90;t++)e[String.fromCharCode(t).toLowerCase()]=t;for(let t=48;t<=57;t++)e[t-48]=t;for(let t=112;t<=123;t++)e["f"+(t-111)]=t;return e}();function bi(e){let t;if("string"==typeof e){if(t=gi[e.toLowerCase()],!t)throw new Jn.b("keyboard-unknown-key: Unknown key name.",null,{key:e})}else t=e.keyCode+(e.altKey?gi.alt:0)+(e.ctrlKey?gi.ctrl:0)+(e.shiftKey?gi.shift:0);return t}function vi(e){return"string"==typeof e&&(e=_i(e)),e.map((e=>"string"==typeof e?bi(e):e)).reduce(((e,t)=>t+e),0)}function wi(e){return pi.isMac?_i(e).map((e=>yi[e.toLowerCase()]||e)).reduce(((e,t)=>e.slice(-1)in mi?e+t:e+"+"+t)):e}function _i(e){return e.split(/\s*\+\s*/)}class ki extends wr{constructor(e,t,n){super(e,t,n),this.getFillerOffset=Oi}is(e,t=null){const n=e.replace(/^view:/,"");return t?"uiElement"==n&&t==this.name||super.is(e,t):"uiElement"==n||super.is(e)}_insertChild(e,t){if(t&&(t instanceof dr||Array.from(t).length>0))throw new Jn.b("view-uielement-cannot-add: Cannot add child nodes to UIElement instance.",this)}render(e){return this.toDomElement(e)}toDomElement(e){const t=e.createElement(this.name);for(const e of this.getAttributeKeys())t.setAttribute(e,this.getAttribute(e));return t}}function Ei(e){e.document.on("keydown",((t,n)=>function(e,t,n){if(t.keyCode==gi.arrowright){const e=t.domTarget.ownerDocument.defaultView.getSelection(),r=1==e.rangeCount&&e.getRangeAt(0).collapsed;if(r||t.shiftKey){const t=e.focusNode,i=e.focusOffset,o=n.domPositionToView(t,i);if(null===o)return;let a=!1;const s=o.getLastMatchingPosition((e=>(e.item.is("uiElement")&&(a=!0),!(!e.item.is("uiElement")&&!e.item.is("attributeElement")))));if(a){const t=n.viewPositionToDom(s);r?e.collapse(t.parent,t.offset):e.extend(t.parent,t.offset)}}}}(0,n,e.domConverter)))}function Oi(){return null}class Ti{constructor(e){this._children=[],e&&this._insertChild(0,e)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(e){return"documentFragment"==e||"view:documentFragment"==e}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,t){this._fireChange("children",this);let n=0;const r=function(e){return"string"==typeof e?[new pr(e)]:(gr(e)||(e=[e]),Array.from(e).map((e=>"string"==typeof e?new pr(e):e instanceof mr?new pr(e.data):e)))}(t);for(const t of r)null!==t.parent&&t._remove(),t.parent=this,this._children.splice(e,0,t),e++,n++;return n}_removeChildren(e,t=1){this._fireChange("children",this);for(let n=e;n<e+t;n++)this._children[n].parent=null;return this._children.splice(e,t)}_fireChange(e,t){this.fire("change:"+e,t)}}ur(Ti,nr);class xi{constructor(e){this.document=e,this._cloneGroups=new Map}setSelection(e,t,n){this.document.selection._setTo(e,t,n)}setSelectionFocus(e,t){this.document.selection._setFocus(e,t)}createText(e){return new pr(e)}createAttributeElement(e,t,n={}){const r=new ci(e,t);return n.priority&&(r._priority=n.priority),n.id&&(r._id=n.id),r}createContainerElement(e,t){return new Er(e,t)}createEditableElement(e,t){const n=new Jr(e,t);return n._document=this.document,n}createEmptyElement(e,t){return new fi(e,t)}createUIElement(e,t,n){const r=new ki(e,t);return n&&(r.render=n),r}setAttribute(e,t,n){n._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,n){T(e)&&void 0===n&&(n=t),n._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,n){n._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}breakAttributes(e){return e instanceof Zr?this._breakAttributes(e):this._breakAttributesRange(e)}breakContainer(e){const t=e.parent;if(!t.is("containerElement"))throw new Jn.b("view-writer-break-non-container-element: Trying to break an element which is not a container element.",this.document);if(!t.parent)throw new Jn.b("view-writer-break-root: Trying to break root element.",this.document);if(e.isAtStart)return Zr._createBefore(t);if(!e.isAtEnd){const n=t._clone(!1);this.insert(Zr._createAfter(t),n);const r=new ei(e,Zr._createAt(t,"end")),i=new Zr(n,0);this.move(r,i)}return Zr._createAfter(t)}mergeAttributes(e){const t=e.offset,n=e.parent;if(n.is("text"))return e;if(n.is("attributeElement")&&0===n.childCount){const e=n.parent,t=n.index;return n._remove(),this._removeFromClonedElementsGroup(n),this.mergeAttributes(new Zr(e,t))}const r=n.getChild(t-1),i=n.getChild(t);if(!r||!i)return e;if(r.is("text")&&i.is("text"))return Ni(r,i);if(r.is("attributeElement")&&i.is("attributeElement")&&r.isSimilar(i)){const e=r.childCount;return r._appendChild(i.getChildren()),i._remove(),this._removeFromClonedElementsGroup(i),this.mergeAttributes(new Zr(r,e))}return e}mergeContainers(e){const t=e.nodeBefore,n=e.nodeAfter;if(!(t&&n&&t.is("containerElement")&&n.is("containerElement")))throw new Jn.b("view-writer-merge-containers-invalid-position: Element before and after given position cannot be merged.",this.document);const r=t.getChild(t.childCount-1),i=r instanceof pr?Zr._createAt(r,"end"):Zr._createAt(t,"end");return this.move(ei._createIn(n),Zr._createAt(t,"end")),this.remove(ei._createOn(n)),i}insert(e,t){!function e(t,n){for(const r of t){if(!Mi.some((e=>r instanceof e)))throw new Jn.b("view-writer-insert-invalid-node",n);r.is("text")||e(r.getChildren(),n)}}(t=gr(t)?[...t]:[t],this.document);const n=Si(e);if(!n)throw new Jn.b("view-writer-invalid-position-container",this.document);const r=this._breakAttributes(e,!0),i=n._insertChild(r.offset,t);for(const e of t)this._addToClonedElementsGroup(e);const o=r.getShiftedBy(i),a=this.mergeAttributes(r);if(0===i)return new ei(a,a);{a.isEqual(r)||o.offset--;const e=this.mergeAttributes(o);return new ei(a,e)}}remove(e){const t=e instanceof ei?e:ei._createOn(e);if(ji(t,this.document),t.isCollapsed)return new Ti;const{start:n,end:r}=this._breakAttributesRange(t,!0),i=n.parent,o=r.offset-n.offset,a=i._removeChildren(n.offset,o);for(const e of a)this._removeFromClonedElementsGroup(e);const s=this.mergeAttributes(n);return t.start=s,t.end=s.clone(),new Ti(a)}clear(e,t){ji(e,this.document);const n=e.getWalker({direction:"backward",ignoreElementEnd:!0});for(const r of n){const n=r.item;let i;if(n.is("element")&&t.isSimilar(n))i=ei._createOn(n);else if(!r.nextPosition.isAfter(e.start)&&n.is("textProxy")){const e=n.getAncestors().find((e=>e.is("element")&&t.isSimilar(e)));e&&(i=ei._createIn(e))}i&&(i.end.isAfter(e.end)&&(i.end=e.end),i.start.isBefore(e.start)&&(i.start=e.start),this.remove(i))}}move(e,t){let n;if(t.isAfter(e.end)){const r=(t=this._breakAttributes(t,!0)).parent,i=r.childCount;e=this._breakAttributesRange(e,!0),n=this.remove(e),t.offset+=r.childCount-i}else n=this.remove(e);return this.insert(t,n)}wrap(e,t){if(!(t instanceof ci))throw new Jn.b("view-writer-wrap-invalid-attribute",this.document);if(ji(e,this.document),e.isCollapsed){let r=e.start;r.parent.is("element")&&(n=r.parent,!Array.from(n.getChildren()).some((e=>!e.is("uiElement"))))&&(r=r.getLastMatchingPosition((e=>e.item.is("uiElement")))),r=this._wrapPosition(r,t);const i=this.document.selection;return i.isCollapsed&&i.getFirstPosition().isEqual(e.start)&&this.setSelection(r),new ei(r)}return this._wrapRange(e,t);var n}unwrap(e,t){if(!(t instanceof ci))throw new Jn.b("view-writer-unwrap-invalid-attribute",this.document);if(ji(e,this.document),e.isCollapsed)return e;const{start:n,end:r}=this._breakAttributesRange(e,!0),i=n.parent,o=this._unwrapChildren(i,n.offset,r.offset,t),a=this.mergeAttributes(o.start);a.isEqual(o.start)||o.end.offset--;const s=this.mergeAttributes(o.end);return new ei(a,s)}rename(e,t){const n=new Er(e,t.getAttributes());return this.insert(Zr._createAfter(t),n),this.move(ei._createIn(t),Zr._createAt(n,0)),this.remove(ei._createOn(t)),n}clearClonedElementsGroup(e){this._cloneGroups.delete(e)}createPositionAt(e,t){return Zr._createAt(e,t)}createPositionAfter(e){return Zr._createAfter(e)}createPositionBefore(e){return Zr._createBefore(e)}createRange(e,t){return new ei(e,t)}createRangeOn(e){return ei._createOn(e)}createRangeIn(e){return ei._createIn(e)}createSelection(e,t,n){return new ri(e,t,n)}_wrapChildren(e,t,n,r){let i=t;const o=[];for(;i<n;){const t=e.getChild(i),n=t.is("text"),a=t.is("attributeElement"),s=t.is("emptyElement"),c=t.is("uiElement");if(a&&this._wrapAttributeElement(r,t))o.push(new Zr(e,i));else if(n||s||c||a&&Ci(r,t)){const n=r._clone();t._remove(),n._appendChild(t),e._insertChild(i,n),this._addToClonedElementsGroup(n),o.push(new Zr(e,i))}else a&&this._wrapChildren(t,0,t.childCount,r);i++}let a=0;for(const e of o)e.offset-=a,e.offset!=t&&(this.mergeAttributes(e).isEqual(e)||(a++,n--));return ei._createFromParentsAndOffsets(e,t,e,n)}_unwrapChildren(e,t,n,r){let i=t;const o=[];for(;i<n;){const t=e.getChild(i);if(t.is("attributeElement"))if(t.isSimilar(r)){const r=t.getChildren(),a=t.childCount;t._remove(),e._insertChild(i,r),this._removeFromClonedElementsGroup(t),o.push(new Zr(e,i),new Zr(e,i+a)),i+=a,n+=a-1}else this._unwrapAttributeElement(r,t)?(o.push(new Zr(e,i),new Zr(e,i+1)),i++):(this._unwrapChildren(t,0,t.childCount,r),i++);else i++}let a=0;for(const e of o)e.offset-=a,e.offset!=t&&e.offset!=n&&(this.mergeAttributes(e).isEqual(e)||(a++,n--));return ei._createFromParentsAndOffsets(e,t,e,n)}_wrapRange(e,t){const{start:n,end:r}=this._breakAttributesRange(e,!0),i=n.parent,o=this._wrapChildren(i,n.offset,r.offset,t),a=this.mergeAttributes(o.start);a.isEqual(o.start)||o.end.offset--;const s=this.mergeAttributes(o.end);return new ei(a,s)}_wrapPosition(e,t){if(t.isSimilar(e.parent))return Ri(e.clone());e.parent.is("text")&&(e=Pi(e));const n=this.createAttributeElement();n._priority=Number.POSITIVE_INFINITY,n.isSimilar=()=>!1,e.parent._insertChild(e.offset,n);const r=new ei(e,e.getShiftedBy(1));this.wrap(r,t);const i=new Zr(n.parent,n.index);n._remove();const o=i.nodeBefore,a=i.nodeAfter;return o instanceof pr&&a instanceof pr?Ni(o,a):Ri(i)}_wrapAttributeElement(e,t){if(!Ii(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;for(const n of e.getAttributeKeys())if("class"!==n&&"style"!==n&&t.hasAttribute(n)&&t.getAttribute(n)!==e.getAttribute(n))return!1;for(const n of e.getStyleNames())if(t.hasStyle(n)&&t.getStyle(n)!==e.getStyle(n))return!1;for(const n of e.getAttributeKeys())"class"!==n&&"style"!==n&&(t.hasAttribute(n)||this.setAttribute(n,e.getAttribute(n),t));for(const n of e.getStyleNames())t.hasStyle(n)||this.setStyle(n,e.getStyle(n),t);for(const n of e.getClassNames())t.hasClass(n)||this.addClass(n,t);return!0}_unwrapAttributeElement(e,t){if(!Ii(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;for(const n of e.getAttributeKeys())if("class"!==n&&"style"!==n&&(!t.hasAttribute(n)||t.getAttribute(n)!==e.getAttribute(n)))return!1;if(!t.hasClass(...e.getClassNames()))return!1;for(const n of e.getStyleNames())if(!t.hasStyle(n)||t.getStyle(n)!==e.getStyle(n))return!1;for(const n of e.getAttributeKeys())"class"!==n&&"style"!==n&&this.removeAttribute(n,t);return this.removeClass(Array.from(e.getClassNames()),t),this.removeStyle(Array.from(e.getStyleNames()),t),!0}_breakAttributesRange(e,t=!1){const n=e.start,r=e.end;if(ji(e,this.document),e.isCollapsed){const n=this._breakAttributes(e.start,t);return new ei(n,n)}const i=this._breakAttributes(r,t),o=i.parent.childCount,a=this._breakAttributes(n,t);return i.offset+=i.parent.childCount-o,new ei(a,i)}_breakAttributes(e,t=!1){const n=e.offset,r=e.parent;if(e.parent.is("emptyElement"))throw new Jn.b("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new Jn.b("view-writer-cannot-break-ui-element",this.document);if(!t&&r.is("text")&&Ai(r.parent))return e.clone();if(Ai(r))return e.clone();if(r.is("text"))return this._breakAttributes(Pi(e),t);if(n==r.childCount){const e=new Zr(r.parent,r.index+1);return this._breakAttributes(e,t)}if(0===n){const e=new Zr(r.parent,r.index);return this._breakAttributes(e,t)}{const e=r.index+1,i=r._clone();r.parent._insertChild(e,i),this._addToClonedElementsGroup(i);const o=r.childCount-n,a=r._removeChildren(n,o);i._appendChild(a);const s=new Zr(r.parent,e);return this._breakAttributes(s,t)}}_addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element"))for(const t of e.getChildren())this._addToClonedElementsGroup(t);const t=e.id;if(!t)return;let n=this._cloneGroups.get(t);n||(n=new Set,this._cloneGroups.set(t,n)),n.add(e),e._clonesGroup=n}_removeFromClonedElementsGroup(e){if(e.is("element"))for(const t of e.getChildren())this._removeFromClonedElementsGroup(t);const t=e.id;if(!t)return;const n=this._cloneGroups.get(t);n&&n.delete(e)}}function Si(e){let t=e.parent;for(;!Ai(t);){if(!t)return;t=t.parent}return t}function Ci(e,t){return e.priority<t.priority||!(e.priority>t.priority)&&e.getIdentity()<t.getIdentity()}function Ri(e){const t=e.nodeBefore;if(t&&t.is("text"))return new Zr(t,t.data.length);const n=e.nodeAfter;return n&&n.is("text")?new Zr(n,0):e}function Pi(e){if(e.offset==e.parent.data.length)return new Zr(e.parent.parent,e.parent.index+1);if(0===e.offset)return new Zr(e.parent.parent,e.parent.index);const t=e.parent.data.slice(e.offset);return e.parent._data=e.parent.data.slice(0,e.offset),e.parent.parent._insertChild(e.parent.index+1,new pr(t)),new Zr(e.parent.parent,e.parent.index+1)}function Ni(e,t){const n=e.data.length;return e._data+=t.data,t._remove(),new Zr(e,n)}const Mi=[pr,ci,Er,fi,ki];function Ai(e){return e&&(e.is("containerElement")||e.is("documentFragment"))}function ji(e,t){const n=Si(e.start),r=Si(e.end);if(!n||!r||n!==r)throw new Jn.b("view-writer-invalid-range-container",t)}function Ii(e,t){return null===e.id&&null===t.id}function Di(e){return"[object Text]"==Object.prototype.toString.call(e)}const Li=e=>e.createTextNode(" "),Bi=e=>{const t=e.createElement("br");return t.dataset.ckeFiller=!0,t},Fi=7,qi=(()=>{let e="";for(let t=0;t<Fi;t++)e+="​";return e})();function Vi(e){return Di(e)&&e.data.substr(0,Fi)===qi}function Ui(e){return e.data.length==Fi&&Vi(e)}function Hi(e){return Vi(e)?e.data.slice(Fi):e.data}function zi(e,t){if(t.keyCode==gi.arrowleft){const e=t.domTarget.ownerDocument.defaultView.getSelection();if(1==e.rangeCount&&e.getRangeAt(0).collapsed){const t=e.getRangeAt(0).startContainer,n=e.getRangeAt(0).startOffset;Vi(t)&&n<=Fi&&e.collapse(t,0)}}}function Wi(e,t,n,r=!1){n=n||function(e,t){return e===t},Array.isArray(e)||(e=Array.from(e)),Array.isArray(t)||(t=Array.from(t));const i=function(e,t,n){const r=Yi(e,t,n);if(-1===r)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const i=Yi(Qi(e,r),Qi(t,r),n);return{firstIndex:r,lastIndexOld:e.length-i,lastIndexNew:t.length-i}}(e,t,n);return r?function(e,t){const{firstIndex:n,lastIndexOld:r,lastIndexNew:i}=e;if(-1===n)return Array(t).fill("equal");let o=[];return n>0&&(o=o.concat(Array(n).fill("equal"))),i-n>0&&(o=o.concat(Array(i-n).fill("insert"))),r-n>0&&(o=o.concat(Array(r-n).fill("delete"))),i<t&&(o=o.concat(Array(t-i).fill("equal"))),o}(i,t.length):function(e,t){const n=[],{firstIndex:r,lastIndexOld:i,lastIndexNew:o}=t;return o-r>0&&n.push({index:r,type:"insert",values:e.slice(r,o)}),i-r>0&&n.push({index:r+(o-r),type:"delete",howMany:i-r}),n}(t,i)}function Yi(e,t,n){for(let r=0;r<Math.max(e.length,t.length);r++)if(void 0===e[r]||void 0===t[r]||!n(e[r],t[r]))return r;return-1}function Qi(e,t){return e.slice(t).reverse()}function Gi(e,t,n){n=n||function(e,t){return e===t};const r=e.length,i=t.length;if(r>200||i>200||r+i>300)return Gi.fastDiff(e,t,n,!0);let o,a;if(i<r){const n=e;e=t,t=n,o="delete",a="insert"}else o="insert",a="delete";const s=e.length,c=t.length,u=c-s,l={},f={};function h(r){const i=(void 0!==f[r-1]?f[r-1]:-1)+1,u=void 0!==f[r+1]?f[r+1]:-1,h=i>u?-1:1;l[r+h]&&(l[r]=l[r+h].slice(0)),l[r]||(l[r]=[]),l[r].push(i>u?o:a);let d=Math.max(i,u),p=d-r;for(;p<s&&d<c&&n(e[p],t[d]);)p++,d++,l[r].push("equal");return d}let d,p=0;do{for(d=-p;d<u;d++)f[d]=h(d);for(d=u+p;d>u;d--)f[d]=h(d);f[u]=h(u),p++}while(f[u]!==c);return l[u].slice(1)}function Ji(e,t,n){e.insertBefore(n,e.childNodes[t]||null)}function Ki(e){const t=e.parentNode;t&&t.removeChild(e)}function $i(e){if(e){if(e.defaultView)return e instanceof e.defaultView.Document;if(e.ownerDocument&&e.ownerDocument.defaultView)return e instanceof e.ownerDocument.defaultView.Node}return!1}Gi.fastDiff=Wi;class Xi{constructor(e,t){this.domDocuments=new Set,this.domConverter=e,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=t,this.isFocused=!1,this._inlineFiller=null,this._fakeSelectionContainer=null}markToSync(e,t){if("text"===e)this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if("attributes"===e)this.markedAttributes.add(t);else{if("children"!==e)throw new Jn.b("view-renderer-unknown-type: Unknown type passed to Renderer.markToSync.",this);this.markedChildren.add(t)}}}render(){let e;for(const e of this.markedChildren)this._updateChildrenMappings(e);this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent));for(const e of this.markedAttributes)this._updateAttrs(e);for(const t of this.markedChildren)this._updateChildren(t,{inlineFillerPosition:e});for(const t of this.markedTexts)!this.markedChildren.has(t.parent)&&this.domConverter.mapViewToDom(t.parent)&&this._updateText(t,{inlineFillerPosition:e});if(e){const t=this.domConverter.viewPositionToDom(e),n=t.parent.ownerDocument;Vi(t.parent)?this._inlineFiller=t.parent:this._inlineFiller=Zi(n,t.parent,t.offset)}else this._inlineFiller=null;this._updateSelection(),this._updateFocus(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const n=this.domConverter.mapViewToDom(e).childNodes,r=Array.from(this.domConverter.viewChildrenToDom(e,t.ownerDocument,{withChildren:!1})),i=this._diffNodeLists(n,r),o=this._findReplaceActions(i,n,r);if(-1!==o.indexOf("replace")){const t={equal:0,insert:0,delete:0};for(const i of o)if("replace"===i){const i=t.equal+t.insert,o=t.equal+t.delete,a=e.getChild(i);a&&!a.is("uiElement")&&this._updateElementMappings(a,n[o]),Ki(r[i]),t.equal++}else t[i]++}}_updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("text")?Zr._createBefore(this.selection.getFirstPosition().parent):e}_isSelectionInInlineFiller(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&Di(t.parent)&&Vi(t.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!Vi(e))throw new Jn.b("view-renderer-filler-was-lost: The inline filler node was lost.",this);Ui(e)?e.parentNode.removeChild(e):e.data=e.data.substr(Fi),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),t=e.parent,n=e.offset;if(!this.domConverter.mapViewToDom(t.root))return!1;if(!t.is("element"))return!1;if(!function(e){if("false"==e.getAttribute("contenteditable"))return!1;const t=e.findAncestor((e=>e.hasAttribute("contenteditable")));return!t||"true"==t.getAttribute("contenteditable")}(t))return!1;if(n===t.getFillerOffset())return!1;const r=e.nodeBefore,i=e.nodeAfter;return!(r instanceof pr||i instanceof pr)}_updateText(e,t){const n=this.domConverter.findCorrespondingDomText(e),r=this.domConverter.viewToDom(e,n.ownerDocument),i=n.data;let o=r.data;const a=t.inlineFillerPosition;if(a&&a.parent==e.parent&&a.offset==e.index&&(o=qi+o),i!=o){const e=Wi(i,o);for(const t of e)"insert"===t.type?n.insertData(t.index,t.values.join("")):n.deleteData(t.index,t.howMany)}}_updateAttrs(e){const t=this.domConverter.mapViewToDom(e);if(!t)return;const n=Array.from(t.attributes).map((e=>e.name)),r=e.getAttributeKeys();for(const n of r)t.setAttribute(n,e.getAttribute(n));for(const r of n)e.hasAttribute(r)||t.removeAttribute(r)}_updateChildren(e,t){const n=this.domConverter.mapViewToDom(e);if(!n)return;const r=t.inlineFillerPosition,i=this.domConverter.mapViewToDom(e).childNodes,o=Array.from(this.domConverter.viewChildrenToDom(e,n.ownerDocument,{bind:!0,inlineFillerPosition:r}));r&&r.parent===e&&Zi(n.ownerDocument,o,r.offset);const a=this._diffNodeLists(i,o);let s=0;const c=new Set;for(const e of a)"insert"===e?(Ji(n,s,o[s]),s++):"delete"===e?(c.add(i[s]),Ki(i[s])):(this._markDescendantTextToSync(this.domConverter.domToView(o[s])),s++);for(const e of c)e.parentNode||this.domConverter.unbindDomElement(e)}_diffNodeLists(e,t){return Gi(e=function(e,t){const n=Array.from(e);return 0!=n.length&&t?(n[n.length-1]==t&&n.pop(),n):n}(e,this._fakeSelectionContainer),t,to.bind(null,this.domConverter))}_findReplaceActions(e,t,n){if(-1===e.indexOf("insert")||-1===e.indexOf("delete"))return e;let r=[],i=[],o=[];const a={equal:0,insert:0,delete:0};for(const s of e)"insert"===s?o.push(n[a.equal+a.insert]):"delete"===s?i.push(t[a.equal+a.delete]):(r=r.concat(Gi(i,o,eo).map((e=>"equal"===e?"replace":e))),r.push("equal"),i=[],o=[]),a[s]++;return r.concat(Gi(i,o,eo).map((e=>"equal"===e?"replace":e)))}_markDescendantTextToSync(e){if(e)if(e.is("text"))this.markedTexts.add(e);else if(e.is("element"))for(const t of e.getChildren())this._markDescendantTextToSync(t)}_updateSelection(){if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();const e=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&e&&(this.selection.isFake?this._updateFakeSelection(e):(this._removeFakeSelection(),this._updateDomSelection(e)))}_updateFakeSelection(e){const t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=function(e){const t=e.createElement("div");return Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent=" ",t}(t));const n=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(n,this.selection),!this._fakeSelectionNeedsUpdate(e))return;n.parentElement&&n.parentElement==e||e.appendChild(n),n.textContent=this.selection.fakeSelectionLabel||" ";const r=t.getSelection(),i=t.createRange();r.removeAllRanges(),i.selectNodeContents(n),r.addRange(i)}_updateDomSelection(e){const t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;const n=this.domConverter.viewPositionToDom(this.selection.anchor),r=this.domConverter.viewPositionToDom(this.selection.focus);e.focus(),t.collapse(n.parent,n.offset),t.extend(r.parent,r.offset),pi.isGecko&&function(e,t){const n=e.parent;if(n.nodeType!=Node.ELEMENT_NODE||e.offset!=n.childNodes.length-1)return;const r=n.childNodes[e.offset];r&&"BR"==r.tagName&&t.addRange(t.getRangeAt(0))}(r,t)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const t=e&&this.domConverter.domSelectionToView(e);return!(t&&this.selection.isEqual(t)||!this.selection.isCollapsed&&this.selection.isSimilar(t))}_fakeSelectionNeedsUpdate(e){const t=this._fakeSelectionContainer,n=e.ownerDocument.getSelection();return!t||t.parentElement!==e||n.anchorNode!==t&&!t.contains(n.anchorNode)||t.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments)if(e.getSelection().rangeCount){const t=e.activeElement,n=this.domConverter.mapDomToView(t);t&&n&&e.getSelection().removeAllRanges()}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}}function Zi(e,t,n){const r=t instanceof Array?t:t.childNodes,i=r[n];if(Di(i))return i.data=qi+i.data,i;{const i=e.createTextNode(qi);return Array.isArray(t)?r.splice(n,0,i):Ji(t,n,i),i}}function eo(e,t){return $i(e)&&$i(t)&&!Di(e)&&!Di(t)&&e.tagName.toLowerCase()===t.tagName.toLowerCase()}function to(e,t,n){return t===n||(Di(t)&&Di(n)?t.data===n.data:!(!e.isBlockFiller(t)||!e.isBlockFiller(n)))}ur(Xi,Ur);var no={window:window,document:document};function ro(e){let t=0;for(;e.previousSibling;)e=e.previousSibling,t++;return t}function io(e){const t=[];for(;e&&e.nodeType!=Node.DOCUMENT_NODE;)t.unshift(e),e=e.parentNode;return t}const oo=Bi(document);class ao{constructor(e={}){this.blockFillerMode=e.blockFillerMode||"br",this.preElements=["pre"],this.blockElements=["p","div","h1","h2","h3","h4","h5","h6","li","dd","dt","figcaption"],this._blockFiller="br"==this.blockFillerMode?Bi:Li,this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap}bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new ri(t))}fakeSelectionToView(e){return this._fakeSelectionMapping.get(e)}bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}unbindDomElement(e){const t=this._domToViewMapping.get(e);if(t){this._domToViewMapping.delete(e),this._viewToDomMapping.delete(t);for(const t of Array.from(e.childNodes))this.unbindDomElement(t)}}bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e)}viewToDom(e,t,n={}){if(e.is("text")){const n=this._processDataFromViewText(e);return t.createTextNode(n)}{if(this.mapViewToDom(e))return this.mapViewToDom(e);let r;if(e.is("documentFragment"))r=t.createDocumentFragment(),n.bind&&this.bindDocumentFragments(r,e);else{if(e.is("uiElement"))return r=e.render(t),n.bind&&this.bindElements(r,e),r;r=e.hasAttribute("xmlns")?t.createElementNS(e.getAttribute("xmlns"),e.name):t.createElement(e.name),n.bind&&this.bindElements(r,e);for(const t of e.getAttributeKeys())r.setAttribute(t,e.getAttribute(t))}if(n.withChildren||void 0===n.withChildren)for(const i of this.viewChildrenToDom(e,t,n))r.appendChild(i);return r}}*viewChildrenToDom(e,t,n={}){const r=e.getFillerOffset&&e.getFillerOffset();let i=0;for(const o of e.getChildren())r===i&&(yield this._blockFiller(t)),yield this.viewToDom(o,t,n),i++;r===i&&(yield this._blockFiller(t))}viewRangeToDom(e){const t=this.viewPositionToDom(e.start),n=this.viewPositionToDom(e.end),r=document.createRange();return r.setStart(t.parent,t.offset),r.setEnd(n.parent,n.offset),r}viewPositionToDom(e){const t=e.parent;if(t.is("text")){const n=this.findCorrespondingDomText(t);if(!n)return null;let r=e.offset;return Vi(n)&&(r+=Fi),{parent:n,offset:r}}{let n,r,i;if(0===e.offset){if(n=this.mapViewToDom(t),!n)return null;i=n.childNodes[0]}else{const t=e.nodeBefore;if(r=t.is("text")?this.findCorrespondingDomText(t):this.mapViewToDom(e.nodeBefore),!r)return null;n=r.parentNode,i=r.nextSibling}return Di(i)&&Vi(i)?{parent:i,offset:Fi}:{parent:n,offset:r?ro(r)+1:0}}}domToView(e,t={}){if(this.isBlockFiller(e,this.blockFillerMode))return null;const n=this.getParentUIElement(e,this._domToViewMapping);if(n)return n;if(Di(e)){if(Ui(e))return null;{const t=this._processDataFromDomText(e);return""===t?null:new pr(t)}}if(this.isComment(e))return null;{if(this.mapDomToView(e))return this.mapDomToView(e);let n;if(this.isDocumentFragment(e))n=new Ti,t.bind&&this.bindDocumentFragments(e,n);else{const r=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();n=new wr(r),t.bind&&this.bindElements(e,n);const i=e.attributes;for(let e=i.length-1;e>=0;e--)n._setAttribute(i[e].name,i[e].value)}if(t.withChildren||void 0===t.withChildren)for(const r of this.domChildrenToView(e,t))n._appendChild(r);return n}}*domChildrenToView(e,t={}){for(let n=0;n<e.childNodes.length;n++){const r=e.childNodes[n],i=this.domToView(r,t);null!==i&&(yield i)}}domSelectionToView(e){if(1===e.rangeCount){let t=e.getRangeAt(0).startContainer;Di(t)&&(t=t.parentNode);const n=this.fakeSelectionToView(t);if(n)return n}const t=this.isDomSelectionBackward(e),n=[];for(let t=0;t<e.rangeCount;t++){const r=e.getRangeAt(t),i=this.domRangeToView(r);i&&n.push(i)}return new ri(n,{backward:t})}domRangeToView(e){const t=this.domPositionToView(e.startContainer,e.startOffset),n=this.domPositionToView(e.endContainer,e.endOffset);return t&&n?new ei(t,n):null}domPositionToView(e,t){if(this.isBlockFiller(e,this.blockFillerMode))return this.domPositionToView(e.parentNode,ro(e));const n=this.mapDomToView(e);if(n&&n.is("uiElement"))return Zr._createBefore(n);if(Di(e)){if(Ui(e))return this.domPositionToView(e.parentNode,ro(e));const n=this.findCorrespondingViewText(e);let r=t;return n?(Vi(e)&&(r-=Fi,r=r<0?0:r),new Zr(n,r)):null}if(0===t){const t=this.mapDomToView(e);if(t)return new Zr(t,0)}else{const n=e.childNodes[t-1],r=Di(n)?this.findCorrespondingViewText(n):this.mapDomToView(n);if(r&&r.parent)return new Zr(r.parent,r.index+1)}return null}mapDomToView(e){return this.getParentUIElement(e)||this._domToViewMapping.get(e)}findCorrespondingViewText(e){if(Ui(e))return null;const t=this.getParentUIElement(e);if(t)return t;const n=e.previousSibling;if(n){if(!this.isElement(n))return null;const e=this.mapDomToView(n);if(e)return e.nextSibling instanceof pr?e.nextSibling:null}else{const t=this.mapDomToView(e.parentNode);if(t){const e=t.getChild(0);return e instanceof pr?e:null}}return null}mapViewToDom(e){return this._viewToDomMapping.get(e)}findCorrespondingDomText(e){const t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null}focus(e){const t=this.mapViewToDom(e);if(t&&t.ownerDocument.activeElement!==t){const{scrollX:e,scrollY:n}=no.window,r=[];co(t,(e=>{const{scrollLeft:t,scrollTop:n}=e;r.push([t,n])})),t.focus(),co(t,(e=>{const[t,n]=r.shift();e.scrollLeft=t,e.scrollTop=n})),no.window.scrollTo(e,n)}}isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE}isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(e){return e&&e.nodeType==Node.COMMENT_NODE}isBlockFiller(e){return"br"==this.blockFillerMode?e.isEqualNode(oo):!("BR"!==e.tagName||!uo(e,this.blockElements)||1!==e.parentNode.childNodes.length)||function(e,t){return Di(e)&&" "==e.data&&uo(e,t)&&1===e.parentNode.childNodes.length}(e,this.blockElements)}isDomSelectionBackward(e){if(e.isCollapsed)return!1;const t=document.createRange();t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset);const n=t.collapsed;return t.detach(),n}getParentUIElement(e){const t=io(e);for(t.pop();t.length;){const e=t.pop(),n=this._domToViewMapping.get(e);if(n&&n.is("uiElement"))return n}return null}isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset)}_isDomSelectionPositionCorrect(e,t){if(Di(e)&&Vi(e)&&t<Fi)return!1;if(this.isElement(e)&&Vi(e.childNodes[t]))return!1;const n=this.mapDomToView(e);return!n||!n.is("uiElement")}_processDataFromViewText(e){let t=e.data;if(e.getAncestors().some((e=>this.preElements.includes(e.name))))return t;if(" "==t.charAt(0)){const n=this._getTouchingViewTextNode(e,!1);(!n||!this._nodeEndsWithSpace(n))&&n||(t=" "+t.substr(1))}if(" "==t.charAt(t.length-1)){const n=this._getTouchingViewTextNode(e,!0);" "!=t.charAt(t.length-2)&&n&&" "!=n.data.charAt(0)||(t=t.substr(0,t.length-1)+" ")}return t.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(e){if(e.getAncestors().some((e=>this.preElements.includes(e.name))))return!1;const t=this._processDataFromViewText(e);return" "==t.charAt(t.length-1)}_processDataFromDomText(e){let t=e.data;if(so(e,this.preElements))return Hi(e);t=t.replace(/[ \n\t\r]{1,}/g," ");const n=this._getTouchingInlineDomNode(e,!1),r=this._getTouchingInlineDomNode(e,!0),i=this._checkShouldLeftTrimDomText(n),o=this._checkShouldRightTrimDomText(e,r);return i&&(t=t.replace(/^ /,"")),o&&(t=t.replace(/ $/,"")),t=Hi(new Text(t)),t=t.replace(/ \u00A0/g,"  "),(/( |\u00A0)\u00A0$/.test(t)||!r||r.data&&" "==r.data.charAt(0))&&(t=t.replace(/\u00A0$/," ")),i&&(t=t.replace(/^\u00A0/," ")),t}_checkShouldLeftTrimDomText(e){return!e||!!Yn(e)||/[^\S\u00A0]/.test(e.data.charAt(e.data.length-1))}_checkShouldRightTrimDomText(e,t){return!t&&!Vi(e)}_getTouchingViewTextNode(e,t){const n=new Xr({startPosition:t?Zr._createAfter(e):Zr._createBefore(e),direction:t?"forward":"backward"});for(const e of n){if(e.item.is("containerElement"))return null;if(e.item.is("br"))return null;if(e.item.is("textProxy"))return e.item}return null}_getTouchingInlineDomNode(e,t){if(!e.parentNode)return null;const n=t?"nextNode":"previousNode",r=e.ownerDocument,i=io(e)[0],o=r.createTreeWalker(i,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:e=>Di(e)||"BR"==e.tagName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});o.currentNode=e;const a=o[n]();if(null!==a){const t=function(e,t){const n=io(e),r=io(t);let i=0;for(;n[i]==r[i]&&n[i];)i++;return 0===i?null:n[i-1]}(e,a);if(t&&!so(e,this.blockElements,t)&&!so(a,this.blockElements,t))return a}return null}}function so(e,t,n){let r=io(e);return n&&(r=r.slice(r.indexOf(n)+1)),r.some((e=>e.tagName&&t.includes(e.tagName.toLowerCase())))}function co(e,t){for(;e&&e!=no.document;)t(e),e=e.parentNode}function uo(e,t){const n=e.parentNode;return n&&n.tagName&&t.includes(n.tagName.toLowerCase())}function lo(e){const t=Object.prototype.toString.apply(e);return"[object Window]"==t||"[object global]"==t}var fo=Lr({},nr,{listenTo(e,...t){if($i(e)||lo(e)){const n=this._getProxyEmitter(e)||new ho(e);n.attach(...t),e=n}nr.listenTo.call(this,e,...t)},stopListening(e,t,n){if($i(e)||lo(e)){const t=this._getProxyEmitter(e);if(!t)return;e=t}nr.stopListening.call(this,e,t,n),e instanceof ho&&e.detach(t)},_getProxyEmitter(e){return t=this,n=po(e),t[er]&&t[er][n]?t[er][n].emitter:null;var t,n}});class ho{constructor(e){rr(this,po(e)),this._domNode=e}}function po(e){return e["data-ck-expando"]||(e["data-ck-expando"]=Xn())}Lr(ho.prototype,nr,{attach(e,t,n={}){if(this._domListeners&&this._domListeners[e])return;const r=this._createDomListener(e,!!n.useCapture);this._domNode.addEventListener(e,r,!!n.useCapture),this._domListeners||(this._domListeners={}),this._domListeners[e]=r},detach(e){let t;!this._domListeners[e]||(t=this._events[e])&&t.callbacks.length||this._domListeners[e].removeListener()},_createDomListener(e,t){const n=t=>{this.fire(e,t)};return n.removeListener=()=>{this._domNode.removeEventListener(e,n,t),delete this._domListeners[e]},n}});class mo{constructor(e){this.view=e,this.document=e.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}}ur(mo,fo);var yo="__lodash_hash_undefined__",go=function(e){return this.__data__.set(e,yo),this},bo=function(e){return this.__data__.has(e)};function vo(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Ce;++t<n;)this.add(e[t])}vo.prototype.add=vo.prototype.push=go,vo.prototype.has=bo;var wo=vo,_o=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},ko=function(e,t){return e.has(t)},Eo=1,Oo=2,To=function(e,t,n,r,i,o){var a=n&Eo,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var l=-1,f=!0,h=n&Oo?new wo:void 0;for(o.set(e,t),o.set(t,e);++l<s;){var d=e[l],p=t[l];if(r)var m=a?r(p,d,l,t,e,o):r(d,p,l,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(h){if(!_o(t,(function(e,t){if(!ko(h,t)&&(d===e||i(d,e,n,r,o)))return h.push(t)}))){f=!1;break}}else if(d!==p&&!i(d,p,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f},xo=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},So=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},Co=1,Ro=2,Po="[object Boolean]",No="[object Date]",Mo="[object Error]",Ao="[object Map]",jo="[object Number]",Io="[object RegExp]",Do="[object Set]",Lo="[object String]",Bo="[object Symbol]",Fo="[object ArrayBuffer]",qo="[object DataView]",Vo=i?i.prototype:void 0,Uo=Vo?Vo.valueOf:void 0,Ho=function(e,t,n,r,i,o,a){switch(n){case qo:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Fo:return!(e.byteLength!=t.byteLength||!o(new Qt(e),new Qt(t)));case Po:case No:case jo:return S(+e,+t);case Mo:return e.name==t.name&&e.message==t.message;case Io:case Lo:return e==t+"";case Ao:var s=xo;case Do:var c=r&Co;if(s||(s=So),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;r|=Ro,a.set(e,t);var l=To(s(e),s(t),r,i,o,a);return a.delete(e),l;case Bo:if(Uo)return Uo.call(e)==Uo.call(t)}return!1},zo=1,Wo=Object.prototype.hasOwnProperty,Yo=function(e,t,n,r,i,o){var a=n&zo,s=Mt(e),c=s.length;if(c!=Mt(t).length&&!a)return!1;for(var u=c;u--;){var l=s[u];if(!(a?l in t:Wo.call(t,l)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var h=!0;o.set(e,t),o.set(t,e);for(var d=a;++u<c;){var p=e[l=s[u]],m=t[l];if(r)var y=a?r(m,p,l,t,e,o):r(p,m,l,e,t,o);if(!(void 0===y?p===m||i(p,m,n,r,o):y)){h=!1;break}d||(d="constructor"==l)}if(h&&!d){var g=e.constructor,b=t.constructor;g!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof b&&b instanceof b)&&(h=!1)}return o.delete(e),o.delete(t),h},Qo=1,Go="[object Arguments]",Jo="[object Array]",Ko="[object Object]",$o=Object.prototype.hasOwnProperty,Xo=function(e,t,n,r,i,o){var a=Ye(e),s=Ye(t),c=a?Jo:zt(e),u=s?Jo:zt(t),l=(c=c==Go?Ko:c)==Ko,f=(u=u==Go?Ko:u)==Ko,h=c==u;if(h&&Object(Qe.a)(e)){if(!Object(Qe.a)(t))return!1;a=!0,l=!1}if(h&&!l)return o||(o=new Me),a||it(e)?To(e,t,n,r,i,o):Ho(e,t,c,n,r,i,o);if(!(n&Qo)){var d=l&&$o.call(e,"__wrapped__"),p=f&&$o.call(t,"__wrapped__");if(d||p){var m=d?e.value():e,y=p?t.value():t;return o||(o=new Me),i(m,y,n,r,o)}}return!!h&&(o||(o=new Me),Yo(e,t,n,r,i,o))},Zo=function e(t,n,r,i,o){return t===n||(null==t||null==n||!b(t)&&!b(n)?t!=t&&n!=n:Xo(t,n,r,i,e,o))},ea=function(e,t,n){var r=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===r?Zo(e,t,void 0,n):!!r};class ta extends mo{constructor(e){super(e),this._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},this.domConverter=e.domConverter,this.renderer=e._renderer,this._domElements=[],this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.push(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(0===e.length)return;const t=this.domConverter,n=new Map,r=new Set;for(const n of e)if("childList"===n.type){const e=t.mapDomToView(n.target);if(e&&e.is("uiElement"))continue;e&&!this._isBogusBrMutation(n)&&r.add(e)}for(const i of e){const e=t.mapDomToView(i.target);if(!(e&&e.is("uiElement")||"characterData"!==i.type)){const e=t.findCorrespondingViewText(i.target);e&&!r.has(e.parent)?n.set(e,{type:"text",oldText:e.data,newText:Hi(i.target),node:e}):!e&&Vi(i.target)&&r.add(t.mapDomToView(i.target.parentNode))}}const i=[];for(const e of n.values())this.renderer.markToSync("text",e.node),i.push(e);for(const e of r){const n=t.mapViewToDom(e),r=Array.from(e.getChildren()),o=Array.from(t.domChildrenToView(n,{withChildren:!1}));ea(r,o,s)||(this.renderer.markToSync("children",e),i.push({type:"children",oldChildren:r,newChildren:o,node:e}))}const o=e[0].target.ownerDocument.getSelection();let a=null;if(o&&o.anchorNode){const e=t.domPositionToView(o.anchorNode,o.anchorOffset),n=t.domPositionToView(o.focusNode,o.focusOffset);e&&n&&(a=new ri(e),a.setFocus(n))}function s(e,t){if(!Array.isArray(e))return e===t||!(!e.is("text")||!t.is("text"))&&e.data===t.data}this.document.fire("mutations",i,a),this.view.forceRender()}_isBogusBrMutation(e){let t=null;return null===e.nextSibling&&0===e.removedNodes.length&&1==e.addedNodes.length&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br")}}class na{constructor(e,t,n){this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,Lr(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class ra extends mo{constructor(e){super(e),this.useCapture=!1}observe(e){("string"==typeof this.domEventType?[this.domEventType]:this.domEventType).forEach((t=>{this.listenTo(e,t,((e,t)=>{this.isEnabled&&this.onDomEvent(t)}),{useCapture:this.useCapture})}))}fire(e,t,n){this.isEnabled&&this.document.fire(e,new na(this.view,t,n))}}class ia extends ra{constructor(e){super(e),this.domEventType=["keydown","keyup"]}onDomEvent(e){this.fire(e.type,e,{keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey||e.metaKey,shiftKey:e.shiftKey,get keystroke(){return bi(this)}})}}var oa=function(){return r.a.Date.now()},aa="[object Symbol]",sa=function(e){return"symbol"==typeof e||b(e)&&m(e)==aa},ca=NaN,ua=/^\s+|\s+$/g,la=/^[-+]0x[0-9a-f]+$/i,fa=/^0b[01]+$/i,ha=/^0o[0-7]+$/i,da=parseInt,pa=function(e){if("number"==typeof e)return e;if(sa(e))return ca;if(V(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=V(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(ua,"");var n=fa.test(e);return n||ha.test(e)?da(e.slice(2),n?2:8):la.test(e)?ca:+e},ma="Expected a function",ya=Math.max,ga=Math.min,ba=function(e,t,n){var r,i,o,a,s,c,u=0,l=!1,f=!1,h=!0;if("function"!=typeof e)throw new TypeError(ma);function d(t){var n=r,o=i;return r=i=void 0,u=t,a=e.apply(o,n)}function p(e){var n=e-c;return void 0===c||n>=t||n<0||f&&e-u>=o}function m(){var e=oa();if(p(e))return y(e);s=setTimeout(m,function(e){var n=t-(e-c);return f?ga(n,o-(e-u)):n}(e))}function y(e){return s=void 0,h&&r?d(e):(r=i=void 0,a)}function g(){var e=oa(),n=p(e);if(r=arguments,i=this,c=e,n){if(void 0===s)return function(e){return u=e,s=setTimeout(m,t),l?d(e):a}(c);if(f)return clearTimeout(s),s=setTimeout(m,t),d(c)}return void 0===s&&(s=setTimeout(m,t)),a}return t=pa(t)||0,V(n)&&(l=!!n.leading,o=(f="maxWait"in n)?ya(pa(n.maxWait)||0,t):o,h="trailing"in n?!!n.trailing:h),g.cancel=function(){void 0!==s&&clearTimeout(s),u=0,r=c=i=s=void 0},g.flush=function(){return void 0===s?a:y(oa())},g};class va extends mo{constructor(e){super(e),this._fireSelectionChangeDoneDebounced=ba((e=>this.document.fire("selectionChangeDone",e)),200)}observe(){const e=this.document;e.on("keydown",((t,n)=>{e.selection.isFake&&function(e){return e==gi.arrowright||e==gi.arrowleft||e==gi.arrowup||e==gi.arrowdown}(n.keyCode)&&this.isEnabled&&(n.preventDefault(),this._handleSelectionMove(n.keyCode))}),{priority:"lowest"})}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const t=this.document.selection,n=new ri(t.getRanges(),{backward:t.isBackward,fake:!1});e!=gi.arrowleft&&e!=gi.arrowup||n.setTo(n.getFirstPosition()),e!=gi.arrowright&&e!=gi.arrowdown||n.setTo(n.getLastPosition());const r={oldSelection:t,newSelection:n,domSelection:null};this.document.fire("selectionChange",r),this._fireSelectionChangeDoneDebounced(r)}}class wa extends mo{constructor(e){super(e),this.mutationObserver=e.getObserver(ta),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=ba((e=>this.document.fire("selectionChangeDone",e)),200),this._clearInfiniteLoopInterval=setInterval((()=>this._clearInfiniteLoop()),1e3),this._loopbackCounter=0}observe(e){const t=e.ownerDocument;this._documents.has(t)||(this.listenTo(t,"selectionchange",(()=>{this._handleSelectionChange(t)})),this._documents.add(t))}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionChange(e){if(!this.isEnabled||!this.document.isFocused&&!this.document.isReadOnly)return;this.mutationObserver.flush();const t=e.defaultView.getSelection(),n=this.domConverter.domSelectionToView(t);if(!(this.selection.isEqual(n)&&this.domConverter.isDomSelectionCorrect(t)||++this._loopbackCounter>60))if(this.selection.isSimilar(n))this.view.forceRender();else{const e={oldSelection:this.selection,newSelection:n,domSelection:t};this.document.fire("selectionChange",e),this._fireSelectionChangeDoneDebounced(e)}}_clearInfiniteLoop(){this._loopbackCounter=0}}class _a extends ra{constructor(e){super(e),this.domEventType=["focus","blur"],this.useCapture=!0;const t=this.document;t.on("focus",(()=>{t.isFocused=!0,this._renderTimeoutId=setTimeout((()=>e.forceRender()),50)})),t.on("blur",((n,r)=>{const i=t.selection.editableElement;null!==i&&i!==r.target||(t.isFocused=!1,e.forceRender())}))}onDomEvent(e){this.fire(e.type,e)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}class ka extends ra{constructor(e){super(e),this.domEventType=["compositionstart","compositionupdate","compositionend"];const t=this.document;t.on("compositionstart",(()=>{t.isComposing=!0})),t.on("compositionend",(()=>{t.isComposing=!1}))}onDomEvent(e){this.fire(e.type,e)}}class Ea extends ra{constructor(e){super(e),this.domEventType=["beforeinput"]}onDomEvent(e){this.fire(e.type,e)}}function Oa(e){return"[object Range]"==Object.prototype.toString.apply(e)}function Ta(e){const t=e.ownerDocument.defaultView.getComputedStyle(e);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}const xa=["top","right","bottom","left","width","height"];class Sa{constructor(e){const t=Oa(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),Yn(e)||t)Ca(this,t?Sa.getDomRangeRects(e)[0]:e.getBoundingClientRect());else if(lo(e)){const{innerWidth:t,innerHeight:n}=e;Ca(this,{top:0,right:t,bottom:n,left:0,width:t,height:n})}else Ca(this,e)}clone(){return new Sa(this)}moveTo(e,t){return this.top=t,this.right=e+this.width,this.bottom=t+this.height,this.left=e,this}moveBy(e,t){return this.top+=t,this.right+=e,this.left+=e,this.bottom+=t,this}getIntersection(e){const t={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left)};return t.width=t.right-t.left,t.height=t.bottom-t.top,t.width<0||t.height<0?null:new Sa(t)}getIntersectionArea(e){const t=this.getIntersection(e);return t?t.getArea():0}getArea(){return this.width*this.height}getVisible(){const e=this._source;let t=this.clone();if(!Ra(e)){let n=e.parentNode||e.commonAncestorContainer;for(;n&&!Ra(n);){const e=new Sa(n),r=t.getIntersection(e);if(!r)return null;r.getArea()<t.getArea()&&(t=r),n=n.parentNode}}return t}isEqual(e){for(const t of xa)if(this[t]!==e[t])return!1;return!0}contains(e){const t=this.getIntersection(e);return!(!t||!t.isEqual(e))}excludeScrollbarsAndBorders(){const e=this._source;let t,n,r;if(lo(e))t=e.innerWidth-e.document.documentElement.clientWidth,n=e.innerHeight-e.document.documentElement.clientHeight,r=e.getComputedStyle(e.document.documentElement).direction;else{const i=Ta(this._source);t=e.offsetWidth-e.clientWidth-i.left-i.right,n=e.offsetHeight-e.clientHeight-i.top-i.bottom,r=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=i.left,this.top+=i.top,this.right-=i.right,this.bottom-=i.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=t,"ltr"===r?this.right-=t:this.left+=t,this.height-=n,this.bottom-=n,this}static getDomRangeRects(e){const t=[],n=Array.from(e.getClientRects());if(n.length)for(const e of n)t.push(new Sa(e));else{let n=e.startContainer;Di(n)&&(n=n.parentNode);const r=new Sa(n.getBoundingClientRect());r.right=r.left,r.width=0,t.push(r)}return t}}function Ca(e,t){for(const n of xa)e[n]=t[n]}function Ra(e){return!!Yn(e)&&e===e.ownerDocument.body}function Pa({target:e,viewportOffset:t=0}){const n=La(e);let r=n,i=null;for(;r;){let o;o=Ba(r==n?e:i),Ma(o,(()=>Fa(e,r)));const a=Fa(e,r);if(Na(r,a,t),r.parent!=r){if(i=r.frameElement,r=r.parent,!i)return}else r=null}}function Na(e,t,n){const r=t.clone().moveBy(0,n),i=t.clone().moveBy(0,-n),o=new Sa(e).excludeScrollbarsAndBorders();if(![i,r].every((e=>o.contains(e)))){let{scrollX:a,scrollY:s}=e;ja(i,o)?s-=o.top-t.top+n:Aa(r,o)&&(s+=t.bottom-o.bottom+n),Ia(t,o)?a-=o.left-t.left+n:Da(t,o)&&(a+=t.right-o.right+n),e.scrollTo(a,s)}}function Ma(e,t){const n=La(e);let r,i;for(;e!=n.document.body;)i=t(),r=new Sa(e).excludeScrollbarsAndBorders(),r.contains(i)||(ja(i,r)?e.scrollTop-=r.top-i.top:Aa(i,r)&&(e.scrollTop+=i.bottom-r.bottom),Ia(i,r)?e.scrollLeft-=r.left-i.left:Da(i,r)&&(e.scrollLeft+=i.right-r.right)),e=e.parentNode}function Aa(e,t){return e.bottom>t.bottom}function ja(e,t){return e.top<t.top}function Ia(e,t){return e.left<t.left}function Da(e,t){return e.right>t.right}function La(e){return Oa(e)?e.startContainer.ownerDocument.defaultView:e.ownerDocument.defaultView}function Ba(e){if(Oa(e)){let t=e.commonAncestorContainer;return Di(t)&&(t=t.parentNode),t}return e.parentNode}function Fa(e,t){const n=La(e),r=new Sa(e);if(n===t)return r;{let e=n;for(;e!=t;){const t=e.frameElement,n=new Sa(t).excludeScrollbarsAndBorders();r.moveBy(n.left,n.top),e=e.parent}}return r}Object.assign({},{scrollViewportToShowTarget:Pa,scrollAncestorsToShowTarget:function(e){Ma(Ba(e),(()=>new Sa(e)))}});class qa{constructor(){this.document=new ai,this.domConverter=new ao,this.domRoots=new Map,this.set("isRenderingInProgress",!1),this._renderer=new Xi(this.domConverter,this.document.selection),this._renderer.bind("isFocused").to(this.document),this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this._writer=new xi(this.document),this.addObserver(ta),this.addObserver(wa),this.addObserver(_a),this.addObserver(ia),this.addObserver(va),this.addObserver(ka),pi.isAndroid&&this.addObserver(Ea),this.document.on("keydown",zi),Ei(this),this.on("render",(()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1})),this.listenTo(this.document.selection,"change",(()=>{this._hasChangedSinceTheLastRendering=!0}))}attachDomRoot(e,t="main"){const n=this.document.getRoot(t);n._name=e.tagName.toLowerCase();const r={};for(const{name:t,value:i}of Array.from(e.attributes))r[t]=i,"class"===t?this._writer.addClass(i.split(" "),n):this._writer.setAttribute(t,i,n);this._initialDomRootAttributes.set(e,r);const i=()=>{this._writer.setAttribute("contenteditable",!n.isReadOnly,n),n.isReadOnly?this._writer.addClass("ck-read-only",n):this._writer.removeClass("ck-read-only",n)};i(),this.domRoots.set(t,e),this.domConverter.bindElements(e,n),this._renderer.markToSync("children",n),this._renderer.markToSync("attributes",n),this._renderer.domDocuments.add(e.ownerDocument),n.on("change:children",((e,t)=>this._renderer.markToSync("children",t))),n.on("change:attributes",((e,t)=>this._renderer.markToSync("attributes",t))),n.on("change:text",((e,t)=>this._renderer.markToSync("text",t))),n.on("change:isReadOnly",(()=>this.change(i))),n.on("change",(()=>{this._hasChangedSinceTheLastRendering=!0}));for(const n of this._observers.values())n.observe(e,t)}detachDomRoot(e){const t=this.domRoots.get(e);Array.from(t.attributes).forEach((({name:e})=>t.removeAttribute(e)));const n=this._initialDomRootAttributes.get(t);for(const e in n)t.setAttribute(e,n[e]);this.domRoots.delete(e),this.domConverter.unbindDomElement(t)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);for(const[e,n]of this.domRoots)t.observe(n,e);return t.enable(),t}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection(){const e=this.document.selection.getFirstRange();e&&Pa({target:this.domConverter.viewRangeToDom(e),viewportOffset:20})}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new Jn.b("cannot-change-view-tree: Attempting to make changes to the view when it is in an incorrect state: rendering or post-fixers are in progress. This may cause some unexpected behavior and inconsistency between the DOM and the view.",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const t=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),t}catch(e){Jn.b.rethrowUnexpectedError(e,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.change((()=>{}))}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,t){return Zr._createAt(e,t)}createPositionAfter(e){return Zr._createAfter(e)}createPositionBefore(e){return Zr._createBefore(e)}createRange(e,t){return new ei(e,t)}createRangeOn(e){return ei._createOn(e)}createRangeIn(e){return ei._createIn(e)}createSelection(e,t,n){return new ri(e,t,n)}_disableRendering(e){this._renderingDisabled=e,0==e&&this.change((()=>{}))}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}function Va(e){return T(e)?yr(e):new Map(e)}ur(qa,Ur);class Ua{constructor(e){this.parent=null,this._attrs=Va(e)}get index(){let e;if(!this.parent)return null;if(null===(e=this.parent.getChildIndex(this)))throw new Jn.b("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return e}get startOffset(){let e;if(!this.parent)return null;if(null===(e=this.parent.getChildStartOffset(this)))throw new Jn.b("model-node-not-found-in-parent: The node's parent does not contain this node.",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return null!==e&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return null!==e&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}get document(){return this.root==this?null:this.root.document||null}getPath(){const e=[];let t=this;for(;t.parent;)e.unshift(t.startOffset),t=t.parent;return e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}getCommonAncestor(e,t={}){const n=this.getAncestors(t),r=e.getAncestors(t);let i=0;for(;n[i]==r[i]&&n[i];)i++;return 0===i?null:n[i-1]}isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;const t=this.getPath(),n=e.getPath(),r=lr(t,n);switch(r){case"prefix":return!0;case"extension":return!1;default:return t[r]<n[r]}}isAfter(e){return this!=e&&this.root===e.root&&!this.isBefore(e)}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce(((e,t)=>(e[t[0]]=t[1],e)),{})),e}is(e){return"node"==e||"model:node"==e}_clone(){return new Ua(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,t){this._attrs.set(e,t)}_setAttributesTo(e){this._attrs=Va(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}}class Ha extends Ua{constructor(e,t){super(t),this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}is(e){return"text"==e||"model:text"==e||super.is(e)}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new Ha(this.data,this.getAttributes())}static fromJSON(e){return new Ha(e.data,e.attributes)}}class za{constructor(e,t,n){if(this.textNode=e,t<0||t>e.offsetSize)throw new Jn.b("model-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.",this);if(n<0||t+n>e.offsetSize)throw new Jn.b("model-textproxy-wrong-length: Given length value is incorrect.",this);this.data=e.data.substring(t,t+n),this.offsetInText=t}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(e){return"textProxy"==e||"model:textProxy"==e}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={includeSelf:!1,parentFirst:!1}){const t=[];let n=e.includeSelf?this:this.parent;for(;n;)t[e.parentFirst?"push":"unshift"](n),n=n.parent;return t}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}class Wa{constructor(e){this._nodes=[],e&&this._insertNodes(0,e)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce(((e,t)=>e+t.offsetSize),0)}getNode(e){return this._nodes[e]||null}getNodeIndex(e){const t=this._nodes.indexOf(e);return-1==t?null:t}getNodeStartOffset(e){const t=this.getNodeIndex(e);return null===t?null:this._nodes.slice(0,t).reduce(((e,t)=>e+t.offsetSize),0)}indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;const t=this._nodes[e];if(!t)throw new Jn.b("model-nodelist-index-out-of-bounds: Given index cannot be found in the node list.",this);return this.getNodeStartOffset(t)}offsetToIndex(e){let t=0;for(const n of this._nodes){if(e>=t&&e<t+n.offsetSize)return this.getNodeIndex(n);t+=n.offsetSize}if(t!=e)throw new Jn.b("model-nodelist-offset-out-of-bounds: Given offset cannot be found in the node list.",this,{offset:e,nodeList:this});return this.length}_insertNodes(e,t){for(const e of t)if(!(e instanceof Ua))throw new Jn.b("model-nodelist-insertNodes-not-node: Trying to insert an object which is not a Node instance.",this);this._nodes.splice(e,0,...t)}_removeNodes(e,t=1){return this._nodes.splice(e,t)}toJSON(){return this._nodes.map((e=>e.toJSON()))}}class Ya extends Ua{constructor(e,t,n){super(t),this.name=e,this._children=new Wa,n&&this._insertChild(0,n)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(e,t=null){const n=e.replace(/^model:/,"");return t?"element"==n&&t==this.name:"element"==n||n==this.name||super.is(e)}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let t=this;for(const n of e)t=t.getChild(t.offsetToIndex(n));return t}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const t of this._children)e.children.push(t.toJSON())}return e}_clone(e=!1){const t=e?Array.from(this._children).map((e=>e._clone(!0))):null;return new Ya(this.name,this.getAttributes(),t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const n=function(e){return"string"==typeof e?[new Ha(e)]:(gr(e)||(e=[e]),Array.from(e).map((e=>"string"==typeof e?new Ha(e):e instanceof za?new Ha(e.data,e.getAttributes()):e)))}(t);for(const e of n)null!==e.parent&&e._remove(),e.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,t=1){const n=this._children._removeNodes(e,t);for(const e of n)e.parent=null;return n}static fromJSON(e){let t=null;if(e.children){t=[];for(const n of e.children)n.name?t.push(Ya.fromJSON(n)):t.push(Ha.fromJSON(n))}return new Ya(e.name,e.attributes,t)}}class Qa{constructor(e={}){if(!e.boundaries&&!e.startPosition)throw new Jn.b("model-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.",null);const t=e.direction||"forward";if("forward"!=t&&"backward"!=t)throw new Jn.b("model-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this.position=e.startPosition.clone():this.position=Ka._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(e){let t,n,r,i;do{r=this.position,i=this._visitedParent,({done:t,value:n}=this.next())}while(!t&&e(n));t||(this.position=r,this._visitedParent=i)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const e=this.position,t=this.position.clone(),n=this._visitedParent;if(null===n.parent&&t.offset===n.maxOffset)return{done:!0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};const r=t.textNode?t.textNode:t.nodeAfter;if(r instanceof Ya)return this.shallow?t.offset++:(t.path.push(0),this._visitedParent=r),this.position=t,Ga("elementStart",r,e,t,1);if(r instanceof Ha){let i;if(this.singleCharacters)i=1;else{let e=r.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<e&&(e=this.boundaries.end.offset),i=e-t.offset}const o=t.offset-r.startOffset,a=new za(r,o,i);return t.offset+=i,this.position=t,Ga("text",a,e,t,i)}return t.path.pop(),t.offset++,this.position=t,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():Ga("elementEnd",n,e,t)}_previous(){const e=this.position,t=this.position.clone(),n=this._visitedParent;if(null===n.parent&&0===t.offset)return{done:!0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};const r=t.textNode?t.textNode:t.nodeBefore;if(r instanceof Ya)return t.offset--,this.shallow?(this.position=t,Ga("elementStart",r,e,t,1)):(t.path.push(r.maxOffset),this.position=t,this._visitedParent=r,this.ignoreElementEnd?this._previous():Ga("elementEnd",r,e,t));if(r instanceof Ha){let i;if(this.singleCharacters)i=1;else{let e=r.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>e&&(e=this.boundaries.start.offset),i=t.offset-e}const o=t.offset-r.startOffset,a=new za(r,o-i,i);return t.offset-=i,this.position=t,Ga("text",a,e,t,i)}return t.path.pop(),this.position=t,this._visitedParent=n.parent,Ga("elementStart",n,e,t,1)}}function Ga(e,t,n,r,i){return{done:!1,value:{type:e,item:t,previousPosition:n,nextPosition:r,length:i}}}var Ja=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};class Ka{constructor(e,t,n="toNone"){if(!e.is("element")&&!e.is("documentFragment"))throw new Jn.b("model-position-root-invalid: Position root invalid.",e);if(!(t instanceof Array)||0===t.length)throw new Jn.b("model-position-path-incorrect-format: Position path must be an array with at least one item.",e,{path:t});t=e.getPath().concat(t),e=e.root,this.root=e,this.path=t,this.stickiness=n}get offset(){return Ja(this.path)}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let t=0;t<this.path.length-1;t++)if(e=e.getChild(e.offsetToIndex(this.path[t])),!e)throw new Jn.b("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});if(e.is("text"))throw new Jn.b("model-position-path-incorrect: The position's path is incorrect.",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){const e=this.parent.getChild(this.index);return e instanceof Ha&&e.startOffset<this.offset?e:null}get nodeAfter(){return null===this.textNode?this.parent.getChild(this.index):null}get nodeBefore(){return null===this.textNode?this.parent.getChild(this.index-1):null}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const t=lr(this.path,e.path);switch(t){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[t]<e.path[t]?"before":"after"}}getLastMatchingPosition(e,t={}){t.startPosition=this;const n=new Qa(t);return n.skip(e),n.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonPath(e){if(this.root!=e.root)return[];const t=lr(this.path,e.path),n="string"==typeof t?Math.min(this.path.length,e.path.length):t;return this.path.slice(0,n)}getCommonAncestor(e){const t=this.getAncestors(),n=e.getAncestors();let r=0;for(;t[r]==n[r]&&t[r];)r++;return 0===r?null:t[r-1]}getShiftedBy(e){const t=this.clone(),n=t.offset+e;return t.offset=n<0?0:n,t}isAfter(e){return"after"==this.compareWith(e)}isBefore(e){return"before"==this.compareWith(e)}isEqual(e){return"same"==this.compareWith(e)}isTouching(e){let t=null,n=null;switch(this.compareWith(e)){case"same":return!0;case"before":t=Ka._createAt(this),n=Ka._createAt(e);break;case"after":t=Ka._createAt(e),n=Ka._createAt(this);break;default:return!1}let r=t.parent;for(;t.path.length+n.path.length;){if(t.isEqual(n))return!0;if(t.path.length>n.path.length){if(t.offset!==r.maxOffset)return!1;t.path=t.path.slice(0,-1),r=r.parent,t.offset++}else{if(0!==n.offset)return!1;n.path=n.path.slice(0,-1)}}}is(e){return"position"==e||"model:position"==e}hasSameParentAs(e){return this.root===e.root&&"same"==lr(this.getParentPath(),e.getParentPath())}getTransformedByOperation(e){let t;switch(e.type){case"insert":t=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":t=this._getTransformedByMoveOperation(e);break;case"split":t=this._getTransformedBySplitOperation(e);break;case"merge":t=this._getTransformedByMergeOperation(e);break;default:t=Ka._createAt(this)}return t}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const t=e.movedRange;return t.containsPosition(this)||t.start.isEqual(this)&&"toNext"==this.stickiness?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const t=e.movedRange;let n;return t.containsPosition(this)||t.start.isEqual(this)?(n=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(n=n._getTransformedByDeletion(e.deletionPosition,1))):n=this.isEqual(e.deletionPosition)?Ka._createAt(e.deletionPosition):this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),n}_getTransformedByDeletion(e,t){const n=Ka._createAt(this);if(this.root!=e.root)return n;if("same"==lr(e.getParentPath(),this.getParentPath())){if(e.offset<this.offset){if(e.offset+t>this.offset)return null;n.offset-=t}}else if("prefix"==lr(e.getParentPath(),this.getParentPath())){const r=e.path.length-1;if(e.offset<=this.path[r]){if(e.offset+t>this.path[r])return null;n.path[r]-=t}}return n}_getTransformedByInsertion(e,t){const n=Ka._createAt(this);if(this.root!=e.root)return n;if("same"==lr(e.getParentPath(),this.getParentPath()))(e.offset<this.offset||e.offset==this.offset&&"toPrevious"!=this.stickiness)&&(n.offset+=t);else if("prefix"==lr(e.getParentPath(),this.getParentPath())){const r=e.path.length-1;e.offset<=this.path[r]&&(n.path[r]+=t)}return n}_getTransformedByMove(e,t,n){if(t=t._getTransformedByDeletion(e,n),e.isEqual(t))return Ka._createAt(this);const r=this._getTransformedByDeletion(e,n);return null===r||e.isEqual(this)&&"toNext"==this.stickiness||e.getShiftedBy(n).isEqual(this)&&"toPrevious"==this.stickiness?this._getCombined(e,t):r._getTransformedByInsertion(t,n)}_getCombined(e,t){const n=e.path.length-1,r=Ka._createAt(t);return r.stickiness=this.stickiness,r.offset=r.offset+this.path[n]-e.offset,r.path=r.path.concat(this.path.slice(n+1)),r}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,t,n="toNone"){if(e instanceof Ka)return new Ka(e.root,e.path,e.stickiness);{const r=e;if("end"==t)t=r.maxOffset;else{if("before"==t)return this._createBefore(r,n);if("after"==t)return this._createAfter(r,n);if(0!==t&&!t)throw new Jn.b("model-createPositionAt-offset-required: Model#createPositionAt() requires the offset when the first parameter is a model item.",[this,e])}if(!r.is("element")&&!r.is("documentFragment"))throw new Jn.b("model-position-parent-incorrect: Position parent have to be a element or document fragment.",[this,e]);const i=r.getPath();return i.push(t),new this(r.root,i,n)}}static _createAfter(e,t){if(!e.parent)throw new Jn.b("model-position-after-root: You cannot make a position after root.",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,t)}static _createBefore(e,t){if(!e.parent)throw new Jn.b("model-position-before-root: You cannot make a position before root.",e,{root:e});return this._createAt(e.parent,e.startOffset,t)}static fromJSON(e,t){if("$graveyard"===e.root){const n=new Ka(t.graveyard,e.path);return n.stickiness=e.stickiness,n}if(!t.getRoot(e.root))throw new Jn.b("model-position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.",t,{rootName:e.root});return new Ka(t.getRoot(e.root),e.path,e.stickiness)}}class $a{constructor(e,t=null){this.start=Ka._createAt(e),this.end=t?Ka._createAt(t):Ka._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new Qa({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return"same"==lr(this.start.getParentPath(),this.end.getParentPath())}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,t=!1){e.isCollapsed&&(t=!1);const n=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),r=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return n&&r}containsItem(e){const t=Ka._createBefore(e);return this.containsPosition(t)||this.start.isEqual(t)}is(e){return"range"==e||"model:range"==e}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new $a(this.start,e.start)),this.containsPosition(e.end)&&t.push(new $a(e.end,this.end))):t.push(new $a(this.start,this.end)),t}getIntersection(e){if(this.isIntersecting(e)){let t=this.start,n=this.end;return this.containsPosition(e.start)&&(t=e.start),this.containsPosition(e.end)&&(n=e.end),new $a(t,n)}return null}getMinimalFlatRanges(){const e=[],t=this.start.getCommonPath(this.end).length,n=Ka._createAt(this.start);let r=n.parent;for(;n.path.length>t+1;){const t=r.maxOffset-n.offset;0!==t&&e.push(new $a(n,n.getShiftedBy(t))),n.path=n.path.slice(0,-1),n.offset++,r=r.parent}for(;n.path.length<=this.end.path.length;){const t=this.end.path[n.path.length-1],r=t-n.offset;0!==r&&e.push(new $a(n,n.getShiftedBy(r))),n.offset=t,n.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new Qa(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const t=new Qa(e);for(const e of t)yield e.item}*getPositions(e={}){e.boundaries=this;const t=new Qa(e);yield t.position;for(const e of t)yield e.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new $a(this.start,this.end)]}getTransformedByOperations(e){const t=[new $a(this.start,this.end)];for(const n of e)for(let e=0;e<t.length;e++){const r=t[e].getTransformedByOperation(n);t.splice(e,1,...r),e+=r.length-1}for(let e=0;e<t.length;e++){const n=t[e];for(let r=e+1;r<t.length;r++){const e=t[r];(n.containsRange(e)||e.containsRange(n)||n.isEqual(e))&&t.splice(r,1)}}return t}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,t=!1){return this._getTransformedByInsertion(e.position,e.howMany,t)}_getTransformedByMoveOperation(e,t=!1){const n=e.sourcePosition,r=e.howMany,i=e.targetPosition;return this._getTransformedByMove(n,i,r,t)}_getTransformedBySplitOperation(e){const t=this.start._getTransformedBySplitOperation(e);let n=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(n=this.end.getShiftedBy(1)),t.root!=n.root&&(n=this.end.getShiftedBy(-1)),new $a(t,n)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new $a(this.start);let t=this.start._getTransformedByMergeOperation(e),n=this.end._getTransformedByMergeOperation(e);return t.root!=n.root&&(n=this.end.getShiftedBy(-1)),t.isAfter(n)?(e.sourcePosition.isBefore(e.targetPosition)?(t=Ka._createAt(n),t.offset=0):(e.deletionPosition.isEqual(t)||(n=e.deletionPosition),t=e.targetPosition),new $a(t,n)):new $a(t,n)}_getTransformedByInsertion(e,t,n=!1){if(n&&this.containsPosition(e))return[new $a(this.start,e),new $a(e.getShiftedBy(t),this.end._getTransformedByInsertion(e,t))];{const n=new $a(this.start,this.end);return n.start=n.start._getTransformedByInsertion(e,t),n.end=n.end._getTransformedByInsertion(e,t),[n]}}_getTransformedByMove(e,t,n,r=!1){if(this.isCollapsed){const r=this.start._getTransformedByMove(e,t,n);return[new $a(r)]}const i=$a._createFromPositionAndShift(e,n),o=t._getTransformedByDeletion(e,n);if(this.containsPosition(t)&&!r&&(i.containsPosition(this.start)||i.containsPosition(this.end))){const r=this.start._getTransformedByMove(e,t,n),i=this.end._getTransformedByMove(e,t,n);return[new $a(r,i)]}let a;const s=this.getDifference(i);let c=null;const u=this.getIntersection(i);if(1==s.length?c=new $a(s[0].start._getTransformedByDeletion(e,n),s[0].end._getTransformedByDeletion(e,n)):2==s.length&&(c=new $a(this.start,this.end._getTransformedByDeletion(e,n))),a=c?c._getTransformedByInsertion(o,n,null!==u||r):[],u){const e=new $a(u.start._getCombined(i.start,o),u.end._getCombined(i.start,o));2==a.length?a.splice(1,0,e):a.push(e)}return a}_getTransformedByDeletion(e,t){let n=this.start._getTransformedByDeletion(e,t),r=this.end._getTransformedByDeletion(e,t);return null==n&&null==r?null:(null==n&&(n=e),null==r&&(r=e),new $a(n,r))}static _createFromPositionAndShift(e,t){const n=e,r=e.getShiftedBy(t);return t>0?new this(n,r):new this(r,n)}static _createIn(e){return new this(Ka._createAt(e,0),Ka._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(Ka._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(0===e.length)throw new Jn.b("range-create-from-ranges-empty-array: At least one range has to be passed.",null);if(1==e.length)return e[0].clone();const t=e[0];e.sort(((e,t)=>e.start.isAfter(t.start)?1:-1));const n=e.indexOf(t),r=new this(t.start,t.end);if(n>0)for(let t=n-1;e[t].end.isEqual(r.start);t++)r.start=Ka._createAt(e[t].start);for(let t=n+1;t<e.length&&e[t].start.isEqual(r.end);t++)r.end=Ka._createAt(e[t].end);return r}static fromJSON(e,t){return new this(Ka.fromJSON(e.start,t),Ka.fromJSON(e.end,t))}}class Xa{constructor(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",((e,t)=>{if(t.viewPosition)return;const n=this._modelToViewMapping.get(t.modelPosition.parent);t.viewPosition=this._findPositionIn(n,t.modelPosition.offset)}),{priority:"low"}),this.on("viewToModelPosition",((e,t)=>{if(t.modelPosition)return;const n=this.findMappedViewAncestor(t.viewPosition),r=this._viewToModelMapping.get(n),i=this._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,n);t.modelPosition=Ka._createAt(r,i)}),{priority:"low"})}bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e)}unbindViewElement(e){const t=this.toModelElement(e);if(this._viewToModelMapping.delete(e),this._elementToMarkerNames.has(e))for(const t of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(t);this._modelToViewMapping.get(t)==e&&this._modelToViewMapping.delete(t)}unbindModelElement(e){const t=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping.delete(t)}bindElementToMarker(e,t){const n=this._markerNameToElements.get(t)||new Set;n.add(e);const r=this._elementToMarkerNames.get(e)||new Set;r.add(t),this._markerNameToElements.set(t,n),this._elementToMarkerNames.set(e,r)}unbindElementFromMarkerName(e,t){const n=this._markerNameToElements.get(t);n&&(n.delete(e),0==n.size&&this._markerNameToElements.delete(t));const r=this._elementToMarkerNames.get(e);r&&(r.delete(t),0==r.size&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new $a(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new ei(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition}toViewPosition(e,t={isPhantom:!1}){const n={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",n),n.viewPosition}markerNameToElements(e){const t=this._markerNameToElements.get(e);if(!t)return null;const n=new Set;for(const e of t)if(e.is("attributeElement"))for(const t of e.getElementsWithSameId())n.add(t);else n.add(e);return n}registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t)}findMappedViewAncestor(e){let t=e.parent;for(;!this._viewToModelMapping.has(t);)t=t.parent;return t}_toModelOffset(e,t,n){if(n!=e)return this._toModelOffset(e.parent,e.index,n)+this._toModelOffset(e,t,e);if(e.is("text"))return t;let r=0;for(let n=0;n<t;n++)r+=this.getModelLength(e.getChild(n));return r}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name))return this._viewToModelLengthCallbacks.get(e.name)(e);if(this._viewToModelMapping.has(e))return 1;if(e.is("text"))return e.data.length;if(e.is("uiElement"))return 0;{let t=0;for(const n of e.getChildren())t+=this.getModelLength(n);return t}}_findPositionIn(e,t){let n,r=0,i=0,o=0;if(e.is("text"))return new Zr(e,t);for(;i<t;)n=e.getChild(o),r=this.getModelLength(n),i+=r,o++;return i==t?this._moveViewPositionToTextNode(new Zr(e,o)):this._findPositionIn(n,t-(i-r))}_moveViewPositionToTextNode(e){const t=e.nodeBefore,n=e.nodeAfter;return t instanceof pr?new Zr(t,t.data.length):n instanceof pr?new Zr(n,0):e}}ur(Xa,nr);class Za{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(e,t){t=es(t),e instanceof za&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map),this._consumable.get(e).set(t,!0)}consume(e,t){return t=es(t),e instanceof za&&(e=this._getSymbolForTextProxy(e)),!!this.test(e,t)&&(this._consumable.get(e).set(t,!1),!0)}test(e,t){t=es(t),e instanceof za&&(e=this._getSymbolForTextProxy(e));const n=this._consumable.get(e);if(void 0===n)return null;const r=n.get(t);return void 0===r?null:r}revert(e,t){t=es(t),e instanceof za&&(e=this._getSymbolForTextProxy(e));const n=this.test(e,t);return!1===n?(this._consumable.get(e).set(t,!0),!0):!0!==n&&null}_getSymbolForTextProxy(e){let t=null;const n=this._textProxyRegistry.get(e.startOffset);if(n){const r=n.get(e.endOffset);r&&(t=r.get(e.parent))}return t||(t=this._addSymbolForTextProxy(e.startOffset,e.endOffset,e.parent)),t}_addSymbolForTextProxy(e,t,n){const r=Symbol("textProxySymbol");let i,o;return i=this._textProxyRegistry.get(e),i||(i=new Map,this._textProxyRegistry.set(e,i)),o=i.get(t),o||(o=new Map,i.set(t,o)),o.set(n,r),r}}function es(e){const t=e.split(":");return t.length>1?t[0]+":"+t[1]:t[0]}class ts{constructor(e){this.conversionApi=Lr({dispatcher:this},e)}convertChanges(e,t,n){for(const t of e.getMarkersToRemove())this.convertMarkerRemove(t.name,t.range,n);for(const t of e.getChanges())"insert"==t.type?this.convertInsert($a._createFromPositionAndShift(t.position,t.length),n):"remove"==t.type?this.convertRemove(t.position,t.length,t.name,n):this.convertAttribute(t.range,t.attributeKey,t.attributeOldValue,t.attributeNewValue,n);for(const e of this.conversionApi.mapper.flushUnboundMarkerNames()){const r=t.get(e).getRange();this.convertMarkerRemove(e,r,n),this.convertMarkerAdd(e,r,n)}for(const t of e.getMarkersToAdd())this.convertMarkerAdd(t.name,t.range,n)}convertInsert(e,t){this.conversionApi.writer=t,this.conversionApi.consumable=this._createInsertConsumable(e);for(const t of e){const e=t.item,n={item:e,range:$a._createFromPositionAndShift(t.previousPosition,t.length)};this._testAndFire("insert",n);for(const t of e.getAttributeKeys())n.attributeKey=t,n.attributeOldValue=null,n.attributeNewValue=e.getAttribute(t),this._testAndFire(`attribute:${t}`,n)}this._clearConversionApi()}convertRemove(e,t,n,r){this.conversionApi.writer=r,this.fire("remove:"+n,{position:e,length:t},this.conversionApi),this._clearConversionApi()}convertAttribute(e,t,n,r,i){this.conversionApi.writer=i,this.conversionApi.consumable=this._createConsumableForRange(e,`attribute:${t}`);for(const i of e){const e={item:i.item,range:$a._createFromPositionAndShift(i.previousPosition,i.length),attributeKey:t,attributeOldValue:n,attributeNewValue:r};this._testAndFire(`attribute:${t}`,e)}this._clearConversionApi()}convertSelection(e,t,n){const r=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this.conversionApi.writer=n,this.conversionApi.consumable=this._createSelectionConsumable(e,r),this.fire("selection",{selection:e},this.conversionApi),e.isCollapsed){for(const t of r){const n=t.getRange();if(!ns(e.getFirstPosition(),t,this.conversionApi.mapper))continue;const r={item:e,markerName:t.name,markerRange:n};this.conversionApi.consumable.test(e,"addMarker:"+t.name)&&this.fire("addMarker:"+t.name,r,this.conversionApi)}for(const t of e.getAttributeKeys()){const n={item:e,range:e.getFirstRange(),attributeKey:t,attributeOldValue:null,attributeNewValue:e.getAttribute(t)};this.conversionApi.consumable.test(e,"attribute:"+n.attributeKey)&&this.fire("attribute:"+n.attributeKey+":$text",n,this.conversionApi)}this._clearConversionApi()}}convertMarkerAdd(e,t,n){if(!t.root.document||"$graveyard"==t.root.rootName)return;this.conversionApi.writer=n;const r="addMarker:"+e,i=new Za;if(i.add(t,r),this.conversionApi.consumable=i,this.fire(r,{markerName:e,markerRange:t},this.conversionApi),i.test(t,r)){this.conversionApi.consumable=this._createConsumableForRange(t,r);for(const n of t.getItems()){if(!this.conversionApi.consumable.test(n,r))continue;const i={item:n,range:$a._createOn(n),markerName:e,markerRange:t};this.fire(r,i,this.conversionApi)}this._clearConversionApi()}}convertMarkerRemove(e,t,n){t.root.document&&"$graveyard"!=t.root.rootName&&(this.conversionApi.writer=n,this.fire("removeMarker:"+e,{markerName:e,markerRange:t},this.conversionApi),this._clearConversionApi())}_createInsertConsumable(e){const t=new Za;for(const n of e){const e=n.item;t.add(e,"insert");for(const n of e.getAttributeKeys())t.add(e,"attribute:"+n)}return t}_createConsumableForRange(e,t){const n=new Za;for(const r of e.getItems())n.add(r,t);return n}_createSelectionConsumable(e,t){const n=new Za;n.add(e,"selection");for(const r of t)n.add(e,"addMarker:"+r.name);for(const t of e.getAttributeKeys())n.add(e,"attribute:"+t);return n}_testAndFire(e,t){if(!this.conversionApi.consumable.test(t.item,e))return;const n=t.item.name||"$text";this.fire(e+":"+n,t,this.conversionApi)}_clearConversionApi(){delete this.conversionApi.writer,delete this.conversionApi.consumable}}function ns(e,t,n){const r=t.getRange(),i=Array.from(e.getAncestors());return i.shift(),i.reverse(),!i.some((e=>{if(r.containsItem(e))return!!n.toViewElement(e).getCustomProperty("addHighlight")}))}ur(ts,nr);class rs{constructor(e,t,n){this._lastRangeBackward=!1,this._ranges=[],this._attrs=new Map,e&&this.setTo(e,t,n)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return 1===this._ranges.length&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const t of this._ranges){let n=!1;for(const r of e._ranges)if(t.isEqual(r)){n=!0;break}if(!n)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new $a(e.start,e.end)}getFirstRange(){let e=null;for(const t of this._ranges)e&&!t.start.isBefore(e.start)||(e=t);return e?new $a(e.start,e.end):null}getLastRange(){let e=null;for(const t of this._ranges)e&&!t.end.isAfter(e.end)||(e=t);return e?new $a(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(e,t,n){if(null===e)this._setRanges([]);else if(e instanceof rs)this._setRanges(e.getRanges(),e.isBackward);else if(e&&"function"==typeof e.getRanges)this._setRanges(e.getRanges(),e.isBackward);else if(e instanceof $a)this._setRanges([e],!!t&&!!t.backward);else if(e instanceof Ka)this._setRanges([new $a(e)]);else if(e instanceof Ua){const r=!!n&&!!n.backward;let i;if("in"==t)i=$a._createIn(e);else if("on"==t)i=$a._createOn(e);else{if(void 0===t)throw new Jn.b("model-selection-setTo-required-second-parameter: selection.setTo requires the second parameter when the first parameter is a node.",[this,e]);i=new $a(Ka._createAt(e,t))}this._setRanges([i],r)}else{if(!gr(e))throw new Jn.b("model-selection-setTo-not-selectable: Cannot set the selection to the given place.",[this,e]);this._setRanges(e,t&&!!t.backward)}}_setRanges(e,t=!1){const n=(e=Array.from(e)).some((t=>{if(!(t instanceof $a))throw new Jn.b("model-selection-set-ranges-not-range: Selection range set to an object that is not an instance of model.Range.",[this,e]);return this._ranges.every((e=>!e.isEqual(t)))}));if(e.length!==this._ranges.length||n){this._removeAllRanges();for(const t of e)this._pushRange(t);this._lastRangeBackward=!!t,this.fire("change:range",{directChange:!0})}}setFocus(e,t){if(null===this.anchor)throw new Jn.b("model-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.",[this,e]);const n=Ka._createAt(e,t);if("same"==n.compareWith(this.focus))return;const r=this.anchor;this._ranges.length&&this._popRange(),"before"==n.compareWith(r)?(this._pushRange(new $a(n,r)),this._lastRangeBackward=!0):(this._pushRange(new $a(r,n)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,t){this.getAttribute(e)!==t&&(this._attrs.set(e,t),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){if(1!==this.rangeCount)return null;const e=this.getFirstRange(),t=e.start.nodeAfter,n=e.end.nodeBefore;return t instanceof Ya&&t==n?t:null}is(e){return"selection"==e||"model:selection"==e}*getSelectedBlocks(){const e=new WeakSet;for(const t of this.getRanges()){const n=as(t.start,e);n&&ss(n,t)&&(yield n);for(const n of t.getWalker()){const r=n.item;"elementEnd"==n.type&&os(r,e,t)&&(yield r)}const r=as(t.end,e);r&&!t.end.isTouching(Ka._createAt(r,0))&&ss(r,t)&&(yield r)}}containsEntireContent(e=this.anchor.root){const t=Ka._createAt(e,0),n=Ka._createAt(e,"end");return t.isTouching(this.getFirstPosition())&&n.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new $a(e.start,e.end))}_checkRange(e){for(let t=0;t<this._ranges.length;t++)if(e.isIntersecting(this._ranges[t]))throw new Jn.b("model-selection-range-intersects: Trying to add a range that intersects with another range in the selection.",[this,e],{addedRange:e,intersectingRange:this._ranges[t]})}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}function is(e,t){return!t.has(e)&&(t.add(e),e.document.model.schema.isBlock(e)&&e.parent)}function os(e,t,n){return is(e,t)&&ss(e,n)}function as(e,t){const n=e.parent.document.model.schema,r=e.parent.getAncestors({parentFirst:!0,includeSelf:!0});let i=!1;const o=r.find((e=>!i&&(i=n.isLimit(e),!i&&is(e,t))));return r.forEach((e=>t.add(e))),o}function ss(e,t){const n=function(e){const t=e.document.model.schema;let n=e.parent;for(;n;){if(t.isBlock(n))return n;n=n.parent}}(e);return!n||!t.containsRange($a._createOn(n),!0)}ur(rs,nr);class cs extends $a{constructor(e,t){super(e,t),us.call(this)}detach(){this.stopListening()}is(e){return"liveRange"==e||"model:liveRange"==e||super.is(e)}toRange(){return new $a(this.start,this.end)}static fromRange(e){return new cs(e.start,e.end)}}function us(){this.listenTo(this.root.document.model,"applyOperation",((e,t)=>{const n=t[0];n.isDocumentOperation&&ls.call(this,n)}),{priority:"low"})}function ls(e){const t=this.getTransformedByOperation(e),n=$a._createFromRanges(t),r=!n.isEqual(this),i=function(e,t){switch(t.type){case"insert":return e.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return e.containsPosition(t.sourcePosition)||e.start.isEqual(t.sourcePosition)||e.containsPosition(t.targetPosition);case"split":return e.containsPosition(t.splitPosition)||e.containsPosition(t.insertionPosition)}return!1}(this,e);let o=null;if(r){"$graveyard"==n.root.rootName&&(o="remove"==e.type?e.sourcePosition:e.deletionPosition);const t=this.toRange();this.start=n.start,this.end=n.end,this.fire("change:range",t,{deletionPosition:o})}else i&&this.fire("change:content",this.toRange(),{deletionPosition:o})}ur(cs,nr);const fs="selection:";class hs{constructor(e){this._selection=new ds(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection._updateMarkers(),this._selection._updateAttributes(!1)}is(e){return"selection"==e||"model:selection"==e||"documentSelection"==e||"model:documentSelection"==e}_setFocus(e,t){this._selection.setFocus(e,t)}_setTo(e,t,n){this._selection.setTo(e,t,n)}_setAttribute(e,t){this._selection.setAttribute(e,t)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection._getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return fs+e}static _isStoreAttributeKey(e){return e.startsWith(fs)}}ur(hs,nr);class ds extends rs{constructor(e){super(),this.markers=new oi({idProperty:"name"}),this._model=e.model,this._document=e,this._attributePriority=new Map,this._fixGraveyardRangesData=[],this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this.listenTo(this._model,"applyOperation",((e,t)=>{const n=t[0];if(n.isDocumentOperation&&"marker"!=n.type&&"rename"!=n.type&&"noop"!=n.type){for(;this._fixGraveyardRangesData.length;){const{liveRange:e,sourcePosition:t}=this._fixGraveyardRangesData.shift();this._fixGraveyardSelection(e,t)}this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1}))}}),{priority:"lowest"}),this.on("change:range",(()=>{for(const e of this.getRanges())if(!this._document._validateSelectionRange(e))throw new Jn.b("document-selection-wrong-position: Range from document selection starts or ends at incorrect position.",this,{range:e})})),this.listenTo(this._model.markers,"update",(()=>this._updateMarkers())),this.listenTo(this._document,"change",((e,t)=>{!function(e,t){const n=e.document.differ;for(const r of n.getChanges()){if("insert"!=r.type)continue;const n=r.position.parent;r.length===n.maxOffset&&e.enqueueChange(t,(e=>{const t=Array.from(n.getAttributeKeys()).filter((e=>e.startsWith(fs)));for(const r of t)e.removeAttribute(r,n)}))}}(this._model,t)}))}get isCollapsed(){return 0===this._ranges.length?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(e,t,n){super.setTo(e,t,n),this._updateAttributes(!0)}setFocus(e,t){super.setFocus(e,t),this._updateAttributes(!0)}setAttribute(e,t){if(this._setAttribute(e,t)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const t=[e];this.fire("change:attribute",{attributeKeys:t,directChange:!0})}}overrideGravity(){const e=Xn();return this._overriddenGravityRegister.add(e),1===this._overriddenGravityRegister.size&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new Jn.b("document-selection-gravity-wrong-restore: Attempting to restore the selection gravity for an unknown UID.",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const t=this._prepareRange(e);t&&this._ranges.push(t)}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const t=cs.fromRange(e);return t.on("change:range",((e,n,r)=>{this._hasChangedRange=!0,t.root==this._document.graveyard&&this._fixGraveyardRangesData.push({liveRange:t,sourcePosition:r.deletionPosition})})),t}_updateMarkers(){const e=[];for(const t of this._model.markers){const n=t.getRange();for(const r of this.getRanges())n.containsRange(r,!r.isCollapsed)&&e.push(t)}for(const t of e)this.markers.has(t)||this.markers.add(t);for(const t of Array.from(this.markers))e.includes(t)||this.markers.remove(t)}_updateAttributes(e){const t=Va(this._getSurroundingAttributes()),n=Va(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[e,t]of this._attributePriority)"low"==t&&(this._attrs.delete(e),this._attributePriority.delete(e));this._setAttributesTo(t);const r=[];for(const[e,t]of this.getAttributes())n.has(e)&&n.get(e)===t||r.push(e);for(const[e]of n)this.hasAttribute(e)||r.push(e);r.length>0&&this.fire("change:attribute",{attributeKeys:r,directChange:!1})}_setAttribute(e,t,n=!0){const r=n?"normal":"low";return("low"!=r||"normal"!=this._attributePriority.get(e))&&super.getAttribute(e)!==t&&(this._attrs.set(e,t),this._attributePriority.set(e,r),!0)}_removeAttribute(e,t=!0){const n=t?"normal":"low";return!("low"==n&&"normal"==this._attributePriority.get(e)||(this._attributePriority.set(e,n),!super.hasAttribute(e)||(this._attrs.delete(e),0)))}_setAttributesTo(e){const t=new Set;for(const[t,n]of this.getAttributes())e.get(t)!==n&&this._removeAttribute(t,!1);for(const[n,r]of e)this._setAttribute(n,r,!1)&&t.add(n);return t}*_getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const t of e.getAttributeKeys())if(t.startsWith(fs)){const n=t.substr(fs.length);yield[n,e.getAttribute(t)]}}_getSurroundingAttributes(){const e=this.getFirstPosition(),t=this._model.schema;let n=null;if(this.isCollapsed){const t=e.textNode?e.textNode:e.nodeBefore,r=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(n=ps(t)),n||(n=ps(r)),!this.isGravityOverridden&&!n){let e=t;for(;e&&!n;)e=e.previousSibling,n=ps(e)}if(!n){let e=r;for(;e&&!n;)e=e.nextSibling,n=ps(e)}n||(n=this._getStoredAttributes())}else{const e=this.getFirstRange();for(const r of e){if(r.item.is("element")&&t.isObject(r.item))break;if("text"==r.type){n=r.item.getAttributes();break}}}return n}_fixGraveyardSelection(e,t){const n=t.clone(),r=this._model.schema.getNearestSelectionRange(n),i=this._ranges.indexOf(e);if(this._ranges.splice(i,1),e.detach(),r){const e=this._prepareRange(r);this._ranges.splice(i,0,e)}}}function ps(e){return e instanceof za||e instanceof Ha?e.getAttributes():null}class ms{constructor(e){this._dispatchers=e}add(e){for(const t of this._dispatchers)e(t);return this}}var ys=1,gs=4,bs=function(e){return Un(e,ys|gs)};class vs extends ms{elementToElement(e){return this.add(function(e){return(e=bs(e)).view=_s(e.view,"container"),t=>{t.on("insert:"+e.model,function(e){return(t,n,r)=>{const i=e(n.item,r.writer);if(!i)return;if(!r.consumable.consume(n.item,"insert"))return;const o=r.mapper.toViewPosition(n.range.start);r.mapper.bindElements(n.item,i),r.writer.insert(o,i)}}(e.view),{priority:e.converterPriority||"normal"})}}(e))}attributeToElement(e){return this.add(function(e){let t="attribute:"+((e=bs(e)).model.key?e.model.key:e.model);if(e.model.name&&(t+=":"+e.model.name),e.model.values)for(const t of e.model.values)e.view[t]=_s(e.view[t],"attribute");else e.view=_s(e.view,"attribute");const n=ks(e);return r=>{r.on(t,function(e){return(t,n,r)=>{const i=e(n.attributeOldValue,r.writer),o=e(n.attributeNewValue,r.writer);if(!i&&!o)return;if(!r.consumable.consume(n.item,t.name))return;const a=r.writer,s=a.document.selection;if(n.item instanceof rs||n.item instanceof hs)a.wrap(s.getFirstRange(),o);else{let e=r.mapper.toViewRange(n.range);null!==n.attributeOldValue&&i&&(e=a.unwrap(e,i)),null!==n.attributeNewValue&&o&&a.wrap(e,o)}}}(n),{priority:e.converterPriority||"normal"})}}(e))}attributeToAttribute(e){return this.add(function(e){let t="attribute:"+((e=bs(e)).model.key?e.model.key:e.model);if(e.model.name&&(t+=":"+e.model.name),e.model.values)for(const t of e.model.values)e.view[t]=Es(e.view[t]);else e.view=Es(e.view);const n=ks(e);return r=>{r.on(t,function(e){return(t,n,r)=>{const i=e(n.attributeOldValue,n),o=e(n.attributeNewValue,n);if(!i&&!o)return;if(!r.consumable.consume(n.item,t.name))return;const a=r.mapper.toViewElement(n.item),s=r.writer;if(!a)throw new Jn.b("conversion-attribute-to-attribute-on-text: Trying to convert text node's attribute with attribute-to-attribute converter.",[n,r]);if(null!==n.attributeOldValue&&i)if("class"==i.key){const e=Array.isArray(i.value)?i.value:[i.value];for(const t of e)s.removeClass(t,a)}else if("style"==i.key){const e=Object.keys(i.value);for(const t of e)s.removeStyle(t,a)}else s.removeAttribute(i.key,a);if(null!==n.attributeNewValue&&o)if("class"==o.key){const e=Array.isArray(o.value)?o.value:[o.value];for(const t of e)s.addClass(t,a)}else if("style"==o.key){const e=Object.keys(o.value);for(const t of e)s.setStyle(t,o.value[t],a)}else s.setAttribute(o.key,o.value,a)}}(n),{priority:e.converterPriority||"normal"})}}(e))}markerToElement(e){return this.add(function(e){return(e=bs(e)).view=_s(e.view,"ui"),t=>{t.on("addMarker:"+e.model,function(e){return(t,n,r)=>{n.isOpening=!0;const i=e(n,r.writer);n.isOpening=!1;const o=e(n,r.writer);if(!i||!o)return;const a=n.markerRange;if(a.isCollapsed&&!r.consumable.consume(a,t.name))return;for(const e of a)if(!r.consumable.consume(e.item,t.name))return;const s=r.mapper,c=r.writer;c.insert(s.toViewPosition(a.start),i),r.mapper.bindElementToMarker(i,n.markerName),a.isCollapsed||(c.insert(s.toViewPosition(a.end),o),r.mapper.bindElementToMarker(o,n.markerName)),t.stop()}}(e.view),{priority:e.converterPriority||"normal"}),t.on("removeMarker:"+e.model,(e.view,(e,t,n)=>{const r=n.mapper.markerNameToElements(t.markerName);if(r){for(const e of r)n.mapper.unbindElementFromMarkerName(e,t.markerName),n.writer.clear(n.writer.createRangeOn(e),e);n.writer.clearClonedElementsGroup(t.markerName),e.stop()}}),{priority:e.converterPriority||"normal"})}}(e))}markerToHighlight(e){return this.add(function(e){return t=>{t.on("addMarker:"+e.model,function(e){return(t,n,r)=>{if(!n.item)return;if(!(n.item instanceof rs||n.item instanceof hs||n.item.is("textProxy")))return;const i=Os(e,n,r);if(!i)return;if(!r.consumable.consume(n.item,t.name))return;const o=ws(i),a=r.writer,s=a.document.selection;if(n.item instanceof rs||n.item instanceof hs)a.wrap(s.getFirstRange(),o,s);else{const e=r.mapper.toViewRange(n.range),t=a.wrap(e,o);for(const e of t.getItems())if(e.is("attributeElement")&&e.isSimilar(o)){r.mapper.bindElementToMarker(e,n.markerName);break}}}}(e.view),{priority:e.converterPriority||"normal"}),t.on("addMarker:"+e.model,function(e){return(t,n,r)=>{if(!n.item)return;if(!(n.item instanceof Ya))return;const i=Os(e,n,r);if(!i)return;if(!r.consumable.test(n.item,t.name))return;const o=r.mapper.toViewElement(n.item);if(o&&o.getCustomProperty("addHighlight")){r.consumable.consume(n.item,t.name);for(const e of $a._createIn(n.item))r.consumable.consume(e.item,t.name);o.getCustomProperty("addHighlight")(o,i,r.writer),r.mapper.bindElementToMarker(o,n.markerName)}}}(e.view),{priority:e.converterPriority||"normal"}),t.on("removeMarker:"+e.model,function(e){return(t,n,r)=>{if(n.markerRange.isCollapsed)return;const i=Os(e,n,r);if(!i)return;const o=ws(i),a=r.mapper.markerNameToElements(n.markerName);if(a){for(const e of a)r.mapper.unbindElementFromMarkerName(e,n.markerName),e.is("attributeElement")?r.writer.unwrap(r.writer.createRangeOn(e),o):e.getCustomProperty("removeHighlight")(e,i.id,r.writer);r.writer.clearClonedElementsGroup(n.markerName),t.stop()}}}(e.view),{priority:e.converterPriority||"normal"})}}(e))}}function ws(e){const t=new ci("span",e.attributes);return e.classes&&t._addClass(e.classes),e.priority&&(t._priority=e.priority),t._id=e.id,t}function _s(e,t){return"function"==typeof e?e:(n,r)=>function(e,t,n){let r;"string"==typeof e&&(e={name:e});const i=Object.assign({},e.attributes);if("container"==n)r=t.createContainerElement(e.name,i);else if("attribute"==n){const n={priority:e.priority||ci.DEFAULT_PRIORITY};r=t.createAttributeElement(e.name,i,n)}else r=t.createUIElement(e.name,i);if(e.styles){const n=Object.keys(e.styles);for(const i of n)t.setStyle(i,e.styles[i],r)}if(e.classes){const n=e.classes;if("string"==typeof n)t.addClass(n,r);else for(const e of n)t.addClass(e,r)}return r}(e,r,t)}function ks(e){return e.model.values?(t,n)=>{const r=e.view[t];return r?r(t,n):null}:e.view}function Es(e){return"string"==typeof e?t=>({key:e,value:t}):"object"==typeof e?e.value?()=>e:t=>({key:e.key,value:t}):e}function Os(e,t,n){const r="function"==typeof e?e(t,n):e;return r?(r.priority||(r.priority=10),r.id||(r.id=t.markerName),r):null}class Ts extends ms{elementToElement(e){return this.add(xs(e))}elementToAttribute(e){return this.add(function(e){Cs(e=bs(e));const t=Rs(e,!1),n=Ss(e.view),r=n?"element:"+n:"element";return n=>{n.on(r,t,{priority:e.converterPriority||"low"})}}(e))}attributeToAttribute(e){return this.add(function(e){let t=null;("string"==typeof(e=bs(e)).view||e.view.key)&&(t=function(e){"string"==typeof e.view&&(e.view={key:e.view});const t=e.view.key;let n;return n="class"==t||"style"==t?{["class"==t?"classes":"styles"]:e.view.value}:{attributes:{[t]:void 0===e.view.value?/[\s\S]*/:e.view.value}},e.view.name&&(n.name=e.view.name),e.view=n,t}(e)),Cs(e,t);const n=Rs(e,!0);return t=>{t.on("element",n,{priority:e.converterPriority||"low"})}}(e))}elementToMarker(e){return this.add(function(e){return function(e){const t=e.model;e.model=(e,n)=>{const r="string"==typeof t?t:t(e);return n.createElement("$marker",{"data-name":r})}}(e=bs(e)),xs(e)}(e))}}function xs(e){const t=function(e){const t=e.view?new br(e.view):null;return(n,r,i)=>{let o={};if(t){const e=t.match(r.viewItem);if(!e)return;o=e.match}o.name=!0;const a=function(e,t,n){return e instanceof Function?e(t,n):n.createElement(e)}(e.model,r.viewItem,i.writer);if(!a)return;if(!i.consumable.test(r.viewItem,o))return;const s=i.splitToAllowedParent(a,r.modelCursor);if(!s)return;i.writer.insert(a,s.position),i.convertChildren(r.viewItem,i.writer.createPositionAt(a,0)),i.consumable.consume(r.viewItem,o);const c=i.getSplitParts(a);r.modelRange=new $a(i.writer.createPositionBefore(a),i.writer.createPositionAfter(c[c.length-1])),s.cursorParent?r.modelCursor=i.writer.createPositionAt(s.cursorParent,0):r.modelCursor=r.modelRange.end}}(e=bs(e)),n=Ss(e.view),r=n?"element:"+n:"element";return n=>{n.on(r,t,{priority:e.converterPriority||"normal"})}}function Ss(e){return"string"==typeof e?e:"object"==typeof e&&"string"==typeof e.name?e.name:null}function Cs(e,t=null){const n=null===t||(e=>e.getAttribute(t)),r="object"!=typeof e.model?e.model:e.model.key,i="object"!=typeof e.model||void 0===e.model.value?n:e.model.value;e.model={key:r,value:i}}function Rs(e,t){const n=new br(e.view);return(r,i,o)=>{const a=n.match(i.viewItem);if(!a)return;const s=e.model.key,c="function"==typeof e.model.value?e.model.value(i.viewItem):e.model.value;null!==c&&(function(e,t){const n="function"==typeof e?e(t):e;return!("object"==typeof n&&!Ss(n)||n.classes||n.attributes||n.styles)}(e.view,i.viewItem)?a.match.name=!0:delete a.match.name,o.consumable.test(i.viewItem,a.match)&&(i.modelRange||(i=Object.assign(i,o.convertChildren(i.viewItem,i.modelCursor))),function(e,t,n,r){let i=!1;for(const o of Array.from(e.getItems({shallow:n})))r.schema.checkAttribute(o,t.key)&&(r.writer.setAttribute(t.key,t.value,o),i=!0);return i}(i.modelRange,{key:s,value:c},t,o)&&o.consumable.consume(i.viewItem,a.match)))}}class Ps{constructor(e){this.model=e,this.view=new qa,this.mapper=new Xa,this.downcastDispatcher=new ts({mapper:this.mapper});const t=this.model.document,n=t.selection,r=this.model.markers;this.listenTo(this.model,"_beforeChanges",(()=>{this.view._disableRendering(!0)}),{priority:"highest"}),this.listenTo(this.model,"_afterChanges",(()=>{this.view._disableRendering(!1)}),{priority:"lowest"}),this.listenTo(t,"change",(()=>{this.view.change((e=>{this.downcastDispatcher.convertChanges(t.differ,r,e),this.downcastDispatcher.convertSelection(n,r,e)}))}),{priority:"low"}),this.listenTo(this.view.document,"selectionChange",function(e,t){return(n,r)=>{const i=r.newSelection,o=new rs,a=[];for(const e of i.getRanges())a.push(t.toModelRange(e));o.setTo(a,{backward:i.isBackward}),o.isEqual(e.document.selection)||e.change((e=>{e.setSelection(o)}))}}(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",((e,t,n)=>{if(!n.consumable.consume(t.item,"insert"))return;const r=n.writer,i=n.mapper.toViewPosition(t.range.start),o=r.createText(t.item.data);r.insert(i,o)}),{priority:"lowest"}),this.downcastDispatcher.on("remove",((e,t,n)=>{const r=n.mapper.toViewPosition(t.position),i=t.position.getShiftedBy(t.length),o=n.mapper.toViewPosition(i,{isPhantom:!0}),a=n.writer.createRange(r,o),s=n.writer.remove(a.getTrimmed());for(const e of n.writer.createRangeIn(s).getItems())n.mapper.unbindViewElement(e)}),{priority:"low"}),this.downcastDispatcher.on("selection",((e,t,n)=>{const r=n.writer,i=r.document.selection;for(const e of i.getRanges())e.isCollapsed&&e.end.parent.document&&n.writer.mergeAttributes(e.start);r.setSelection(null)}),{priority:"low"}),this.downcastDispatcher.on("selection",((e,t,n)=>{const r=t.selection;if(r.isCollapsed)return;if(!n.consumable.consume(r,"selection"))return;const i=[];for(const e of r.getRanges()){const t=n.mapper.toViewRange(e);i.push(t)}n.writer.setSelection(i,{backward:r.isBackward})}),{priority:"low"}),this.downcastDispatcher.on("selection",((e,t,n)=>{const r=t.selection;if(!r.isCollapsed)return;if(!n.consumable.consume(r,"selection"))return;const i=n.writer,o=r.getFirstPosition(),a=n.mapper.toViewPosition(o),s=i.breakAttributes(a);i.setSelection(s)}),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using((e=>{if("$graveyard"==e.rootName)return null;const t=new $r(e.name);return t.rootName=e.rootName,t._document=this.view.document,this.mapper.bindElements(e,t),t}))}destroy(){this.view.destroy(),this.stopListening()}}ur(Ps,Ur);class Ns{constructor(e,t=[]){this._editor=e,this._availablePlugins=new Map,this._plugins=new Map;for(const e of t)this._availablePlugins.set(e,e),e.pluginName&&this._availablePlugins.set(e.pluginName,e)}*[Symbol.iterator](){for(const e of this._plugins)"function"==typeof e[0]&&(yield e)}get(e){const t=this._plugins.get(e);if(!t){const t="plugincollection-plugin-not-loaded: The requested plugin is not loaded.";let n=e;throw"function"==typeof e&&(n=e.pluginName||e.name),new Jn.b(t,this._editor,{plugin:n})}return t}has(e){return this._plugins.has(e)}init(e,t=[]){const n=this,r=this._editor,i=new Set,o=[],a=h(e),s=h(t),c=function(e){const t=[];for(const n of e)f(n)||t.push(n);return t.length?t:null}(e);if(c){const e="plugincollection-plugin-not-found: Some plugins are not available and could not be loaded.";return console.error(Object(Jn.a)(e),{plugins:c}),Promise.reject(new Jn.b(e,this._editor,{plugins:c}))}return Promise.all(a.map(u)).then((()=>l(o,"init"))).then((()=>l(o,"afterInit"))).then((()=>o));function u(e){if(!s.includes(e)&&!n._plugins.has(e)&&!i.has(e))return function(e){return new Promise((a=>{i.add(e),e.requires&&e.requires.forEach((n=>{const i=f(n);if(t.includes(i))throw new Jn.b("plugincollection-required: Cannot load a plugin because one of its dependencies is listed inthe `removePlugins` option.",r,{plugin:i,requiredBy:e});u(i)}));const s=new e(r);n._add(e,s),o.push(s),a()}))}(e).catch((t=>{throw console.error(Object(Jn.a)("plugincollection-load: It was not possible to load the plugin."),{plugin:e}),t}))}function l(e,t){return e.reduce(((e,n)=>n[t]?e.then(n[t].bind(n)):e),Promise.resolve())}function f(e){return"function"==typeof e?e:n._availablePlugins.get(e)}function h(e){return e.map((e=>f(e))).filter((e=>!!e))}}destroy(){const e=Array.from(this).map((([,e])=>e)).filter((e=>"function"==typeof e.destroy)).map((e=>e.destroy()));return Promise.all(e)}_add(e,t){this._plugins.set(e,t);const n=e.pluginName;if(n){if(this._plugins.has(n))throw new Jn.b("plugincollection-plugin-name-conflict: Two plugins with the same name were loaded.",null,{pluginName:n,plugin1:this._plugins.get(n).constructor,plugin2:e});this._plugins.set(n,t)}}}ur(Ns,nr);class Ms{constructor(){this._commands=new Map}add(e,t){this._commands.set(e,t)}get(e){return this._commands.get(e)}execute(e,...t){const n=this.get(e);if(!n)throw new Jn.b("commandcollection-command-not-found: Command does not exist.",this,{commandName:e});n.execute(...t)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const e of this.commands())e.destroy()}}function As(e,t){const n=Object.keys(window.CKEDITOR_TRANSLATIONS).length;return 1===n&&(e=Object.keys(window.CKEDITOR_TRANSLATIONS)[0]),0!==n&&function(e,t){return e in window.CKEDITOR_TRANSLATIONS&&t in window.CKEDITOR_TRANSLATIONS[e]}(e,t)?window.CKEDITOR_TRANSLATIONS[e][t].replace(/ \[context: [^\]]+\]$/,""):t.replace(/ \[context: [^\]]+\]$/,"")}window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={});const js=["ar","fa","he","ku","ug"];class Is{constructor(e={}){this.uiLanguage=e.uiLanguage||"en",this.contentLanguage=e.contentLanguage||this.uiLanguage,this.uiLanguageDirection=Ds(this.uiLanguage),this.contentLanguageDirection=Ds(this.contentLanguage),this.t=(...e)=>this._t(...e)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(e,t){let n=As(this.uiLanguage,e);return t&&(n=n.replace(/%(\d+)/g,((e,n)=>n<t.length?t[n]:e))),n}}function Ds(e){return js.includes(e)?"rtl":"ltr"}class Ls{constructor(){this._consumables=new Map}add(e,t){let n;e.is("text")||e.is("documentFragment")?this._consumables.set(e,!0):(this._consumables.has(e)?n=this._consumables.get(e):(n=new Bs,this._consumables.set(e,n)),n.add(t))}test(e,t){const n=this._consumables.get(e);return void 0===n?null:e.is("text")||e.is("documentFragment")?n:n.test(t)}consume(e,t){return!!this.test(e,t)&&(e.is("text")||e.is("documentFragment")?this._consumables.set(e,!1):this._consumables.get(e).consume(t),!0)}revert(e,t){const n=this._consumables.get(e);void 0!==n&&(e.is("text")||e.is("documentFragment")?this._consumables.set(e,!0):n.revert(t))}static consumablesFromElement(e){const t={name:!0,attributes:[],classes:[],styles:[]},n=e.getAttributeKeys();for(const e of n)"style"!=e&&"class"!=e&&t.attributes.push(e);const r=e.getClassNames();for(const e of r)t.classes.push(e);const i=e.getStyleNames();for(const e of i)t.styles.push(e);return t}static createFrom(e,t){if(t||(t=new Ls),e.is("text"))return t.add(e),t;e.is("element")&&t.add(e,Ls.consumablesFromElement(e)),e.is("documentFragment")&&t.add(e);for(const n of e.getChildren())t=Ls.createFrom(n,t);return t}}class Bs{constructor(){this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(e){e.name&&(this._canConsumeName=!0);for(const t in this._consumables)t in e&&this._add(t,e[t])}test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(const t in this._consumables)if(t in e){const n=this._test(t,e[t]);if(!0!==n)return n}return!0}consume(e){e.name&&(this._canConsumeName=!1);for(const t in this._consumables)t in e&&this._consume(t,e[t])}revert(e){e.name&&(this._canConsumeName=!0);for(const t in this._consumables)t in e&&this._revert(t,e[t])}_add(e,t){const n=Ye(t)?t:[t],r=this._consumables[e];for(const t of n){if("attributes"===e&&("class"===t||"style"===t))throw new Jn.b("viewconsumable-invalid-attribute: Classes and styles should be handled separately.",this);r.set(t,!0)}}_test(e,t){const n=Ye(t)?t:[t],r=this._consumables[e];for(const t of n)if("attributes"!==e||"class"!==t&&"style"!==t){const e=r.get(t);if(void 0===e)return null;if(!e)return!1}else{const e="class"==t?"classes":"styles",n=this._test(e,[...this._consumables[e].keys()]);if(!0!==n)return n}return!0}_consume(e,t){const n=Ye(t)?t:[t],r=this._consumables[e];for(const t of n)if("attributes"!==e||"class"!==t&&"style"!==t)r.set(t,!1);else{const e="class"==t?"classes":"styles";this._consume(e,[...this._consumables[e].keys()])}}_revert(e,t){const n=Ye(t)?t:[t],r=this._consumables[e];for(const t of n)if("attributes"!==e||"class"!==t&&"style"!==t)!1===r.get(t)&&r.set(t,!0);else{const e="class"==t?"classes":"styles";this._revert(e,[...this._consumables[e].keys()])}}}class Fs{constructor(){this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",((e,t)=>{t[0]=new qs(t[0])}),{priority:"highest"}),this.on("checkChild",((e,t)=>{t[0]=new qs(t[0]),t[1]=this.getDefinition(t[1])}),{priority:"highest"})}register(e,t){if(this._sourceDefinitions[e])throw new Jn.b("schema-cannot-register-item-twice: A single item cannot be registered twice in the schema.",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache()}extend(e,t){if(!this._sourceDefinitions[e])throw new Jn.b("schema-cannot-extend-missing-item: Cannot extend an item which was not registered yet.",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let t;return t="string"==typeof e?e:e.is&&(e.is("text")||e.is("textProxy"))?"$text":e.name,this.getDefinitions()[t]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const t=this.getDefinition(e);return!(!t||!t.isBlock)}isLimit(e){const t=this.getDefinition(e);return!(!t||!t.isLimit&&!t.isObject)}isObject(e){const t=this.getDefinition(e);return!(!t||!t.isObject)}isInline(e){const t=this.getDefinition(e);return!(!t||!t.isInline)}checkChild(e,t){return!!t&&this._checkContextMatch(t,e)}checkAttribute(e,t){const n=this.getDefinition(e.last);return!!n&&n.allowAttributes.includes(t)}checkMerge(e,t=null){if(e instanceof Ka){const t=e.nodeBefore,n=e.nodeAfter;if(!(t instanceof Ya))throw new Jn.b("schema-check-merge-no-element-before: The node before the merge position must be an element.",this);if(!(n instanceof Ya))throw new Jn.b("schema-check-merge-no-element-after: The node after the merge position must be an element.",this);return this.checkMerge(t,n)}for(const n of t.getChildren())if(!this.checkChild(e,n))return!1;return!0}addChildCheck(e){this.on("checkChild",((t,[n,r])=>{if(!r)return;const i=e(n,r);"boolean"==typeof i&&(t.stop(),t.return=i)}),{priority:"high"})}addAttributeCheck(e){this.on("checkAttribute",((t,[n,r])=>{const i=e(n,r);"boolean"==typeof i&&(t.stop(),t.return=i)}),{priority:"high"})}setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t)}getAttributeProperties(e){return this._attributeProperties[e]||{}}getLimitElement(e){let t;for(t=e instanceof Ka?e.parent:(e instanceof $a?[e]:Array.from(e.getRanges())).reduce(((e,t)=>{const n=t.getCommonAncestor();return e?e.getCommonAncestor(n,{includeSelf:!0}):n}),null);!this.isLimit(t)&&t.parent;)t=t.parent;return t}checkAttributeInSelection(e,t){if(e.isCollapsed){const n=[...e.getFirstPosition().getAncestors(),new Ha("",e.getAttributes())];return this.checkAttribute(n,t)}{const n=e.getRanges();for(const e of n)for(const n of e)if(this.checkAttribute(n.item,t))return!0}return!1}*getValidRanges(e,t){e=function*(e){for(const t of e)yield*t.getMinimalFlatRanges()}(e);for(const n of e)yield*this._getValidRangesForRange(n,t)}getNearestSelectionRange(e,t="both"){if(this.checkChild(e,"$text"))return new $a(e);let n,r;"both"!=t&&"backward"!=t||(n=new Qa({startPosition:e,direction:"backward"})),"both"!=t&&"forward"!=t||(r=new Qa({startPosition:e}));for(const e of function*(e,t){let n=!1;for(;!n;){if(n=!0,e){const t=e.next();t.done||(n=!1,yield{walker:e,value:t.value})}if(t){const e=t.next();e.done||(n=!1,yield{walker:t,value:e.value})}}}(n,r)){const t=e.walker==n?"elementEnd":"elementStart",r=e.value;if(r.type==t&&this.isObject(r.item))return $a._createOn(r.item);if(this.checkChild(r.nextPosition,"$text"))return new $a(r.nextPosition)}return null}findAllowedParent(e,t){let n=e.parent;for(;n;){if(this.checkChild(n,t))return n;if(this.isLimit(n))return null;n=n.parent}return null}removeDisallowedAttributes(e,t){for(const n of e)if(n.is("text"))$s(this,n,t);else{const e=$a._createIn(n).getPositions();for(const n of e)$s(this,n.nodeBefore||n.parent,t)}}createContext(e){return new qs(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},t=this._sourceDefinitions,n=Object.keys(t);for(const r of n)e[r]=Vs(t[r],r);for(const t of n)Us(e,t);for(const t of n)Hs(e,t);for(const t of n)zs(e,t),Ws(e,t);for(const t of n)Ys(e,t),Qs(e,t);this._compiledDefinitions=e}_checkContextMatch(e,t,n=t.length-1){const r=t.getItem(n);if(e.allowIn.includes(r.name)){if(0==n)return!0;{const e=this.getDefinition(r);return this._checkContextMatch(e,t,n-1)}}return!1}*_getValidRangesForRange(e,t){let n=e.start,r=e.start;for(const i of e.getItems({shallow:!0}))i.is("element")&&(yield*this._getValidRangesForRange($a._createIn(i),t)),this.checkAttribute(i,t)||(n.isEqual(r)||(yield new $a(n,r)),n=Ka._createAfter(i)),r=Ka._createAfter(i);n.isEqual(r)||(yield new $a(n,r))}}ur(Fs,Ur);class qs{constructor(e){if(e instanceof qs)return e;"string"==typeof e?e=[e]:Array.isArray(e)||(e=e.getAncestors({includeSelf:!0})),e[0]&&"string"!=typeof e[0]&&e[0].is("documentFragment")&&e.shift(),this._items=e.map(Ks)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(e){const t=new qs([e]);return t._items=[...this._items,...t._items],t}getItem(e){return this._items[e]}*getNames(){yield*this._items.map((e=>e.name))}endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e)}}function Vs(e,t){const n={name:t,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],inheritTypesFrom:[]};return function(e,t){for(const n of e){const e=Object.keys(n).filter((e=>e.startsWith("is")));for(const r of e)t[r]=n[r]}}(e,n),Gs(e,n,"allowIn"),Gs(e,n,"allowContentOf"),Gs(e,n,"allowWhere"),Gs(e,n,"allowAttributes"),Gs(e,n,"allowAttributesOf"),Gs(e,n,"inheritTypesFrom"),function(e,t){for(const n of e){const e=n.inheritAllFrom;e&&(t.allowContentOf.push(e),t.allowWhere.push(e),t.allowAttributesOf.push(e),t.inheritTypesFrom.push(e))}}(e,n),n}function Us(e,t){for(const n of e[t].allowContentOf)e[n]&&Js(e,n).forEach((e=>{e.allowIn.push(t)}));delete e[t].allowContentOf}function Hs(e,t){for(const n of e[t].allowWhere){const r=e[n];if(r){const n=r.allowIn;e[t].allowIn.push(...n)}}delete e[t].allowWhere}function zs(e,t){for(const n of e[t].allowAttributesOf){const r=e[n];if(r){const n=r.allowAttributes;e[t].allowAttributes.push(...n)}}delete e[t].allowAttributesOf}function Ws(e,t){const n=e[t];for(const t of n.inheritTypesFrom){const r=e[t];if(r){const e=Object.keys(r).filter((e=>e.startsWith("is")));for(const t of e)t in n||(n[t]=r[t])}}delete n.inheritTypesFrom}function Ys(e,t){const n=e[t],r=n.allowIn.filter((t=>e[t]));n.allowIn=Array.from(new Set(r))}function Qs(e,t){const n=e[t];n.allowAttributes=Array.from(new Set(n.allowAttributes))}function Gs(e,t,n){for(const r of e)"string"==typeof r[n]?t[n].push(r[n]):Array.isArray(r[n])&&t[n].push(...r[n])}function Js(e,t){const n=e[t];return(r=e,Object.keys(r).map((e=>r[e]))).filter((e=>e.allowIn.includes(n.name)));var r}function Ks(e){return"string"==typeof e?{name:e,*getAttributeKeys(){},getAttribute(){}}:{name:e.is("element")?e.name:"$text",*getAttributeKeys(){yield*e.getAttributeKeys()},getAttribute:t=>e.getAttribute(t)}}function $s(e,t,n){for(const r of t.getAttributeKeys())e.checkAttribute(t,r)||n.removeAttribute(r,t)}class Xs{constructor(e={}){this._splitParts=new Map,this._modelCursor=null,this.conversionApi=Object.assign({},e),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this),this.conversionApi.splitToAllowedParent=this._splitToAllowedParent.bind(this),this.conversionApi.getSplitParts=this._getSplitParts.bind(this)}convert(e,t,n=["$root"]){this.fire("viewCleanup",e),this._modelCursor=function(e,t){let n;for(const r of new qs(e)){const e={};for(const t of r.getAttributeKeys())e[t]=r.getAttribute(t);const i=t.createElement(r.name,e);n&&t.append(i,n),n=Ka._createAt(i,0)}return n}(n,t),this.conversionApi.writer=t,this.conversionApi.consumable=Ls.createFrom(e),this.conversionApi.store={};const{modelRange:r}=this._convertItem(e,this._modelCursor),i=t.createDocumentFragment();if(r){this._removeEmptyElements();for(const e of Array.from(this._modelCursor.parent.getChildren()))t.append(e,i);i.markers=function(e,t){const n=new Set,r=new Map,i=$a._createIn(e).getItems();for(const e of i)"$marker"==e.name&&n.add(e);for(const e of n){const n=e.getAttribute("data-name"),i=t.createPositionBefore(e);r.has(n)?r.get(n).end=i.clone():r.set(n,new $a(i.clone())),t.remove(e)}return r}(i,t)}return this._modelCursor=null,this._splitParts.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,i}_convertItem(e,t){const n=Object.assign({viewItem:e,modelCursor:t,modelRange:null});if(e.is("element")?this.fire("element:"+e.name,n,this.conversionApi):e.is("text")?this.fire("text",n,this.conversionApi):this.fire("documentFragment",n,this.conversionApi),n.modelRange&&!(n.modelRange instanceof $a))throw new Jn.b("view-conversion-dispatcher-incorrect-result: Incorrect conversion result was dropped.",this);return{modelRange:n.modelRange,modelCursor:n.modelCursor}}_convertChildren(e,t){const n=new $a(t);let r=t;for(const t of Array.from(e.getChildren())){const e=this._convertItem(t,r);e.modelRange instanceof $a&&(n.end=e.modelRange.end,r=e.modelCursor)}return{modelRange:n,modelCursor:r}}_splitToAllowedParent(e,t){const n=this.conversionApi.schema.findAllowedParent(t,e);if(!n)return null;if(n===t.parent)return{position:t};if(this._modelCursor.parent.getAncestors().includes(n))return null;const r=this.conversionApi.writer.split(t,n),i=[];for(const e of r.range.getWalker())if("elementEnd"==e.type)i.push(e.item);else{const t=i.pop(),n=e.item;this._registerSplitPair(t,n)}return{position:r.position,cursorParent:r.range.end.parent}}_registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);const n=this._splitParts.get(e);this._splitParts.set(t,n),n.push(t)}_getSplitParts(e){let t;return t=this._splitParts.has(e)?this._splitParts.get(e):[e],t}_removeEmptyElements(){let e=!1;for(const t of this._splitParts.keys())t.isEmpty&&(this.conversionApi.writer.remove(t),this._splitParts.delete(t),e=!0);e&&this._removeEmptyElements()}}ur(Xs,nr);class Zs{constructor(e,t){this.model=e,this.processor=t,this.mapper=new Xa,this.downcastDispatcher=new ts({mapper:this.mapper}),this.downcastDispatcher.on("insert:$text",((e,t,n)=>{if(!n.consumable.consume(t.item,"insert"))return;const r=n.writer,i=n.mapper.toViewPosition(t.range.start),o=r.createText(t.item.data);r.insert(i,o)}),{priority:"lowest"}),this.upcastDispatcher=new Xs({schema:e.schema}),this.upcastDispatcher.on("text",((e,t,n)=>{if(n.schema.checkChild(t.modelCursor,"$text")&&n.consumable.consume(t.viewItem)){const e=n.writer.createText(t.viewItem.data);n.writer.insert(e,t.modelCursor),t.modelRange=$a._createFromPositionAndShift(t.modelCursor,e.offsetSize),t.modelCursor=t.modelRange.end}}),{priority:"lowest"}),this.upcastDispatcher.on("element",((e,t,n)=>{if(!t.modelRange&&n.consumable.consume(t.viewItem,{name:!0})){const{modelRange:e,modelCursor:r}=n.convertChildren(t.viewItem,t.modelCursor);t.modelRange=e,t.modelCursor=r}}),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",((e,t,n)=>{if(!t.modelRange&&n.consumable.consume(t.viewItem,{name:!0})){const{modelRange:e,modelCursor:r}=n.convertChildren(t.viewItem,t.modelCursor);t.modelRange=e,t.modelCursor=r}}),{priority:"lowest"}),this.decorate("init"),this.on("init",(()=>{this.fire("ready")}),{priority:"lowest"})}get(e){const{rootName:t="main",trim:n="empty"}=e||{};if(!this._checkIfRootsExists([t]))throw new Jn.b("datacontroller-get-non-existent-root: Attempting to get data from a non-existing root.",this);const r=this.model.document.getRoot(t);return"empty"!==n||this.model.hasContent(r,{ignoreWhitespaces:!0})?this.stringify(r):""}stringify(e){const t=this.toView(e);return this.processor.toData(t)}toView(e){this.mapper.clearBindings();const t=$a._createIn(e),n=new Ti,r=new xi(new ai);if(this.mapper.bindElements(e,n),this.downcastDispatcher.convertInsert(t,r),!e.is("documentFragment")){const t=function(e){const t=[],n=e.root.document;if(!n)return[];const r=$a._createIn(e);for(const e of n.model.markers){const n=r.getIntersection(e.getRange());n&&t.push([e.name,n])}return t}(e);for(const[e,n]of t)this.downcastDispatcher.convertMarkerAdd(e,n,r)}return n}init(e){if(this.model.document.version)throw new Jn.b("datacontroller-init-document-not-empty: Trying to set initial data to not empty document.",this);let t={};if("string"==typeof e?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new Jn.b("datacontroller-init-non-existent-root: Attempting to init data on a non-existing root.",this);return this.model.enqueueChange("transparent",(e=>{for(const n of Object.keys(t)){const r=this.model.document.getRoot(n);e.insert(this.parse(t[n],r),r,0)}})),Promise.resolve()}set(e){let t={};if("string"==typeof e?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new Jn.b("datacontroller-set-non-existent-root: Attempting to set data on a non-existing root.",this);this.model.enqueueChange("transparent",(e=>{e.setSelection(null),e.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const n of Object.keys(t)){const r=this.model.document.getRoot(n);e.remove(e.createRangeIn(r)),e.insert(this.parse(t[n],r),r,0)}}))}parse(e,t="$root"){const n=this.processor.toView(e);return this.toModel(n,t)}toModel(e,t="$root"){return this.model.change((n=>this.upcastDispatcher.convert(e,n,t)))}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const t of e)if(!this.model.document.getRootNames().includes(t))return!1;return!0}}ur(Zs,Ur);class ec{constructor(e,t){this._helpers=new Map,this._downcast=Array.isArray(e)?e:[e],this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=Array.isArray(t)?t:[t],this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(e,t){const n=this._downcast.includes(t);if(!this._upcast.includes(t)&&!n)throw new Jn.b("conversion-add-alias-dispatcher-not-registered: Trying to register and alias for a dispatcher that nas not been registered.",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:n})}for(e){if(!this._helpers.has(e))throw new Jn.b("conversion-for-unknown-group: Trying to add a converter to an unknown dispatchers group.",this);return this._helpers.get(e)}elementToElement(e){this.for("downcast").elementToElement(e);for(const{model:t,view:n}of tc(e))this.for("upcast").elementToElement({model:t,view:n,converterPriority:e.converterPriority})}attributeToElement(e){this.for("downcast").attributeToElement(e);for(const{model:t,view:n}of tc(e))this.for("upcast").elementToAttribute({view:n,model:t,converterPriority:e.converterPriority})}attributeToAttribute(e){this.for("downcast").attributeToAttribute(e);for(const{model:t,view:n}of tc(e))this.for("upcast").attributeToAttribute({view:n,model:t})}_createConversionHelpers({name:e,dispatchers:t,isDowncast:n}){if(this._helpers.has(e))throw new Jn.b("conversion-group-exists: Trying to register a group name that has already been registered.",this);const r=n?new vs(t):new Ts(t);this._helpers.set(e,r)}}function*tc(e){if(e.model.values)for(const t of e.model.values){const n={key:e.model.key,value:t},r=e.view[t],i=e.upcastAlso?e.upcastAlso[t]:void 0;yield*nc(n,r,i)}else yield*nc(e.model,e.view,e.upcastAlso)}function*nc(e,t,n){if(yield{model:e,view:t},n){n=Array.isArray(n)?n:[n];for(const t of n)yield{model:e,view:t}}}class rc{constructor(e="default"){this.operations=[],this.type=e}get baseVersion(){for(const e of this.operations)if(null!==e.baseVersion)return e.baseVersion;return null}addOperation(e){return e.batch=this,this.operations.push(e),e}}class ic{constructor(e){this.baseVersion=e,this.isDocumentOperation=null!==this.baseVersion,this.batch=null}_validate(){}toJSON(){const e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e}static get className(){return"Operation"}static fromJSON(e){return new this(e.baseVersion)}}class oc{constructor(e){this.markers=new Map,this._children=new Wa,e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(e){return"documentFragment"==e||"model:documentFragment"==e}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let t=this;for(const n of e)t=t.getChild(t.offsetToIndex(n));return t}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const t of this._children)e.push(t.toJSON());return e}static fromJSON(e){const t=[];for(const n of e)n.name?t.push(Ya.fromJSON(n)):t.push(Ha.fromJSON(n));return new oc(t)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,t){const n=function(e){return"string"==typeof e?[new Ha(e)]:(gr(e)||(e=[e]),Array.from(e).map((e=>"string"==typeof e?new Ha(e):e instanceof za?new Ha(e.data,e.getAttributes()):e)))}(t);for(const e of n)null!==e.parent&&e._remove(),e.parent=this;this._children._insertNodes(e,n)}_removeChildren(e,t=1){const n=this._children._removeNodes(e,t);for(const e of n)e.parent=null;return n}}function ac(e,t){const n=(t=uc(t)).reduce(((e,t)=>e+t.offsetSize),0),r=e.parent;fc(e);const i=e.index;return r._insertChild(i,t),lc(r,i+t.length),lc(r,i),new $a(e,e.getShiftedBy(n))}function sc(e){if(!e.isFlat)throw new Jn.b("operation-utils-remove-range-not-flat: Trying to remove a range which starts and ends in different element.",this);const t=e.start.parent;fc(e.start),fc(e.end);const n=t._removeChildren(e.start.index,e.end.index-e.start.index);return lc(t,e.start.index),n}function cc(e,t){if(!e.isFlat)throw new Jn.b("operation-utils-move-range-not-flat: Trying to move a range which starts and ends in different element.",this);const n=sc(e);return ac(t=t._getTransformedByDeletion(e.start,e.end.offset-e.start.offset),n)}function uc(e){const t=[];e instanceof Array||(e=[e]);for(let n=0;n<e.length;n++)if("string"==typeof e[n])t.push(new Ha(e[n]));else if(e[n]instanceof za)t.push(new Ha(e[n].data,e[n].getAttributes()));else if(e[n]instanceof oc||e[n]instanceof Wa)for(const r of e[n])t.push(r);else e[n]instanceof Ua&&t.push(e[n]);for(let e=1;e<t.length;e++){const n=t[e],r=t[e-1];n instanceof Ha&&r instanceof Ha&&hc(n,r)&&(t.splice(e-1,2,new Ha(r.data+n.data,r.getAttributes())),e--)}return t}function lc(e,t){const n=e.getChild(t-1),r=e.getChild(t);if(n&&r&&n.is("text")&&r.is("text")&&hc(n,r)){const i=new Ha(n.data+r.data,n.getAttributes());e._removeChildren(t-1,2),e._insertChild(t-1,i)}}function fc(e){const t=e.textNode,n=e.parent;if(t){const r=e.offset-t.startOffset,i=t.index;n._removeChildren(i,1);const o=new Ha(t.data.substr(0,r),t.getAttributes()),a=new Ha(t.data.substr(r),t.getAttributes());n._insertChild(i,[o,a])}}function hc(e,t){const n=e.getAttributes(),r=t.getAttributes();for(const e of n){if(e[1]!==t.getAttribute(e[0]))return!1;r.next()}return r.next().done}var dc=function(e,t){return Zo(e,t)};class pc extends ic{constructor(e,t,n,r,i){super(i),this.range=e.clone(),this.key=t,this.oldValue=void 0===n?null:n,this.newValue=void 0===r?null:r}get type(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}clone(){return new pc(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new pc(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new Jn.b("attribute-operation-range-not-flat: The range to change is not flat.",this);for(const e of this.range.getItems({shallow:!0})){if(null!==this.oldValue&&!dc(e.getAttribute(this.key),this.oldValue))throw new Jn.b("attribute-operation-wrong-old-value: Changed node has different attribute value than operation's old attribute value.",this,{item:e,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&e.hasAttribute(this.key))throw new Jn.b("attribute-operation-attribute-exists: The attribute with given key already exists.",this,{node:e,key:this.key})}}_execute(){dc(this.oldValue,this.newValue)||function(e,t,n){fc(e.start),fc(e.end);for(const r of e.getItems({shallow:!0})){const e=r.is("textProxy")?r.textNode:r;null!==n?e._setAttribute(t,n):e._removeAttribute(t),lc(e.parent,e.index)}lc(e.end.parent,e.end.index)}(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,t){return new pc($a.fromJSON(e.range,t),e.key,e.oldValue,e.newValue,e.baseVersion)}}class mc extends ic{constructor(e,t){super(null),this.sourcePosition=e.clone(),this.howMany=t}get type(){return"detach"}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new Jn.b("detach-operation-on-document-node: Cannot detach document node.",this)}_execute(){sc($a._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class yc extends ic{constructor(e,t,n,r){super(r),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=t,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNone"}get type(){return"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move"}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent,n=this.sourcePosition.offset,r=this.targetPosition.offset;if(n+this.howMany>e.maxOffset)throw new Jn.b("move-operation-nodes-do-not-exist: The nodes which should be moved do not exist.",this);if(e===t&&n<r&&r<n+this.howMany)throw new Jn.b("move-operation-range-into-itself: Trying to move a range of nodes to the inside of that range.",this);if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==lr(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){const e=this.sourcePosition.path.length-1;if(this.targetPosition.path[e]>=n&&this.targetPosition.path[e]<n+this.howMany)throw new Jn.b("move-operation-node-into-itself: Trying to move a range of nodes into one of nodes from that range.",this)}}_execute(){cc($a._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,t){const n=Ka.fromJSON(e.sourcePosition,t),r=Ka.fromJSON(e.targetPosition,t);return new this(n,e.howMany,r,e.baseVersion)}}class gc extends ic{constructor(e,t,n){super(n),this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new Wa(uc(t)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}clone(){const e=new Wa([...this.nodes].map((e=>e._clone(!0)))),t=new gc(this.position,e,this.baseVersion);return t.shouldReceiveAttributes=this.shouldReceiveAttributes,t}getReversed(){const e=this.position.root.document.graveyard,t=new Ka(e,[0]);return new yc(this.position,this.nodes.maxOffset,t,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new Jn.b("insert-operation-position-invalid: Insertion position is invalid.",this)}_execute(){const e=this.nodes;this.nodes=new Wa([...e].map((e=>e._clone(!0)))),ac(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,t){const n=[];for(const t of e.nodes)t.name?n.push(Ya.fromJSON(t)):n.push(Ha.fromJSON(t));const r=new gc(Ka.fromJSON(e.position,t),n,e.baseVersion);return r.shouldReceiveAttributes=e.shouldReceiveAttributes,r}}class bc extends ic{constructor(e,t,n,r,i,o){super(o),this.name=e,this.oldRange=t?t.clone():null,this.newRange=n?n.clone():null,this.affectsData=i,this._markers=r}get type(){return"marker"}clone(){return new bc(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new bc(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){const e=this.newRange?"_set":"_remove";this._markers[e](this.name,this.newRange,!0,this.affectsData)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,t){return new bc(e.name,e.oldRange?$a.fromJSON(e.oldRange,t):null,e.newRange?$a.fromJSON(e.newRange,t):null,t.model.markers,e.affectsData,e.baseVersion)}}class vc extends ic{constructor(e,t,n,r){super(r),this.position=e,this.position.stickiness="toNext",this.oldName=t,this.newName=n}get type(){return"rename"}clone(){return new vc(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new vc(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(!(e instanceof Ya))throw new Jn.b("rename-operation-wrong-position: Given position is invalid or node after it is not an instance of Element.",this);if(e.name!==this.oldName)throw new Jn.b("rename-operation-wrong-name: Element to change has different name than operation's old name.",this)}_execute(){this.position.nodeAfter.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,t){return new vc(Ka.fromJSON(e.position,t),e.oldName,e.newName,e.baseVersion)}}class wc extends ic{constructor(e,t,n,r,i){super(i),this.root=e,this.key=t,this.oldValue=n,this.newValue=r}get type(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}clone(){return new wc(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new wc(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new Jn.b("rootattribute-operation-not-a-root: The element to change is not a root element.",this,{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new Jn.b("rootattribute-operation-wrong-old-value: Changed node has different attribute value than operation's old attribute value.",this,{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new Jn.b("rootattribute-operation-attribute-exists: The attribute with given key already exists.",this,{root:this.root,key:this.key})}_execute(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,t){if(!t.getRoot(e.root))throw new Jn.b("rootattribute-operation-fromjson-no-root: Cannot create RootAttributeOperation. Root with specified name does not exist.",this,{rootName:e.root});return new wc(t.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}class _c extends ic{constructor(e,t,n,r,i){super(i),this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=t,this.targetPosition=n.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=r.clone()}get type(){return"merge"}get deletionPosition(){return new Ka(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new $a(this.sourcePosition,e)}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),t=this.sourcePosition.path.slice(0,-1),n=new Ka(this.sourcePosition.root,t)._getTransformedByMergeOperation(this),r=new kc(e,this.howMany,this.graveyardPosition,this.baseVersion+1);return r.insertionPosition=n,r}_validate(){const e=this.sourcePosition.parent,t=this.targetPosition.parent;if(!e.parent)throw new Jn.b("merge-operation-source-position-invalid: Merge source position is invalid.",this);if(!t.parent)throw new Jn.b("merge-operation-target-position-invalid: Merge target position is invalid.",this);if(this.howMany!=e.maxOffset)throw new Jn.b("merge-operation-how-many-invalid: Merge operation specifies wrong number of nodes to move.",this)}_execute(){const e=this.sourcePosition.parent;cc($a._createIn(e),this.targetPosition),cc($a._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,t){const n=Ka.fromJSON(e.sourcePosition,t),r=Ka.fromJSON(e.targetPosition,t),i=Ka.fromJSON(e.graveyardPosition,t);return new this(n,e.howMany,r,i,e.baseVersion)}}class kc extends ic{constructor(e,t,n,r){super(r),this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=t,this.insertionPosition=kc.getInsertionPosition(e),this.insertionPosition.stickiness="toNone",this.graveyardPosition=n?n.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new Ka(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new $a(this.splitPosition,e)}clone(){const e=new this.constructor(this.splitPosition,this.howMany,this.graveyardPosition,this.baseVersion);return e.insertionPosition=this.insertionPosition,e}getReversed(){const e=this.splitPosition.root.document.graveyard,t=new Ka(e,[0]);return new _c(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,t=this.splitPosition.offset;if(!e||e.maxOffset<t)throw new Jn.b("split-operation-position-invalid: Split position is invalid.",this);if(!e.parent)throw new Jn.b("split-operation-split-in-root: Cannot split root element.",this);if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new Jn.b("split-operation-how-many-invalid: Split operation specifies wrong number of nodes to move.",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new Jn.b("split-operation-graveyard-position-invalid: Graveyard position invalid.",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)cc($a._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const t=e._clone();ac(this.insertionPosition,t)}cc(new $a(Ka._createAt(e,this.splitPosition.offset),Ka._createAt(e,e.maxOffset)),this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const t=e.path.slice(0,-1);return t[t.length-1]++,new Ka(e.root,t)}static fromJSON(e,t){const n=Ka.fromJSON(e.splitPosition,t),r=Ka.fromJSON(e.insertionPosition,t),i=e.graveyardPosition?Ka.fromJSON(e.graveyardPosition,t):null,o=new this(n,e.howMany,i,e.baseVersion);return o.insertionPosition=r,o}}class Ec extends Ya{constructor(e,t,n="main"){super(t),this._doc=e,this.rootName=n}get document(){return this._doc}is(e,t){const n=e.replace("model:","");return t?"rootElement"==n&&t==this.name||super.is(e,t):"rootElement"==n||super.is(e)}toJSON(){return this.rootName}}class Oc{constructor(e,t){this.model=e,this.batch=t}createText(e,t){return new Ha(e,t)}createElement(e,t){return new Ya(e,t)}createDocumentFragment(){return new oc}insert(e,t,n=0){if(this._assertWriterUsedCorrectly(),e instanceof Ha&&""==e.data)return;const r=Ka._createAt(t,n);if(e.parent){if(Rc(e.root,r.root))return void this.move($a._createOn(e),r);if(e.root.document)throw new Jn.b("model-writer-insert-forbidden-move: Cannot move a node from a document to a different tree. It is forbidden to move a node that was already in a document outside of it.",this);this.remove(e)}const i=r.root.document?r.root.document.version:null,o=new gc(r,e,i);if(e instanceof Ha&&(o.shouldReceiveAttributes=!0),this.batch.addOperation(o),this.model.applyOperation(o),e instanceof oc)for(const[t,n]of e.markers){const e=Ka._createAt(n.root,0),i={range:new $a(n.start._getCombined(e,r),n.end._getCombined(e,r)),usingOperation:!0,affectsData:!0};this.model.markers.has(t)?this.updateMarker(t,i):this.addMarker(t,i)}}insertText(e,t,n,r){t instanceof oc||t instanceof Ya||t instanceof Ka?this.insert(this.createText(e),t,n):this.insert(this.createText(e,t),n,r)}insertElement(e,t,n,r){t instanceof oc||t instanceof Ya||t instanceof Ka?this.insert(this.createElement(e),t,n):this.insert(this.createElement(e,t),n,r)}append(e,t){this.insert(e,t,"end")}appendText(e,t,n){t instanceof oc||t instanceof Ya?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),n,"end")}appendElement(e,t,n){t instanceof oc||t instanceof Ya?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),n,"end")}setAttribute(e,t,n){if(this._assertWriterUsedCorrectly(),n instanceof $a){const r=n.getMinimalFlatRanges();for(const n of r)Tc(this,e,t,n)}else xc(this,e,t,n)}setAttributes(e,t){for(const[n,r]of Va(e))this.setAttribute(n,r,t)}removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof $a){const n=t.getMinimalFlatRanges();for(const t of n)Tc(this,e,null,t)}else xc(this,e,null,t)}clearAttributes(e){this._assertWriterUsedCorrectly();const t=e=>{for(const t of e.getAttributeKeys())this.removeAttribute(t,e)};if(e instanceof $a)for(const n of e.getItems())t(n);else t(e)}move(e,t,n){if(this._assertWriterUsedCorrectly(),!(e instanceof $a))throw new Jn.b("writer-move-invalid-range: Invalid range to move.",this);if(!e.isFlat)throw new Jn.b("writer-move-range-not-flat: Range to move is not flat.",this);const r=Ka._createAt(t,n);if(r.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!Rc(e.root,r.root))throw new Jn.b("writer-move-different-document: Range is going to be moved between different documents.",this);const i=e.root.document?e.root.document.version:null,o=new yc(e.start,e.end.offset-e.start.offset,r,i);this.batch.addOperation(o),this.model.applyOperation(o)}remove(e){this._assertWriterUsedCorrectly();const t=(e instanceof $a?e:$a._createOn(e)).getMinimalFlatRanges().reverse();for(const e of t)this._addOperationForAffectedMarkers("move",e),Cc(e.start,e.end.offset-e.start.offset,this.batch,this.model)}merge(e){this._assertWriterUsedCorrectly();const t=e.nodeBefore,n=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof Ya))throw new Jn.b("writer-merge-no-element-before: Node before merge position must be an element.",this);if(!(n instanceof Ya))throw new Jn.b("writer-merge-no-element-after: Node after merge position must be an element.",this);e.root.document?this._merge(e):this._mergeDetached(e)}createPositionFromPath(e,t,n){return this.model.createPositionFromPath(e,t,n)}createPositionAt(e,t){return this.model.createPositionAt(e,t)}createPositionAfter(e){return this.model.createPositionAfter(e)}createPositionBefore(e){return this.model.createPositionBefore(e)}createRange(e,t){return this.model.createRange(e,t)}createRangeIn(e){return this.model.createRangeIn(e)}createRangeOn(e){return this.model.createRangeOn(e)}createSelection(e,t,n){return this.model.createSelection(e,t,n)}_mergeDetached(e){const t=e.nodeBefore,n=e.nodeAfter;this.move($a._createIn(n),Ka._createAt(t,"end")),this.remove(n)}_merge(e){const t=Ka._createAt(e.nodeBefore,"end"),n=Ka._createAt(e.nodeAfter,0),r=e.root.document.graveyard,i=new Ka(r,[0]),o=e.root.document.version,a=new _c(n,e.nodeAfter.maxOffset,t,i,o);this.batch.addOperation(a),this.model.applyOperation(a)}rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof Ya))throw new Jn.b("writer-rename-not-element-instance: Trying to rename an object which is not an instance of Element.",this);const n=e.root.document?e.root.document.version:null,r=new vc(Ka._createBefore(e),e.name,t,n);this.batch.addOperation(r),this.model.applyOperation(r)}split(e,t){this._assertWriterUsedCorrectly();let n,r,i=e.parent;if(!i.parent)throw new Jn.b("writer-split-element-no-parent: Element with no parent can not be split.",this);if(t||(t=i.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new Jn.b("writer-split-invalid-limit-element: Limit element is not a position ancestor.",this);do{const t=i.root.document?i.root.document.version:null,o=i.maxOffset-e.offset,a=new kc(e,o,null,t);this.batch.addOperation(a),this.model.applyOperation(a),n||r||(n=i,r=e.parent.nextSibling),i=(e=this.createPositionAfter(e.parent)).parent}while(i!==t);return{position:e,range:new $a(Ka._createAt(n,"end"),Ka._createAt(r,0))}}wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new Jn.b("writer-wrap-range-not-flat: Range to wrap is not flat.",this);const n=t instanceof Ya?t:new Ya(t);if(n.childCount>0)throw new Jn.b("writer-wrap-element-not-empty: Element to wrap with is not empty.",this);if(null!==n.parent)throw new Jn.b("writer-wrap-element-attached: Element to wrap with is already attached to tree model.",this);this.insert(n,e.start);const r=new $a(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(r,Ka._createAt(n,0))}unwrap(e){if(this._assertWriterUsedCorrectly(),null===e.parent)throw new Jn.b("writer-unwrap-element-no-parent: Trying to unwrap an element which has no parent.",this);this.move($a._createIn(e),this.createPositionAfter(e)),this.remove(e)}addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||"boolean"!=typeof t.usingOperation)throw new Jn.b("writer-addMarker-no-usingOperation: The options.usingOperation parameter is required when adding a new marker.",this);const n=t.usingOperation,r=t.range,i=void 0!==t.affectsData&&t.affectsData;if(this.model.markers.has(e))throw new Jn.b("writer-addMarker-marker-exists: Marker with provided name already exists.",this);if(!r)throw new Jn.b("writer-addMarker-no-range: Range parameter is required when adding a new marker.",this);return n?(Sc(this,e,null,r,i),this.model.markers.get(e)):this.model.markers._set(e,r,n,i)}updateMarker(e,t){this._assertWriterUsedCorrectly();const n="string"==typeof e?e:e.name,r=this.model.markers.get(n);if(!r)throw new Jn.b("writer-updateMarker-marker-not-exists: Marker with provided name does not exists.",this);if(!t)return void this.model.markers._refresh(r);const i="boolean"==typeof t.usingOperation,o="boolean"==typeof t.affectsData,a=o?t.affectsData:r.affectsData;if(!i&&!t.range&&!o)throw new Jn.b("writer-updateMarker-wrong-options: One of the options is required - provide range, usingOperations or affectsData.",this);const s=r.getRange(),c=t.range?t.range:s;i&&t.usingOperation!==r.managedUsingOperations?t.usingOperation?Sc(this,n,null,c,a):(Sc(this,n,s,null,a),this.model.markers._set(n,c,void 0,a)):r.managedUsingOperations?Sc(this,n,s,c,a):this.model.markers._set(n,c,void 0,a)}removeMarker(e){this._assertWriterUsedCorrectly();const t="string"==typeof e?e:e.name;if(!this.model.markers.has(t))throw new Jn.b("writer-removeMarker-no-marker: Trying to remove marker which does not exist.",this);const n=this.model.markers.get(t);n.managedUsingOperations?Sc(this,t,n.getRange(),null,n.affectsData):this.model.markers._remove(t)}setSelection(e,t,n){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(e,t,n)}setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t)}setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),"string"==typeof e)this._setSelectionAttribute(e,t);else for(const[t,n]of Va(e))this._setSelectionAttribute(t,n)}removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),"string"==typeof e)this._removeSelectionAttribute(e);else for(const t of e)this._removeSelectionAttribute(t)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e)}_setSelectionAttribute(e,t){const n=this.model.document.selection;if(n.isCollapsed&&n.anchor.parent.isEmpty){const r=hs._getStoreAttributeKey(e);this.setAttribute(r,t,n.anchor.parent)}n._setAttribute(e,t)}_removeSelectionAttribute(e){const t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){const n=hs._getStoreAttributeKey(e);this.removeAttribute(n,t.anchor.parent)}t._removeAttribute(e)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new Jn.b("writer-incorrect-use: Trying to use a writer outside the change() block.",this)}_addOperationForAffectedMarkers(e,t){for(const n of this.model.markers){if(!n.managedUsingOperations)continue;const r=n.getRange();let i=!1;if("move"==e)i=t.containsPosition(r.start)||t.start.isEqual(r.start)||t.containsPosition(r.end)||t.end.isEqual(r.end);else{const e=t.nodeBefore,n=t.nodeAfter,o=r.start.parent==e&&r.start.isAtEnd,a=r.end.parent==n&&0==r.end.offset,s=r.end.nodeAfter==n,c=r.start.nodeAfter==n;i=o||a||s||c}i&&this.updateMarker(n.name,{range:r})}}}function Tc(e,t,n,r){const i=e.model,o=i.document;let a,s,c,u=r.start;for(const e of r.getWalker({shallow:!0}))c=e.item.getAttribute(t),a&&s!=c&&(s!=n&&l(),u=a),a=e.nextPosition,s=c;function l(){const r=new $a(u,a),c=r.root.document?o.version:null,l=new pc(r,t,s,n,c);e.batch.addOperation(l),i.applyOperation(l)}a instanceof Ka&&a!=u&&s!=n&&l()}function xc(e,t,n,r){const i=e.model,o=i.document,a=r.getAttribute(t);let s,c;if(a!=n){if(r.root===r){const e=r.document?o.version:null;c=new wc(r,t,a,n,e)}else{s=new $a(Ka._createBefore(r),e.createPositionAfter(r));const i=s.root.document?o.version:null;c=new pc(s,t,a,n,i)}e.batch.addOperation(c),i.applyOperation(c)}}function Sc(e,t,n,r,i){const o=e.model,a=o.document,s=new bc(t,n,r,o.markers,i,a.version);e.batch.addOperation(s),o.applyOperation(s)}function Cc(e,t,n,r){let i;if(e.root.document){const n=r.document,o=new Ka(n.graveyard,[0]);i=new yc(e,t,o,n.version)}else i=new mc(e,t);n.addOperation(i),r.applyOperation(i)}function Rc(e,t){return e===t||e instanceof Ec&&t instanceof Ec}class Pc{constructor(e){this._markerCollection=e,this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null}get isEmpty(){return 0==this._changesInElement.size&&0==this._changedMarkers.size}refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize);const t=$a._createOn(e);for(const e of this._markerCollection.getMarkersIntersectingRange(t)){const t=e.getRange();this.bufferMarkerChange(e.name,t,t,e.affectsData)}this._cachedChanges=null}bufferOperation(e){switch(e.type){case"insert":if(this._isInInsertedElement(e.position.parent))return;this._markInsert(e.position.parent,e.position.offset,e.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":for(const t of e.range.getItems({shallow:!0}))this._isInInsertedElement(t.parent)||this._markAttribute(t);break;case"remove":case"move":case"reinsert":{if(e.sourcePosition.isEqual(e.targetPosition)||e.sourcePosition.getShiftedBy(e.howMany).isEqual(e.targetPosition))return;const t=this._isInInsertedElement(e.sourcePosition.parent),n=this._isInInsertedElement(e.targetPosition.parent);t||this._markRemove(e.sourcePosition.parent,e.sourcePosition.offset,e.howMany),n||this._markInsert(e.targetPosition.parent,e.getMovedRangeStart().offset,e.howMany);break}case"rename":{if(this._isInInsertedElement(e.position.parent))return;this._markRemove(e.position.parent,e.position.offset,1),this._markInsert(e.position.parent,e.position.offset,1);const t=$a._createFromPositionAndShift(e.position,1);for(const e of this._markerCollection.getMarkersIntersectingRange(t)){const t=e.getRange();this.bufferMarkerChange(e.name,t,t,e.affectsData)}break}case"split":{const t=e.splitPosition.parent;this._isInInsertedElement(t)||this._markRemove(t,e.splitPosition.offset,e.howMany),this._isInInsertedElement(e.insertionPosition.parent)||this._markInsert(e.insertionPosition.parent,e.insertionPosition.offset,1),e.graveyardPosition&&this._markRemove(e.graveyardPosition.parent,e.graveyardPosition.offset,1);break}case"merge":{const t=e.sourcePosition.parent;this._isInInsertedElement(t.parent)||this._markRemove(t.parent,t.startOffset,1);const n=e.graveyardPosition.parent;this._markInsert(n,e.graveyardPosition.offset,1);const r=e.targetPosition.parent;this._isInInsertedElement(r)||this._markInsert(r,e.targetPosition.offset,t.maxOffset);break}}this._cachedChanges=null}bufferMarkerChange(e,t,n,r){const i=this._changedMarkers.get(e);i?(i.newRange=n,i.affectsData=r,null==i.oldRange&&null==i.newRange&&this._changedMarkers.delete(e)):this._changedMarkers.set(e,{oldRange:t,newRange:n,affectsData:r})}getMarkersToRemove(){const e=[];for(const[t,n]of this._changedMarkers)null!=n.oldRange&&e.push({name:t,range:n.oldRange});return e}getMarkersToAdd(){const e=[];for(const[t,n]of this._changedMarkers)null!=n.newRange&&e.push({name:t,range:n.newRange});return e}getChangedMarkers(){return Array.from(this._changedMarkers).map((e=>({name:e[0],data:{oldRange:e[1].oldRange,newRange:e[1].newRange}})))}hasDataChanges(){for(const[,e]of this._changedMarkers)if(e.affectsData)return!0;return this._changesInElement.size>0}getChanges(e={includeChangesInGraveyard:!1}){if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();const t=[];for(const e of this._changesInElement.keys()){const n=this._changesInElement.get(e).sort(((e,t)=>e.offset===t.offset?e.type!=t.type?"remove"==e.type?-1:1:0:e.offset<t.offset?-1:1)),r=this._elementSnapshots.get(e),i=Nc(e.getChildren()),o=Mc(r.length,n);let a=0,s=0;for(const n of o)if("i"===n)t.push(this._getInsertDiff(e,a,i[a].name)),a++;else if("r"===n)t.push(this._getRemoveDiff(e,a,r[s].name)),s++;else if("a"===n){const n=i[a].attributes,o=r[s].attributes;let c;if("$text"==i[a].name)c=new $a(Ka._createAt(e,a),Ka._createAt(e,a+1));else{const t=e.offsetToIndex(a);c=new $a(Ka._createAt(e,a),Ka._createAt(e.getChild(t),0))}t.push(...this._getAttributesDiff(c,o,n)),a++,s++}else a++,s++}t.sort(((e,t)=>e.position.root!=t.position.root?e.position.root.rootName<t.position.root.rootName?-1:1:e.position.isEqual(t.position)?e.changeCount-t.changeCount:e.position.isBefore(t.position)?-1:1));for(let e=1;e<t.length;e++){const n=t[e-1],r=t[e],i="remove"==n.type&&"remove"==r.type&&"$text"==n.name&&"$text"==r.name&&n.position.isEqual(r.position),o="insert"==n.type&&"insert"==r.type&&"$text"==n.name&&"$text"==r.name&&n.position.parent==r.position.parent&&n.position.offset+n.length==r.position.offset,a="attribute"==n.type&&"attribute"==r.type&&n.position.parent==r.position.parent&&n.range.isFlat&&r.range.isFlat&&n.position.offset+n.length==r.position.offset&&n.attributeKey==r.attributeKey&&n.attributeOldValue==r.attributeOldValue&&n.attributeNewValue==r.attributeNewValue;(i||o||a)&&(t[e-1].length++,a&&(t[e-1].range.end=t[e-1].range.end.getShiftedBy(1)),t.splice(e,1),e--)}for(const e of t)delete e.changeCount,"attribute"==e.type&&(delete e.position,delete e.length);return this._changeCount=0,this._cachedChangesWithGraveyard=t.slice(),this._cachedChanges=t.slice().filter(Ac),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard:this._cachedChanges}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._cachedChanges=null}_markInsert(e,t,n){const r={type:"insert",offset:t,howMany:n,count:this._changeCount++};this._markChange(e,r)}_markRemove(e,t,n){const r={type:"remove",offset:t,howMany:n,count:this._changeCount++};this._markChange(e,r),this._removeAllNestedChanges(e,t,n)}_markAttribute(e){const t={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,t)}_markChange(e,t){this._makeSnapshot(e);const n=this._getChangesForElement(e);this._handleChange(t,n),n.push(t);for(let e=0;e<n.length;e++)n[e].howMany<1&&(n.splice(e,1),e--)}_getChangesForElement(e){let t;return this._changesInElement.has(e)?t=this._changesInElement.get(e):(t=[],this._changesInElement.set(e,t)),t}_makeSnapshot(e){this._elementSnapshots.has(e)||this._elementSnapshots.set(e,Nc(e.getChildren()))}_handleChange(e,t){e.nodesToHandle=e.howMany;for(const n of t){const r=e.offset+e.howMany,i=n.offset+n.howMany;if("insert"==e.type&&("insert"==n.type&&(e.offset<=n.offset?n.offset+=e.howMany:e.offset<i&&(n.howMany+=e.nodesToHandle,e.nodesToHandle=0)),"remove"==n.type&&e.offset<n.offset&&(n.offset+=e.howMany),"attribute"==n.type))if(e.offset<=n.offset)n.offset+=e.howMany;else if(e.offset<i){const i=n.howMany;n.howMany=e.offset-n.offset,t.unshift({type:"attribute",offset:r,howMany:i-n.howMany,count:this._changeCount++})}if("remove"==e.type){if("insert"==n.type)if(r<=n.offset)n.offset-=e.howMany;else if(r<=i)if(e.offset<n.offset){const t=r-n.offset;n.offset=e.offset,n.howMany-=t,e.nodesToHandle-=t}else n.howMany-=e.nodesToHandle,e.nodesToHandle=0;else if(e.offset<=n.offset)e.nodesToHandle-=n.howMany,n.howMany=0;else if(e.offset<i){const t=i-e.offset;n.howMany-=t,e.nodesToHandle-=t}if("remove"==n.type&&(r<=n.offset?n.offset-=e.howMany:e.offset<n.offset&&(e.nodesToHandle+=n.howMany,n.howMany=0)),"attribute"==n.type)if(r<=n.offset)n.offset-=e.howMany;else if(e.offset<n.offset){const t=r-n.offset;n.offset=e.offset,n.howMany-=t}else if(e.offset<i)if(r<=i){const r=n.howMany;n.howMany=e.offset-n.offset;const i=r-n.howMany-e.nodesToHandle;t.unshift({type:"attribute",offset:e.offset,howMany:i,count:this._changeCount++})}else n.howMany-=i-e.offset}if("attribute"==e.type){if("insert"==n.type)if(e.offset<n.offset&&r>n.offset){if(r>i){const e={type:"attribute",offset:i,howMany:r-i,count:this._changeCount++};this._handleChange(e,t),t.push(e)}e.nodesToHandle=n.offset-e.offset,e.howMany=e.nodesToHandle}else e.offset>=n.offset&&e.offset<i&&(r>i?(e.nodesToHandle=r-i,e.offset=i):e.nodesToHandle=0);if("remove"==n.type&&e.offset<n.offset&&r>n.offset){const i={type:"attribute",offset:n.offset,howMany:r-n.offset,count:this._changeCount++};this._handleChange(i,t),t.push(i),e.nodesToHandle=n.offset-e.offset,e.howMany=e.nodesToHandle}"attribute"==n.type&&(e.offset>=n.offset&&r<=i?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=n.offset&&r>=i&&(n.howMany=0))}}e.howMany=e.nodesToHandle,delete e.nodesToHandle}_getInsertDiff(e,t,n){return{type:"insert",position:Ka._createAt(e,t),name:n,length:1,changeCount:this._changeCount++}}_getRemoveDiff(e,t,n){return{type:"remove",position:Ka._createAt(e,t),name:n,length:1,changeCount:this._changeCount++}}_getAttributesDiff(e,t,n){const r=[];n=new Map(n);for(const[i,o]of t){const t=n.has(i)?n.get(i):null;t!==o&&r.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:i,attributeOldValue:o,attributeNewValue:t,changeCount:this._changeCount++}),n.delete(i)}for(const[t,i]of n)r.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:t,attributeOldValue:null,attributeNewValue:i,changeCount:this._changeCount++});return r}_isInInsertedElement(e){const t=e.parent;if(!t)return!1;const n=this._changesInElement.get(t),r=e.startOffset;if(n)for(const e of n)if("insert"==e.type&&r>=e.offset&&r<e.offset+e.howMany)return!0;return this._isInInsertedElement(t)}_removeAllNestedChanges(e,t,n){const r=new $a(Ka._createAt(e,t),Ka._createAt(e,t+n));for(const e of r.getItems({shallow:!0}))e.is("element")&&(this._elementSnapshots.delete(e),this._changesInElement.delete(e),this._removeAllNestedChanges(e,0,e.maxOffset))}}function Nc(e){const t=[];for(const n of e)if(n.is("text"))for(let e=0;e<n.data.length;e++)t.push({name:"$text",attributes:new Map(n.getAttributes())});else t.push({name:n.name,attributes:new Map(n.getAttributes())});return t}function Mc(e,t){const n=[];let r=0,i=0;for(const e of t){if(e.offset>r){for(let t=0;t<e.offset-r;t++)n.push("e");i+=e.offset-r}if("insert"==e.type){for(let t=0;t<e.howMany;t++)n.push("i");r=e.offset+e.howMany}else if("remove"==e.type){for(let t=0;t<e.howMany;t++)n.push("r");r=e.offset,i+=e.howMany}else n.push(..."a".repeat(e.howMany).split("")),r=e.offset+e.howMany,i+=e.howMany}if(i<e)for(let t=0;t<e-i-r;t++)n.push("e");return n}function Ac(e){const t=e.position&&"$graveyard"==e.position.root.rootName,n=e.range&&"$graveyard"==e.range.root.rootName;return!t&&!n}class jc{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set}addOperation(e){this._operations.includes(e)||this._operations.push(e)}getOperations(e=0,t=Number.POSITIVE_INFINITY){return e<0?[]:this._operations.slice(e,t)}getOperation(e){return this._operations[e]}setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e)}isUndoingOperation(e){return this._undoPairs.has(e)}isUndoneOperation(e){return this._undoneOperations.has(e)}getUndoneOperation(e){return this._undoPairs.get(e)}}function Ic(e,t){return!!(n=e.charAt(t-1))&&1==n.length&&/[\ud800-\udbff]/.test(n)&&function(e){return!!e&&1==e.length&&/[\udc00-\udfff]/.test(e)}(e.charAt(t));var n}function Dc(e,t){return!!(n=e.charAt(t))&&1==n.length&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(n);var n}const Lc="$graveyard";class Bc{constructor(e){this.model=e,this.version=0,this.history=new jc(this),this.selection=new hs(this),this.roots=new oi({idProperty:"rootName"}),this.differ=new Pc(e.markers),this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",Lc),this.listenTo(e,"applyOperation",((e,t)=>{const n=t[0];if(n.isDocumentOperation&&n.baseVersion!==this.version)throw new Jn.b("model-document-applyOperation-wrong-version: Only operations with matching versions can be applied.",this,{operation:n})}),{priority:"highest"}),this.listenTo(e,"applyOperation",((e,t)=>{const n=t[0];n.isDocumentOperation&&this.differ.bufferOperation(n)}),{priority:"high"}),this.listenTo(e,"applyOperation",((e,t)=>{const n=t[0];n.isDocumentOperation&&(this.version++,this.history.addOperation(n))}),{priority:"low"}),this.listenTo(this.selection,"change",(()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0})),this.listenTo(e.markers,"update",((e,t,n,r)=>{this.differ.bufferMarkerChange(t.name,n,r,t.affectsData),null===n&&t.on("change",((e,n)=>{this.differ.bufferMarkerChange(t.name,n,t.getRange(),t.affectsData)}))}))}get graveyard(){return this.getRoot(Lc)}createRoot(e="$root",t="main"){if(this.roots.get(t))throw new Jn.b("model-document-createRoot-name-exists: Root with specified name already exists.",this,{name:t});const n=new Ec(this,e,t);return this.roots.add(n),n}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(){return Array.from(this.roots,(e=>e.rootName)).filter((e=>e!=Lc))}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=hr(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){for(const e of this.roots)if(e!==this.graveyard)return e;return this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),t=this.model,n=t.schema,r=t.createPositionFromPath(e,[0]);return n.getNearestSelectionRange(r)||t.createRange(r)}_validateSelectionRange(e){return Fc(e.start)&&Fc(e.end)}_callPostFixers(e){let t=!1;do{for(const n of this._postFixers)if(this.selection.refresh(),t=n(e),t)break}while(t)}}function Fc(e){const t=e.textNode;if(t){const n=t.data,r=e.offset-t.startOffset;return!Ic(n,r)&&!Dc(n,r)}return!0}ur(Bc,nr);class qc{constructor(){this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(e){return this._markers.has(e)}get(e){return this._markers.get(e)||null}_set(e,t,n=!1,r=!1){const i=e instanceof Vc?e.name:e,o=this._markers.get(i);if(o){const e=o.getRange();let a=!1;return e.isEqual(t)||(o._attachLiveRange(cs.fromRange(t)),a=!0),n!=o.managedUsingOperations&&(o._managedUsingOperations=n,a=!0),"boolean"==typeof r&&r!=o.affectsData&&(o._affectsData=r,a=!0),a&&this.fire("update:"+i,o,e,t),o}const a=cs.fromRange(t),s=new Vc(i,a,n,r);return this._markers.set(i,s),this.fire("update:"+i,s,null,t),s}_remove(e){const t=e instanceof Vc?e.name:e,n=this._markers.get(t);return!!n&&(this._markers.delete(t),this.fire("update:"+t,n,n.getRange(),null),this._destroyMarker(n),!0)}_refresh(e){const t=e instanceof Vc?e.name:e,n=this._markers.get(t);if(!n)throw new Jn.b("markercollection-refresh-marker-not-exists: Marker with provided name does not exists.",this);const r=n.getRange();this.fire("update:"+t,n,r,r,n.managedUsingOperations,n.affectsData)}*getMarkersAtPosition(e){for(const t of this)t.getRange().containsPosition(e)&&(yield t)}*getMarkersIntersectingRange(e){for(const t of this)null!==t.getRange().getIntersection(e)&&(yield t)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const t of this._markers.values())t.name.startsWith(e+":")&&(yield t)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}ur(qc,nr);class Vc{constructor(e,t,n,r){this.name=e,this._liveRange=this._attachLiveRange(t),this._managedUsingOperations=n,this._affectsData=r}get managedUsingOperations(){if(!this._liveRange)throw new Jn.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new Jn.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._affectsData}getStart(){if(!this._liveRange)throw new Jn.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new Jn.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new Jn.b("marker-destroyed: Cannot use a destroyed marker instance.",this);return this._liveRange.toRange()}is(e){return"marker"==e||"model:marker"==e}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}ur(Vc,nr);class Uc extends Ka{constructor(e,t,n="toNone"){if(super(e,t,n),!this.root.is("rootElement"))throw new Jn.b("model-liveposition-root-not-rootelement: LivePosition's root has to be an instance of RootElement.",e);Hc.call(this)}detach(){this.stopListening()}is(e){return"livePosition"==e||"model:livePosition"==e||super.is(e)}toPosition(){return new Ka(this.root,this.path.slice(),this.stickiness)}static fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness)}}function Hc(){this.listenTo(this.root.document.model,"applyOperation",((e,t)=>{const n=t[0];n.isDocumentOperation&&zc.call(this,n)}),{priority:"low"})}function zc(e){const t=this.getTransformedByOperation(e);if(!this.isEqual(t)){const e=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",e)}}ur(Uc,nr);class Wc{constructor(e,t,n){this.model=e,this.writer=t,this.position=n,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null}handleNodes(e,t){e=Array.from(e);for(let n=0;n<e.length;n++){const r=e[n];this._handleNode(r,{isFirst:0===n&&t.isFirst,isLast:n===e.length-1&&t.isLast})}this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}getSelectionRange(){return this.nodeToSelect?$a._createOn(this.nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new $a(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(e,t){this.schema.isObject(e)?this._handleObject(e,t):this._checkAndSplitToAllowedPosition(e,t)?(this._insert(e),this._mergeSiblingsOf(e,t)):this._handleDisallowedNode(e,t)}_handleObject(e,t){this._checkAndSplitToAllowedPosition(e)?this._insert(e):this._tryAutoparagraphing(e,t)}_handleDisallowedNode(e,t){e.is("element")?this.handleNodes(e.getChildren(),t):this._tryAutoparagraphing(e,t)}_insert(e){if(!this.schema.checkChild(this.position,e))throw new Jn.b("insertcontent-wrong-position: Given node cannot be inserted on the given position.",this,{node:e,position:this.position});const t=Uc.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this.writer.insert(e,this.position),this.position=t.toPosition(),t.detach(),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this.nodeToSelect=e:this.nodeToSelect=null,this._filterAttributesOf.push(e)}_setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=Uc.fromPosition(e,"toPrevious")),this._affectedEnd&&!this._affectedEnd.isBefore(e)||(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=Uc.fromPosition(e,"toNext"))}_mergeSiblingsOf(e,t){if(!(e instanceof Ya))return;const n=this._canMergeLeft(e,t),r=this._canMergeRight(e,t),i=Uc._createBefore(e);i.stickiness="toNext";const o=Uc._createAfter(e);if(o.stickiness="toNext",n){const e=Uc.fromPosition(this.position);e.stickiness="toNext",this._affectedStart.isEqual(i)&&(this._affectedStart.detach(),this._affectedStart=Uc._createAt(i.nodeBefore,"end","toPrevious")),this.writer.merge(i),i.isEqual(this._affectedEnd)&&t.isLast&&(this._affectedEnd.detach(),this._affectedEnd=Uc._createAt(i.nodeBefore,"end","toNext")),this.position=e.toPosition(),e.detach()}if(r){if(!this.position.isEqual(o))throw new Jn.b("insertcontent-invalid-insertion-position",this);this.position=Ka._createAt(o.nodeBefore,"end");const e=Uc.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(o)&&(this._affectedEnd.detach(),this._affectedEnd=Uc._createAt(o.nodeBefore,"end","toNext")),this.writer.merge(o),o.getShiftedBy(-1).isEqual(this._affectedStart)&&t.isFirst&&(this._affectedStart.detach(),this._affectedStart=Uc._createAt(o.nodeBefore,0,"toPrevious")),this.position=e.toPosition(),e.detach()}(n||r)&&this._filterAttributesOf.push(this.position.parent),i.detach(),o.detach()}_canMergeLeft(e,t){const n=e.previousSibling;return t.isFirst&&n instanceof Ya&&this.canMergeWith.has(n)&&this.model.schema.checkMerge(n,e)}_canMergeRight(e,t){const n=e.nextSibling;return t.isLast&&n instanceof Ya&&this.canMergeWith.has(n)&&this.model.schema.checkMerge(e,n)}_tryAutoparagraphing(e,t){const n=this.writer.createElement("paragraph");this._getAllowedIn(n,this.position.parent)&&this.schema.checkChild(n,e)&&(n._appendChild(e),this._handleNode(n,t))}_checkAndSplitToAllowedPosition(e){const t=this._getAllowedIn(e,this.position.parent);if(!t)return!1;for(;t!=this.position.parent;){if(this.schema.isLimit(this.position.parent))return!1;if(this.position.isAtStart){const e=this.position.parent;this.position=this.writer.createPositionBefore(e),e.isEmpty&&e.parent===t&&this.writer.remove(e)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const e=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=e,this.canMergeWith.add(this.position.nodeAfter)}}return!0}_getAllowedIn(e,t){return this.schema.checkChild(t,e)?t:t.parent?this._getAllowedIn(e,t.parent):null}}function Yc(e,t,n={}){if(t.isCollapsed)return;const r=t.getFirstRange();if("$graveyard"==r.root.rootName)return;const i=e.schema;e.change((e=>{if(!n.doNotResetEntireContent&&function(e,t){const n=e.getLimitElement(t);if(!t.containsEntireContent(n))return!1;const r=t.getFirstRange();return r.start.parent!=r.end.parent&&e.checkChild(n,"paragraph")}(i,t))return void function(e,t){const n=e.model.schema.getLimitElement(t);e.remove(e.createRangeIn(n)),Qc(e,e.createPositionAt(n,0),t)}(e,t);const o=r.start,a=Uc.fromPosition(r.end,"toNext");if(r.start.isTouching(r.end)||e.remove(r),n.leaveUnmerged||(function e(t,n,r){const i=n.parent,o=r.parent;if(i!=o&&!t.model.schema.isLimit(i)&&!t.model.schema.isLimit(o)&&function(e,t,n){const r=new $a(e,t);for(const e of r.getWalker())if(n.isLimit(e.item))return!1;return!0}(n,r,t.model.schema)){for(n=t.createPositionAfter(i),(r=t.createPositionBefore(o)).isEqual(n)||t.insert(o,n),t.merge(n);r.parent.isEmpty;){const e=r.parent;r=t.createPositionBefore(e),t.remove(e)}e(t,n,r)}}(e,o,a),i.removeDisallowedAttributes(o.parent.getChildren(),e)),Gc(e,t,o),function(e,t){const n=e.checkChild(t,"$text"),r=e.checkChild(t,"paragraph");return!n&&r}(i,o)){const r=i.getNearestSelectionRange(o);n.doNotAutoparagraph&&r?Gc(e,t,r):Qc(e,o,t)}a.detach()}))}function Qc(e,t,n){const r=e.createElement("paragraph");e.insert(r,t),Gc(e,n,e.createPositionAt(r,0))}function Gc(e,t,n){t instanceof hs?e.setSelection(n):t.setTo(n)}const Jc=' ,.?!:;"-()';function Kc(e,t){if("text"==t.type)return"word"===e.unit?function(e,t){let n=e.position.textNode;if(n){let r=e.position.offset-n.startOffset;for(;!Xc(n.data,r,t)&&!Zc(n,r,t);){e.next();const i=t?e.position.nodeAfter:e.position.nodeBefore;if(i&&i.is("text")){const r=i.data.charAt(t?0:i.data.length-1);Jc.includes(r)||(e.next(),n=e.position.textNode)}r=e.position.offset-n.startOffset}}return e.position}(e.walker,e.isForward):function(e,t){const n=e.position.textNode;if(n){const r=n.data;let i=e.position.offset-n.startOffset;for(;Ic(r,i)||"character"==t&&Dc(r,i);)e.next(),i=e.position.offset-n.startOffset}return e.position}(e.walker,e.unit,e.isForward);if(t.type==(e.isForward?"elementStart":"elementEnd")){if(e.schema.isObject(t.item))return Ka._createAt(t.item,e.isForward?"after":"before");if(e.schema.checkChild(t.nextPosition,"$text"))return t.nextPosition}else{if(e.schema.isLimit(t.item))return void e.walker.skip((()=>!0));if(e.schema.checkChild(t.nextPosition,"$text"))return t.nextPosition}}function $c(e,t){const n=e.root,r=Ka._createAt(n,t?"end":0);return t?new $a(e,r):new $a(r,e)}function Xc(e,t,n){const r=t+(n?0:-1);return Jc.includes(e.charAt(r))}function Zc(e,t,n){return t===(n?e.endOffset:0)}function eu(e,t){const n=[];Array.from(e.getItems({direction:"backward"})).map((e=>t.createRangeOn(e))).filter((t=>(t.start.isAfter(e.start)||t.start.isEqual(e.start))&&(t.end.isBefore(e.end)||t.end.isEqual(e.end)))).forEach((e=>{n.push(e.start.parent),t.remove(e)})),n.forEach((e=>{let n=e;for(;n.parent&&n.isEmpty;){const e=t.createRangeOn(n);n=n.parent,t.remove(e)}}))}function tu(e){e.document.registerPostFixer((t=>function(e,t){const n=t.document.selection,r=t.schema,i=[];let o=!1;for(const e of n.getRanges()){const t=nu(e,r);t?(i.push(t),o=!0):i.push(e)}if(o){let t=i;if(i.length>1){const e=i[0].start,n=i[i.length-1].end;t=[new $a(e,n)]}e.setSelection(t,{backward:n.isBackward})}}(t,e)))}function nu(e,t){return e.isCollapsed?function(e,t){const n=e.start,r=t.getNearestSelectionRange(n);if(!r)return null;const i=r.start;return n.isEqual(i)?null:i.nodeAfter&&t.isLimit(i.nodeAfter)?new $a(i,Ka._createAfter(i.nodeAfter)):new $a(i)}(e,t):function(e,t){const n=e.start,r=e.end,i=t.checkChild(n,"$text"),o=t.checkChild(r,"$text"),a=t.getLimitElement(n),s=t.getLimitElement(r);if(a===s){if(i&&o)return null;if(function(e,t,n){const r=e.nodeAfter&&!n.isLimit(e.nodeAfter)||n.checkChild(e,"$text"),i=t.nodeBefore&&!n.isLimit(t.nodeBefore)||n.checkChild(t,"$text");return r||i}(n,r,t)){const e=n.nodeAfter&&t.isObject(n.nodeAfter)?null:t.getNearestSelectionRange(n,"forward"),i=r.nodeBefore&&t.isObject(r.nodeBefore)?null:t.getNearestSelectionRange(r,"backward"),o=e?e.start:n,a=i?i.start:r;return new $a(o,a)}}const c=a&&!a.is("rootElement"),u=s&&!s.is("rootElement");if(c||u){const e=n.nodeAfter&&r.nodeBefore&&n.nodeAfter.parent===r.nodeBefore.parent,i=c&&(!e||!iu(n.nodeAfter,t)),o=u&&(!e||!iu(r.nodeBefore,t));let l=n,f=r;return i&&(l=Ka._createBefore(ru(a,t))),o&&(f=Ka._createAfter(ru(s,t))),new $a(l,f)}return null}(e,t)}function ru(e,t){let n=e,r=n;for(;t.isLimit(r)&&r.parent;)n=r,r=r.parent;return n}function iu(e,t){return e&&t.isObject(e)}class ou{constructor(){this.markers=new qc,this.document=new Bc(this),this.schema=new Fs,this._pendingChanges=[],this._currentWriter=null,["insertContent","deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach((e=>this.decorate(e))),this.on("applyOperation",((e,t)=>{t[0]._validate()}),{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$block",{allowIn:"$root",isBlock:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",isLimit:!0}),this.schema.extend("$text",{allowIn:"$clipboardHolder"}),this.schema.register("$marker"),this.schema.addChildCheck(((e,t)=>{if("$marker"===t.name)return!0})),tu(this)}change(e){try{return 0===this._pendingChanges.length?(this._pendingChanges.push({batch:new rc,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(e){Jn.b.rethrowUnexpectedError(e,this)}}enqueueChange(e,t){try{"string"==typeof e?e=new rc(e):"function"==typeof e&&(t=e,e=new rc),this._pendingChanges.push({batch:e,callback:t}),1==this._pendingChanges.length&&this._runPendingChanges()}catch(e){Jn.b.rethrowUnexpectedError(e,this)}}applyOperation(e){e._execute()}insertContent(e,t,n){return function(e,t,n,r){return e.change((i=>{let o;o=n?n instanceof rs||n instanceof hs?n:i.createSelection(n,r):e.document.selection;const a=o.getFirstPosition();o.isCollapsed||e.deleteContent(o,{doNotAutoparagraph:!0});const s=new Wc(e,i,a);let c;c=t.is("documentFragment")?t.getChildren():[t],s.handleNodes(c,{isFirst:!0,isLast:!0});const u=s.getSelectionRange();u&&(o instanceof hs?i.setSelection(u):o.setTo(u));const l=s.getAffectedRange()||e.createRange(a);return s.destroy(),l}))}(this,e,t,n)}deleteContent(e,t){Yc(this,e,t)}modifySelection(e,t){!function(e,t,n={}){const r=e.schema,i="backward"!=n.direction,o=n.unit?n.unit:"character",a=t.focus,s=new Qa({boundaries:$c(a,i),singleCharacters:!0,direction:i?"forward":"backward"}),c={walker:s,schema:r,isForward:i,unit:o};let u;for(;u=s.next();){if(u.done)return;const n=Kc(c,u.value);if(n)return void(t instanceof hs?e.change((e=>{e.setSelectionFocus(n)})):t.setFocus(n))}}(this,e,t)}getSelectedContent(e){return function(e,t){return e.change((e=>{const n=e.createDocumentFragment(),r=t.getFirstRange();if(!r||r.isCollapsed)return n;const i=r.start.root,o=r.start.getCommonPath(r.end),a=i.getNodeByPath(o);let s;s=r.start.parent==r.end.parent?r:e.createRange(e.createPositionAt(a,r.start.path[o.length]),e.createPositionAt(a,r.end.path[o.length]+1));const c=s.end.offset-s.start.offset;for(const t of s.getItems({shallow:!0}))t.is("textProxy")?e.appendText(t.data,t.getAttributes(),n):e.append(t._clone(!0),n);if(s!=r){const t=r._getTransformedByMove(s.start,e.createPositionAt(n,0),c)[0],i=e.createRange(e.createPositionAt(n,0),t.start);eu(e.createRange(t.end,e.createPositionAt(n,"end")),e),eu(i,e)}return n}))}(this,e)}hasContent(e,t){const n=e instanceof Ya?$a._createIn(e):e;if(n.isCollapsed)return!1;for(const e of this.markers.getMarkersIntersectingRange(n))if(e.affectsData)return!0;const{ignoreWhitespaces:r=!1}=t||{};for(const e of n.getItems())if(e.is("textProxy")){if(!r)return!0;if(-1!==e.data.search(/\S/))return!0}else if(this.schema.isObject(e))return!0;return!1}createPositionFromPath(e,t,n){return new Ka(e,t,n)}createPositionAt(e,t){return Ka._createAt(e,t)}createPositionAfter(e){return Ka._createAfter(e)}createPositionBefore(e){return Ka._createBefore(e)}createRange(e,t){return new $a(e,t)}createRangeIn(e){return $a._createIn(e)}createRangeOn(e){return $a._createOn(e)}createSelection(e,t,n){return new rs(e,t,n)}createBatch(e){return new rc(e)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];for(this.fire("_beforeChanges");this._pendingChanges.length;){const t=this._pendingChanges[0].batch;this._currentWriter=new Oc(this,t);const n=this._pendingChanges[0].callback(this._currentWriter);e.push(n),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}return this.fire("_afterChanges"),e}}ur(ou,Ur);class au{constructor(){this._listener=Object.create(fo)}listenTo(e){this._listener.listenTo(e,"keydown",((e,t)=>{this._listener.fire("_keydown:"+bi(t),t)}))}set(e,t,n={}){const r=vi(e),i=n.priority;this._listener.listenTo(this._listener,"_keydown:"+r,((e,n)=>{t(n,(()=>{n.preventDefault(),n.stopPropagation(),e.stop()})),e.return=!0}),{priority:i})}press(e){return!!this._listener.fire("_keydown:"+bi(e),e)}destroy(){this._listener.stopListening()}}class su extends au{constructor(e){super(),this.editor=e}set(e,t,n={}){if("string"==typeof t){const e=t;t=(t,n)=>{this.editor.execute(e),n()}}super.set(e,t,n)}}class cu{constructor(e){const t=this.constructor.builtinPlugins;this.config=new Qn(e,this.constructor.defaultConfig),this.config.define("plugins",t),this.plugins=new Ns(this,t),this.commands=new Ms;const n=this.config.get("language")||{};this.locale=new Is({uiLanguage:"string"==typeof n?n:n.ui,contentLanguage:this.config.get("language.content")}),this.t=this.locale.t,this.set("state","initializing"),this.once("ready",(()=>this.state="ready"),{priority:"high"}),this.once("destroy",(()=>this.state="destroyed"),{priority:"high"}),this.set("isReadOnly",!1),this.model=new ou,this.data=new Zs(this.model),this.editing=new Ps(this.model),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new ec([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new su(this),this.keystrokes.listenTo(this.editing.view.document)}initPlugins(){const e=this.config,t=e.get("plugins")||[],n=e.get("removePlugins")||[],r=e.get("extraPlugins")||[];return this.plugins.init(t.concat(r),n)}destroy(){let e=Promise.resolve();return"initializing"==this.state&&(e=new Promise((e=>this.once("ready",e)))),e.then((()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()})).then((()=>this.plugins.destroy())).then((()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}))}execute(...e){try{this.commands.execute(...e)}catch(e){Jn.b.rethrowUnexpectedError(e,this)}}}ur(cu,Ur);var uu={setData(e){this.data.set(e)},getData(e){return this.data.get(e)}},lu={updateSourceElement(){if(!this.sourceElement)throw new Jn.b("editor-missing-sourceelement: Cannot update the source element of a detached editor.",this);var e,t;e=this.sourceElement,t=this.data.get(),e instanceof HTMLTextAreaElement&&(e.value=t),e.innerHTML=t}};class fu{getHtml(e){const t=document.implementation.createHTMLDocument("").createElement("div");return t.appendChild(e),t.innerHTML}}class hu{constructor(){this._domParser=new DOMParser,this._domConverter=new ao({blockFillerMode:"nbsp"}),this._htmlWriter=new fu}toData(e){const t=this._domConverter.viewToDom(e,document);return this._htmlWriter.getHtml(t)}toView(e){const t=this._toDom(e);return this._domConverter.domToView(t)}_toDom(e){const t=this._domParser.parseFromString(e,"text/html"),n=t.createDocumentFragment(),r=t.body.childNodes;for(;r.length>0;)n.appendChild(r[0]);return n}}class du{constructor(e){this.editor=e,this._components=new Map}*names(){for(const e of this._components.values())yield e.originalName}add(e,t){if(this.has(e))throw new Jn.b("componentfactory-item-exists: The item already exists in the component factory.",this,{name:e});this._components.set(pu(e),{callback:t,originalName:e})}create(e){if(!this.has(e))throw new Jn.b("componentfactory-item-missing: The required component is not registered in the factory.",this,{name:e});return this._components.get(pu(e)).callback(this.editor.locale)}has(e){return this._components.has(pu(e))}}function pu(e){return String(e).toLowerCase()}class mu{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(e){if(this._elements.has(e))throw new Jn.b("focusTracker-add-element-already-exist",this);this.listenTo(e,"focus",(()=>this._focus(e)),{useCapture:!0}),this.listenTo(e,"blur",(()=>this._blur()),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(e),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout((()=>{this.focusedElement=null,this.isFocused=!1}),0)}}ur(mu,fo),ur(mu,Ur);class yu{constructor(e){this.editor=e,this.componentFactory=new du(e),this.focusTracker=new mu,this._editableElementsMap=new Map,this.listenTo(e.editing.view.document,"layoutChanged",(()=>this.update()))}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null;this._editableElementsMap=new Map}setEditableElement(e,t){this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}}ur(yu,nr),n(13);const gu=new WeakMap;function bu(e){const{view:t,element:n,text:r,isDirectHost:i=!0}=e,o=t.document;gu.has(o)||(gu.set(o,new Map),o.registerPostFixer((e=>wu(o,e)))),gu.get(o).set(n,{text:r,isDirectHost:i}),t.change((e=>wu(o,e)))}function vu(e,t){return!!t.hasClass("ck-placeholder")&&(e.removeClass("ck-placeholder",t),!0)}function wu(e,t){const n=gu.get(e);let r=!1;for(const[e,i]of n)_u(t,e,i)&&(r=!0);return r}function _u(e,t,n){const{text:r,isDirectHost:i}=n,o=i?t:function(e){if(1===e.childCount){const t=e.getChild(0);if(t.is("element")&&!t.is("uiElement"))return t}return null}(t);let a=!1;return!!o&&(n.hostElement=o,o.getAttribute("data-placeholder")!==r&&(e.setAttribute("data-placeholder",r,o),a=!0),function(e){const t=e.document;if(!t)return!1;const n=!Array.from(e.getChildren()).some((e=>!e.is("uiElement")));if(!t.isFocused&&n)return!0;const r=t.selection.anchor;return!(!n||!r||r.parent===e)}(o)?function(e,t){return!t.hasClass("ck-placeholder")&&(e.addClass("ck-placeholder",t),!0)}(e,o)&&(a=!0):vu(e,o)&&(a=!0),a)}class ku{constructor(){this._replacedElements=[]}replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling)}restore(){this._replacedElements.forEach((({element:e,newElement:t})=>{e.style.display="",t&&t.remove()})),this._replacedElements=[]}}class Eu extends yu{constructor(e,t){var n;super(e),this.view=t,this._toolbarConfig=(n=e.config.get("toolbar"),Array.isArray(n)?{items:n}:n?Object.assign({items:[]},n):{items:[]}),this._elementReplacer=new ku}get element(){return this.view.element}init(e){const t=this.editor,n=this.view,r=t.editing.view,i=n.editable,o=r.document.getRoot();i.name=o.rootName,n.render();const a=i.element;this.setEditableElement(i.name,a),this.focusTracker.add(a),n.editable.bind("isFocused").to(this.focusTracker),r.attachDomRoot(a),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){const e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.detachDomRoot(e.editable.name),e.destroy(),super.destroy()}_initToolbar(){const e=this.editor,t=this.view,n=e.editing.view;t.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),t.stickyPanel.limiterElement=t.element,this._toolbarConfig.viewportTopOffset&&(t.stickyPanel.viewportTopOffset=this._toolbarConfig.viewportTopOffset),t.toolbar.fillFromConfig(this._toolbarConfig.items,this.componentFactory),function({origin:e,originKeystrokeHandler:t,originFocusTracker:n,toolbar:r,beforeFocus:i,afterBlur:o}){n.add(r.element),t.set("Alt+F10",((e,t)=>{n.isFocused&&!r.focusTracker.isFocused&&(i&&i(),r.focus(),t())})),r.keystrokes.set("Esc",((t,n)=>{r.focusTracker.isFocused&&(e.focus(),o&&o(),n())}))}({origin:n,originFocusTracker:this.focusTracker,originKeystrokeHandler:e.keystrokes,toolbar:t.toolbar})}_initPlaceholder(){const e=this.editor,t=e.editing.view,n=t.document.getRoot(),r=e.sourceElement,i=e.config.get("placeholder")||r&&"textarea"===r.tagName.toLowerCase()&&r.getAttribute("placeholder");i&&bu({view:t,element:n,text:i,isDirectHost:!1})}}class Ou extends oi{constructor(e){super({idProperty:"viewUid"}),this.on("add",((e,t,n)=>{t.isRendered||t.render(),t.element&&this._parentElement&&this._parentElement.insertBefore(t.element,this._parentElement.children[n])})),this.on("remove",((e,t)=>{t.element&&this._parentElement&&t.element.remove()})),this.locale=e,this._parentElement=null}destroy(){this.map((e=>e.destroy()))}setParent(e){this._parentElement=e}delegate(...e){if(!e.length||!e.every((e=>"string"==typeof e)))throw new Jn.b("ui-viewcollection-delegate-wrong-events: All event names must be strings.",this);return{to:t=>{for(const n of this)for(const r of e)n.delegate(r).to(t);this.on("add",((n,r)=>{for(const n of e)r.delegate(n).to(t)})),this.on("remove",((n,r)=>{for(const n of e)r.stopDelegating(n,t)}))}}}}const Tu="http://www.w3.org/1999/xhtml";class xu{constructor(e){Object.assign(this,Du(Iu(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData={children:[],bindings:[],attributes:{}},this._renderNode({node:e,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new Jn.b("ui-template-revert-not-applied: Attempting to revert a template which has not been applied yet.",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){yield*function*e(t){if(t.children)for(const n of t.children)Vu(n)?yield n:Uu(n)&&(yield*e(n))}(this)}static bind(e,t){return{to:(n,r)=>new Cu({eventNameOrFunction:n,attribute:n,observable:e,emitter:t,callback:r}),if:(n,r,i)=>new Ru({observable:e,emitter:t,attribute:n,valueIfTrue:r,callback:i})}}static extend(e,t){if(e._isRendered)throw new Jn.b("template-extend-render: Attempting to extend a template which has already been rendered.",[this,e]);!function e(t,n){if(n.attributes&&(t.attributes||(t.attributes={}),Fu(t.attributes,n.attributes)),n.eventListeners&&(t.eventListeners||(t.eventListeners={}),Fu(t.eventListeners,n.eventListeners)),n.text&&t.text.push(...n.text),n.children&&n.children.length){if(t.children.length!=n.children.length)throw new Jn.b("ui-template-extend-children-mismatch: The number of children in extended definition does not match.",t);let r=0;for(const i of n.children)e(t.children[r++],i)}}(e,Du(Iu(t)))}_renderNode(e){let t;if(t=e.node?this.tag&&this.text:this.tag?this.text:!this.text,t)throw new Jn.b('ui-template-wrong-syntax: Node definition must have either "tag" or "text" when rendering a new Node.',this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let t=e.node;return t||(t=e.node=document.createElementNS(this.ns||Tu,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),t}_renderText(e){let t=e.node;return t?e.revertData.text=t.textContent:t=e.node=document.createTextNode(""),Pu(this.text)?this._bindToObservable({schema:this.text,updater:Mu(t),data:e}):t.textContent=this.text.join(""),t}_renderAttributes(e){let t,n,r,i;if(!this.attributes)return;const o=e.node,a=e.revertData;for(t in this.attributes)if(r=o.getAttribute(t),n=this.attributes[t],a&&(a.attributes[t]=r),i=V(n[0])&&n[0].ns?n[0].ns:null,Pu(n)){const s=i?n[0].value:n;a&&zu(t)&&s.unshift(r),this._bindToObservable({schema:s,updater:Au(o,t,i),data:e})}else"style"==t&&"string"!=typeof n[0]?this._renderStyleAttribute(n[0],e):(a&&r&&zu(t)&&n.unshift(r),n=n.map((e=>e&&e.value||e)).reduce(((e,t)=>e.concat(t)),[]).reduce(Bu,""),qu(n)||o.setAttributeNS(i,t,n))}_renderStyleAttribute(e,t){const n=t.node;for(const r in e){const i=e[r];Pu(i)?this._bindToObservable({schema:[i],updater:ju(n,r),data:t}):n.style[r]=i}}_renderElementChildren(e){const t=e.node,n=e.intoFragment?document.createDocumentFragment():t,r=e.isApplying;let i=0;for(const o of this.children)if(Hu(o)){if(!r){o.setParent(t);for(const e of o)n.appendChild(e.element)}}else if(Vu(o))r||(o.isRendered||o.render(),n.appendChild(o.element));else if($i(o))n.appendChild(o);else if(r){const t={children:[],bindings:[],attributes:{}};e.revertData.children.push(t),o._renderNode({node:n.childNodes[i++],isApplying:!0,revertData:t})}else n.appendChild(o.render());e.intoFragment&&t.appendChild(n)}_setUpListeners(e){if(this.eventListeners)for(const t in this.eventListeners){const n=this.eventListeners[t].map((n=>{const[r,i]=t.split("@");return n.activateDomEventListener(r,i,e)}));e.revertData&&e.revertData.bindings.push(n)}}_bindToObservable({schema:e,updater:t,data:n}){const r=n.revertData;Nu(e,t,n);const i=e.filter((e=>!qu(e))).filter((e=>e.observable)).map((r=>r.activateAttributeListener(e,t,n)));r&&r.bindings.push(i)}_revertTemplateFromNode(e,t){for(const e of t.bindings)for(const t of e)t();if(t.text)e.textContent=t.text;else{for(const n in t.attributes){const r=t.attributes[n];null===r?e.removeAttribute(n):e.setAttribute(n,r)}for(let n=0;n<t.children.length;++n)this._revertTemplateFromNode(e.childNodes[n],t.children[n])}}}ur(xu,nr);class Su{constructor(e){Object.assign(this,e)}getValue(e){const t=this.observable[this.attribute];return this.callback?this.callback(t,e):t}activateAttributeListener(e,t,n){const r=()=>Nu(e,t,n);return this.emitter.listenTo(this.observable,"change:"+this.attribute,r),()=>{this.emitter.stopListening(this.observable,"change:"+this.attribute,r)}}}class Cu extends Su{activateDomEventListener(e,t,n){const r=(e,n)=>{t&&!n.target.matches(t)||("function"==typeof this.eventNameOrFunction?this.eventNameOrFunction(n):this.observable.fire(this.eventNameOrFunction,n))};return this.emitter.listenTo(n.node,e,r),()=>{this.emitter.stopListening(n.node,e,r)}}}class Ru extends Su{getValue(e){return!qu(super.getValue(e))&&(this.valueIfTrue||!0)}}function Pu(e){return!!e&&(e.value&&(e=e.value),Array.isArray(e)?e.some(Pu):e instanceof Su)}function Nu(e,t,{node:n}){let r=function(e,t){return e.map((e=>e instanceof Su?e.getValue(t):e))}(e,n);r=1==e.length&&e[0]instanceof Ru?r[0]:r.reduce(Bu,""),qu(r)?t.remove():t.set(r)}function Mu(e){return{set(t){e.textContent=t},remove(){e.textContent=""}}}function Au(e,t,n){return{set(r){e.setAttributeNS(n,t,r)},remove(){e.removeAttributeNS(n,t)}}}function ju(e,t){return{set(n){e.style[t]=n},remove(){e.style[t]=null}}}function Iu(e){return Wn(e,(e=>{if(e&&(e instanceof Su||Uu(e)||Vu(e)||Hu(e)))return e}))}function Du(e){if("string"==typeof e?e=function(e){return{text:[e]}}(e):e.text&&function(e){Array.isArray(e.text)||(e.text=[e.text])}(e),e.on&&(e.eventListeners=function(e){for(const t in e)Lu(e,t);return e}(e.on),delete e.on),!e.text){e.attributes&&function(e){for(const t in e)e[t].value&&(e[t].value=[].concat(e[t].value)),Lu(e,t)}(e.attributes);const t=[];if(e.children)if(Hu(e.children))t.push(e.children);else for(const n of e.children)Uu(n)||Vu(n)||$i(n)?t.push(n):t.push(new xu(n));e.children=t}return e}function Lu(e,t){Array.isArray(e[t])||(e[t]=[e[t]])}function Bu(e,t){return qu(t)?e:qu(e)?t:`${e} ${t}`}function Fu(e,t){for(const n in t)e[n]?e[n].push(...t[n]):e[n]=t[n]}function qu(e){return!e&&0!==e}function Vu(e){return e instanceof Wu}function Uu(e){return e instanceof xu}function Hu(e){return e instanceof Ou}function zu(e){return"class"==e||"style"==e}n(15);class Wu{constructor(e){this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new oi,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",((t,n)=>{n.locale=e})),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=xu.bind(this,this)}createCollection(){const e=new Ou;return this._viewCollections.add(e),e}registerChild(e){gr(e)||(e=[e]);for(const t of e)this._unboundChildren.add(t)}deregisterChild(e){gr(e)||(e=[e]);for(const t of e)this._unboundChildren.remove(t)}setTemplate(e){this.template=new xu(e)}extendTemplate(e){xu.extend(this.template,e)}render(){if(this.isRendered)throw new Jn.b("ui-view-render-already-rendered: This View has already been rendered.",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map((e=>e.destroy())),this.template&&this.template._revertData&&this.template.revert(this.element)}}ur(Wu,fo),ur(Wu,Ur),n(17);class Yu extends Wu{constructor(e){super(e),this.body=this.createCollection()}render(){super.render(),this._renderBodyCollection()}destroy(){return this._bodyCollectionContainer.remove(),super.destroy()}_renderBodyCollection(){const e=this.locale,t=this._bodyCollectionContainer=new xu({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:e.uiLanguageDirection},children:this.body}).render();document.body.appendChild(t)}}n(19);class Qu extends Wu{constructor(e){super(e),this.set("text"),this.set("for");const t=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],for:t.to("for")},children:[{text:t.to("text")}]})}}class Gu extends Yu{constructor(e){super(e);const t=Xn();this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":`ck-editor__aria-label_${t}`},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(e){const t=this.t,n=new Qu;return n.text=t("bl"),n.extendTemplate({attributes:{id:`ck-editor__aria-label_${e}`,class:"ck-voice-label"}}),n}}class Ju extends Wu{constructor(e,t,n){super(e),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.name=null,this.set("isFocused",!1),this._editableElement=n,this._hasExternalElement=!!this._editableElement,this._editingView=t}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",(()=>this._updateIsFocusedClasses())),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}_updateIsFocusedClasses(){const e=this._editingView;function t(t){e.change((n=>{const r=e.document.getRoot(t.name);n.addClass(t.isFocused?"ck-focused":"ck-blurred",r),n.removeClass(t.isFocused?"ck-blurred":"ck-focused",r)}))}e.isRenderingInProgress?function n(r){e.once("change:isRenderingInProgress",((e,i,o)=>{o?n(r):t(r)}))}(this):t(this)}}class Ku extends Ju{constructor(e,t,n){super(e,t,n),this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const e=this._editingView,t=this.t;e.change((n=>{const r=e.document.getRoot(this.name);n.setAttribute("aria-label",t("bu",[this.name]),r)}))}}function $u(e){return t=>t+e}n(21);const Xu=$u("px");class Zu extends Wu{constructor(e){super(e);const t=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheLimiter",!1),this.set("_hasViewportTopOffset",!1),this.content=this.createCollection(),this._contentPanelPlaceholder=new xu({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",(e=>e?"block":"none")),height:t.to("isSticky",(e=>e?Xu(this._panelRect.height):null))}}}).render(),this._contentPanel=new xu({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",t.if("isSticky","ck-sticky-panel__content_sticky"),t.if("_isStickyToTheLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",(e=>e?Xu(this._contentPanelPlaceholder.getBoundingClientRect().width):null)),top:t.to("_hasViewportTopOffset",(e=>e?Xu(this.viewportTopOffset):null)),bottom:t.to("_isStickyToTheLimiter",(e=>e?Xu(this.limiterBottomOffset):null)),marginLeft:t.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this._contentPanel]})}render(){super.render(),this._checkIfShouldBeSticky(),this.listenTo(no.window,"scroll",(()=>{this._checkIfShouldBeSticky()})),this.listenTo(this,"change:isActive",(()=>{this._checkIfShouldBeSticky()}))}_checkIfShouldBeSticky(){const e=this._panelRect=this._contentPanel.getBoundingClientRect();let t;this.limiterElement?(t=this._limiterRect=this.limiterElement.getBoundingClientRect(),this.isSticky=this.isActive&&t.top<this.viewportTopOffset&&this._panelRect.height+this.limiterBottomOffset<t.height):this.isSticky=!1,this.isSticky?(this._isStickyToTheLimiter=t.bottom<e.height+this.limiterBottomOffset+this.viewportTopOffset,this._hasViewportTopOffset=!this._isStickyToTheLimiter&&!!this.viewportTopOffset,this._marginLeft=this._isStickyToTheLimiter?null:Xu(-no.window.scrollX)):(this._isStickyToTheLimiter=!1,this._hasViewportTopOffset=!1,this._marginLeft=null)}}class el{constructor(e){if(Object.assign(this,e),e.actions&&e.keystrokeHandler)for(const t in e.actions){let n=e.actions[t];"string"==typeof n&&(n=[n]);for(const r of n)e.keystrokeHandler.set(r,((e,n)=>{this[t](),n()}))}}get first(){return this.focusables.find(tl)||null}get last(){return this.focusables.filter(tl).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let e=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find(((t,n)=>{const r=t.element===this.focusTracker.focusedElement;return r&&(e=n),r})),e)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(e){e&&e.focus()}_getFocusableItem(e){const t=this.current,n=this.focusables.length;if(!n)return null;if(null===t)return this[1===e?"first":"last"];let r=(t+n+e)%n;do{const t=this.focusables.get(r);if(tl(t))return t;r=(r+n+e)%n}while(r!==t);return null}}function tl(e){return!(!e.focus||"none"==no.window.getComputedStyle(e.element).display)}class nl extends Wu{constructor(e){super(e),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}const rl=100;class il{constructor(e){this._callback=e,this._elements=new Set,this._previousRects=new Map,this._periodicCheckTimeout=null}observe(e){this._elements.add(e),1===this._elements.size&&this._startPeriodicCheck()}unobserve(e){this._elements.delete(e),this._previousRects.delete(e),this._elements.size||this._stopPeriodicCheck()}disconnect(){this._elements.forEach((e=>this.unobserve(e)))}_startPeriodicCheck(){const e=()=>{this._checkElementRectsAndExecuteCallback(),this._periodicCheckTimeout=setTimeout(e,rl)};this.listenTo(no.window,"resize",(()=>{this._checkElementRectsAndExecuteCallback()})),e()}_stopPeriodicCheck(){clearTimeout(this._periodicCheckTimeout),this.stopListening(),this._previousRects.clear()}_checkElementRectsAndExecuteCallback(){const e=[];for(const t of this._elements)this._hasRectChanged(t)&&e.push({target:t,contentRect:this._previousRects.get(t)});e.length&&this._callback(e)}_hasRectChanged(e){if(!e.ownerDocument.body.contains(e))return!1;const t=new Sa(e),n=this._previousRects.get(e),r=!n||!n.isEqual(t);return this._previousRects.set(e,t),r}}ur(il,fo);class ol extends Wu{constructor(e){super(e);const t=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",t.to("position",(e=>`ck-dropdown__panel_${e}`)),t.if("isVisible","ck-dropdown__panel-visible")]},children:this.children,on:{selectstart:t.to((e=>e.preventDefault()))}})}focus(){this.children.length&&this.children.first.focus()}focusLast(){if(this.children.length){const e=this.children.last;"function"==typeof e.focusLast?e.focusLast():e.focus()}}}function al({element:e,target:t,positions:n,limiter:r,fitInViewport:i}){Y(t)&&(t=t()),Y(r)&&(r=r());const o=function(e){for(;e&&"html"!=e.tagName.toLowerCase();){if("static"!=no.window.getComputedStyle(e).position)return e;e=e.parentElement}return null}(e.parentElement),a=new Sa(e),s=new Sa(t);let c,u;if(r||i){const e=r&&new Sa(r).getVisible(),t=i&&new Sa(no.window);[u,c]=function(e,t,n,r,i){let o,a,s=0,c=0;const u=n.getArea();return e.some((e=>{const[l,f]=sl(e,t,n);let h,d;if(r)if(i){const e=r.getIntersection(i);h=e?e.getIntersectionArea(f):0}else h=r.getIntersectionArea(f);function p(){c=d,s=h,o=f,a=l}return i&&(d=i.getIntersectionArea(f)),i&&!r?d>c&&p():!i&&r?h>s&&p():(d>c&&h>=s||d>=c&&h>s)&&p(),h===u})),o?[a,o]:null}(n,s,a,e,t)||sl(n[0],s,a)}else[u,c]=sl(n[0],s,a);let{left:l,top:f}=cl(c);if(o){const e=cl(new Sa(o)),t=Ta(o);l-=e.left,f-=e.top,l+=o.scrollLeft,f+=o.scrollTop,l-=t.left,f-=t.top}return{left:l,top:f,name:u}}function sl(e,t,n){const{left:r,top:i,name:o}=e(t,n);return[o,n.clone().moveTo(r,i)]}function cl({left:e,top:t}){const{scrollX:n,scrollY:r}=no.window;return{left:e+n,top:t+r}}n(23);class ul extends Wu{constructor(e,t,n){super(e);const r=this.bindTemplate;this.buttonView=t,this.panelView=n,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class"),this.set("panelPosition","auto"),this.focusTracker=new mu,this.keystrokes=new au,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",r.to("class"),r.if("isEnabled","ck-disabled",(e=>!e))]},children:[t,n]}),t.extendTemplate({attributes:{class:["ck-dropdown__button"]}})}render(){super.render(),this.listenTo(this.buttonView,"open",(()=>{this.isOpen=!this.isOpen})),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",(()=>{this.isOpen&&("auto"===this.panelPosition?this.panelView.position=ul._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions}).name:this.panelView.position=this.panelPosition)})),this.keystrokes.listenTo(this.element),this.focusTracker.add(this.element);const e=(e,t)=>{this.isOpen&&(this.buttonView.focus(),this.isOpen=!1,t())};this.keystrokes.set("arrowdown",((e,t)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,t())})),this.keystrokes.set("arrowright",((e,t)=>{this.isOpen&&t()})),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:e,southWest:t,northEast:n,northWest:r}=ul.defaultPanelPositions;return"ltr"===this.locale.uiLanguageDirection?[e,t,n,r]:[t,e,r,n]}}ul.defaultPanelPositions={southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,t)=>({top:e.bottom,left:e.left-t.width+e.width,name:"sw"}),northEast:(e,t)=>({top:e.top-t.height,left:e.left,name:"ne"}),northWest:(e,t)=>({top:e.bottom-t.height,left:e.left-t.width+e.width,name:"nw"})},ul._getOptimalPosition=al,n(25);class ll extends Wu{constructor(){super();const e=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon"],viewBox:e.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",(()=>{this._updateXMLContent(),this._colorFillPaths()})),this.on("change:fillColor",(()=>{this._colorFillPaths()}))}_updateXMLContent(){if(this.content){const e=(new DOMParser).parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),t=e.getAttribute("viewBox");for(t&&(this.viewBox=t),this.element.innerHTML="";e.childNodes.length>0;)this.element.appendChild(e.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach((e=>{e.style.fill=this.fillColor}))}}n(27);class fl extends Wu{constructor(e){super(e),this.set("text",""),this.set("position","s");const t=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip",t.to("position",(e=>"ck-tooltip_"+e)),t.if("text","ck-hidden",(e=>!e.trim()))]},children:[{tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:t.to("text")}]}]})}}n(29);class hl extends Wu{constructor(e){super(e);const t=this.bindTemplate,n=Xn();this.set("class"),this.set("labelStyle"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.tooltipView=this._createTooltipView(),this.labelView=this._createLabelView(n),this.iconView=new ll,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this)),this.setTemplate({tag:"button",attributes:{class:["ck","ck-button",t.to("class"),t.if("isEnabled","ck-disabled",(e=>!e)),t.if("isVisible","ck-hidden",(e=>!e)),t.to("isOn",(e=>e?"ck-on":"ck-off")),t.if("withText","ck-button_with-text"),t.if("withKeystroke","ck-button_with-keystroke")],type:t.to("type",(e=>e||"button")),tabindex:t.to("tabindex"),"aria-labelledby":`ck-editor__aria-label_${n}`,"aria-disabled":t.if("isEnabled",!0,(e=>!e)),"aria-pressed":t.to("isOn",(e=>!!this.isToggleable&&String(e)))},children:this.children,on:{mousedown:t.to((e=>{e.preventDefault()})),click:t.to((e=>{this.isEnabled?this.fire("execute"):e.preventDefault()}))}})}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.tooltipView),this.children.add(this.labelView),this.withKeystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}_createTooltipView(){const e=new fl;return e.bind("text").to(this,"_tooltipString"),e.bind("position").to(this,"tooltipPosition"),e}_createLabelView(e){const t=new Wu,n=this.bindTemplate;return t.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:n.to("labelStyle"),id:`ck-editor__aria-label_${e}`},children:[{text:this.bindTemplate.to("label")}]}),t}_createKeystrokeView(){const e=new Wu;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",(e=>wi(e)))}]}),e}_getTooltipString(e,t,n){return e?"string"==typeof e?e:(n&&(n=wi(n)),e instanceof Function?e(t,n):`${t}${n?` (${n})`:""}`):""}}var dl='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';class pl extends hl{constructor(e){super(e),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new ll;return e.content=dl,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}n(31);class ml extends Wu{constructor(){super(),this.items=this.createCollection(),this.focusTracker=new mu,this.keystrokes=new au,this._focusCycler=new el({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"]},children:this.items})}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}class yl extends Wu{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item"]},children:this.children})}focus(){this.children.first.focus()}}class gl extends Wu{constructor(e){super(e),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}n(33);class bl extends hl{constructor(e){super(e),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new Wu;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}function vl({emitter:e,activator:t,callback:n,contextElements:r}){e.listenTo(document,"mousedown",((e,{target:i})=>{if(t()){for(const e of r)if(e.contains(i))return;n()}}))}function wl(e,t=pl){const n=new t(e),r=new ol(e),i=new ul(e,n,r);return n.bind("isEnabled").to(i),n instanceof pl?n.bind("isOn").to(i,"isOpen"):n.arrowView.bind("isOn").to(i,"isOpen"),function(e){(function(e){e.on("render",(()=>{vl({emitter:e,activator:()=>e.isOpen,callback:()=>{e.isOpen=!1},contextElements:[e.element]})}))})(e),function(e){e.on("execute",(t=>{t.source instanceof bl||(e.isOpen=!1)}))}(e),function(e){e.keystrokes.set("arrowdown",((t,n)=>{e.isOpen&&(e.panelView.focus(),n())})),e.keystrokes.set("arrowup",((t,n)=>{e.isOpen&&(e.panelView.focusLast(),n())}))}(e)}(i),i}function _l(e,t){const n=e.locale,r=e.listView=new ml(n);r.items.bindTo(t).using((({type:e,model:t})=>{if("separator"===e)return new gl(n);if("button"===e||"switchbutton"===e){const r=new yl(n);let i;return i="button"===e?new hl(n):new bl(n),i.bind(...Object.keys(t)).to(t),i.delegate("execute").to(r),r.children.add(i),r}})),e.panelView.children.add(r),r.items.delegate("execute").to(e)}n(35),n(37);var kl='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>\n';n(39);class El extends Wu{constructor(e,t){super(e);const n=this.bindTemplate,r=this.t;var i;this.options=t||{},this.set("ariaLabel",r("bq")),this.items=this.createCollection(),this.focusTracker=new mu,this.keystrokes=new au,this.set("class"),this.itemsView=new Ol(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection(),this._focusCycler=new el({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:["arrowleft","arrowup"],focusNext:["arrowright","arrowdown"]}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar",n.to("class")],role:"toolbar","aria-label":n.to("ariaLabel")},children:this.children,on:{mousedown:(i=this,i.bindTemplate.to((e=>{e.target===i.element&&e.preventDefault()})))}}),this._behavior=this.options.shouldGroupWhenFull?new xl(this):new Tl(this)}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",((e,t)=>{this.focusTracker.add(t.element)})),this.items.on("remove",((e,t)=>{this.focusTracker.remove(t.element)})),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,t){e.map((e=>{"|"==e?this.items.add(new nl):t.has(e)?this.items.add(t.create(e)):console.warn(Object(Jn.a)("toolbarview-item-unavailable: The requested toolbar item is unavailable."),{name:e})}))}}class Ol extends Wu{constructor(e){super(e),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class Tl{constructor(e){const t=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using((e=>e)),e.focusables.bindTo(e.items).using((e=>e)),e.extendTemplate({attributes:{class:[t.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class xl{constructor(e){this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),this.resizeObserver=null,this.cachedPadding=null,e.itemsView.children.bindTo(this.ungroupedItems).using((e=>e)),this.ungroupedItems.on("add",this._updateFocusCycleableItems.bind(this)),this.ungroupedItems.on("remove",this._updateFocusCycleableItems.bind(this)),e.children.on("add",this._updateFocusCycleableItems.bind(this)),e.children.on("remove",this._updateFocusCycleableItems.bind(this)),e.items.on("add",((e,t,n)=>{n>this.ungroupedItems.length?this.groupedItems.add(t,n-this.ungroupedItems.length):this.ungroupedItems.add(t,n),this._updateGrouping()})),e.items.on("remove",((e,t,n)=>{n>this.ungroupedItems.length?this.groupedItems.remove(t):this.ungroupedItems.remove(t),this._updateGrouping()})),e.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(e){this.viewElement=e.element,this._enableGroupingOnResize()}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.disconnect()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;let e;for(;this._areItemsOverflowing;)this._groupLastItem(),e=!0;if(!e&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const e=this.viewElement,t=this.viewLocale.uiLanguageDirection,n=new Sa(e.lastChild),r=new Sa(e);if(!this.cachedPadding){const n=no.window.getComputedStyle(e),r="ltr"===t?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(n[r])}return"ltr"===t?n.right>r.right-this.cachedPadding:n.left<r.left+this.cachedPadding}_enableGroupingOnResize(){let e;var t;this.resizeObserver=(t=([t])=>{e&&e===t.contentRect.width||(this._updateGrouping(),e=t.contentRect.width)},"function"==typeof no.window.ResizeObserver?new no.window.ResizeObserver(t):new il(t)),this.resizeObserver.observe(this.viewElement),this._updateGrouping()}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new nl),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const e=this.viewLocale,t=e.t,n=wl(e);return n.class="ck-toolbar__grouped-dropdown",n.panelPosition="ltr"===e.uiLanguageDirection?"sw":"se",function(e,t){const n=e.locale,r=n.t,i=e.toolbarView=new El(n);i.set("ariaLabel",r("bm")),e.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),t.map((e=>i.items.add(e))),e.panelView.children.add(i),i.items.delegate("execute").to(e)}(n,[]),n.buttonView.set({label:t("br"),tooltip:!0,icon:kl}),n.toolbarView.items.bindTo(this.groupedItems).using((e=>e)),n}_updateFocusCycleableItems(){this.viewFocusables.clear(),this.ungroupedItems.map((e=>{this.viewFocusables.add(e)})),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}n(41);class Sl extends Gu{constructor(e,t,n={}){super(e),this.stickyPanel=new Zu(e),this.toolbar=new El(e,{shouldGroupWhenFull:n.shouldToolbarGroupWhenFull}),this.editable=new Ku(e,t)}render(){super.render(),this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}class Cl extends cu{constructor(e,t){super(t),Yn(e)&&(this.sourceElement=e),this.data.processor=new hu,this.model.document.createRoot();const n=!this.config.get("toolbar.shouldNotGroupWhenFull"),r=new Sl(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:n});this.ui=new Eu(this,r),function(e){if(!Y(e.updateSourceElement))throw new Jn.b("attachtoform-missing-elementapi-interface: Editor passed to attachToForm() must implement ElementApi.",e);const t=e.sourceElement;if(t&&"textarea"===t.tagName.toLowerCase()&&t.form){let n;const r=t.form,i=()=>e.updateSourceElement();Y(r.submit)&&(n=r.submit,r.submit=()=>{i(),n.apply(r)}),r.addEventListener("submit",i),e.on("destroy",(()=>{r.removeEventListener("submit",i),n&&(r.submit=n)}))}}(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,t={}){return new Promise((n=>{const r=new this(e,t);n(r.initPlugins().then((()=>r.ui.init(Yn(e)?e:null))).then((()=>{if(!Yn(e)&&t.initialData)throw new Jn.b("editor-create-initial-data: The config.initialData option cannot be used together with initial data passed in Editor.create().",null);const n=t.initialData||function(e){return Yn(e)?(t=e)instanceof HTMLTextAreaElement?t.value:t.innerHTML:e;var t}(e);return r.data.init(n)})).then((()=>r.fire("ready"))).then((()=>r)))}))}}ur(Cl,uu),ur(Cl,lu);class Rl{constructor(e){this.editor=e}destroy(){this.stopListening()}}ur(Rl,Ur);class Pl{constructor(e){this.files=function(e){const t=e.files?Array.from(e.files):[],n=e.items?Array.from(e.items):[];return t.length?t:n.filter((e=>"file"===e.kind)).map((e=>e.getAsFile()))}(e),this._native=e}get types(){return this._native.types}getData(e){return this._native.getData(e)}setData(e,t){this._native.setData(e,t)}}class Nl extends ra{constructor(e){super(e);const t=this.document;function n(e,n){n.preventDefault();const r=n.dropRange?[n.dropRange]:Array.from(t.selection.getRanges()),i=new $n(t,"clipboardInput");t.fire(i,{dataTransfer:n.dataTransfer,targetRanges:r}),i.stop.called&&n.stopPropagation()}this.domEventType=["paste","copy","cut","drop","dragover"],this.listenTo(t,"paste",n,{priority:"low"}),this.listenTo(t,"drop",n,{priority:"low"})}onDomEvent(e){const t={dataTransfer:new Pl(e.clipboardData?e.clipboardData:e.dataTransfer)};"drop"==e.type&&(t.dropRange=function(e,t){const n=t.target.ownerDocument,r=t.clientX,i=t.clientY;let o;return n.caretRangeFromPoint&&n.caretRangeFromPoint(r,i)?o=n.caretRangeFromPoint(r,i):t.rangeParent&&(o=n.createRange(),o.setStart(t.rangeParent,t.rangeOffset),o.collapse(!0)),o?e.domConverter.domRangeToView(o):e.document.selection.getFirstRange()}(this.view,e)),this.fire(e.type,e,t)}}const Ml=["figcaption","li"];class Al extends Rl{static get pluginName(){return"Clipboard"}init(){const e=this.editor,t=e.model.document,n=e.editing.view,r=n.document;function i(n,i){const o=i.dataTransfer;i.preventDefault();const a=e.data.toView(e.model.getSelectedContent(t.selection));r.fire("clipboardOutput",{dataTransfer:o,content:a,method:n.name})}this._htmlDataProcessor=new hu,n.addObserver(Nl),this.listenTo(r,"clipboardInput",(t=>{e.isReadOnly&&t.stop()}),{priority:"highest"}),this.listenTo(r,"clipboardInput",((e,t)=>{const r=t.dataTransfer;let i="";r.getData("text/html")?i=function(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,((e,t)=>1==t.length?" ":t))}(r.getData("text/html")):r.getData("text/plain")&&(i=function(e){return(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"</p><p>").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;")).indexOf("</p><p>")>-1&&(e=`<p>${e}</p>`),e}(r.getData("text/plain"))),i=this._htmlDataProcessor.toView(i),this.fire("inputTransformation",{content:i,dataTransfer:r}),n.scrollToTheSelection()}),{priority:"low"}),this.listenTo(this,"inputTransformation",((e,t)=>{if(!t.content.isEmpty){const e=this.editor.data,n=this.editor.model,r=e.toModel(t.content,"$clipboardHolder");if(0==r.childCount)return;n.insertContent(r)}}),{priority:"low"}),this.listenTo(r,"copy",i,{priority:"low"}),this.listenTo(r,"cut",((t,n)=>{e.isReadOnly?n.preventDefault():i(t,n)}),{priority:"low"}),this.listenTo(r,"clipboardOutput",((n,r)=>{r.content.isEmpty||(r.dataTransfer.setData("text/html",this._htmlDataProcessor.toData(r.content)),r.dataTransfer.setData("text/plain",function e(t){let n="";if(t.is("text")||t.is("textProxy"))n=t.data;else if(t.is("img")&&t.hasAttribute("alt"))n=t.getAttribute("alt");else{let r=null;for(const i of t.getChildren()){const t=e(i);r&&(r.is("containerElement")||i.is("containerElement"))&&(Ml.includes(r.name)||Ml.includes(i.name)?n+="\n":n+="\n\n"),n+=t,r=i}}return n}(r.content))),"cut"==r.method&&e.model.deleteContent(t.selection)}),{priority:"low"})}}class jl{constructor(e){this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",(()=>{this.refresh()})),this.on("execute",(e=>{this.isEnabled||e.stop()}),{priority:"high"}),this.listenTo(e,"change:isReadOnly",((e,t,n)=>{n?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}))}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),1==this._disableStack.size&&(this.on("set:isEnabled",Il,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),0==this._disableStack.size&&(this.off("set:isEnabled",Il),this.refresh())}execute(){}destroy(){this.stopListening()}}function Il(e){e.return=!1,e.stop()}function*Dl(e,t){for(const n of t)n&&e.getAttributeProperties(n[0]).copyOnEnter&&(yield n)}ur(jl,Ur);class Ll extends jl{execute(){const e=this.editor.model,t=e.document;e.change((n=>{!function(e,t,n,r){const i=n.isCollapsed,o=n.getFirstRange(),a=o.start.parent,s=o.end.parent;if(r.isLimit(a)||r.isLimit(s))i||a!=s||e.deleteContent(n);else if(i){const e=Dl(t.model.schema,n.getAttributes());Bl(t,o.start),t.setSelectionAttribute(e)}else{const r=!(o.start.isAtStart&&o.end.isAtEnd),i=a==s;e.deleteContent(n,{leaveUnmerged:r}),r&&(i?Bl(t,n.focus):t.setSelection(s,0))}}(this.editor.model,n,t.selection,e.schema),this.fire("afterExecute",{writer:n})}))}}function Bl(e,t){e.split(t),e.setSelection(t.parent.nextSibling,0)}class Fl extends mo{constructor(e){super(e);const t=this.document;t.on("keydown",((e,n)=>{if(this.isEnabled&&n.keyCode==gi.enter){let r;t.once("enter",(e=>r=e),{priority:"highest"}),t.fire("enter",new na(t,n.domEvent,{isSoft:n.shiftKey})),r&&r.stop.called&&e.stop()}}))}observe(){}}class ql extends Rl{static get pluginName(){return"Enter"}init(){const e=this.editor,t=e.editing.view,n=t.document;t.addObserver(Fl),e.commands.add("enter",new Ll(e)),this.listenTo(n,"enter",((n,r)=>{r.preventDefault(),r.isSoft||(e.execute("enter"),t.scrollToTheSelection())}),{priority:"low"})}}class Vl extends jl{execute(){const e=this.editor.model,t=e.document;e.change((n=>{!function(e,t,n){const r=n.isCollapsed,i=n.getFirstRange(),o=i.start.parent,a=i.end.parent,s=o==a;if(r){const r=Dl(e.schema,n.getAttributes());Ul(t,i.end),t.removeSelectionAttribute(n.getAttributeKeys()),t.setSelectionAttribute(r)}else{const r=!(i.start.isAtStart&&i.end.isAtEnd);e.deleteContent(n,{leaveUnmerged:r}),s?Ul(t,n.focus):r&&t.setSelection(a,0)}}(e,n,t.selection),this.fire("afterExecute",{writer:n})}))}refresh(){const e=this.editor.model,t=e.document;this.isEnabled=function(e,t){if(t.rangeCount>1)return!1;const n=t.anchor;if(!n||!e.checkChild(n,"softBreak"))return!1;const r=t.getFirstRange(),i=r.start.parent,o=r.end.parent;return!Hl(i,e)&&!Hl(o,e)||i===o}(e.schema,t.selection)}}function Ul(e,t){const n=e.createElement("softBreak");e.insert(n,t),e.setSelection(n,"after")}function Hl(e,t){return!e.is("rootElement")&&(t.isLimit(e)||Hl(e.parent,t))}class zl extends Rl{static get pluginName(){return"ShiftEnter"}init(){const e=this.editor,t=e.model.schema,n=e.conversion,r=e.editing.view,i=r.document;t.register("softBreak",{allowWhere:"$text",isInline:!0}),n.for("upcast").elementToElement({model:"softBreak",view:"br"}),n.for("downcast").elementToElement({model:"softBreak",view:(e,t)=>t.createEmptyElement("br")}),r.addObserver(Fl),e.commands.add("shiftEnter",new Vl(e)),this.listenTo(i,"enter",((t,n)=>{n.preventDefault(),n.isSoft&&(e.execute("shiftEnter"),r.scrollToTheSelection())}),{priority:"low"})}}class Wl{constructor(e,t=20){this.model=e,this.size=0,this.limit=t,this.isLocked=!1,this._changeCallback=(e,t)=>{"transparent"!=t.type&&t!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch()),this._batch}input(e){this.size+=e,this.size>=this.limit&&this._reset(!0)}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(e){this.isLocked&&!e||(this._batch=null,this.size=0)}}class Yl extends jl{constructor(e,t){super(e),this._buffer=new Wl(e.model,t),this._batches=new WeakSet}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const t=this.editor.model,n=t.document,r=e.text||"",i=r.length,o=e.range||n.selection.getFirstRange(),a=e.resultRange;t.enqueueChange(this._buffer.batch,(e=>{const s=o.isCollapsed;this._buffer.lock(),t.deleteContent(t.createSelection(o)),r&&t.insertContent(e.createText(r,n.selection.getAttributes()),o.start),a?e.setSelection(a):s&&e.setSelection(o.start.getShiftedBy(i)),this._buffer.unlock(),this._buffer.input(i),this._batches.add(this._buffer.batch)}))}}function Ql(e){let t=null;const n=e.model,r=e.editing.view,i=e.commands.get("input");function o(e){const o=n.document,s=r.document.isComposing,c=t&&t.isEqual(o.selection);t=null,i.isEnabled&&(function(e){return!!e.ctrlKey||Gl.includes(e.keyCode)}(e)||o.selection.isCollapsed||s&&229===e.keyCode||!s&&229===e.keyCode&&c||a())}function a(){const e=i.buffer;e.lock(),n.enqueueChange(e.batch,(()=>{n.deleteContent(n.document.selection)})),e.unlock()}pi.isAndroid?r.document.on("beforeinput",((e,t)=>o(t)),{priority:"lowest"}):r.document.on("keydown",((e,t)=>o(t)),{priority:"lowest"}),r.document.on("compositionstart",(function(){const e=n.document,t=1!==e.selection.rangeCount||e.selection.getFirstRange().isFlat;e.selection.isCollapsed||t||a()}),{priority:"lowest"}),r.document.on("compositionend",(()=>{t=n.createSelection(n.document.selection)}),{priority:"lowest"})}const Gl=[bi("arrowUp"),bi("arrowRight"),bi("arrowDown"),bi("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255];for(let e=112;e<=135;e++)Gl.push(e);function Jl(e){if(e.newChildren.length-e.oldChildren.length!=1)return;const t=function(e,t){const n=[];let r,i=0;return e.forEach((e=>{"equal"==e?(o(),i++):"insert"==e?(a("insert")?r.values.push(t[i]):(o(),r={type:"insert",index:i,values:[t[i]]}),i++):a("delete")?r.howMany++:(o(),r={type:"delete",index:i,howMany:1})})),o(),n;function o(){r&&(n.push(r),r=null)}function a(e){return r&&r.type==e}}(Gi(e.oldChildren,e.newChildren,Kl),e.newChildren);if(t.length>1)return;const n=t[0];return n.values[0]&&n.values[0].is("text")?n:void 0}function Kl(e,t){return e&&e.is("text")&&t&&t.is("text")?e.data===t.data:e===t}class $l{constructor(e){this.editor=e,this.editing=this.editor.editing}handle(e,t){if(function(e){if(0==e.length)return!1;for(const t of e)if("children"===t.type&&!Jl(t))return!0;return!1}(e))this._handleContainerChildrenMutations(e,t);else for(const n of e)this._handleTextMutation(n,t),this._handleTextNodeInsertion(n)}_handleContainerChildrenMutations(e,t){const n=function(e){const t=e.map((e=>e.node)).reduce(((e,t)=>e.getCommonAncestor(t,{includeSelf:!0})));if(t)return t.getAncestors({includeSelf:!0,parentFirst:!0}).find((e=>e.is("containerElement")||e.is("rootElement")))}(e);if(!n)return;const r=this.editor.editing.view.domConverter.mapViewToDom(n),i=new ao,o=this.editor.data.toModel(i.domToView(r)).getChild(0),a=this.editor.editing.mapper.toModelElement(n);if(!a)return;const s=Array.from(o.getChildren()),c=Array.from(a.getChildren()),u=s[s.length-1],l=c[c.length-1];u&&u.is("softBreak")&&l&&!l.is("softBreak")&&s.pop();const f=this.editor.model.schema;if(!Xl(s,f)||!Xl(c,f))return;const h=s.map((e=>e.is("text")?e.data:"@")).join("").replace(/\u00A0/g," "),d=c.map((e=>e.is("text")?e.data:"@")).join("").replace(/\u00A0/g," ");if(d===h)return;const p=Gi(d,h),{firstChangeAt:m,insertions:y,deletions:g}=Zl(p);let b=null;t&&(b=this.editing.mapper.toModelRange(t.getFirstRange()));const v=h.substr(m,y),w=this.editor.model.createRange(this.editor.model.createPositionAt(a,m),this.editor.model.createPositionAt(a,m+g));this.editor.execute("input",{text:v,range:w,resultRange:b})}_handleTextMutation(e,t){if("text"!=e.type)return;const n=e.newText.replace(/\u00A0/g," "),r=e.oldText.replace(/\u00A0/g," ");if(r===n)return;const i=Gi(r,n),{firstChangeAt:o,insertions:a,deletions:s}=Zl(i);let c=null;t&&(c=this.editing.mapper.toModelRange(t.getFirstRange()));const u=this.editing.view.createPositionAt(e.node,o),l=this.editing.mapper.toModelPosition(u),f=this.editor.model.createRange(l,l.getShiftedBy(s)),h=n.substr(o,a);this.editor.execute("input",{text:h,range:f,resultRange:c})}_handleTextNodeInsertion(e){if("children"!=e.type)return;const t=Jl(e),n=this.editing.view.createPositionAt(e.node,t.index),r=this.editing.mapper.toModelPosition(n),i=t.values[0].data;this.editor.execute("input",{text:i.replace(/\u00A0/g," "),range:this.editor.model.createRange(r)})}}function Xl(e,t){return e.every((e=>t.isInline(e)))}function Zl(e){let t=null,n=null;for(let r=0;r<e.length;r++)"equal"!=e[r]&&(t=null===t?r:t,n=r);let r=0,i=0;for(let o=t;o<=n;o++)"insert"!=e[o]&&r++,"delete"!=e[o]&&i++;return{insertions:i,deletions:r,firstChangeAt:t}}class ef extends Rl{static get pluginName(){return"Input"}init(){const e=this.editor,t=new Yl(e,e.config.get("typing.undoStep")||20);e.commands.add("input",t),Ql(e),function(e){e.editing.view.document.on("mutations",((t,n,r)=>{new $l(e).handle(n,r)}))}(e)}isInput(e){return this.editor.commands.get("input")._batches.has(e)}}class tf extends jl{constructor(e,t){super(e),this.direction=t,this._buffer=new Wl(e.model,e.config.get("typing.undoStep"))}get buffer(){return this._buffer}execute(e={}){const t=this.editor.model,n=t.document;t.enqueueChange(this._buffer.batch,(r=>{this._buffer.lock();const i=r.createSelection(e.selection||n.selection),o=i.isCollapsed;if(i.isCollapsed&&t.modifySelection(i,{direction:this.direction,unit:e.unit}),this._shouldEntireContentBeReplacedWithParagraph(e.sequence||1))return void this._replaceEntireContentWithParagraph(r);if(i.isCollapsed)return;let a=0;i.getFirstRange().getMinimalFlatRanges().forEach((e=>{a+=ni(e.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))})),t.deleteContent(i,{doNotResetEntireContent:o}),this._buffer.input(a),r.setSelection(i),this._buffer.unlock()}))}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const t=this.editor.model,n=t.document.selection,r=t.schema.getLimitElement(n);if(!n.isCollapsed||!n.containsEntireContent(r))return!1;if(!t.schema.checkChild(r,"paragraph"))return!1;const i=r.getChild(0);return!i||"paragraph"!==i.name}_replaceEntireContentWithParagraph(e){const t=this.editor.model,n=t.document.selection,r=t.schema.getLimitElement(n),i=e.createElement("paragraph");e.remove(e.createRangeIn(r)),e.insert(i,r),e.setSelection(i,0)}}class nf extends mo{constructor(e){super(e);const t=e.document;let n=0;function r(e,n,r){let i;t.once("delete",(e=>i=e),{priority:Number.POSITIVE_INFINITY}),t.fire("delete",new na(t,n,r)),i&&i.stop.called&&e.stop()}t.on("keyup",((e,t)=>{t.keyCode!=gi.delete&&t.keyCode!=gi.backspace||(n=0)})),t.on("keydown",((e,t)=>{const i={};if(t.keyCode==gi.delete)i.direction="forward",i.unit="character";else{if(t.keyCode!=gi.backspace)return;i.direction="backward",i.unit="codePoint"}const o=pi.isMac?t.altKey:t.ctrlKey;i.unit=o?"word":i.unit,i.sequence=++n,r(e,t.domEvent,i)})),pi.isAndroid&&t.on("beforeinput",((t,n)=>{if("deleteContentBackward"!=n.domEvent.inputType)return;const i={unit:"codepoint",direction:"backward",sequence:1},o=n.domTarget.ownerDocument.defaultView.getSelection();o.anchorNode==o.focusNode&&o.anchorOffset+1!=o.focusOffset&&(i.selectionToRemove=e.domConverter.domSelectionToView(o)),r(t,n.domEvent,i)}))}observe(){}}class rf extends Rl{static get pluginName(){return"Delete"}init(){const e=this.editor,t=e.editing.view,n=t.document;if(t.addObserver(nf),e.commands.add("forwardDelete",new tf(e,"forward")),e.commands.add("delete",new tf(e,"backward")),this.listenTo(n,"delete",((n,r)=>{const i={unit:r.unit,sequence:r.sequence};if(r.selectionToRemove){const t=e.model.createSelection(),n=[];for(const t of r.selectionToRemove.getRanges())n.push(e.editing.mapper.toModelRange(t));t.setTo(n),i.selection=t}e.execute("forward"==r.direction?"forwardDelete":"delete",i),r.preventDefault(),t.scrollToTheSelection()})),pi.isAndroid){let e=null;this.listenTo(n,"delete",((t,n)=>{const r=n.domTarget.ownerDocument.defaultView.getSelection();e={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}}),{priority:"lowest"}),this.listenTo(n,"keyup",((t,n)=>{if(e){const t=n.domTarget.ownerDocument.defaultView.getSelection();t.collapse(e.anchorNode,e.anchorOffset),t.extend(e.focusNode,e.focusOffset),e=null}}))}}}class of extends Rl{static get requires(){return[ef,rf]}static get pluginName(){return"Typing"}}class af extends ic{get type(){return"noop"}clone(){return new af(this.baseVersion)}getReversed(){return new af(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}const sf=new Map;function cf(e,t,n){let r=sf.get(e);r||(r=new Map,sf.set(e,r)),r.set(t,n)}function uf(e){return[e]}function lf(e,t,n={}){const r=function(e,t){const n=sf.get(e);return n&&n.has(t)?n.get(t):uf}(e.constructor,t.constructor);try{return r(e=e.clone(),t,n)}catch(e){throw e}}function ff(e,t,n){e=e.slice(),t=t.slice();const r=new hf(n.document,n.useRelations,n.forceWeakRemove);r.setOriginalOperations(e),r.setOriginalOperations(t);const i=r.originalOperations;if(0==e.length||0==t.length)return{operationsA:e,operationsB:t,originalOperations:i};const o=new WeakMap;for(const t of e)o.set(t,0);const a={nextBaseVersionA:e[e.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:e.length,originalOperationsBCount:t.length};let s=0;for(;s<e.length;){const n=e[s],i=o.get(n);if(i==t.length){s++;continue}const a=t[i],c=lf(n,a,r.getContext(n,a,!0)),u=lf(a,n,r.getContext(a,n,!1));r.updateRelation(n,a),r.setOriginalOperations(c,n),r.setOriginalOperations(u,a);for(const e of c)o.set(e,i+u.length);e.splice(s,1,...c),t.splice(i,1,...u)}if(n.padWithNoOps){const n=e.length-a.originalOperationsACount,r=t.length-a.originalOperationsBCount;pf(e,r-n),pf(t,n-r)}return df(e,a.nextBaseVersionB),df(t,a.nextBaseVersionA),{operationsA:e,operationsB:t,originalOperations:i}}class hf{constructor(e,t,n=!1){this.originalOperations=new Map,this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!n,this._relations=new Map}setOriginalOperations(e,t=null){const n=t?this.originalOperations.get(t):null;for(const t of e)this.originalOperations.set(t,n||t)}updateRelation(e,t){switch(e.constructor){case yc:switch(t.constructor){case _c:e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)&&this._setRelation(e,t,"moveTargetAfter");break;case yc:e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter")}break;case kc:switch(t.constructor){case _c:e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");break;case yc:(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))&&this._setRelation(e,t,"splitBefore")}break;case _c:switch(t.constructor){case _c:e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement");break;case kc:e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource")}break;case bc:{const n=e.newRange;if(!n)return;switch(t.constructor){case yc:{const r=$a._createFromPositionAndShift(t.sourcePosition,t.howMany),i=r.containsPosition(n.start)||r.start.isEqual(n.start),o=r.containsPosition(n.end)||r.end.isEqual(n.end);!i&&!o||r.containsRange(n)||this._setRelation(e,t,{side:i?"left":"right",path:i?n.start.path.slice():n.end.path.slice()});break}case _c:{const r=n.start.isEqual(t.targetPosition),i=n.start.isEqual(t.deletionPosition),o=n.end.isEqual(t.deletionPosition),a=n.end.isEqual(t.sourcePosition);(r||i||o||a)&&this._setRelation(e,t,{wasInLeftElement:r,wasStartBeforeMergedElement:i,wasEndBeforeMergedElement:o,wasInRightElement:a});break}}break}}}getContext(e,t,n){return{aIsStrong:n,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(e){const t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t)}_getRelation(e,t){const n=this.originalOperations.get(t),r=this._history.getUndoneOperation(n);if(!r)return null;const i=this.originalOperations.get(e),o=this._relations.get(i);return o&&o.get(r)||null}_setRelation(e,t,n){const r=this.originalOperations.get(e),i=this.originalOperations.get(t);let o=this._relations.get(r);o||(o=new Map,this._relations.set(r,o)),o.set(i,n)}}function df(e,t){for(const n of e)n.baseVersion=t++}function pf(e,t){for(let n=0;n<t;n++)e.push(new af(0))}function mf(e,t,n){const r=e.nodes.getNode(0).getAttribute(t);if(r==n)return null;const i=new $a(e.position,e.position.getShiftedBy(e.howMany));return new pc(i,t,r,n,0)}function yf(e,t){return null===e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)}function gf(e,t){const n=[];for(let r=0;r<e.length;r++){const i=e[r],o=new yc(i.start,i.end.offset-i.start.offset,t,0);n.push(o);for(let t=r+1;t<e.length;t++)e[t]=e[t]._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)[0];t=t._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)}return n}cf(pc,pc,((e,t,n)=>{if(e.key===t.key){const r=e.range.getDifference(t.range).map((t=>new pc(t,e.key,e.oldValue,e.newValue,0))),i=e.range.getIntersection(t.range);return i&&n.aIsStrong&&r.push(new pc(i,t.key,t.newValue,e.newValue,0)),0==r.length?[new af(0)]:r}return[e]})),cf(pc,gc,((e,t)=>{if(e.range.start.hasSameParentAs(t.position)&&e.range.containsPosition(t.position)){const n=e.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes).map((t=>new pc(t,e.key,e.oldValue,e.newValue,e.baseVersion)));if(t.shouldReceiveAttributes){const r=mf(t,e.key,e.oldValue);r&&n.unshift(r)}return n}return e.range=e.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[e]})),cf(pc,_c,((e,t)=>{const n=[];e.range.start.hasSameParentAs(t.deletionPosition)&&(e.range.containsPosition(t.deletionPosition)||e.range.start.isEqual(t.deletionPosition))&&n.push($a._createFromPositionAndShift(t.graveyardPosition,1));const r=e.range._getTransformedByMergeOperation(t);return r.isCollapsed||n.push(r),n.map((t=>new pc(t,e.key,e.oldValue,e.newValue,e.baseVersion)))})),cf(pc,yc,((e,t)=>function(e,t){const n=$a._createFromPositionAndShift(t.sourcePosition,t.howMany);let r=null,i=[];n.containsRange(e,!0)?r=e:e.start.hasSameParentAs(n.start)?(i=e.getDifference(n),r=e.getIntersection(n)):i=[e];const o=[];for(let e of i){e=e._getTransformedByDeletion(t.sourcePosition,t.howMany);const n=t.getMovedRangeStart(),r=e.start.hasSameParentAs(n);e=e._getTransformedByInsertion(n,t.howMany,r),o.push(...e)}return r&&o.push(r._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]),o}(e.range,t).map((t=>new pc(t,e.key,e.oldValue,e.newValue,e.baseVersion))))),cf(pc,kc,((e,t)=>{if(e.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.range.end.offset++,[e];if(e.range.start.hasSameParentAs(t.splitPosition)&&e.range.containsPosition(t.splitPosition)){const n=e.clone();return n.range=new $a(t.moveTargetPosition.clone(),e.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),e.range.end=t.splitPosition.clone(),e.range.end.stickiness="toPrevious",[e,n]}return e.range=e.range._getTransformedBySplitOperation(t),[e]})),cf(gc,pc,((e,t)=>{const n=[e];if(e.shouldReceiveAttributes&&e.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(e.position)){const r=mf(e,t.key,t.newValue);r&&n.push(r)}return n})),cf(gc,gc,((e,t,n)=>(e.position.isEqual(t.position)&&n.aIsStrong||(e.position=e.position._getTransformedByInsertOperation(t)),[e]))),cf(gc,yc,((e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e]))),cf(gc,kc,((e,t)=>(e.position=e.position._getTransformedBySplitOperation(t),[e]))),cf(gc,_c,((e,t)=>(e.position=e.position._getTransformedByMergeOperation(t),[e]))),cf(bc,gc,((e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByInsertOperation(t)[0]),e.newRange&&(e.newRange=e.newRange._getTransformedByInsertOperation(t)[0]),[e]))),cf(bc,bc,((e,t,n)=>{if(e.name==t.name){if(!n.aIsStrong)return[new af(0)];e.oldRange=t.newRange?t.newRange.clone():null}return[e]})),cf(bc,_c,((e,t)=>(e.oldRange&&(e.oldRange=e.oldRange._getTransformedByMergeOperation(t)),e.newRange&&(e.newRange=e.newRange._getTransformedByMergeOperation(t)),[e]))),cf(bc,yc,((e,t,n)=>{if(e.oldRange&&(e.oldRange=$a._createFromRanges(e.oldRange._getTransformedByMoveOperation(t))),e.newRange){if(n.abRelation){const r=$a._createFromRanges(e.newRange._getTransformedByMoveOperation(t));if("left"==n.abRelation.side&&t.targetPosition.isEqual(e.newRange.start))return e.newRange.start.path=n.abRelation.path,e.newRange.end=r.end,[e];if("right"==n.abRelation.side&&t.targetPosition.isEqual(e.newRange.end))return e.newRange.start=r.start,e.newRange.end.path=n.abRelation.path,[e]}e.newRange=$a._createFromRanges(e.newRange._getTransformedByMoveOperation(t))}return[e]})),cf(bc,kc,((e,t,n)=>{if(e.oldRange&&(e.oldRange=e.oldRange._getTransformedBySplitOperation(t)),e.newRange){if(n.abRelation){const r=e.newRange._getTransformedBySplitOperation(t);return e.newRange.start.isEqual(t.splitPosition)&&n.abRelation.wasStartBeforeMergedElement?e.newRange.start=Ka._createAt(t.insertionPosition):e.newRange.start.isEqual(t.splitPosition)&&!n.abRelation.wasInLeftElement&&(e.newRange.start=Ka._createAt(t.moveTargetPosition)),e.newRange.end.isEqual(t.splitPosition)&&n.abRelation.wasInRightElement?e.newRange.end=Ka._createAt(t.moveTargetPosition):e.newRange.end.isEqual(t.splitPosition)&&n.abRelation.wasEndBeforeMergedElement?e.newRange.end=Ka._createAt(t.insertionPosition):e.newRange.end=r.end,[e]}e.newRange=e.newRange._getTransformedBySplitOperation(t)}return[e]})),cf(_c,gc,((e,t)=>(e.sourcePosition.hasSameParentAs(t.position)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByInsertOperation(t),e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t),[e]))),cf(_c,_c,((e,t,n)=>{if(e.sourcePosition.isEqual(t.sourcePosition)&&e.targetPosition.isEqual(t.targetPosition)){if(n.bWasUndone){const n=t.graveyardPosition.path.slice();return n.push(0),e.sourcePosition=new Ka(t.graveyardPosition.root,n),e.howMany=0,[e]}return[new af(0)]}if(e.sourcePosition.isEqual(t.sourcePosition)&&!e.targetPosition.isEqual(t.targetPosition)&&!n.bWasUndone&&"splitAtSource"!=n.abRelation){const r="$graveyard"==e.targetPosition.root.rootName,i="$graveyard"==t.targetPosition.root.rootName,o=r&&!i;if(i&&!r||!o&&n.aIsStrong){const n=t.targetPosition._getTransformedByMergeOperation(t),r=e.targetPosition._getTransformedByMergeOperation(t);return[new yc(n,e.howMany,r,0)]}return[new af(0)]}return e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMergeOperation(t),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),e.graveyardPosition.isEqual(t.graveyardPosition)&&n.aIsStrong||(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]})),cf(_c,yc,((e,t,n)=>{const r=$a._createFromPositionAndShift(t.sourcePosition,t.howMany);return"remove"==t.type&&!n.bWasUndone&&!n.forceWeakRemove&&e.deletionPosition.hasSameParentAs(t.sourcePosition)&&r.containsPosition(e.sourcePosition)?[new af(0)]:(e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition.hasSameParentAs(t.sourcePosition)&&(e.howMany-=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMoveOperation(t),e.targetPosition=e.targetPosition._getTransformedByMoveOperation(t),e.graveyardPosition.isEqual(t.targetPosition)||(e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)),[e])})),cf(_c,kc,((e,t,n)=>{if(t.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),e.deletionPosition.isEqual(t.graveyardPosition)&&(e.howMany=t.howMany)),e.targetPosition.isEqual(t.splitPosition)){const r=0!=t.howMany,i=t.graveyardPosition&&e.deletionPosition.isEqual(t.graveyardPosition);if(r||i||"mergeTargetNotMoved"==n.abRelation)return e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),[e]}if(e.sourcePosition.isEqual(t.splitPosition)){if("mergeSourceNotMoved"==n.abRelation)return e.howMany=0,e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];if("mergeSameElement"==n.abRelation||e.sourcePosition.offset>0)return e.sourcePosition=t.moveTargetPosition.clone(),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]}return e.sourcePosition.hasSameParentAs(t.splitPosition)&&(e.howMany=t.splitPosition.offset),e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e]})),cf(yc,gc,((e,t)=>{const n=$a._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByInsertOperation(t,!1)[0];return e.sourcePosition=n.start,e.howMany=n.end.offset-n.start.offset,e.targetPosition.isEqual(t.position)||(e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t)),[e]})),cf(yc,yc,((e,t,n)=>{const r=$a._createFromPositionAndShift(e.sourcePosition,e.howMany),i=$a._createFromPositionAndShift(t.sourcePosition,t.howMany);let o,a=n.aIsStrong,s=!n.aIsStrong;if("insertBefore"==n.abRelation||"insertAfter"==n.baRelation?s=!0:"insertAfter"!=n.abRelation&&"insertBefore"!=n.baRelation||(s=!1),o=e.targetPosition.isEqual(t.targetPosition)&&s?e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):e.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),yf(e,t)&&yf(t,e))return[t.getReversed()];if(r.containsPosition(t.targetPosition)&&r.containsRange(i,!0))return r.start=r.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),r.end=r.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),gf([r],o);if(i.containsPosition(e.targetPosition)&&i.containsRange(r,!0))return r.start=r.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),r.end=r.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),gf([r],o);const c=lr(e.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if("prefix"==c||"extension"==c)return r.start=r.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),r.end=r.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),gf([r],o);"remove"!=e.type||"remove"==t.type||n.aWasUndone||n.forceWeakRemove?"remove"==e.type||"remove"!=t.type||n.bWasUndone||n.forceWeakRemove||(a=!1):a=!0;const u=[],l=r.getDifference(i);for(const e of l){e.start=e.start._getTransformedByDeletion(t.sourcePosition,t.howMany),e.end=e.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const n="same"==lr(e.start.getParentPath(),t.getMovedRangeStart().getParentPath()),r=e._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,n);u.push(...r)}const f=r.getIntersection(i);return null!==f&&a&&(f.start=f.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),f.end=f.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),0===u.length?u.push(f):1==u.length?i.start.isBefore(r.start)||i.start.isEqual(r.start)?u.unshift(f):u.push(f):u.splice(1,0,f)),0===u.length?[new af(e.baseVersion)]:gf(u,o)})),cf(yc,kc,((e,t,n)=>{let r=e.targetPosition.clone();e.targetPosition.isEqual(t.insertionPosition)&&t.graveyardPosition&&"moveTargetAfter"!=n.abRelation||(r=e.targetPosition._getTransformedBySplitOperation(t));const i=$a._createFromPositionAndShift(e.sourcePosition,e.howMany);if(i.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.howMany++,e.targetPosition=r,[e];if(i.start.hasSameParentAs(t.splitPosition)&&i.containsPosition(t.splitPosition)){let e=new $a(t.splitPosition,i.end);return e=e._getTransformedBySplitOperation(t),gf([new $a(i.start,t.splitPosition),e],r)}e.targetPosition.isEqual(t.splitPosition)&&"insertAtSource"==n.abRelation&&(r=t.moveTargetPosition),e.targetPosition.isEqual(t.insertionPosition)&&"insertBetween"==n.abRelation&&(r=e.targetPosition);const o=[i._getTransformedBySplitOperation(t)];if(t.graveyardPosition){const r=i.start.isEqual(t.graveyardPosition)||i.containsPosition(t.graveyardPosition);e.howMany>1&&r&&!n.aWasUndone&&o.push($a._createFromPositionAndShift(t.insertionPosition,1))}return gf(o,r)})),cf(yc,_c,((e,t,n)=>{const r=$a._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.deletionPosition.hasSameParentAs(e.sourcePosition)&&r.containsPosition(t.sourcePosition))if("remove"!=e.type||n.forceWeakRemove){if(1==e.howMany)return n.bWasUndone?(e.sourcePosition=t.graveyardPosition.clone(),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]):[new af(0)]}else if(!n.aWasUndone){const n=[];let r=t.graveyardPosition.clone(),i=t.targetPosition._getTransformedByMergeOperation(t);e.howMany>1&&(n.push(new yc(e.sourcePosition,e.howMany-1,e.targetPosition,0)),r=r._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany-1),i=i._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany-1));const o=t.deletionPosition._getCombined(e.sourcePosition,e.targetPosition),a=new yc(r,1,o,0),s=a.getMovedRangeStart().path.slice();s.push(0);const c=new Ka(a.targetPosition.root,s);i=i._getTransformedByMove(r,o,1);const u=new yc(i,t.howMany,c,0);return n.push(a),n.push(u),n}const i=$a._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByMergeOperation(t);return e.sourcePosition=i.start,e.howMany=i.end.offset-i.start.offset,e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]})),cf(vc,gc,((e,t)=>(e.position=e.position._getTransformedByInsertOperation(t),[e]))),cf(vc,_c,((e,t)=>e.position.isEqual(t.deletionPosition)?(e.position=t.graveyardPosition.clone(),e.position.stickiness="toNext",[e]):(e.position=e.position._getTransformedByMergeOperation(t),[e]))),cf(vc,yc,((e,t)=>(e.position=e.position._getTransformedByMoveOperation(t),[e]))),cf(vc,vc,((e,t,n)=>{if(e.position.isEqual(t.position)){if(!n.aIsStrong)return[new af(0)];e.oldName=t.newName}return[e]})),cf(vc,kc,((e,t)=>{if("same"==lr(e.position.path,t.splitPosition.getParentPath())&&!t.graveyardPosition){const t=new vc(e.position.getShiftedBy(1),e.oldName,e.newName,0);return[e,t]}return e.position=e.position._getTransformedBySplitOperation(t),[e]})),cf(wc,wc,((e,t,n)=>{if(e.root===t.root&&e.key===t.key){if(!n.aIsStrong||e.newValue===t.newValue)return[new af(0)];e.oldValue=t.newValue}return[e]})),cf(kc,gc,((e,t)=>(e.splitPosition.hasSameParentAs(t.position)&&e.splitPosition.offset<t.position.offset&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByInsertOperation(t),e.insertionPosition=kc.getInsertionPosition(e.splitPosition),[e]))),cf(kc,_c,((e,t,n)=>{if(!e.graveyardPosition&&!n.bWasUndone&&e.splitPosition.hasSameParentAs(t.sourcePosition)){const n=t.graveyardPosition.path.slice();n.push(0);const r=new Ka(t.graveyardPosition.root,n),i=kc.getInsertionPosition(new Ka(t.graveyardPosition.root,n)),o=new kc(r,0,null,0);return o.insertionPosition=i,e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=kc.getInsertionPosition(e.splitPosition),e.graveyardPosition=o.insertionPosition.clone(),e.graveyardPosition.stickiness="toNext",[o,e]}return e.splitPosition.hasSameParentAs(t.deletionPosition)&&!e.splitPosition.isAfter(t.deletionPosition)&&e.howMany--,e.splitPosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=kc.getInsertionPosition(e.splitPosition),e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e]})),cf(kc,yc,((e,t,n)=>{const r=$a._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.graveyardPosition){const i=r.start.isEqual(e.graveyardPosition)||r.containsPosition(e.graveyardPosition);if(!n.bWasUndone&&i){const n=e.splitPosition._getTransformedByMoveOperation(t),r=e.graveyardPosition._getTransformedByMoveOperation(t),i=r.path.slice();i.push(0);const o=new Ka(r.root,i);return[new yc(n,e.howMany,o,0)]}e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)}if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&r.containsPosition(e.splitPosition)){const n=t.howMany-(e.splitPosition.offset-t.sourcePosition.offset);return e.howMany-=n,e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany),e.splitPosition=t.sourcePosition.clone(),e.insertionPosition=kc.getInsertionPosition(e.splitPosition),[e]}return!e.splitPosition.isEqual(t.targetPosition)||"insertAtSource"!=n.baRelation&&"splitBefore"!=n.abRelation?(t.sourcePosition.isEqual(t.targetPosition)||(e.splitPosition.hasSameParentAs(t.sourcePosition)&&e.splitPosition.offset<=t.sourcePosition.offset&&(e.howMany-=t.howMany),e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany)),e.splitPosition.stickiness="toNone",e.splitPosition=e.splitPosition._getTransformedByMoveOperation(t),e.splitPosition.stickiness="toNext",e.graveyardPosition?e.insertionPosition=e.insertionPosition._getTransformedByMoveOperation(t):e.insertionPosition=kc.getInsertionPosition(e.splitPosition),[e]):(e.howMany+=t.howMany,e.splitPosition=e.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),e.insertionPosition=kc.getInsertionPosition(e.splitPosition),[e])})),cf(kc,kc,((e,t,n)=>{if(e.splitPosition.isEqual(t.splitPosition)){if(!e.graveyardPosition&&!t.graveyardPosition)return[new af(0)];if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition))return[new af(0)];if("splitBefore"==n.abRelation)return e.howMany=0,e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t),[e]}if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition)){const r="$graveyard"==e.splitPosition.root.rootName,i="$graveyard"==t.splitPosition.root.rootName,o=r&&!i;if(i&&!r||!o&&n.aIsStrong){const n=[];return t.howMany&&n.push(new yc(t.moveTargetPosition,t.howMany,t.splitPosition,0)),e.howMany&&n.push(new yc(e.splitPosition,e.howMany,e.moveTargetPosition,0)),n}return[new af(0)]}if(e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t)),e.splitPosition.isEqual(t.insertionPosition)&&"splitBefore"==n.abRelation)return e.howMany++,[e];if(t.splitPosition.isEqual(e.insertionPosition)&&"splitBefore"==n.baRelation){const n=t.insertionPosition.path.slice();n.push(0);const r=new Ka(t.insertionPosition.root,n);return[e,new yc(e.insertionPosition,1,r,0)]}return e.splitPosition.hasSameParentAs(t.splitPosition)&&e.splitPosition.offset<t.splitPosition.offset&&(e.howMany-=t.howMany),e.splitPosition=e.splitPosition._getTransformedBySplitOperation(t),e.insertionPosition=kc.getInsertionPosition(e.splitPosition),[e]}));class bf extends jl{constructor(e){super(e),this._stack=[],this._createdBatches=new WeakSet,this.refresh()}refresh(){this.isEnabled=this._stack.length>0}addBatch(e){const t=this.editor.model.document.selection,n={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:n}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,t,n){const r=this.editor.model,i=r.document,o=[];for(const t of e){const e=vf(t,n).find((e=>e.start.root!=i.graveyard));e&&o.push(e)}o.length&&r.change((e=>{e.setSelection(o,{backward:t})}))}_undo(e,t){const n=this.editor.model,r=n.document;this._createdBatches.add(t);const i=e.operations.slice().filter((e=>e.isDocumentOperation));i.reverse();for(const e of i){const i=e.baseVersion+1,o=Array.from(r.history.getOperations(i)),a=ff([e.getReversed()],o,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(const i of a)t.addOperation(i),n.applyOperation(i),r.history.setOperationAsUndone(e,i)}}}function vf(e,t){const n=e.getTransformedByOperations(t);n.sort(((e,t)=>e.start.isBefore(t.start)?-1:1));for(let e=1;e<n.length;e++){const t=n[e-1],r=n[e];t.end.isTouching(r.start)&&(t.end=r.end,n.splice(e,1),e--)}return n}class wf extends bf{execute(e=null){const t=e?this._stack.findIndex((t=>t.batch==e)):this._stack.length-1,n=this._stack.splice(t,1)[0],r=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(r,(()=>{this._undo(n.batch,r);const e=this.editor.model.document.history.getOperations(n.batch.baseVersion);this._restoreSelection(n.selection.ranges,n.selection.isBackward,e),this.fire("revert",n.batch,r)})),this.refresh()}}class _f extends bf{execute(){const e=this._stack.pop(),t=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(t,(()=>{const n=e.batch.operations[e.batch.operations.length-1].baseVersion+1,r=this.editor.model.document.history.getOperations(n);this._restoreSelection(e.selection.ranges,e.selection.isBackward,r),this._undo(e.batch,t)})),this.refresh()}}class kf extends Rl{static get pluginName(){return"UndoEditing"}constructor(e){super(e),this._batchRegistry=new WeakSet}init(){const e=this.editor;this._undoCommand=new wf(e),this._redoCommand=new _f(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",((e,t)=>{const n=t[0];if(!n.isDocumentOperation)return;const r=n.batch,i=this._redoCommand._createdBatches.has(r),o=this._undoCommand._createdBatches.has(r);this._batchRegistry.has(r)||"transparent"==r.type&&!i&&!o||(i?this._undoCommand.addBatch(r):o||(this._undoCommand.addBatch(r),this._redoCommand.clearStack()),this._batchRegistry.add(r))}),{priority:"highest"}),this.listenTo(this._undoCommand,"revert",((e,t,n)=>{this._redoCommand.addBatch(n)})),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo")}}var Ef='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.042 9.367l2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',Of='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M14.958 9.367l-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';class Tf extends Rl{init(){const e=this.editor,t=e.locale,n=e.t,r="ltr"==t.uiLanguageDirection?Ef:Of,i="ltr"==t.uiLanguageDirection?Of:Ef;this._addButton("undo",n("bs"),"CTRL+Z",r),this._addButton("redo",n("bt"),"CTRL+Y",i)}_addButton(e,t,n,r){const i=this.editor;i.ui.componentFactory.add(e,(o=>{const a=i.commands.get(e),s=new hl(o);return s.set({label:t,icon:r,keystroke:n,tooltip:!0}),s.bind("isEnabled").to(a,"isEnabled"),this.listenTo(s,"execute",(()=>i.execute(e))),s}))}}class xf extends Rl{static get requires(){return[kf,Tf]}static get pluginName(){return"Undo"}}class Sf extends Rl{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new oi({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if("string"!=typeof e)throw new Jn.b("pendingactions-add-invalid-message: The message must be a string.",this);const t=Object.create(Ur);return t.set("message",e),this._actions.add(t),this.hasAny=!0,t}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}class Cf{constructor(){const e=new window.FileReader;this._reader=e,this._data=void 0,this.set("loaded",0),e.onprogress=e=>{this.loaded=e.loaded}}get error(){return this._reader.error}get data(){return this._data}read(e){const t=this._reader;return this.total=e.size,new Promise(((n,r)=>{t.onload=()=>{const e=t.result;this._data=e,n(e)},t.onerror=()=>{r("error")},t.onabort=()=>{r("aborted")},this._reader.readAsDataURL(e)}))}abort(){this._reader.abort()}}ur(Cf,Ur);class Rf extends Rl{static get pluginName(){return"FileRepository"}static get requires(){return[Sf]}init(){this.loaders=new oi,this.loaders.on("add",(()=>this._updatePendingAction())),this.loaders.on("remove",(()=>this._updatePendingAction())),this._loadersMap=new Map,this._pendingAction=null,this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",((e,t)=>t?e/t*100:0))}getLoader(e){return this._loadersMap.get(e)||null}createLoader(e){if(!this.createUploadAdapter)return console.warn(Object(Jn.a)("filerepository-no-upload-adapter: Upload adapter is not defined.")),null;const t=new Pf(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(t),this._loadersMap.set(e,t),e instanceof Promise&&t.file.then((e=>{this._loadersMap.set(e,t)})).catch((()=>{})),t.on("change:uploaded",(()=>{let e=0;for(const t of this.loaders)e+=t.uploaded;this.uploaded=e})),t.on("change:uploadTotal",(()=>{let e=0;for(const t of this.loaders)t.uploadTotal&&(e+=t.uploadTotal);this.uploadTotal=e})),t}destroyLoader(e){const t=e instanceof Pf?e:this.getLoader(e);t._destroy(),this.loaders.remove(t),this._loadersMap.forEach(((e,n)=>{e===t&&this._loadersMap.delete(n)}))}_updatePendingAction(){const e=this.editor.plugins.get(Sf);if(this.loaders.length){if(!this._pendingAction){const t=this.editor.t,n=e=>`${t("ay")} ${parseInt(e)}%.`;this._pendingAction=e.add(n(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",n)}}else e.remove(this._pendingAction),this._pendingAction=null}}ur(Rf,Ur);class Pf{constructor(e,t){this.id=Xn(),this._filePromiseWrapper=this._createFilePromiseWrapper(e),this._adapter=t(this),this._reader=new Cf,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",((e,t)=>t?e/t*100:0)),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then((e=>this._filePromiseWrapper?e:null)):Promise.resolve(null)}get data(){return this._reader.data}read(){if("idle"!=this.status)throw new Jn.b("filerepository-read-wrong-status: You cannot call read if the status is different than idle.",this);return this.status="reading",this.file.then((e=>this._reader.read(e))).then((e=>{if("reading"!==this.status)throw this.status;return this.status="idle",e})).catch((e=>{if("aborted"===e)throw this.status="aborted","aborted";throw this.status="error",this._reader.error?this._reader.error:e}))}upload(){if("idle"!=this.status)throw new Jn.b("filerepository-upload-wrong-status: You cannot call upload if the status is different than idle.",this);return this.status="uploading",this.file.then((()=>this._adapter.upload())).then((e=>(this.uploadResponse=e,this.status="idle",e))).catch((e=>{if("aborted"===this.status)throw"aborted";throw this.status="error",e}))}abort(){const e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?"reading"==e?this._reader.abort():"uploading"==e&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch((()=>{})),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(e){const t={};return t.promise=new Promise(((n,r)=>{t.rejecter=r,t.isFulfilled=!1,e.then((e=>{t.isFulfilled=!0,n(e)})).catch((e=>{t.isFulfilled=!0,r(e)}))})),t}}ur(Pf,Ur);const Nf="ckCsrfToken",Mf=40,Af="abcdefghijklmnopqrstuvwxyz0123456789";function jf(){let e=function(e){e=e.toLowerCase();const t=document.cookie.split(";");for(const n of t){const t=n.split("=");if(decodeURIComponent(t[0].trim().toLowerCase())===e)return decodeURIComponent(t[1])}return null}(Nf);var t,n;return e&&e.length==Mf||(e=function(e){let t="";const n=new Uint8Array(e);window.crypto.getRandomValues(n);for(let e=0;e<n.length;e++){const r=Af.charAt(n[e]%Af.length);t+=Math.random()>.5?r.toUpperCase():r}return t}(Mf),t=Nf,n=e,document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(n)+";path=/"),e}class If extends Rl{static get requires(){return[Rf]}static get pluginName(){return"CKFinderUploadAdapter"}init(){const e=this.editor.config.get("ckfinder.uploadUrl");e&&(this.editor.plugins.get(Rf).createUploadAdapter=t=>new Df(t,e,this.editor.t))}}class Df{constructor(e,t,n){this.loader=e,this.url=t,this.t=n}upload(){return this.loader.file.then((e=>new Promise(((t,n)=>{this._initRequest(),this._initListeners(t,n,e),this._sendRequest(e)}))))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const e=this.xhr=new XMLHttpRequest;e.open("POST",this.url,!0),e.responseType="json"}_initListeners(e,t,n){const r=this.xhr,i=this.loader,o=(0,this.t)("a")+` ${n.name}.`;r.addEventListener("error",(()=>t(o))),r.addEventListener("abort",(()=>t())),r.addEventListener("load",(()=>{const n=r.response;if(!n||!n.uploaded)return t(n&&n.error&&n.error.message?n.error.message:o);e({default:n.url})})),r.upload&&r.upload.addEventListener("progress",(e=>{e.lengthComputable&&(i.uploadTotal=e.total,i.uploaded=e.loaded)}))}_sendRequest(e){const t=new FormData;t.append("upload",e),t.append("ckCsrfToken",jf()),this.xhr.send(t)}}class Lf{static get pluginName(){return"BlockAutoformatEditing"}constructor(e,t,n){let r,i=null;"function"==typeof n?r=n:(i=e.commands.get(n),r=()=>{e.execute(n)}),e.model.document.on("change",((n,o)=>{if(i&&!i.isEnabled)return;if("transparent"==o.type)return;const a=Array.from(e.model.document.differ.getChanges()),s=a[0];if(1!=a.length||"insert"!==s.type||"$text"!=s.name||1!=s.length)return;const c=s.position.parent;if(!c.is("paragraph")||1!==c.childCount)return;const u=t.exec(c.getChild(0).data);u&&e.model.enqueueChange((e=>{const t=e.createPositionAt(c,0),n=e.createPositionAt(c,u[0].length),i=new cs(t,n);!1!==r({match:u})&&e.remove(i),i.detach()}))}))}}class Bf{static get pluginName(){return"InlineAutoformatEditing"}constructor(e,t,n){let r,i,o,a;t instanceof RegExp?r=t:o=t,"string"==typeof n?i=n:a=n,o=o||(e=>{let t;const n=[],i=[];for(;null!==(t=r.exec(e))&&!(t&&t.length<4);){let{index:e,1:r,2:o,3:a}=t;const s=r+o+a;e+=t[0].length-s.length;const c=[e,e+r.length],u=[e+r.length+o.length,e+r.length+o.length+a.length];n.push(c),n.push(u),i.push([e+r.length,e+r.length+o.length])}return{remove:n,format:i}}),a=a||((t,n)=>{const r=e.model.schema.getValidRanges(n,i);for(const e of r)t.setAttribute(i,!0,e);t.removeSelectionAttribute(i)}),e.model.document.on("change",((t,n)=>{if("transparent"==n.type)return;const r=e.model,i=r.document.selection;if(!i.isCollapsed)return;const s=Array.from(r.document.differ.getChanges()),c=s[0];if(1!=s.length||"insert"!==c.type||"$text"!=c.name||1!=c.length)return;const u=i.focus,l=u.parent,{text:f,range:h}=function(e,t){let n=e.start;return{text:Array.from(e.getItems()).reduce(((e,r)=>r.is("text")||r.is("textProxy")?e+r.data:(n=t.createPositionAfter(r),"")),""),range:t.createRange(n,e.end)}}(r.createRange(r.createPositionAt(l,0),u),r),d=o(f),p=Ff(h.start,d.format,r),m=Ff(h.start,d.remove,r);p.length&&m.length&&r.enqueueChange((e=>{if(!1!==a(e,p))for(const t of m.reverse())e.remove(t)}))}))}}function Ff(e,t,n){return t.filter((e=>void 0!==e[0]&&void 0!==e[1])).map((t=>n.createRange(e.getShiftedBy(t[0]),e.getShiftedBy(t[1]))))}function qf(e,t){return(n,r)=>{if(!e.commands.get(t).isEnabled)return!1;const i=e.model.schema.getValidRanges(r,t);for(const e of i)n.setAttribute(t,!0,e);n.removeSelectionAttribute(t)}}class Vf extends jl{constructor(e,t){super(e),this.attributeKey=t}refresh(){const e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey)}execute(e={}){const t=this.editor.model,n=t.document.selection,r=void 0===e.forceValue?!this.value:e.forceValue;t.change((e=>{if(n.isCollapsed)r?e.setSelectionAttribute(this.attributeKey,!0):e.removeSelectionAttribute(this.attributeKey);else{const i=t.schema.getValidRanges(n.getRanges(),this.attributeKey);for(const t of i)r?e.setAttribute(this.attributeKey,r,t):e.removeAttribute(this.attributeKey,t)}}))}_getValueFromFirstAllowedNode(){const e=this.editor.model,t=e.schema,n=e.document.selection;if(n.isCollapsed)return n.hasAttribute(this.attributeKey);for(const e of n.getRanges())for(const n of e.getItems())if(t.checkAttribute(n,this.attributeKey))return n.hasAttribute(this.attributeKey);return!1}}const Uf="bold";class Hf extends Rl{static get pluginName(){return"BoldEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Uf}),e.model.schema.setAttributeProperties(Uf,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Uf,view:"strong",upcastAlso:["b",e=>{const t=e.getStyle("font-weight");return t?"bold"==t||Number(t)>=600?{name:!0,styles:["font-weight"]}:void 0:null}]}),e.commands.add(Uf,new Vf(e,Uf)),e.keystrokes.set("CTRL+B",Uf)}}var zf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>';const Wf="bold";class Yf extends Rl{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Wf,(n=>{const r=e.commands.get(Wf),i=new hl(n);return i.set({label:t("ag"),icon:zf,keystroke:"CTRL+B",tooltip:!0,isToggleable:!0}),i.bind("isOn","isEnabled").to(r,"value","isEnabled"),this.listenTo(i,"execute",(()=>e.execute(Wf))),i}))}}const Qf="italic";class Gf extends Rl{static get pluginName(){return"ItalicEditing"}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:Qf}),e.model.schema.setAttributeProperties(Qf,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:Qf,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(Qf,new Vf(e,Qf)),e.keystrokes.set("CTRL+I",Qf)}}var Jf='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.586 14.633l.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';const Kf="italic";class $f extends Rl{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add(Kf,(n=>{const r=e.commands.get(Kf),i=new hl(n);return i.set({label:t("d"),icon:Jf,keystroke:"CTRL+I",tooltip:!0,isToggleable:!0}),i.bind("isOn","isEnabled").to(r,"value","isEnabled"),this.listenTo(i,"execute",(()=>e.execute(Kf))),i}))}}function Xf(e){const t=e.next();return t.done?null:t.value}class Zf extends jl{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const t=this.editor.model,n=t.schema,r=t.document.selection,i=Array.from(r.getSelectedBlocks()),o=void 0===e.forceValue?!this.value:e.forceValue;t.change((e=>{if(o){const t=i.filter((e=>eh(e)||nh(n,e)));this._applyQuote(e,t)}else this._removeQuote(e,i.filter(eh))}))}_getValue(){const e=Xf(this.editor.model.document.selection.getSelectedBlocks());return!(!e||!eh(e))}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,n=Xf(e.getSelectedBlocks());return!!n&&nh(t,n)}_removeQuote(e,t){th(e,t).reverse().forEach((t=>{if(t.start.isAtStart&&t.end.isAtEnd)return void e.unwrap(t.start.parent);if(t.start.isAtStart){const n=e.createPositionBefore(t.start.parent);return void e.move(t,n)}t.end.isAtEnd||e.split(t.end);const n=e.createPositionAfter(t.end.parent);e.move(t,n)}))}_applyQuote(e,t){const n=[];th(e,t).reverse().forEach((t=>{let r=eh(t.start);r||(r=e.createElement("blockQuote"),e.wrap(t,r)),n.push(r)})),n.reverse().reduce(((t,n)=>t.nextSibling==n?(e.merge(e.createPositionAfter(t)),t):n))}}function eh(e){return"blockQuote"==e.parent.name?e.parent:null}function th(e,t){let n,r=0;const i=[];for(;r<t.length;){const o=t[r],a=t[r+1];n||(n=e.createPositionBefore(o)),a&&o.nextSibling==a||(i.push(e.createRange(n,e.createPositionAfter(o))),n=null),r++}return i}function nh(e,t){const n=e.checkChild(t.parent,"blockQuote"),r=e.checkChild(["$root","blockQuote"],t);return n&&r}class rh extends Rl{static get pluginName(){return"BlockQuoteEditing"}init(){const e=this.editor,t=e.model.schema;e.commands.add("blockQuote",new Zf(e)),t.register("blockQuote",{allowWhere:"$block",allowContentOf:"$root"}),t.addChildCheck(((e,t)=>{if(e.endsWith("blockQuote")&&"blockQuote"==t.name)return!1})),e.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),e.model.document.registerPostFixer((n=>{const r=e.model.document.differ.getChanges();for(const e of r)if("insert"==e.type){const r=e.position.nodeAfter;if(!r)continue;if(r.is("blockQuote")&&r.isEmpty)return n.remove(r),!0;if(r.is("blockQuote")&&!t.checkChild(e.position,r))return n.unwrap(r),!0;if(r.is("element")){const e=n.createRangeIn(r);for(const r of e.getItems())if(r.is("blockQuote")&&!t.checkChild(n.createPositionBefore(r),r))return n.unwrap(r),!0}}else if("remove"==e.type){const t=e.position.parent;if(t.is("blockQuote")&&t.isEmpty)return n.remove(t),!0}return!1}))}afterInit(){const e=this.editor.commands.get("blockQuote");this.listenTo(this.editor.editing.view.document,"enter",((t,n)=>{const r=this.editor.model.document,i=r.selection.getLastPosition().parent;r.selection.isCollapsed&&i.isEmpty&&e.value&&(this.editor.execute("blockQuote"),this.editor.editing.view.scrollToTheSelection(),n.preventDefault(),t.stop())}))}}var ih='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>';n(43);class oh extends Rl{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("blockQuote",(n=>{const r=e.commands.get("blockQuote"),i=new hl(n);return i.set({label:t("h"),icon:ih,tooltip:!0,isToggleable:!0}),i.bind("isOn","isEnabled").to(r,"value","isEnabled"),this.listenTo(i,"execute",(()=>e.execute("blockQuote"))),i}))}}var ah='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>';class sh extends Rl{static get pluginName(){return"CKFinderUI"}init(){const e=this.editor,t=e.ui.componentFactory,n=e.t;t.add("ckfinder",(t=>{const r=e.commands.get("ckfinder"),i=new hl(t);return i.set({label:n("g"),icon:ah,tooltip:!0}),i.bind("isEnabled").to(r),i.on("execute",(()=>{e.execute("ckfinder"),e.editing.view.focus()})),i}))}}class ch extends mo{observe(e){this.listenTo(e,"load",((e,t)=>{"IMG"==t.target.tagName&&this._fireEvents(t)}),{useCapture:!0})}_fireEvents(e){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",e))}}function uh(e){return n=>{n.on(`attribute:${e}:image`,t)};function t(e,t,n){if(!n.consumable.consume(t.item,e.name))return;const r=n.writer,i=n.mapper.toViewElement(t.item).getChild(0);null!==t.attributeNewValue?r.setAttribute(t.attributeKey,t.attributeNewValue,i):r.removeAttribute(t.attributeKey,i)}}class lh{constructor(){this._stack=[]}add(e,t){const n=this._stack,r=n[0];this._insertDescriptor(e);const i=n[0];r===i||fh(r,i)||this.fire("change:top",{oldDescriptor:r,newDescriptor:i,writer:t})}remove(e,t){const n=this._stack,r=n[0];this._removeDescriptor(e);const i=n[0];r===i||fh(r,i)||this.fire("change:top",{oldDescriptor:r,newDescriptor:i,writer:t})}_insertDescriptor(e){const t=this._stack,n=t.findIndex((t=>t.id===e.id));if(fh(e,t[n]))return;n>-1&&t.splice(n,1);let r=0;for(;t[r]&&hh(t[r],e);)r++;t.splice(r,0,e)}_removeDescriptor(e){const t=this._stack,n=t.findIndex((t=>t.id===e));n>-1&&t.splice(n,1)}}function fh(e,t){return e&&t&&e.priority==t.priority&&dh(e.classes)==dh(t.classes)}function hh(e,t){return e.priority>t.priority||!(e.priority<t.priority)&&dh(e.classes)>dh(t.classes)}function dh(e){return Array.isArray(e)?e.sort().join(","):e}ur(lh,nr);var ph='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';const mh="ck-widget",yh="ck-widget_selected";function gh(e){return!!e.is("element")&&!!e.getCustomProperty("widget")}function bh(e,t,n={}){return pi.isEdge||t.setAttribute("contenteditable","false",e),t.addClass(mh,e),t.setCustomProperty("widget",!0,e),e.getFillerOffset=kh,n.label&&function(e,t,n){n.setCustomProperty("widgetLabel",t,e)}(e,n.label,t),n.hasSelectionHandle&&function(e,t){const n=t.createUIElement("div",{class:"ck ck-widget__selection-handle"},(function(e){const t=this.toDomElement(e),n=new ll;return n.set("content",ph),n.render(),t.appendChild(n.element),t}));t.insert(t.createPositionAt(e,0),n),t.addClass(["ck-widget_with-selection-handle"],e)}(e,t),function(e,t,n,r){const i=new lh;i.on("change:top",((t,i)=>{i.oldDescriptor&&r(e,i.oldDescriptor,i.writer),i.newDescriptor&&n(e,i.newDescriptor,i.writer)})),t.setCustomProperty("addHighlight",((e,t,n)=>i.add(t,n)),e),t.setCustomProperty("removeHighlight",((e,t,n)=>i.remove(t,n)),e)}(e,t,((e,t,n)=>n.addClass(r(t.classes),e)),((e,t,n)=>n.removeClass(r(t.classes),e))),e;function r(e){return Array.isArray(e)?e:[e]}}function vh(e){const t=e.getCustomProperty("widgetLabel");return t?"function"==typeof t?t():t:""}function wh(e,t){return t.addClass(["ck-editor__editable","ck-editor__nested-editable"],e),pi.isEdge||(t.setAttribute("contenteditable",e.isReadOnly?"false":"true",e),e.on("change:isReadOnly",((n,r,i)=>{t.setAttribute("contenteditable",i?"false":"true",e)}))),e.on("change:isFocused",((n,r,i)=>{i?t.addClass("ck-editor__nested-editable_focused",e):t.removeClass("ck-editor__nested-editable_focused",e)})),e}function _h(e,t){const n=e.getSelectedElement();if(n&&t.schema.isBlock(n))return t.createPositionAfter(n);const r=e.getSelectedBlocks().next().value;if(r){if(r.isEmpty)return t.createPositionAt(r,0);const n=t.createPositionAfter(r);return e.focus.isTouching(n)?n:t.createPositionBefore(r)}return e.focus}function kh(){return null}function Eh(e){const t=e.getSelectedElement();return t&&function(e){return!!e.getCustomProperty("image")&&gh(e)}(t)?t:null}function Oh(e){return!!e&&e.is("image")}function Th(e,t,n={}){const r=e.createElement("image",n),i=_h(t.document.selection,t);t.insertContent(r,i),r.parent&&e.setSelection(r,"on")}function xh(e){const t=e.schema,n=e.document.selection;return function(e,t,n){const r=function(e,t){const n=_h(e,t).parent;return n.isEmpty&&!n.is("$root")?n.parent:n}(e,n);return t.checkChild(r,"image")}(n,t,e)&&!function(e,t){const n=e.getSelectedElement();return n&&t.isObject(n)}(n,t)&&function(e){return[...e.focus.getAncestors()].every((e=>!e.is("image")))}(n)}class Sh extends jl{refresh(){this.isEnabled=xh(this.editor.model)}execute(e){const t=this.editor.model;t.change((n=>{const r=Array.isArray(e.source)?e.source:[e.source];for(const e of r)Th(n,t,{src:e})}))}}class Ch extends Rl{static get pluginName(){return"ImageEditing"}init(){const e=this.editor,t=e.model.schema,n=e.t,r=e.conversion;e.editing.view.addObserver(ch),t.register("image",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),r.for("dataDowncast").elementToElement({model:"image",view:(e,t)=>Rh(t)}),r.for("editingDowncast").elementToElement({model:"image",view:(e,t)=>function(e,t,n){return t.setCustomProperty("image",!0,e),bh(e,t,{label:function(){const t=e.getChild(0).getAttribute("alt");return t?`${t} ${n}`:n}})}(Rh(t),t,n("i"))}),r.for("downcast").add(uh("src")).add(uh("alt")).add(function(){return t=>{t.on("attribute:srcset:image",e)};function e(e,t,n){if(!n.consumable.consume(t.item,e.name))return;const r=n.writer,i=n.mapper.toViewElement(t.item).getChild(0);if(null===t.attributeNewValue){const e=t.attributeOldValue;e.data&&(r.removeAttribute("srcset",i),r.removeAttribute("sizes",i),e.width&&r.removeAttribute("width",i))}else{const e=t.attributeNewValue;e.data&&(r.setAttribute("srcset",e.data,i),r.setAttribute("sizes","100vw",i),e.width&&r.setAttribute("width",e.width,i))}}}()),r.for("upcast").elementToElement({view:{name:"img",attributes:{src:!0}},model:(e,t)=>t.createElement("image",{src:e.getAttribute("src")})}).attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:e=>{const t={data:e.getAttribute("srcset")};return e.hasAttribute("width")&&(t.width=e.getAttribute("width")),t}}}).add(function(){return t=>{t.on("element:figure",e)};function e(e,t,n){if(!n.consumable.test(t.viewItem,{name:!0,classes:"image"}))return;const r=Array.from(t.viewItem.getChildren()).find((e=>e.is("img")));if(!r||!r.hasAttribute("src")||!n.consumable.test(r,{name:!0}))return;const i=n.convertItem(r,t.modelCursor),o=Xf(i.modelRange.getItems());o&&(n.convertChildren(t.viewItem,n.writer.createPositionAt(o,0)),t.modelRange=i.modelRange,t.modelCursor=i.modelCursor)}}()),e.commands.add("imageInsert",new Sh(e))}}function Rh(e){const t=e.createEmptyElement("img"),n=e.createContainerElement("figure",{class:"image"});return e.insert(e.createPositionAt(n,0),t),n}function Ph(e,t,n){return n.createRange(Nh(e,t,!0,n),Nh(e,t,!1,n))}function Nh(e,t,n,r){let i=e.textNode||(n?e.nodeBefore:e.nodeAfter),o=null;for(;i&&i.getAttribute("linkHref")==t;)o=i,i=n?i.previousSibling:i.nextSibling;return o?r.createPositionAt(o,n?"before":"after"):e}class Mh extends jl{constructor(e){super(e),this.manualDecorators=new oi}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,t=e.document;this.value=t.selection.getAttribute("linkHref");for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id);this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"linkHref")}execute(e,t={}){const n=this.editor.model,r=n.document.selection,i=[],o=[];for(const e in t)t[e]?i.push(e):o.push(e);n.change((t=>{if(r.isCollapsed){const a=r.getFirstPosition();if(r.hasAttribute("linkHref")){const s=Ph(a,r.getAttribute("linkHref"),n);t.setAttribute("linkHref",e,s),i.forEach((e=>{t.setAttribute(e,!0,s)})),o.forEach((e=>{t.removeAttribute(e,s)})),t.setSelection(s)}else if(""!==e){const o=Va(r.getAttributes());o.set("linkHref",e),i.forEach((e=>{o.set(e,!0)}));const s=t.createText(e,o);n.insertContent(s,a),t.setSelection(t.createRangeOn(s))}}else{const a=n.schema.getValidRanges(r.getRanges(),"linkHref");for(const n of a)t.setAttribute("linkHref",e,n),i.forEach((e=>{t.setAttribute(e,!0,n)})),o.forEach((e=>{t.removeAttribute(e,n)}))}}))}_getDecoratorStateFromModel(e){return this.editor.model.document.selection.getAttribute(e)||!1}}class Ah extends jl{refresh(){this.isEnabled=this.editor.model.document.selection.hasAttribute("linkHref")}execute(){const e=this.editor,t=this.editor.model,n=t.document.selection,r=e.commands.get("link");t.change((e=>{const i=n.isCollapsed?[Ph(n.getFirstPosition(),n.getAttribute("linkHref"),t)]:n.getRanges();for(const t of i)if(e.removeAttribute("linkHref",t),r)for(const n of r.manualDecorators)e.removeAttribute(n.id,t)}))}}var jh=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o},Ih=function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:jh(e,t,n)},Dh=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),Lh=function(e){return Dh.test(e)},Bh=function(e){return e.split("")},Fh="[\\ud800-\\udfff]",qh="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Vh="\\ud83c[\\udffb-\\udfff]",Uh="[^\\ud800-\\udfff]",Hh="(?:\\ud83c[\\udde6-\\uddff]){2}",zh="[\\ud800-\\udbff][\\udc00-\\udfff]",Wh="(?:"+qh+"|"+Vh+")?",Yh="[\\ufe0e\\ufe0f]?"+Wh+"(?:\\u200d(?:"+[Uh,Hh,zh].join("|")+")[\\ufe0e\\ufe0f]?"+Wh+")*",Qh="(?:"+[Uh+qh+"?",qh,Hh,zh,Fh].join("|")+")",Gh=RegExp(Vh+"(?="+Vh+")|"+Qh+Yh,"g"),Jh=function(e){return e.match(Gh)||[]},Kh=function(e){return Lh(e)?Jh(e):Bh(e)},$h=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},Xh=1/0,Zh=i?i.prototype:void 0,ed=Zh?Zh.toString:void 0,td=function e(t){if("string"==typeof t)return t;if(Ye(t))return $h(t,e)+"";if(sa(t))return ed?ed.call(t):"";var n=t+"";return"0"==n&&1/t==-Xh?"-0":n},nd=function(e){return null==e?"":td(e)},rd=function(e){return function(t){t=nd(t);var n=Lh(t)?Kh(t):void 0,r=n?n[0]:t.charAt(0),i=n?Ih(n,1).join(""):t.slice(1);return r[e]()+i}}("toUpperCase");const id=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,od=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i;function ad(e,t){const n=t.createAttributeElement("a",{href:e},{priority:5});return t.setCustomProperty("link",!0,n),n}function sd(e){return function(e){return e.replace(id,"").match(od)}(e=String(e))?e:"#"}class cd{constructor(){this._definitions=new Set}get length(){return this._definitions.size}add(e){Array.isArray(e)?e.forEach((e=>this._definitions.add(e))):this._definitions.add(e)}getDispatcher(){return e=>{e.on("attribute:linkHref",((e,t,n)=>{if(!n.consumable.test(t.item,"attribute:linkHref"))return;const r=n.writer,i=r.document.selection;for(const e of this._definitions){const o=r.createAttributeElement("a",e.attributes,{priority:5});r.setCustomProperty("link",!0,o),e.callback(t.attributeNewValue)?t.item.is("selection")?r.wrap(i.getFirstRange(),o):r.wrap(n.mapper.toViewRange(t.range),o):r.unwrap(n.mapper.toViewRange(t.range),o)}}),{priority:"high"})}}}class ud{constructor({id:e,label:t,attributes:n}){this.id=e,this.set("value"),this.label=t,this.attributes=n}}ur(ud,Ur);class ld{constructor(e,t,n){this.model=e,this.attribute=n,this._modelSelection=e.document.selection,this._overrideUid=null,this._isNextGravityRestorationSkipped=!1,t.listenTo(this._modelSelection,"change:range",((e,t)=>{this._isNextGravityRestorationSkipped?this._isNextGravityRestorationSkipped=!1:this._isGravityOverridden&&(!t.directChange&&fd(this._modelSelection.getFirstPosition(),n)||this._restoreGravity())}))}handleForwardMovement(e,t){const n=this.attribute;if(!(this._isGravityOverridden||e.isAtStart&&this._hasSelectionAttribute))return pd(e,n)&&this._hasSelectionAttribute?(this._preventCaretMovement(t),this._removeSelectionAttribute(),!0):hd(e,n)||dd(e,n)&&this._hasSelectionAttribute?(this._preventCaretMovement(t),this._overrideGravity(),!0):void 0}handleBackwardMovement(e,t){const n=this.attribute;return this._isGravityOverridden?pd(e,n)&&this._hasSelectionAttribute?(this._preventCaretMovement(t),this._restoreGravity(),this._removeSelectionAttribute(),!0):(this._preventCaretMovement(t),this._restoreGravity(),e.isAtStart&&this._removeSelectionAttribute(),!0):pd(e,n)&&!this._hasSelectionAttribute?(this._preventCaretMovement(t),this._setSelectionAttributeFromTheNodeBefore(e),!0):e.isAtEnd&&dd(e,n)?this._hasSelectionAttribute?void(md(e,n)&&(this._skipNextAutomaticGravityRestoration(),this._overrideGravity())):(this._preventCaretMovement(t),this._setSelectionAttributeFromTheNodeBefore(e),!0):e.isAtStart?this._hasSelectionAttribute?(this._removeSelectionAttribute(),this._preventCaretMovement(t),!0):void 0:void(md(e,n)&&(this._skipNextAutomaticGravityRestoration(),this._overrideGravity()))}get _isGravityOverridden(){return!!this._overrideUid}get _hasSelectionAttribute(){return this._modelSelection.hasAttribute(this.attribute)}_overrideGravity(){this._overrideUid=this.model.change((e=>e.overrideSelectionGravity()))}_restoreGravity(){this.model.change((e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null}))}_preventCaretMovement(e){e.preventDefault()}_removeSelectionAttribute(){this.model.change((e=>{e.removeSelectionAttribute(this.attribute)}))}_setSelectionAttributeFromTheNodeBefore(e){const t=this.attribute;this.model.change((n=>{n.setSelectionAttribute(this.attribute,e.nodeBefore.getAttribute(t))}))}_skipNextAutomaticGravityRestoration(){this._isNextGravityRestorationSkipped=!0}}function fd(e,t){return hd(e,t)||dd(e,t)}function hd(e,t){const{nodeBefore:n,nodeAfter:r}=e,i=!!n&&n.hasAttribute(t);return!!r&&r.hasAttribute(t)&&(!i||n.getAttribute(t)!==r.getAttribute(t))}function dd(e,t){const{nodeBefore:n,nodeAfter:r}=e,i=!!n&&n.hasAttribute(t),o=!!r&&r.hasAttribute(t);return i&&(!o||n.getAttribute(t)!==r.getAttribute(t))}function pd(e,t){const{nodeBefore:n,nodeAfter:r}=e,i=!!n&&n.hasAttribute(t);if(r&&r.hasAttribute(t)&&i)return r.getAttribute(t)!==n.getAttribute(t)}function md(e,t){return fd(e.getShiftedBy(-1),t)}n(45);const yd="ck-link_selected",gd="automatic",bd="manual",vd=/^(https?:)?\/\//;class wd extends Rl{static get pluginName(){return"LinkEditing"}constructor(e){super(e),e.config.define("link",{addTargetToExternalLinks:!1})}init(){const e=this.editor,t=e.locale;e.model.schema.extend("$text",{allowAttributes:"linkHref"}),e.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:ad}),e.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(e,t)=>ad(sd(e),t)}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:e=>e.getAttribute("href")}}),e.commands.add("link",new Mh(e)),e.commands.add("unlink",new Ah(e));const n=function(e,t){const n={"Open in a new tab":e("az"),Downloadable:e("ba")};return t.forEach((e=>(e.label&&n[e.label]&&(e.label=n[e.label]),e))),t}(e.t,function(e){const t=[];if(e)for(const[n,r]of Object.entries(e)){const e=Object.assign({},r,{id:`link${rd(n)}`});t.push(e)}return t}(e.config.get("link.decorators")));this._enableAutomaticDecorators(n.filter((e=>e.mode===gd))),this._enableManualDecorators(n.filter((e=>e.mode===bd))),function({view:e,model:t,emitter:n,attribute:r,locale:i}){const o=new ld(t,n,r),a=t.document.selection;n.listenTo(e.document,"keydown",((e,t)=>{if(!a.isCollapsed)return;if(t.shiftKey||t.altKey||t.ctrlKey)return;const n=t.keyCode==gi.arrowright,r=t.keyCode==gi.arrowleft;if(!n&&!r)return;const s=a.getFirstPosition(),c=i.contentLanguageDirection;let u;u="ltr"===c&&n||"rtl"===c&&r?o.handleForwardMovement(s,t):o.handleBackwardMovement(s,t),u&&e.stop()}),{priority:Zn.get("high")+1})}({view:e.editing.view,model:e.model,emitter:this,attribute:"linkHref",locale:t}),this._setupLinkHighlight()}_enableAutomaticDecorators(e){const t=this.editor,n=new cd;t.config.get("link.addTargetToExternalLinks")&&n.add({id:"linkIsExternal",mode:gd,callback:e=>vd.test(e),attributes:{target:"_blank",rel:"noopener noreferrer"}}),n.add(e),n.length&&t.conversion.for("downcast").add(n.getDispatcher())}_enableManualDecorators(e){if(!e.length)return;const t=this.editor,n=t.commands.get("link").manualDecorators;e.forEach((e=>{t.model.schema.extend("$text",{allowAttributes:e.id}),n.add(new ud(e)),t.conversion.for("downcast").attributeToElement({model:e.id,view:(t,r)=>{if(t){const t=n.get(e.id).attributes,i=r.createAttributeElement("a",t,{priority:5});return r.setCustomProperty("link",!0,i),i}}}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:n.get(e.id).attributes},model:{key:e.id}})}))}_setupLinkHighlight(){const e=this.editor,t=e.editing.view,n=new Set;t.document.registerPostFixer((t=>{const r=e.model.document.selection;let i=!1;if(r.hasAttribute("linkHref")){const o=Ph(r.getFirstPosition(),r.getAttribute("linkHref"),e.model),a=e.editing.mapper.toViewRange(o);for(const e of a.getItems())e.is("a")&&!e.hasClass(yd)&&(t.addClass(yd,e),n.add(e),i=!0)}return i})),e.conversion.for("editingDowncast").add((e=>{function r(){t.change((e=>{for(const t of n.values())e.removeClass(yd,t),n.delete(t)}))}e.on("insert",r,{priority:"highest"}),e.on("remove",r,{priority:"highest"}),e.on("attribute",r,{priority:"highest"}),e.on("selection",r,{priority:"highest"})}))}}class _d extends Rl{static get pluginName(){return"Notification"}init(){this.on("show:warning",((e,t)=>{window.alert(t.message)}),{priority:"lowest"})}showSuccess(e,t={}){this._showNotification({message:e,type:"success",namespace:t.namespace,title:t.title})}showInfo(e,t={}){this._showNotification({message:e,type:"info",namespace:t.namespace,title:t.title})}showWarning(e,t={}){this._showNotification({message:e,type:"warning",namespace:t.namespace,title:t.title})}_showNotification(e){const t=`show:${e.type}`+(e.namespace?`:${e.namespace}`:"");this.fire(t,{message:e.message,type:e.type,title:e.title||""})}}class kd extends jl{constructor(e){super(e),this.stopListening(this.editor.model.document,"change"),this.listenTo(this.editor.model.document,"change",(()=>this.refresh()),{priority:"low"})}refresh(){const e=this.editor.commands.get("imageInsert"),t=this.editor.commands.get("link");this.isEnabled=e.isEnabled||t.isEnabled}execute(){const e=this.editor,t=this.editor.config.get("ckfinder.openerMethod")||"modal";if("popup"!=t&&"modal"!=t)throw new Jn.b('ckfinder-unknown-openerMethod: The openerMethod config option must by "popup" or "modal".',e);const n=this.editor.config.get("ckfinder.options")||{};n.chooseFiles=!0;const r=n.onInit;n.language||(n.language=e.locale.uiLanguage),n.onInit=t=>{r&&r(t),t.on("files:choose",(n=>{const r=n.data.files.toArray(),i=r.filter((e=>!e.isImage())),o=r.filter((e=>e.isImage()));for(const t of i)e.execute("link",t.getUrl());const a=[];for(const e of o){const n=e.getUrl();a.push(n||t.request("file:getProxyUrl",{file:e}))}a.length&&Ed(e,a)})),t.on("file:choose:resizedImage",(t=>{const n=t.data.resizedUrl;if(n)Ed(e,[n]);else{const t=e.plugins.get("Notification"),n=e.locale.t;t.showWarning(n("at"),{title:n("au"),namespace:"ckfinder"})}}))},window.CKFinder[t](n)}}function Ed(e,t){if(e.commands.get("imageInsert").isEnabled)e.execute("imageInsert",{source:t});else{const t=e.plugins.get("Notification"),n=e.locale.t;t.showWarning(n("av"),{title:n("aw"),namespace:"ckfinder"})}}class Od extends Rl{static get pluginName(){return"CKFinderEditing"}static get requires(){return[_d,Ch,wd]}init(){const e=this.editor;e.commands.add("ckfinder",new kd(e))}}const Td=/^data:(\S*?);base64,/;class xd{constructor(e,t,n){if(!e)throw new Jn.b("fileuploader-missing-file: File must be provided as the first argument",null);if(!t)throw new Jn.b("fileuploader-missing-token: Token must be provided as the second argument.",null);if(!n)throw new Jn.b("fileuploader-missing-api-address: Api address must be provided as the third argument.",null);this.file=function(e){if("string"!=typeof e)return!1;const t=e.match(Td);return!(!t||!t.length)}(e)?function(e,t=512){try{const n=e.match(Td)[1],r=atob(e.replace(Td,"")),i=[];for(let e=0;e<r.length;e+=t){const n=r.slice(e,e+t),o=new Array(n.length);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);i.push(new Uint8Array(o))}return new Blob(i,{type:n})}catch(e){throw new Jn.b("fileuploader-decoding-image-data-error: Problem with decoding Base64 image data.",null)}}(e):e,this._token=t,this._apiAddress=n}onProgress(e){return this.on("progress",((t,n)=>e(n))),this}onError(e){return this.once("error",((t,n)=>e(n))),this}abort(){this.xhr.abort()}send(){return this._prepareRequest(),this._attachXHRListeners(),this._sendRequest()}_prepareRequest(){const e=new XMLHttpRequest;e.open("POST",this._apiAddress),e.setRequestHeader("Authorization",this._token.value),e.responseType="json",this.xhr=e}_attachXHRListeners(){const e=this,t=this.xhr;function n(t){return()=>e.fire("error",t)}t.addEventListener("error",n("Network Error")),t.addEventListener("abort",n("Abort")),t.upload&&t.upload.addEventListener("progress",(e=>{e.lengthComputable&&this.fire("progress",{total:e.total,uploaded:e.loaded})})),t.addEventListener("load",(()=>{const e=t.status,n=t.response;if(e<200||e>299)return this.fire("error",n.message||n.error)}))}_sendRequest(){const e=new FormData,t=this.xhr;return e.append("file",this.file),new Promise(((n,r)=>{t.addEventListener("load",(()=>{const e=t.status,i=t.response;return e<200||e>299?i.message?r(new Jn.b("fileuploader-uploading-data-failed: Uploading file failed.",this,{message:i.message})):r(i.error):n(i)})),t.addEventListener("error",(()=>r(new Error("Network Error")))),t.addEventListener("abort",(()=>r(new Error("Abort")))),t.send(e)}))}}ur(xd,nr);const Sd={refreshInterval:36e5,autoRefresh:!0};class Cd{constructor(e,t=Sd){if(!e)throw new Jn.b("token-missing-token-url: A `tokenUrl` must be provided as the first constructor argument.",this);this.set("value",t.initValue),this._refresh="function"==typeof e?e:()=>function(e){return new Promise(((t,n)=>{const r=new XMLHttpRequest;r.open("GET",e),r.addEventListener("load",(()=>{const e=r.status,i=r.response;return e<200||e>299?n(new Jn.b("token-cannot-download-new-token: Cannot download new token from the provided url.",null)):t(i)})),r.addEventListener("error",(()=>n(new Error("Network Error")))),r.addEventListener("abort",(()=>n(new Error("Abort")))),r.send()}))}(e),this._options=Object.assign({},Sd,t)}init(){return new Promise(((e,t)=>{this._options.autoRefresh&&this._startRefreshing(),this.value?e(this):this._refreshToken().then(e).catch(t)}))}_refreshToken(){return this._refresh().then((e=>this.set("value",e))).then((()=>this))}destroy(){this._stopRefreshing()}_startRefreshing(){this._refreshInterval=setInterval((()=>this._refreshToken()),this._options.refreshInterval)}_stopRefreshing(){clearInterval(this._refreshInterval)}static create(e,t=Sd){return new Cd(e,t).init()}}ur(Cd,Ur);var Rd=Cd;class Pd extends Rl{static get pluginName(){return"CloudServices"}init(){const e=this.editor.config.get("cloudServices")||{};for(const t in e)this[t]=e[t];if(this.tokenUrl)return this.token=new Pd.Token(this.tokenUrl),this.token.init();this.token=null}}Pd.Token=Rd;class Nd extends Rl{static get requires(){return[Rf,Pd]}init(){const e=this.editor,t=e.plugins.get(Pd),n=t.token,r=t.uploadUrl;n&&(this._uploadGateway=new Nd._UploadGateway(n,r),e.plugins.get(Rf).createUploadAdapter=e=>new Md(this._uploadGateway,e))}}class Md{constructor(e,t){this.uploadGateway=e,this.loader=t}upload(){return this.loader.file.then((e=>(this.fileUploader=this.uploadGateway.upload(e),this.fileUploader.on("progress",((e,t)=>{this.loader.uploadTotal=t.total,this.loader.uploaded=t.uploaded})),this.fileUploader.send())))}abort(){this.fileUploader.abort()}}Nd._UploadGateway=class{constructor(e,t){if(!e)throw new Jn.b("uploadgateway-missing-token: Token must be provided.",null);if(!t)throw new Jn.b("uploadgateway-missing-api-address: Api address must be provided.",null);this._token=e,this._apiAddress=t}upload(e){return new xd(e,this._token,this._apiAddress)}};class Ad extends ra{constructor(e){super(e),this.domEventType="mousedown"}onDomEvent(e){this.fire(e.type,e)}}n(47);const jd=vi("Ctrl+A");class Id extends Rl{static get pluginName(){return"Widget"}init(){const e=this.editor.editing.view,t=e.document;this._previouslySelected=new Set,this.editor.editing.downcastDispatcher.on("selection",((e,t,n)=>{this._clearPreviouslySelectedWidgets(n.writer);const r=n.writer,i=r.document.selection,o=i.getSelectedElement();let a=null;for(const e of i.getRanges())for(const t of e){const e=t.item;gh(e)&&!Dd(e,a)&&(r.addClass(yh,e),this._previouslySelected.add(e),a=e,e==o&&r.setSelection(i.getRanges(),{fake:!0,label:vh(o)}))}}),{priority:"low"}),e.addObserver(Ad),this.listenTo(t,"mousedown",((...e)=>this._onMousedown(...e))),this.listenTo(t,"keydown",((...e)=>this._onKeydown(...e)),{priority:"high"}),this.listenTo(t,"delete",((e,t)=>{this._handleDelete("forward"==t.direction)&&(t.preventDefault(),e.stop())}),{priority:"high"})}_onMousedown(e,t){const n=this.editor,r=n.editing.view,i=r.document;let o=t.target;if(function(e){for(;e;){if(e.is("editableElement")&&!e.is("rootElement"))return!0;if(gh(e))return!1;e=e.parent}return!1}(o)){if(pi.isSafari&&t.domEvent.detail>=3){const e=n.editing.mapper.toModelElement(o);this.editor.model.change((n=>{t.preventDefault(),n.setSelection(e,"in")}))}return}if(!gh(o)&&(o=o.findAncestor(gh),!o))return;t.preventDefault(),i.isFocused||r.focus();const a=n.editing.mapper.toModelElement(o);this._setSelectionOverElement(a)}_onKeydown(e,t){const n=t.keyCode,r="ltr"===this.editor.locale.contentLanguageDirection,i=n==gi.arrowdown||n==gi[r?"arrowright":"arrowleft"];let o=!1;!function(e){return e==gi.arrowright||e==gi.arrowleft||e==gi.arrowup||e==gi.arrowdown}(n)?function(e){return bi(e)==jd}(t)?o=this._selectAllNestedEditableContent()||this._selectAllContent():n===gi.enter&&(o=this._handleEnterKey(t.shiftKey)):o=this._handleArrowKeys(i),o&&(t.preventDefault(),e.stop())}_handleDelete(e){if(this.editor.isReadOnly)return;const t=this.editor.model.document.selection;if(!t.isCollapsed)return;const n=this._getObjectElementNextToSelection(e);return n?(this.editor.model.change((e=>{let r=t.anchor.parent;for(;r.isEmpty;){const t=r;r=t.parent,e.remove(t)}this._setSelectionOverElement(n)})),!0):void 0}_handleArrowKeys(e){const t=this.editor.model,n=t.schema,r=t.document.selection,i=r.getSelectedElement();if(i&&n.isObject(i)){const i=e?r.getLastPosition():r.getFirstPosition(),o=n.getNearestSelectionRange(i,e?"forward":"backward");return o&&t.change((e=>{e.setSelection(o)})),!0}if(!r.isCollapsed)return;const o=this._getObjectElementNextToSelection(e);return o&&n.isObject(o)?(this._setSelectionOverElement(o),!0):void 0}_handleEnterKey(e){const t=this.editor.model,n=t.document.selection.getSelectedElement();if(r=n,i=t.schema,r&&i.isObject(r)&&!i.isInline(r))return t.change((r=>{let i=r.createPositionAt(n,e?"before":"after");const o=r.createElement("paragraph");if(t.schema.isBlock(n.parent)){const e=t.schema.findAllowedParent(i,o);i=r.split(i,e).position}r.insert(o,i),r.setSelection(o,"in")})),!0;var r,i}_selectAllNestedEditableContent(){const e=this.editor.model,t=e.document.selection,n=e.schema.getLimitElement(t);return t.getFirstRange().root!=n&&(e.change((e=>{e.setSelection(e.createRangeIn(n))})),!0)}_selectAllContent(){const e=this.editor.model,t=this.editor.editing,n=t.view.document.selection.getSelectedElement();if(n&&gh(n)){const r=t.mapper.toModelElement(n.parent);return e.change((e=>{e.setSelection(e.createRangeIn(r))})),!0}return!1}_setSelectionOverElement(e){this.editor.model.change((t=>{t.setSelection(t.createRangeOn(e))}))}_getObjectElementNextToSelection(e){const t=this.editor.model,n=t.schema,r=t.document.selection,i=t.createSelection(r);t.modifySelection(i,{direction:e?"forward":"backward"});const o=e?i.focus.nodeBefore:i.focus.nodeAfter;return o&&n.isObject(o)?o:null}_clearPreviouslySelectedWidgets(e){for(const t of this._previouslySelected)e.removeClass(yh,t);this._previouslySelected.clear()}}function Dd(e,t){return!!t&&Array.from(e.getAncestors()).includes(t)}class Ld extends jl{refresh(){const e=this.editor.model.document.selection.getSelectedElement();this.isEnabled=Oh(e),Oh(e)&&e.hasAttribute("alt")?this.value=e.getAttribute("alt"):this.value=!1}execute(e){const t=this.editor.model,n=t.document.selection.getSelectedElement();t.change((t=>{t.setAttribute("alt",e.newValue,n)}))}}class Bd extends Rl{static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new Ld(this.editor))}}n(49);class Fd extends Wu{constructor(e,t){super(e);const n=`ck-input-${Xn()}`,r=`ck-status-${Xn()}`;this.set("label"),this.set("value"),this.set("isReadOnly",!1),this.set("errorText",null),this.set("infoText",null),this.labelView=this._createLabelView(n),this.inputView=this._createInputView(t,n,r),this.statusView=this._createStatusView(r),this.bind("_statusText").to(this,"errorText",this,"infoText",((e,t)=>e||t));const i=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-input",i.if("isReadOnly","ck-disabled")]},children:[this.labelView,this.inputView,this.statusView]})}_createLabelView(e){const t=new Qu(this.locale);return t.for=e,t.bind("text").to(this,"label"),t}_createInputView(e,t,n){const r=new e(this.locale,n);return r.id=t,r.ariaDescribedById=n,r.bind("value").to(this),r.bind("isReadOnly").to(this),r.bind("hasError").to(this,"errorText",(e=>!!e)),r.on("input",(()=>{this.errorText=null})),r}_createStatusView(e){const t=new Wu(this.locale),n=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-input__status",n.if("errorText","ck-labeled-input__status_error"),n.if("_statusText","ck-hidden",(e=>!e))],id:e,role:n.if("errorText","alert")},children:[{text:n.to("_statusText")}]}),t}select(){this.inputView.select()}focus(){this.inputView.focus()}}n(51);class qd extends Wu{constructor(e){super(e),this.set("value"),this.set("id"),this.set("placeholder"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById");const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",t.if("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),readonly:t.to("isReadOnly"),"aria-invalid":t.if("hasError",!0),"aria-describedby":t.to("ariaDescribedById")},on:{input:t.to("input")}})}render(){super.render();const e=e=>{this.element.value=e||0===e?e:""};e(this.value),this.on("change:value",((t,n,r)=>{e(r)}))}select(){this.element.select()}focus(){this.element.focus()}}function Vd({view:e}){e.listenTo(e.element,"submit",((t,n)=>{n.preventDefault(),e.fire("submit")}),{useCapture:!0})}var Ud='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',Hd='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.591 10.177l4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>';n(53);class zd extends Wu{constructor(e){super(e);const t=this.locale.t;this.focusTracker=new mu,this.keystrokes=new au,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(t("bf"),Ud,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(t("bg"),Hd,"ck-button-cancel","cancel"),this._focusables=new Ou,this._focusCycler=new el({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]})}render(){super.render(),this.keystrokes.listenTo(this.element),Vd({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)}))}_createButton(e,t,n,r){const i=new hl(this.locale);return i.set({label:e,icon:t,tooltip:!0}),i.extendTemplate({attributes:{class:n}}),r&&i.delegate("execute").to(this,r),i}_createLabeledInputView(){const e=this.locale.t,t=new Fd(this.locale,qd);return t.label=e("cd"),t.inputView.placeholder=e("cd"),t}}n(55);const Wd=$u("px"),Yd=no.document.body;class Qd extends Wu{constructor(e){super(e);const t=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class"),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",t.to("position",(e=>`ck-balloon-panel_${e}`)),t.if("isVisible","ck-balloon-panel_visible"),t.if("withArrow","ck-balloon-panel_with-arrow"),t.to("class")],style:{top:t.to("top",Wd),left:t.to("left",Wd)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const t=Qd.defaultPositions,n=Object.assign({},{element:this.element,positions:[t.southArrowNorth,t.southArrowNorthWest,t.southArrowNorthEast,t.northArrowSouth,t.northArrowSouthWest,t.northArrowSouthEast],limiter:Yd,fitInViewport:!0},e),r=Qd._getOptimalPosition(n),i=parseInt(r.left),o=parseInt(r.top),a=r.name;Object.assign(this,{top:o,left:i,position:a})}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const t=Gd(e.target),n=e.limiter?Gd(e.limiter):Yd;this.listenTo(no.document,"scroll",((r,i)=>{const o=i.target,a=t&&o.contains(t),s=n&&o.contains(n);!a&&!s&&t&&n||this.attachTo(e)}),{useCapture:!0}),this.listenTo(no.window,"resize",(()=>{this.attachTo(e)}))}_stopPinning(){this.stopListening(no.document,"scroll"),this.stopListening(no.window,"resize")}}function Gd(e){return Yn(e)?e:Oa(e)?e.commonAncestorContainer:"function"==typeof e?Gd(e()):null}function Jd(e,t){return e.top-t.height-Qd.arrowVerticalOffset}function Kd(e){return e.bottom+Qd.arrowVerticalOffset}Qd.arrowHorizontalOffset=25,Qd.arrowVerticalOffset=10,Qd._getOptimalPosition=al,Qd.defaultPositions={northArrowSouth:(e,t)=>({top:Jd(e,t),left:e.left+e.width/2-t.width/2,name:"arrow_s"}),northArrowSouthEast:(e,t)=>({top:Jd(e,t),left:e.left+e.width/2-t.width+Qd.arrowHorizontalOffset,name:"arrow_se"}),northArrowSouthWest:(e,t)=>({top:Jd(e,t),left:e.left+e.width/2-Qd.arrowHorizontalOffset,name:"arrow_sw"}),northWestArrowSouth:(e,t)=>({top:Jd(e,t),left:e.left-t.width/2,name:"arrow_s"}),northWestArrowSouthWest:(e,t)=>({top:Jd(e,t),left:e.left-Qd.arrowHorizontalOffset,name:"arrow_sw"}),northWestArrowSouthEast:(e,t)=>({top:Jd(e,t),left:e.left-t.width+Qd.arrowHorizontalOffset,name:"arrow_se"}),northEastArrowSouth:(e,t)=>({top:Jd(e,t),left:e.right-t.width/2,name:"arrow_s"}),northEastArrowSouthEast:(e,t)=>({top:Jd(e,t),left:e.right-t.width+Qd.arrowHorizontalOffset,name:"arrow_se"}),northEastArrowSouthWest:(e,t)=>({top:Jd(e,t),left:e.right-Qd.arrowHorizontalOffset,name:"arrow_sw"}),southArrowNorth:(e,t)=>({top:Kd(e),left:e.left+e.width/2-t.width/2,name:"arrow_n"}),southArrowNorthEast:(e,t)=>({top:Kd(e),left:e.left+e.width/2-t.width+Qd.arrowHorizontalOffset,name:"arrow_ne"}),southArrowNorthWest:(e,t)=>({top:Kd(e),left:e.left+e.width/2-Qd.arrowHorizontalOffset,name:"arrow_nw"}),southWestArrowNorth:(e,t)=>({top:Kd(e),left:e.left-t.width/2,name:"arrow_n"}),southWestArrowNorthWest:(e,t)=>({top:Kd(e),left:e.left-Qd.arrowHorizontalOffset,name:"arrow_nw"}),southWestArrowNorthEast:(e,t)=>({top:Kd(e),left:e.left-t.width+Qd.arrowHorizontalOffset,name:"arrow_ne"}),southEastArrowNorth:(e,t)=>({top:Kd(e),left:e.right-t.width/2,name:"arrow_n"}),southEastArrowNorthEast:(e,t)=>({top:Kd(e),left:e.right-t.width+Qd.arrowHorizontalOffset,name:"arrow_ne"}),southEastArrowNorthWest:(e,t)=>({top:Kd(e),left:e.right-Qd.arrowHorizontalOffset,name:"arrow_nw"})};var $d='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z" /></svg>\n',Xd='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>\n';n(57),n(59);const Zd=$u("px");class ep extends Rl{static get pluginName(){return"ContextualBalloon"}constructor(e){super(e),this.positionLimiter=()=>{const e=this.editor.editing.view,t=e.document.selection.editableElement;return t?e.domConverter.mapViewToDom(t.root):null},this.set("visibleView",null),this.view=new Qd(e.locale),e.ui.view.body.add(this.view),e.ui.focusTracker.add(this.view.element),this._viewToStack=new Map,this._idToStack=new Map,this.set("_numberOfStacks",0),this.set("_singleViewMode",!1),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this.hasView(e.view))throw new Jn.b("contextualballoon-add-view-exist: Cannot add configuration of the same view twice.",[this,e]);const t=e.stackId||"main";if(!this._idToStack.has(t))return this._idToStack.set(t,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(t)),this._numberOfStacks=this._idToStack.size,void(this._visibleStack&&!e.singleViewMode||this.showStack(t));const n=this._idToStack.get(t);e.singleViewMode&&this.showStack(t),n.set(e.view,e),this._viewToStack.set(e.view,n),n===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new Jn.b("contextualballoon-remove-view-not-exist: Cannot remove the configuration of a non-existent view.",[this,e]);const t=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(1===t.size?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(t.values())[t.size-2])),1===t.size?(this._idToStack.delete(this._getStackId(t)),this._numberOfStacks=this._idToStack.size):t.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(e){this.visibleStack=e;const t=this._idToStack.get(e);if(!t)throw new Jn.b("contextualballoon-showstack-stack-not-exist: Cannot show a stack that does not exist.",this);this._visibleStack!==t&&this._showView(Array.from(t.values()).pop())}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){return Array.from(this._idToStack.entries()).find((t=>t[1]===e))[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)+1;e[t]||(t=0),this.showStack(this._getStackId(e[t]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let t=e.indexOf(this._visibleStack)-1;e[t]||(t=e.length-1),this.showStack(this._getStackId(e[t]))}_createRotatorView(){const e=new tp(this.editor.locale),t=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",((e,t)=>!t&&e>1)),e.on("change:isNavigationVisible",(()=>this.updatePosition()),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",((e,n)=>{if(n<2)return"";const r=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return t("bn",[r,n])})),e.buttonNextView.on("execute",(()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()})),e.buttonPrevView.on("execute",(()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()})),e}_createFakePanelsView(){const e=new np(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",((e,t)=>!t&&e>=2?Math.min(e-1,2):0)),e.listenTo(this.view,"change:top",(()=>e.updatePosition())),e.listenTo(this.view,"change:left",(()=>e.updatePosition())),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:t="",withArrow:n=!0,singleViewMode:r=!1}){this.view.class=t,this.view.withArrow=n,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),r&&(this._singleViewMode=!0)}_getBalloonPosition(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&!e.limiter&&(e=Object.assign({},e,{limiter:this.positionLimiter})),e}}class tp extends Wu{constructor(e){super(e);const t=e.t,n=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new mu,this.buttonPrevView=this._createButtonView(t("bo"),$d),this.buttonNextView=this._createButtonView(t("bp"),Xd),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",n.to("isNavigationVisible",(e=>e?"":"ck-hidden"))]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:n.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,t){const n=new hl(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n}}class np extends Wu{constructor(e,t){super(e);const n=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=t,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",n.to("numberOfPanels",(e=>e?"":"ck-hidden"))],style:{top:n.to("top",Zd),left:n.to("left",Zd),width:n.to("width",Zd),height:n.to("height",Zd)}},children:this.content}),this.on("change:numberOfPanels",((e,t,n,r)=>{n>r?this._addPanels(n-r):this._removePanels(r-n),this.updatePosition()}))}_addPanels(e){for(;e--;){const e=new Wu;e.setTemplate({tag:"div"}),this.content.add(e),this.registerChild(e)}}_removePanels(e){for(;e--;){const e=this.content.last;this.content.remove(e),this.deregisterChild(e),e.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:t}=this._balloonPanelView,{width:n,height:r}=new Sa(this._balloonPanelView.element);Object.assign(this,{top:e,left:t,width:n,height:r})}}}var rp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22L2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21l-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>';function ip(e){const t=e.editing.view,n=Qd.defaultPositions;return{target:t.domConverter.viewToDom(t.document.selection.getSelectedElement()),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast]}}class op extends Rl{static get requires(){return[ep]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton(),this._createForm()}destroy(){super.destroy(),this._form.destroy()}_createButton(){const e=this.editor,t=e.t;e.ui.componentFactory.add("imageTextAlternative",(n=>{const r=e.commands.get("imageTextAlternative"),i=new hl(n);return i.set({label:t("bv"),icon:rp,tooltip:!0}),i.bind("isEnabled").to(r,"isEnabled"),this.listenTo(i,"execute",(()=>this._showForm())),i}))}_createForm(){const e=this.editor,t=e.editing.view.document;this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new zd(e.locale),this._form.render(),this.listenTo(this._form,"submit",(()=>{e.execute("imageTextAlternative",{newValue:this._form.labeledInput.inputView.element.value}),this._hideForm(!0)})),this.listenTo(this._form,"cancel",(()=>{this._hideForm(!0)})),this._form.keystrokes.set("Esc",((e,t)=>{this._hideForm(!0),t()})),this.listenTo(e.ui,"update",(()=>{Eh(t.selection)?this._isVisible&&function(e){const t=e.plugins.get("ContextualBalloon");if(Eh(e.editing.view.document.selection)){const n=ip(e);t.updatePosition(n)}}(e):this._hideForm(!0)})),vl({emitter:this._form,activator:()=>this._isVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;const e=this.editor,t=e.commands.get("imageTextAlternative"),n=this._form.labeledInput;this._isInBalloon||this._balloon.add({view:this._form,position:ip(e)}),n.value=n.inputView.element.value=t.value||"",this._form.labeledInput.select()}_hideForm(e){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return this._balloon.visibleView===this._form}get _isInBalloon(){return this._balloon.hasView(this._form)}}class ap extends Rl{static get requires(){return[Bd,op]}static get pluginName(){return"ImageTextAlternative"}}n(61);class sp extends Rl{static get requires(){return[Ch,Id,ap]}static get pluginName(){return"Image"}}class cp extends Wu{constructor(e){super(e),this.buttonView=new hl(e),this._fileInputView=new up(e),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[this.buttonView,this._fileInputView]}),this.buttonView.on("execute",(()=>{this._fileInputView.open()}))}focus(){this.buttonView.focus()}}class up extends Wu{constructor(e){super(e),this.set("acceptedType"),this.set("allowMultipleFiles",!1);const t=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to((()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""}))}})}open(){this.element.click()}}var lp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>';function fp(e){const t=e.map((e=>e.replace("+","\\+")));return new RegExp(`^image\\/(${t.join("|")})$`)}function hp(e){return new Promise(((t,n)=>{const r=e.getAttribute("src");fetch(r).then((e=>e.blob())).then((e=>{const i=function(e,t){return e.type?e.type:t.match(/data:(image\/\w+);base64/)?t.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}(e,r),o=function(e,t,n){try{return new File([e],t,{type:n})}catch(e){return null}}(e,`image.${i.replace("image/","")}`,i);o?t(o):n()})).catch(n)}))}class dp extends Rl{init(){const e=this.editor,t=e.t;e.ui.componentFactory.add("imageUpload",(n=>{const r=new cp(n),i=e.commands.get("imageUpload"),o=e.config.get("image.upload.types"),a=fp(o);return r.set({acceptedType:o.map((e=>`image/${e}`)).join(","),allowMultipleFiles:!0}),r.buttonView.set({label:t("j"),icon:lp,tooltip:!0}),r.buttonView.bind("isEnabled").to(i),r.on("done",((t,n)=>{const r=Array.from(n).filter((e=>a.test(e.type)));r.length&&e.execute("imageUpload",{file:r})})),r}))}}var pp='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 250"><rect rx="4"/></svg>';n(63),n(65),n(67);class mp extends Rl{constructor(e){super(e),this.placeholder="data:image/svg+xml;utf8,"+encodeURIComponent(pp)}init(){this.editor.editing.downcastDispatcher.on("attribute:uploadStatus:image",((...e)=>this.uploadStatusChange(...e)))}uploadStatusChange(e,t,n){const r=this.editor,i=t.item,o=i.getAttribute("uploadId");if(!n.consumable.consume(t.item,e.name))return;const a=r.plugins.get(Rf),s=o?t.attributeNewValue:null,c=this.placeholder,u=r.editing.mapper.toViewElement(i),l=n.writer;if("reading"==s)return yp(u,l),void gp(c,u,l);if("uploading"==s){const e=a.loaders.get(o);return yp(u,l),void(e?(bp(u,l),function(e,t,n,r){const i=function(e){const t=e.createUIElement("div",{class:"ck-progress-bar"});return e.setCustomProperty("progressBar",!0,t),t}(t);t.insert(t.createPositionAt(e,"end"),i),n.on("change:uploadedPercent",((e,t,n)=>{r.change((e=>{e.setStyle("width",n+"%",i)}))}))}(u,l,e,r.editing.view),function(e,t,n){if(n.data){const r=e.getChild(0);t.setAttribute("src",n.data,r)}}(u,l,e)):gp(c,u,l))}"complete"==s&&a.loaders.get(o)&&!pi.isEdge&&function(e,t,n){const r=t.createUIElement("div",{class:"ck-image-upload-complete-icon"});t.insert(t.createPositionAt(e,"end"),r),setTimeout((()=>{n.change((e=>e.remove(e.createRangeOn(r))))}),3e3)}(u,l,r.editing.view),function(e,t){wp(e,t,"progressBar")}(u,l),bp(u,l),function(e,t){t.removeClass("ck-appear",e)}(u,l)}}function yp(e,t){e.hasClass("ck-appear")||t.addClass("ck-appear",e)}function gp(e,t,n){t.hasClass("ck-image-upload-placeholder")||n.addClass("ck-image-upload-placeholder",t);const r=t.getChild(0);r.getAttribute("src")!==e&&n.setAttribute("src",e,r),vp(t,"placeholder")||n.insert(n.createPositionAfter(r),function(e){const t=e.createUIElement("div",{class:"ck-upload-placeholder-loader"});return e.setCustomProperty("placeholder",!0,t),t}(n))}function bp(e,t){e.hasClass("ck-image-upload-placeholder")&&t.removeClass("ck-image-upload-placeholder",e),wp(e,t,"placeholder")}function vp(e,t){for(const n of e.getChildren())if(n.getCustomProperty(t))return n}function wp(e,t,n){const r=vp(e,n);r&&t.remove(t.createRangeOn(r))}class _p{createDocumentFragment(e){return new Ti(e)}createElement(e,t,n){return new wr(e,t,n)}createText(e){return new pr(e)}clone(e,t=!1){return e._clone(t)}appendChild(e,t){return t._appendChild(e)}insertChild(e,t,n){return n._insertChild(e,t)}removeChildren(e,t,n){return n._removeChildren(e,t)}remove(e){const t=e.parent;return t?this.removeChildren(t.getChildIndex(e),1,t):[]}replace(e,t){const n=e.parent;if(n){const r=n.getChildIndex(e);return this.removeChildren(r,1,n),this.insertChild(r,t,n),!0}return!1}unwrapElement(e){const t=e.parent;if(t){const n=t.getChildIndex(e);this.remove(e),this.insertChild(n,e.getChildren(),t)}}rename(e,t){const n=new wr(e,t.getAttributes(),t.getChildren());return this.replace(t,n)?n:null}setAttribute(e,t,n){n._setAttribute(e,t)}removeAttribute(e,t){t._removeAttribute(e)}addClass(e,t){t._addClass(e)}removeClass(e,t){t._removeClass(e)}setStyle(e,t,n){T(e)&&void 0===n&&(n=t),n._setStyle(e,t)}removeStyle(e,t){t._removeStyle(e)}setCustomProperty(e,t,n){n._setCustomProperty(e,t)}removeCustomProperty(e,t){return t._removeCustomProperty(e)}createPositionAt(e,t){return Zr._createAt(e,t)}createPositionAfter(e){return Zr._createAfter(e)}createPositionBefore(e){return Zr._createBefore(e)}createRange(e,t){return new ei(e,t)}createRangeOn(e){return ei._createOn(e)}createRangeIn(e){return ei._createIn(e)}createSelection(e,t,n){return new ri(e,t,n)}}class kp extends jl{refresh(){this.isEnabled=xh(this.editor.model)}execute(e){const t=this.editor,n=t.model,r=t.plugins.get(Rf);n.change((t=>{const i=Array.isArray(e.file)?e.file:[e.file];for(const e of i)Ep(t,n,r,e)}))}}function Ep(e,t,n,r){const i=n.createLoader(r);i&&Th(e,t,{uploadId:i.id})}class Op extends Rl{static get requires(){return[Rf,_d,Al]}static get pluginName(){return"ImageUploadEditing"}constructor(e){super(e),e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}})}init(){const e=this.editor,t=e.model.document,n=e.model.schema,r=e.conversion,i=e.plugins.get(Rf),o=fp(e.config.get("image.upload.types"));n.extend("image",{allowAttributes:["uploadId","uploadStatus"]}),e.commands.add("imageUpload",new kp(e)),r.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(e.editing.view.document,"clipboardInput",((t,n)=>{if(function(e){return Array.from(e.types).includes("text/html")&&""!==e.getData("text/html")}(n.dataTransfer))return;const r=Array.from(n.dataTransfer.files).filter((e=>!!e&&o.test(e.type))),i=n.targetRanges.map((t=>e.editing.mapper.toModelRange(t)));e.model.change((n=>{n.setSelection(i),r.length&&(t.stop(),e.model.enqueueChange("default",(()=>{e.execute("imageUpload",{file:r})})))}))})),this.listenTo(e.plugins.get(Al),"inputTransformation",((t,n)=>{const r=Array.from(e.editing.view.createRangeIn(n.content)).filter((e=>function(e){return!(!e.is("element","img")||!e.getAttribute("src"))&&(e.getAttribute("src").match(/^data:image\/\w+;base64,/g)||e.getAttribute("src").match(/^blob:/g))}(e.item)&&!e.item.getAttribute("uploadProcessed"))).map((e=>({promise:hp(e.item),imageElement:e.item})));if(!r.length)return;const o=new _p;for(const e of r){o.setAttribute("uploadProcessed",!0,e.imageElement);const t=i.createLoader(e.promise);t&&(o.setAttribute("src","",e.imageElement),o.setAttribute("uploadId",t.id,e.imageElement))}})),e.editing.view.document.on("dragover",((e,t)=>{t.preventDefault()})),t.on("change",(()=>{const n=t.differ.getChanges({includeChangesInGraveyard:!0});for(const t of n)if("insert"==t.type&&"$text"!=t.name){const n=t.position.nodeAfter,r="$graveyard"==t.position.root.rootName;for(const t of Tp(e,n)){const e=t.getAttribute("uploadId");if(!e)continue;const n=i.loaders.get(e);n&&(r?n.abort():"idle"==n.status&&this._readAndUpload(n,t))}}}))}_readAndUpload(e,t){const n=this.editor,r=n.model,i=n.locale.t,o=n.plugins.get(Rf),a=n.plugins.get(_d);return r.enqueueChange("transparent",(e=>{e.setAttribute("uploadStatus","reading",t)})),e.read().then((()=>{const i=e.upload();if(pi.isSafari){const e=n.editing.mapper.toViewElement(t).getChild(0);n.editing.view.once("render",(()=>{if(!e.parent)return;const t=n.editing.view.domConverter.mapViewToDom(e.parent);if(!t)return;const r=t.style.display;t.style.display="none",t._ckHack=t.offsetHeight,t.style.display=r}))}return r.enqueueChange("transparent",(e=>{e.setAttribute("uploadStatus","uploading",t)})),i})).then((e=>{r.enqueueChange("transparent",(n=>{n.setAttributes({uploadStatus:"complete",src:e.default},t),this._parseAndSetSrcsetAttributeOnImage(e,t,n)})),s()})).catch((n=>{if("error"!==e.status&&"aborted"!==e.status)throw n;"error"==e.status&&n&&a.showWarning(n,{title:i("an"),namespace:"upload"}),s(),r.enqueueChange("transparent",(e=>{e.remove(t)}))}));function s(){r.enqueueChange("transparent",(e=>{e.removeAttribute("uploadId",t),e.removeAttribute("uploadStatus",t)})),o.destroyLoader(e)}}_parseAndSetSrcsetAttributeOnImage(e,t,n){let r=0;const i=Object.keys(e).filter((e=>{const t=parseInt(e,10);if(!isNaN(t))return r=Math.max(r,t),!0})).map((t=>`${e[t]} ${t}w`)).join(", ");""!=i&&n.setAttribute("srcset",{data:i,width:r},t)}}function Tp(e,t){return Array.from(e.model.createRangeOn(t)).filter((e=>e.item.is("image"))).map((e=>e.item))}class xp extends Rl{static get pluginName(){return"ImageUpload"}static get requires(){return[Op,dp,mp]}}class Sp extends jl{refresh(){const e=this.editor.model,t=Xf(e.document.selection.getSelectedBlocks());this.value=!!t&&t.is("paragraph"),this.isEnabled=!!t&&Cp(t,e.schema)}execute(e={}){const t=this.editor.model,n=t.document;t.change((r=>{const i=(e.selection||n.selection).getSelectedBlocks();for(const e of i)!e.is("paragraph")&&Cp(e,t.schema)&&r.rename(e,"paragraph")}))}}function Cp(e,t){return t.checkChild(e.parent,"paragraph")&&!t.isObject(e)}class Rp extends Rl{static get pluginName(){return"Paragraph"}init(){const e=this.editor,t=e.model,n=e.data;e.commands.add("paragraph",new Sp(e)),t.schema.register("paragraph",{inheritAllFrom:"$block"}),e.conversion.elementToElement({model:"paragraph",view:"p"}),e.conversion.for("upcast").elementToElement({model:(e,t)=>Rp.paragraphLikeElements.has(e.name)?e.isEmpty?null:t.createElement("paragraph"):null,converterPriority:"low"}),n.upcastDispatcher.on("element",((e,t,n)=>{n.consumable.test(t.viewItem,{name:t.viewItem.name})&&Np(t.viewItem,t.modelCursor,n.schema)&&Object.assign(t,Pp(t.viewItem,t.modelCursor,n))}),{priority:"low"}),n.upcastDispatcher.on("text",((e,t,n)=>{t.modelRange||Np(t.viewItem,t.modelCursor,n.schema)&&Object.assign(t,Pp(t.viewItem,t.modelCursor,n))}),{priority:"lowest"}),t.document.registerPostFixer((e=>this._autoparagraphEmptyRoots(e))),e.data.on("ready",(()=>{t.enqueueChange("transparent",(e=>this._autoparagraphEmptyRoots(e)))}),{priority:"lowest"})}_autoparagraphEmptyRoots(e){const t=this.editor.model;for(const n of t.document.getRootNames()){const r=t.document.getRoot(n);if(r.isEmpty&&"$graveyard"!=r.rootName&&t.schema.checkChild(r,"paragraph"))return e.insertElement("paragraph",r),!0}}}function Pp(e,t,n){const r=n.writer.createElement("paragraph");return n.writer.insert(r,t),n.convertItem(e,n.writer.createPositionAt(r,0))}function Np(e,t,n){const r=n.createContext(t);return!!n.checkChild(r,"paragraph")&&!!n.checkChild(r.push("paragraph"),e)}Rp.paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td"]);class Mp extends jl{constructor(e,t){super(e),this.modelElements=t}refresh(){const e=Xf(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some((t=>Ap(e,t,this.editor.model.schema)))}execute(e){const t=this.editor.model,n=t.document,r=e.value;t.change((e=>{const i=Array.from(n.selection.getSelectedBlocks()).filter((e=>Ap(e,r,t.schema)));for(const t of i)t.is(r)||e.rename(t,r)}))}}function Ap(e,t,n){return n.checkChild(e.parent,t)&&!n.isObject(e)}const jp="paragraph";class Ip extends Rl{static get pluginName(){return"HeadingEditing"}constructor(e){super(e),e.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[Rp]}init(){const e=this.editor,t=e.config.get("heading.options"),n=[];for(const r of t)r.model!==jp&&(e.model.schema.register(r.model,{inheritAllFrom:"$block"}),e.conversion.elementToElement(r),n.push(r.model));this._addDefaultH1Conversion(e),e.commands.add("heading",new Mp(e,n))}afterInit(){const e=this.editor,t=e.commands.get("enter"),n=e.config.get("heading.options");t&&this.listenTo(t,"afterExecute",((t,r)=>{const i=e.model.document.selection.getFirstPosition().parent;n.some((e=>i.is(e.model)))&&!i.is(jp)&&0===i.childCount&&r.writer.rename(i,jp)}))}_addDefaultH1Conversion(e){e.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:Zn.get("low")+1})}}class Dp{constructor(e,t){t&&Lr(this,t),e&&this.set(e)}}ur(Dp,Ur),n(10);class Lp extends Rl{init(){const e=this.editor,t=e.t,n=function(e){const t=e.t,n={Paragraph:t("bw"),"Heading 1":t("bx"),"Heading 2":t("by"),"Heading 3":t("bz"),"Heading 4":t("ca"),"Heading 5":t("cb"),"Heading 6":t("cc")};return e.config.get("heading.options").map((e=>{const t=n[e.title];return t&&t!=e.title&&(e.title=t),e}))}(e),r=t("e"),i=t("f");e.ui.componentFactory.add("heading",(t=>{const o={},a=new oi,s=e.commands.get("heading"),c=e.commands.get("paragraph"),u=[s];for(const e of n){const t={type:"button",model:new Dp({label:e.title,class:e.class,withText:!0})};"paragraph"===e.model?(t.model.bind("isOn").to(c,"value"),t.model.set("commandName","paragraph"),u.push(c)):(t.model.bind("isOn").to(s,"value",(t=>t===e.model)),t.model.set({commandName:"heading",commandValue:e.model})),a.add(t),o[e.model]=e.title}const l=wl(t);return _l(l,a),l.buttonView.set({isOn:!1,withText:!0,tooltip:i}),l.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),l.bind("isEnabled").toMany(u,"isEnabled",((...e)=>e.some((e=>e)))),l.buttonView.bind("label").to(s,"value",c,"value",((e,t)=>{const n=e||t&&"paragraph";return o[n]?o[n]:r})),this.listenTo(l,"execute",(t=>{e.execute(t.source.commandName,t.source.commandValue?{value:t.source.commandValue}:void 0),e.editing.view.focus()})),l}))}}function Bp(e){for(const t of e.getChildren())if(t&&t.is("caption"))return t;return null}function Fp(e){const t=e.parent;return"figcaption"==e.name&&t&&"figure"==t.name&&t.hasClass("image")?{name:!0}:null}class qp extends Rl{static get pluginName(){return"ImageCaptionEditing"}init(){const e=this.editor,t=e.editing.view,n=e.model.schema,r=e.data,i=e.editing,o=e.t;n.register("caption",{allowIn:"image",allowContentOf:"$block",isLimit:!0}),e.model.document.registerPostFixer((e=>this._insertMissingModelCaptionElement(e))),e.conversion.for("upcast").elementToElement({view:Fp,model:"caption"}),r.downcastDispatcher.on("insert:caption",Vp((e=>e.createContainerElement("figcaption")),!1));const a=function(e,t){return n=>{const r=n.createEditableElement("figcaption");return n.setCustomProperty("imageCaption",!0,r),bu({view:e,element:r,text:t}),wh(r,n)}}(t,o("am"));i.downcastDispatcher.on("insert:caption",Vp(a)),i.downcastDispatcher.on("insert",this._fixCaptionVisibility((e=>e.item)),{priority:"high"}),i.downcastDispatcher.on("remove",this._fixCaptionVisibility((e=>e.position.parent)),{priority:"high"}),t.document.registerPostFixer((e=>this._updateCaptionVisibility(e)))}_updateCaptionVisibility(e){const t=this.editor.editing.mapper,n=this._lastSelectedCaption;let r;const i=this.editor.model.document.selection,o=i.getSelectedElement();if(o&&o.is("image")){const e=Bp(o);r=t.toViewElement(e)}const a=Up(i.getFirstPosition().parent);if(a&&(r=t.toViewElement(a)),r)return n?(n===r||(Hp(n,e),this._lastSelectedCaption=r),zp(r,e)):(this._lastSelectedCaption=r,zp(r,e));if(n){const t=Hp(n,e);return this._lastSelectedCaption=null,t}return!1}_fixCaptionVisibility(e){return(t,n,r)=>{const i=Up(e(n)),o=this.editor.editing.mapper,a=r.writer;if(i){const e=o.toViewElement(i);e&&(i.childCount?a.removeClass("ck-hidden",e):a.addClass("ck-hidden",e))}}}_insertMissingModelCaptionElement(e){const t=this.editor.model,n=t.document.differ.getChanges(),r=[];for(const e of n)if("insert"==e.type&&"$text"!=e.name){const n=e.position.nodeAfter;if(n.is("image")&&!Bp(n)&&r.push(n),!n.is("image")&&n.childCount)for(const e of t.createRangeIn(n).getItems())e.is("image")&&!Bp(e)&&r.push(e)}for(const t of r)e.appendElement("caption",t);return!!r.length}}function Vp(e,t=!0){return(n,r,i)=>{const o=r.item;if((o.childCount||t)&&Oh(o.parent)){if(!i.consumable.consume(r.item,"insert"))return;const t=i.mapper.toViewElement(r.range.start.parent),n=e(i.writer),a=i.writer;o.childCount||a.addClass("ck-hidden",n),function(e,t,n,r){const i=r.writer.createPositionAt(n,"end");r.writer.insert(i,e),r.mapper.bindElements(t,e)}(n,r.item,t,i)}}}function Up(e){const t=e.getAncestors({includeSelf:!0}).find((e=>"caption"==e.name));return t&&t.parent&&"image"==t.parent.name?t:null}function Hp(e,t){return!e.childCount&&!e.hasClass("ck-hidden")&&(t.addClass("ck-hidden",e),!0)}function zp(e,t){return!!e.hasClass("ck-hidden")&&(t.removeClass("ck-hidden",e),!0)}n(70);class Wp extends jl{constructor(e,t){super(e),this.defaultStyle=!1,this.styles=t.reduce(((e,t)=>(e[t.name]=t,t.isDefault&&(this.defaultStyle=t.name),e)),{})}refresh(){const e=this.editor.model.document.selection.getSelectedElement();if(this.isEnabled=Oh(e),e)if(e.hasAttribute("imageStyle")){const t=e.getAttribute("imageStyle");this.value=!!this.styles[t]&&t}else this.value=this.defaultStyle;else this.value=!1}execute(e){const t=e.value,n=this.editor.model,r=n.document.selection.getSelectedElement();n.change((e=>{this.styles[t].isDefault?e.removeAttribute("imageStyle",r):e.setAttribute("imageStyle",t,r)}))}}function Yp(e,t){for(const n of t)if(n.name===e)return n}var Qp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm2.5 3V12h11V7.5h-11zM4.061 6H15.94c.586 0 1.061.407 1.061.91v5.68c0 .503-.475.91-1.061.91H4.06c-.585 0-1.06-.407-1.06-.91V6.91C3 6.406 3.475 6 4.061 6zM2 16.5V15h16v1.5z"/></svg>',Gp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M18 4.5V3H2v1.5h16zm0 3V6h-5.674v1.5H18zm0 3V9h-5.674v1.5H18zm0 3V12h-5.674v1.5H18zm-8.5-6V12h-6V7.5h6zm.818-1.5H2.682C2.305 6 2 6.407 2 6.91v5.68c0 .503.305.91.682.91h7.636c.377 0 .682-.407.682-.91V6.91c0-.503-.305-.91-.682-.91zM18 16.5V15H2v1.5h16z"/></svg>',Jp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm4.5 3V12h7V7.5h-7zM5.758 6h8.484c.419 0 .758.407.758.91v5.681c0 .502-.34.909-.758.909H5.758c-.419 0-.758-.407-.758-.91V6.91c0-.503.34-.91.758-.91zM2 16.5V15h16v1.5z"/></svg>',Kp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm0 3V6h5.674v1.5zm0 3V9h5.674v1.5zm0 3V12h5.674v1.5zm8.5-6V12h6V7.5h-6zM9.682 6h7.636c.377 0 .682.407.682.91v5.68c0 .503-.305.91-.682.91H9.682c-.377 0-.682-.407-.682-.91V6.91c0-.503.305-.91.682-.91zM2 16.5V15h16v1.5z"/></svg>';const $p={full:{name:"full",title:"Full size image",icon:Qp,isDefault:!0},side:{name:"side",title:"Side image",icon:Kp,className:"image-style-side"},alignLeft:{name:"alignLeft",title:"Left aligned image",icon:Gp,className:"image-style-align-left"},alignCenter:{name:"alignCenter",title:"Centered image",icon:Jp,className:"image-style-align-center"},alignRight:{name:"alignRight",title:"Right aligned image",icon:Kp,className:"image-style-align-right"}},Xp={full:Qp,left:Gp,right:Kp,center:Jp};function Zp(e=[]){return e.map(em)}function em(e){if("string"==typeof e){const t=e;$p[t]?e=Object.assign({},$p[t]):(console.warn(Object(Jn.a)("image-style-not-found: There is no such image style of given name."),{name:t}),e={name:t})}else if($p[e.name]){const t=$p[e.name],n=Object.assign({},e);for(const r in t)e.hasOwnProperty(r)||(n[r]=t[r]);e=n}return"string"==typeof e.icon&&Xp[e.icon]&&(e.icon=Xp[e.icon]),e}class tm extends Rl{static get pluginName(){return"ImageStyleEditing"}init(){const e=this.editor,t=e.model.schema,n=e.data,r=e.editing;e.config.define("image.styles",["full","side"]);const i=Zp(e.config.get("image.styles"));t.extend("image",{allowAttributes:"imageStyle"});const o=function(e){return(t,n,r)=>{if(!r.consumable.consume(n.item,t.name))return;const i=Yp(n.attributeNewValue,e),o=Yp(n.attributeOldValue,e),a=r.mapper.toViewElement(n.item),s=r.writer;o&&s.removeClass(o.className,a),i&&s.addClass(i.className,a)}}(i);r.downcastDispatcher.on("attribute:imageStyle:image",o),n.downcastDispatcher.on("attribute:imageStyle:image",o),n.upcastDispatcher.on("element:figure",function(e){const t=e.filter((e=>!e.isDefault));return(e,n,r)=>{if(!n.modelRange)return;const i=n.viewItem,o=Xf(n.modelRange.getItems());if(r.schema.checkAttribute(o,"imageStyle"))for(const e of t)r.consumable.consume(i,{classes:e.className})&&r.writer.setAttribute("imageStyle",e.name,o)}}(i),{priority:"low"}),e.commands.add("imageStyle",new Wp(e,i))}}n(72);class nm extends Rl{static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const e=this.editor.t;return{"Full size image":e("ah"),"Side image":e("ai"),"Left aligned image":e("aj"),"Centered image":e("ak"),"Right aligned image":e("al")}}init(){const e=function(e,t){for(const n of e)t[n.title]&&(n.title=t[n.title]);return e}(Zp(this.editor.config.get("image.styles")),this.localizedDefaultStylesTitles);for(const t of e)this._createButton(t)}_createButton(e){const t=this.editor,n=`imageStyle:${e.name}`;t.ui.componentFactory.add(n,(n=>{const r=t.commands.get("imageStyle"),i=new hl(n);return i.set({label:e.title,icon:e.icon,tooltip:!0,isToggleable:!0}),i.bind("isEnabled").to(r,"isEnabled"),i.bind("isOn").to(r,"value",(t=>t===e.name)),this.listenTo(i,"execute",(()=>t.execute("imageStyle",{value:e.name}))),i}))}}class rm extends Rl{static get requires(){return[ep]}static get pluginName(){return"WidgetToolbarRepository"}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const t=e.plugins.get("BalloonToolbar");this.listenTo(t,"show",(t=>{(function(e){const t=e.getSelectedElement();return!(!t||!gh(t))})(e.editing.view.document.selection)&&t.stop()}),{priority:"high"})}this._toolbarDefinitions=new Map,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.listenTo(e.ui,"update",(()=>{this._updateToolbarsVisibility()})),this.listenTo(e.ui.focusTracker,"change:isFocused",(()=>{this._updateToolbarsVisibility()}),{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:t,items:n,getRelatedElement:r,balloonClassName:i="ck-toolbar-container"}){const o=this.editor,a=o.t,s=new El(o.locale);if(s.ariaLabel=t||a("ax"),this._toolbarDefinitions.has(e))throw new Jn.b("widget-toolbar-duplicated: Toolbar with the given id was already added.",this,{toolbarId:e});s.fillFromConfig(n,o.ui.componentFactory),this._toolbarDefinitions.set(e,{view:s,getRelatedElement:r,balloonClassName:i})}_updateToolbarsVisibility(){let e=0,t=null,n=null;for(const r of this._toolbarDefinitions.values()){const i=r.getRelatedElement(this.editor.editing.view.document.selection);if(this.editor.ui.focusTracker.isFocused)if(i){const o=i.getAncestors().length;o>e&&(e=o,t=i,n=r)}else this._isToolbarInBalloon(r)&&this._hideToolbar(r);else this._isToolbarVisible(r)&&this._hideToolbar(r)}n&&this._showToolbar(n,t)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,t){this._isToolbarVisible(e)?im(this.editor,t):this._isToolbarInBalloon(e)||(this._balloon.add({view:e.view,position:om(this.editor,t),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",(()=>{for(const e of this._toolbarDefinitions.values())if(this._isToolbarVisible(e)){const t=e.getRelatedElement(this.editor.editing.view.document.selection);im(this.editor,t)}})))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function im(e,t){const n=e.plugins.get("ContextualBalloon"),r=om(e,t);n.updatePosition(r)}function om(e,t){const n=e.editing.view,r=Qd.defaultPositions;return{target:n.domConverter.mapViewToDom(t),positions:[r.northArrowSouth,r.northArrowSouthWest,r.northArrowSouthEast,r.southArrowNorth,r.southArrowNorthWest,r.southArrowNorthEast]}}class am extends jl{constructor(e){super(e),this._childCommands=[]}refresh(){}execute(...e){this._getFirstEnabledCommand().execute(e)}registerChildCommand(e){this._childCommands.push(e),e.on("change:isEnabled",(()=>this._checkEnabled())),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){return this._childCommands.find((e=>e.isEnabled))}}class sm extends Rl{static get pluginName(){return"IndentEditing"}init(){const e=this.editor;e.commands.add("indent",new am(e)),e.commands.add("outdent",new am(e))}}var cm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5z"/><path d="M1.632 6.95L5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>\n',um='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5z"/><path d="M4.368 6.95L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>\n';class lm extends Rl{static get pluginName(){return"IndentUI"}init(){const e=this.editor,t=e.locale,n=e.t,r="ltr"==t.uiLanguageDirection?cm:um,i="ltr"==t.uiLanguageDirection?um:cm;this._defineButton("indent",n("k"),r),this._defineButton("outdent",n("l"),i)}_defineButton(e,t,n){const r=this.editor;r.ui.componentFactory.add(e,(i=>{const o=r.commands.get(e),a=new hl(i);return a.set({label:t,icon:n,tooltip:!0}),a.bind("isOn","isEnabled").to(o,"value","isEnabled"),this.listenTo(a,"execute",(()=>r.execute(e))),a}))}}class fm extends ra{constructor(e){super(e),this.domEventType="click"}onDomEvent(e){this.fire(e.type,e)}}n(74);class hm extends Wu{constructor(e,t=[]){super(e);const n=e.t;this.focusTracker=new mu,this.keystrokes=new au,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(n("bf"),Ud,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(n("bg"),Hd,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(t),this.children=this._createFormChildren(t),this._focusables=new Ou,this._focusCycler=new el({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const r=["ck","ck-link-form"];t.length&&r.push("ck-link-form_layout-vertical"),this.setTemplate({tag:"form",attributes:{class:r,tabindex:"-1"},children:this.children})}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce(((e,t)=>(e[t.name]=t.isOn,e)),{})}render(){super.render(),Vd({view:this}),[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createUrlInput(){const e=this.locale.t,t=new Fd(this.locale,qd);return t.label=e("bk"),t.inputView.placeholder="https://example.com",t}_createButton(e,t,n,r){const i=new hl(this.locale);return i.set({label:e,icon:t,tooltip:!0}),i.extendTemplate({attributes:{class:n}}),r&&i.delegate("execute").to(this,r),i}_createManualDecoratorSwitches(e){const t=this.createCollection();for(const n of e){const e=new bl(this.locale);e.set({name:n.id,label:n.label,withText:!0}),e.bind("isOn").to(n,"value"),e.on("execute",(()=>{n.set("value",!e.isOn)})),t.add(e)}return t}_createFormChildren(e){const t=this.createCollection();if(t.add(this.urlInputView),e.length){const e=new Wu;e.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map((e=>({tag:"li",children:[e],attributes:{class:["ck","ck-list__item"]}}))),attributes:{class:["ck","ck-reset","ck-list"]}}),t.add(e)}return t.add(this.saveButtonView),t.add(this.cancelButtonView),t}}var dm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.077 15l.991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562l-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>',pm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7.3 17.37l-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506L13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5L9.375 17H19v1.5H8z"/></svg>';n(76);class mm extends Wu{constructor(e){super(e);const t=e.t;this.focusTracker=new mu,this.keystrokes=new au,this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(t("bb"),dm,"unlink"),this.editButtonView=this._createButton(t("bc"),pm,"edit"),this.set("href"),this._focusables=new Ou,this._focusCycler=new el({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render(),[this.previewButtonView,this.editButtonView,this.unlinkButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createButton(e,t,n){const r=new hl(this.locale);return r.set({label:e,icon:t,tooltip:!0}),r.delegate("execute").to(this,n),r}_createPreviewButton(){const e=new hl(this.locale),t=this.bindTemplate,n=this.t;return e.set({withText:!0,tooltip:n("bd")}),e.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:t.to("href",(e=>e&&sd(e))),target:"_blank",rel:"noopener noreferrer"}}),e.bind("label").to(this,"href",(e=>e||n("be"))),e.bind("isEnabled").to(this,"href",(e=>!!e)),e.template.tag="a",e.template.eventListeners={},e}}var ym='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.077 15l.991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>';const gm="Ctrl+K";class bm extends Rl{static get requires(){return[ep]}static get pluginName(){return"LinkUI"}init(){const e=this.editor;e.editing.view.addObserver(fm),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=e.plugins.get(ep),this._createToolbarLinkButton(),this._enableUserBalloonInteractions()}destroy(){super.destroy(),this.formView.destroy()}_createActionsView(){const e=this.editor,t=new mm(e.locale),n=e.commands.get("link"),r=e.commands.get("unlink");return t.bind("href").to(n,"value"),t.editButtonView.bind("isEnabled").to(n),t.unlinkButtonView.bind("isEnabled").to(r),this.listenTo(t,"edit",(()=>{this._addFormView()})),this.listenTo(t,"unlink",(()=>{e.execute("unlink"),this._hideUI()})),t.keystrokes.set("Esc",((e,t)=>{this._hideUI(),t()})),t.keystrokes.set(gm,((e,t)=>{this._addFormView(),t()})),t}_createFormView(){const e=this.editor,t=e.commands.get("link"),n=new hm(e.locale,t.manualDecorators);return n.urlInputView.bind("value").to(t,"value"),n.urlInputView.bind("isReadOnly").to(t,"isEnabled",(e=>!e)),n.saveButtonView.bind("isEnabled").to(t),this.listenTo(n,"submit",(()=>{e.execute("link",n.urlInputView.inputView.element.value,n.getDecoratorSwitchesState()),this._closeFormView()})),this.listenTo(n,"cancel",(()=>{this._closeFormView()})),n.keystrokes.set("Esc",((e,t)=>{this._closeFormView(),t()})),n}_createToolbarLinkButton(){const e=this.editor,t=e.commands.get("link"),n=e.t;e.keystrokes.set(gm,((e,n)=>{n(),t.isEnabled&&this._showUI(!0)})),e.ui.componentFactory.add("link",(e=>{const r=new hl(e);return r.isEnabled=!0,r.label=n("as"),r.icon=ym,r.keystroke=gm,r.tooltip=!0,r.isToggleable=!0,r.bind("isEnabled").to(t,"isEnabled"),r.bind("isOn").to(t,"value",(e=>!!e)),this.listenTo(r,"execute",(()=>this._showUI(!0))),r}))}_enableUserBalloonInteractions(){const e=this.editor.editing.view.document;this.listenTo(e,"click",(()=>{this._getSelectedLinkElement()&&this._showUI()})),this.editor.keystrokes.set("Tab",((e,t)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),t())}),{priority:"high"}),this.editor.keystrokes.set("Esc",((e,t)=>{this._isUIVisible&&(this._hideUI(),t())})),vl({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this._isFormInPanel)return;const e=this.editor.commands.get("link");this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this._balloon.visibleView===this.formView&&this.formView.urlInputView.select(),this.formView.urlInputView.inputView.element.value=e.value||""}_closeFormView(){const e=this.editor.commands.get("link");e.restoreManualDecoratorStates(),void 0!==e.value?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this._balloon.remove(this.formView),this.editor.editing.view.focus())}_showUI(e=!1){this.editor.commands.get("link").isEnabled&&(this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI())}_hideUI(){if(!this._isUIInPanel)return;const e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView)}_startUpdatingUI(){const e=this.editor,t=e.editing.view.document;let n=this._getSelectedLinkElement(),r=o();const i=()=>{const e=this._getSelectedLinkElement(),t=o();n&&!e||!n&&t!==r?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),n=e,r=t};function o(){return t.selection.focus.getAncestors().reverse().find((e=>e.is("element")))}this.listenTo(e.ui,"update",i),this.listenTo(this._balloon,"change:visibleView",i)}get _isFormInPanel(){return this._balloon.hasView(this.formView)}get _areActionsInPanel(){return this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){return this._balloon.visibleView==this.formView||this._areActionsVisible}_getBalloonPositionData(){const e=this.editor.editing.view,t=e.document,n=this._getSelectedLinkElement();return{target:n?e.domConverter.mapViewToDom(n):e.domConverter.viewRangeToDom(t.selection.getFirstRange())}}_getSelectedLinkElement(){const e=this.editor.editing.view,t=e.document.selection;if(t.isCollapsed)return vm(t.getFirstPosition());{const n=t.getFirstRange().getTrimmed(),r=vm(n.start),i=vm(n.end);return r&&r==i&&e.createRangeIn(r).getTrimmed().isEqual(n)?r:null}}}function vm(e){return e.getAncestors().find((e=>function(e){return e.is("attributeElement")&&!!e.getCustomProperty("link")}(e)))}class wm extends jl{constructor(e,t){super(e),this.type=t}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,t=e.document,n=Array.from(t.selection.getSelectedBlocks()).filter((t=>km(t,e.schema))),r=!0===this.value;e.change((e=>{if(r){let t=n[n.length-1].nextSibling,r=Number.POSITIVE_INFINITY,i=[];for(;t&&"listItem"==t.name&&0!==t.getAttribute("listIndent");){const e=t.getAttribute("listIndent");e<r&&(r=e);const n=e-r;i.push({element:t,listIndent:n}),t=t.nextSibling}i=i.reverse();for(const t of i)e.setAttribute("listIndent",t.listIndent,t.element)}if(!r){let e=Number.POSITIVE_INFINITY;for(const t of n)t.is("listItem")&&t.getAttribute("listIndent")<e&&(e=t.getAttribute("listIndent"));e=0===e?1:e,_m(n,!0,e),_m(n,!1,e)}for(const t of n.reverse())r&&"listItem"==t.name?e.rename(t,"paragraph"):r||"listItem"==t.name?r||"listItem"!=t.name||t.getAttribute("listType")==this.type||e.setAttribute("listType",this.type,t):(e.setAttributes({listType:this.type,listIndent:0},t),e.rename(t,"listItem"))}))}_getValue(){const e=Xf(this.editor.model.document.selection.getSelectedBlocks());return!!e&&e.is("listItem")&&e.getAttribute("listType")==this.type}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,t=this.editor.model.schema,n=Xf(e.getSelectedBlocks());return!!n&&km(n,t)}}function _m(e,t,n){const r=t?e[0]:e[e.length-1];if(r.is("listItem")){let i=r[t?"previousSibling":"nextSibling"],o=r.getAttribute("listIndent");for(;i&&i.is("listItem")&&i.getAttribute("listIndent")>=n;)o>i.getAttribute("listIndent")&&(o=i.getAttribute("listIndent")),i.getAttribute("listIndent")==o&&e[t?"unshift":"push"](i),i=i[t?"previousSibling":"nextSibling"]}}function km(e,t){return t.checkChild(e.parent,"listItem")&&!t.isObject(e)}class Em extends jl{constructor(e,t){super(e),this._indentBy="forward"==t?1:-1}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,t=e.document;let n=Array.from(t.selection.getSelectedBlocks());e.change((e=>{const t=n[n.length-1];let r=t.nextSibling;for(;r&&"listItem"==r.name&&r.getAttribute("listIndent")>t.getAttribute("listIndent");)n.push(r),r=r.nextSibling;this._indentBy<0&&(n=n.reverse());for(const t of n){const n=t.getAttribute("listIndent")+this._indentBy;n<0?e.rename(t,"paragraph"):e.setAttribute("listIndent",n,t)}}))}_checkEnabled(){const e=Xf(this.editor.model.document.selection.getSelectedBlocks());if(!e||!e.is("listItem"))return!1;if(this._indentBy>0){const t=e.getAttribute("listIndent"),n=e.getAttribute("listType");let r=e.previousSibling;for(;r&&r.is("listItem")&&r.getAttribute("listIndent")>=t;){if(r.getAttribute("listIndent")==t)return r.getAttribute("listType")==n;r=r.previousSibling}return!1}return!0}}function Om(e,t){const n=t.mapper,r=t.writer,i="numbered"==e.getAttribute("listType")?"ol":"ul",o=function(e){const t=e.createContainerElement("li");return t.getFillerOffset=Pm,t}(r),a=r.createContainerElement(i,null);return r.insert(r.createPositionAt(a,0),o),n.bindElements(e,o),o}function Tm(e,t,n,r){const i=t.parent,o=n.mapper,a=n.writer;let s=o.toViewPosition(r.createPositionBefore(e));const c=Cm(e.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:e.getAttribute("listIndent")}),u=e.previousSibling;if(c&&c.getAttribute("listIndent")==e.getAttribute("listIndent")){const e=o.toViewElement(c);s=a.breakContainer(a.createPositionAfter(e))}else s=u&&"listItem"==u.name?o.toViewPosition(r.createPositionAt(u,"end")):o.toViewPosition(r.createPositionBefore(e));if(s=Sm(s),a.insert(s,i),u&&"listItem"==u.name){const e=o.toViewElement(u),n=a.createRange(a.createPositionAt(e,0),s).getWalker({ignoreElementEnd:!0});for(const e of n)if(e.item.is("li")){const r=a.breakContainer(a.createPositionBefore(e.item)),i=e.item.parent,o=a.createPositionAt(t,"end");xm(a,o.nodeBefore,o.nodeAfter),a.move(a.createRangeOn(i),o),n.position=r}}else{const n=i.nextSibling;if(n&&(n.is("ul")||n.is("ol"))){let r=null;for(const t of n.getChildren()){const n=o.toModelElement(t);if(!(n&&n.getAttribute("listIndent")>e.getAttribute("listIndent")))break;r=t}r&&(a.breakContainer(a.createPositionAfter(r)),a.move(a.createRangeOn(r.parent),a.createPositionAt(t,"end")))}}xm(a,i,i.nextSibling),xm(a,i.previousSibling,i)}function xm(e,t,n){return!t||!n||"ul"!=t.name&&"ol"!=t.name||t.name!=n.name||t.getAttribute("class")!==n.getAttribute("class")?null:e.mergeContainers(e.createPositionAfter(t))}function Sm(e){return e.getLastMatchingPosition((e=>e.item.is("uiElement")))}function Cm(e,t){const n=!!t.sameIndent,r=!!t.smallerIndent,i=t.listIndent;let o=e;for(;o&&"listItem"==o.name;){const e=o.getAttribute("listIndent");if(n&&i==e||r&&i>e)return o;o=o.previousSibling}return null}function Rm(e,t,n,r){e.ui.componentFactory.add(t,(i=>{const o=e.commands.get(t),a=new hl(i);return a.set({label:n,icon:r,tooltip:!0,isToggleable:!0}),a.bind("isOn","isEnabled").to(o,"value","isEnabled"),a.on("execute",(()=>e.execute(t))),a}))}function Pm(){const e=!this.isEmpty&&("ul"==this.getChild(0).name||"ol"==this.getChild(0).name);return this.isEmpty||e?0:Or.call(this)}function Nm(e){return(t,n,r)=>{const i=r.consumable;if(!i.test(n.item,"insert")||!i.test(n.item,"attribute:listType")||!i.test(n.item,"attribute:listIndent"))return;i.consume(n.item,"insert"),i.consume(n.item,"attribute:listType"),i.consume(n.item,"attribute:listIndent");const o=n.item;Tm(o,Om(o,r),r,e)}}function Mm(e,t,n){if(!n.consumable.consume(t.item,"attribute:listType"))return;const r=n.mapper.toViewElement(t.item),i=n.writer;i.breakContainer(i.createPositionBefore(r)),i.breakContainer(i.createPositionAfter(r));const o=r.parent,a="numbered"==t.attributeNewValue?"ol":"ul";i.rename(a,o)}function Am(e,t,n){const r=n.mapper.toViewElement(t.item).parent,i=n.writer;xm(i,r,r.nextSibling),xm(i,r.previousSibling,r);for(const e of t.item.getChildren())n.consumable.consume(e,"insert")}function jm(e,t,n){if("listItem"!=t.item.name){let e=n.mapper.toViewPosition(t.range.start);const r=n.writer,i=[];for(;("ul"==e.parent.name||"ol"==e.parent.name)&&(e=r.breakContainer(e),"li"==e.parent.name);){const t=e,n=r.createPositionAt(e.parent,"end");if(!t.isEqual(n)){const e=r.remove(r.createRange(t,n));i.push(e)}e=r.createPositionAfter(e.parent)}if(i.length>0){for(let t=0;t<i.length;t++){const n=e.nodeBefore;if(e=r.insert(e,i[t]).end,t>0){const t=xm(r,n,n.nextSibling);t&&t.parent==n&&e.offset--}}xm(r,e.nodeBefore,e.nodeAfter)}}}function Im(e,t,n){const r=n.mapper.toViewPosition(t.position),i=r.nodeBefore,o=r.nodeAfter;xm(n.writer,i,o)}function Dm(e,t,n){if(n.consumable.consume(t.viewItem,{name:!0})){const e=n.writer,r=e.createElement("listItem"),i=function(e){let t=0,n=e.parent;for(;n;){if(n.is("li"))t++;else{const e=n.previousSibling;e&&e.is("li")&&t++}n=n.parent}return t}(t.viewItem);e.setAttribute("listIndent",i,r);const o=t.viewItem.parent&&"ol"==t.viewItem.parent.name?"numbered":"bulleted";e.setAttribute("listType",o,r);const a=n.splitToAllowedParent(r,t.modelCursor);if(!a)return;e.insert(r,a.position);const s=function(e,t,n){const{writer:r,schema:i}=n;let o=r.createPositionAfter(e);for(const a of t)if("ul"==a.name||"ol"==a.name)o=n.convertItem(a,o).modelCursor;else{const t=n.convertItem(a,r.createPositionAt(e,"end")),s=t.modelRange.start.nodeAfter;s&&s.is("element")&&!i.checkChild(e,s.name)&&(e=t.modelCursor.parent.is("listItem")?t.modelCursor.parent:Vm(t.modelCursor),o=r.createPositionAfter(e))}return o}(r,t.viewItem.getChildren(),n);t.modelRange=e.createRange(t.modelCursor,s),a.cursorParent?t.modelCursor=e.createPositionAt(a.cursorParent,0):t.modelCursor=t.modelRange.end}}function Lm(e,t,n){if(n.consumable.test(t.viewItem,{name:!0})){const e=Array.from(t.viewItem.getChildren());for(const t of e)!t.is("li")&&!Hm(t)&&t._remove()}}function Bm(e,t,n){if(n.consumable.test(t.viewItem,{name:!0})){if(0===t.viewItem.childCount)return;const e=[...t.viewItem.getChildren()];let n=!1,r=!0;for(const t of e)n&&!Hm(t)&&t._remove(),t.is("text")?(r&&(t._data=t.data.replace(/^\s+/,"")),t.nextSibling&&!Hm(t.nextSibling)||(t._data=t.data.replace(/\s+$/,""))):Hm(t)&&(n=!0),r=!1}}function Fm(e){return(t,n)=>{if(n.isPhantom)return;const r=n.modelPosition.nodeBefore;if(r&&r.is("listItem")){const t=n.mapper.toViewElement(r),i=t.getAncestors().find(Hm),o=e.createPositionAt(t,0).getWalker();for(const e of o){if("elementStart"==e.type&&e.item.is("li")){n.viewPosition=e.previousPosition;break}if("elementEnd"==e.type&&e.item==i){n.viewPosition=e.nextPosition;break}}}}}function qm(e,[t,n]){let r,i=t.is("documentFragment")?t.getChild(0):t;if(r=n?this.createSelection(n):this.document.selection,i&&i.is("listItem")){const e=r.getFirstPosition();let t=null;if(e.parent.is("listItem")?t=e.parent:e.nodeBefore&&e.nodeBefore.is("listItem")&&(t=e.nodeBefore),t){const e=t.getAttribute("listIndent");if(e>0)for(;i&&i.is("listItem");)i._setAttribute("listIndent",i.getAttribute("listIndent")+e),i=i.nextSibling}}}function Vm(e){const t=new Qa({startPosition:e});let n;do{n=t.next()}while(!n.value.item.is("listItem"));return n.value.item}function Um(e,t,n,r,i,o){const a=Cm(t.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:e,foo:"b"}),s=i.mapper,c=i.writer,u=a?a.getAttribute("listIndent"):null;let l;if(a)if(u==e){const e=s.toViewElement(a).parent;l=c.createPositionAfter(e)}else{const e=o.createPositionAt(a,"end");l=s.toViewPosition(e)}else l=n;l=Sm(l);for(const e of[...r.getChildren()])Hm(e)&&(l=c.move(c.createRangeOn(e),l).end,xm(c,e,e.nextSibling),xm(c,e.previousSibling,e))}function Hm(e){return e.is("ol")||e.is("ul")}class zm extends Rl{static get pluginName(){return"ListEditing"}static get requires(){return[Rp]}init(){const e=this.editor;e.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});const t=e.data,n=e.editing;var r;e.model.document.registerPostFixer((t=>function(e,t){const n=e.document.differ.getChanges(),r=new Map;let i=!1;for(const r of n)if("insert"==r.type&&"listItem"==r.name)o(r.position);else if("insert"==r.type&&"listItem"!=r.name){if("$text"!=r.name){const n=r.position.nodeAfter;n.hasAttribute("listIndent")&&(t.removeAttribute("listIndent",n),i=!0),n.hasAttribute("listType")&&(t.removeAttribute("listType",n),i=!0);for(const t of Array.from(e.createRangeIn(n)).filter((e=>e.item.is("listItem"))))o(t.previousPosition)}o(r.position.getShiftedBy(r.length))}else"remove"==r.type&&"listItem"==r.name?o(r.position):("attribute"==r.type&&"listIndent"==r.attributeKey||"attribute"==r.type&&"listType"==r.attributeKey)&&o(r.range.start);for(const e of r.values())a(e),s(e);return i;function o(e){const t=e.nodeBefore;if(t&&t.is("listItem")){let n=t;if(r.has(n))return;for(;n.previousSibling&&n.previousSibling.is("listItem");)if(n=n.previousSibling,r.has(n))return;r.set(e.nodeBefore,n)}else{const t=e.nodeAfter;t&&t.is("listItem")&&r.set(t,t)}}function a(e){let n=0,r=null;for(;e&&e.is("listItem");){const o=e.getAttribute("listIndent");if(o>n){let a;null===r?(r=o-n,a=n):(r>o&&(r=o),a=o-r),t.setAttribute("listIndent",a,e),i=!0}else r=null,n=e.getAttribute("listIndent")+1;e=e.nextSibling}}function s(e){let n=[],r=null;for(;e&&e.is("listItem");){const o=e.getAttribute("listIndent");if(r&&r.getAttribute("listIndent")>o&&(n=n.slice(0,o+1)),0!=o)if(n[o]){const r=n[o];e.getAttribute("listType")!=r&&(t.setAttribute("listType",r,e),i=!0)}else n[o]=e.getAttribute("listType");r=e,e=e.nextSibling}}}(e.model,t))),n.mapper.registerViewToModelLength("li",Wm),t.mapper.registerViewToModelLength("li",Wm),n.mapper.on("modelToViewPosition",Fm(n.view)),n.mapper.on("viewToModelPosition",(r=e.model,(e,t)=>{const n=t.viewPosition,i=n.parent,o=t.mapper;if("ul"==i.name||"ol"==i.name){if(n.isAtEnd){const e=o.toModelElement(n.nodeBefore),i=o.getModelLength(n.nodeBefore);t.modelPosition=r.createPositionBefore(e).getShiftedBy(i)}else{const e=o.toModelElement(n.nodeAfter);t.modelPosition=r.createPositionBefore(e)}e.stop()}else if("li"==i.name&&n.nodeBefore&&("ul"==n.nodeBefore.name||"ol"==n.nodeBefore.name)){const a=o.toModelElement(i);let s=1,c=n.nodeBefore;for(;c&&Hm(c);)s+=o.getModelLength(c),c=c.previousSibling;t.modelPosition=r.createPositionBefore(a).getShiftedBy(s),e.stop()}})),t.mapper.on("modelToViewPosition",Fm(n.view)),e.conversion.for("editingDowncast").add((t=>{t.on("insert",jm,{priority:"high"}),t.on("insert:listItem",Nm(e.model)),t.on("attribute:listType:listItem",Mm,{priority:"high"}),t.on("attribute:listType:listItem",Am,{priority:"low"}),t.on("attribute:listIndent:listItem",function(e){return(t,n,r)=>{if(!r.consumable.consume(n.item,"attribute:listIndent"))return;const i=r.mapper.toViewElement(n.item),o=r.writer;o.breakContainer(o.createPositionBefore(i)),o.breakContainer(o.createPositionAfter(i));const a=i.parent,s=a.previousSibling,c=o.createRangeOn(a);o.remove(c),s&&s.nextSibling&&xm(o,s,s.nextSibling),Um(n.attributeOldValue+1,n.range.start,c.start,i,r,e),Tm(n.item,i,r,e);for(const e of n.item.getChildren())r.consumable.consume(e,"insert")}}(e.model)),t.on("remove:listItem",function(e){return(t,n,r)=>{const i=r.mapper.toViewPosition(n.position).getLastMatchingPosition((e=>!e.item.is("li"))).nodeAfter,o=r.writer;o.breakContainer(o.createPositionBefore(i)),o.breakContainer(o.createPositionAfter(i));const a=i.parent,s=a.previousSibling,c=o.createRangeOn(a),u=o.remove(c);s&&s.nextSibling&&xm(o,s,s.nextSibling),Um(r.mapper.toModelElement(i).getAttribute("listIndent")+1,n.position,c.start,i,r,e);for(const e of o.createRangeIn(u).getItems())r.mapper.unbindViewElement(e);t.stop()}}(e.model)),t.on("remove",Im,{priority:"low"})})),e.conversion.for("dataDowncast").add((t=>{t.on("insert",jm,{priority:"high"}),t.on("insert:listItem",Nm(e.model))})),e.conversion.for("upcast").add((e=>{e.on("element:ul",Lm,{priority:"high"}),e.on("element:ol",Lm,{priority:"high"}),e.on("element:li",Bm,{priority:"high"}),e.on("element:li",Dm)})),e.model.on("insertContent",qm,{priority:"high"}),e.commands.add("numberedList",new wm(e,"numbered")),e.commands.add("bulletedList",new wm(e,"bulleted")),e.commands.add("indentList",new Em(e,"forward")),e.commands.add("outdentList",new Em(e,"backward"));const i=n.view.document;this.listenTo(i,"enter",((e,t)=>{const n=this.editor.model.document,r=n.selection.getLastPosition().parent;n.selection.isCollapsed&&"listItem"==r.name&&r.isEmpty&&(this.editor.execute("outdentList"),t.preventDefault(),e.stop())})),this.listenTo(i,"delete",((e,t)=>{if("backward"!==t.direction)return;const n=this.editor.model.document.selection;if(!n.isCollapsed)return;const r=n.getFirstPosition();if(!r.isAtStart)return;const i=r.parent;"listItem"===i.name&&(i.previousSibling&&"listItem"===i.previousSibling.name||(this.editor.execute("outdentList"),t.preventDefault(),e.stop()))}),{priority:"high"});const o=e=>(t,n)=>{this.editor.commands.get(e).isEnabled&&(this.editor.execute(e),n())};e.keystrokes.set("Tab",o("indentList")),e.keystrokes.set("Shift+Tab",o("outdentList"))}afterInit(){const e=this.editor.commands,t=e.get("indent"),n=e.get("outdent");t&&t.registerChildCommand(e.get("indentList")),n&&n.registerChildCommand(e.get("outdentList"))}}function Wm(e){let t=1;for(const n of e.getChildren())if("ul"==n.name||"ol"==n.name)for(const e of n.getChildren())t+=Wm(e);return t}var Ym='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',Qm='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>';class Gm extends Rl{init(){const e=this.editor.t;Rm(this.editor,"numberedList",e("ae"),Ym),Rm(this.editor,"bulletedList",e("af"),Qm)}}function Jm(e,t){return e=>{e.on("attribute:url:media",n)};function n(n,r,i){if(!i.consumable.consume(r.item,n.name))return;const o=r.attributeNewValue,a=i.writer,s=i.mapper.toViewElement(r.item);a.remove(a.createRangeIn(s));const c=e.getMediaViewElement(a,o,t);a.insert(a.createPositionAt(s,0),c)}}function Km(e,t,n,r){const i=e.createContainerElement("figure",{class:"media"});return i.getFillerOffset=Zm,e.insert(e.createPositionAt(i,0),t.getMediaViewElement(e,n,r)),i}function $m(e){const t=e.getSelectedElement();return t&&t.is("media")?t:null}function Xm(e,t,n){e.change((r=>{const i=r.createElement("media",{url:t});e.insertContent(i,n),r.setSelection(i,"on")}))}function Zm(){return null}class ey extends jl{refresh(){const e=this.editor.model,t=e.document.selection,n=e.schema,r=t.getFirstPosition(),i=$m(t);let o=r.parent;o!=o.root&&(o=o.parent),this.value=i?i.getAttribute("url"):null,this.isEnabled=n.checkChild(o,"media")}execute(e){const t=this.editor.model,n=t.document.selection,r=$m(n);if(r)t.change((t=>{t.setAttribute("url",e,r)}));else{const r=_h(n,t);Xm(t,e,r)}}}var ty='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>';const ny="0 0 64 42";class ry{constructor(e,t){const n=t.providers,r=t.extraProviders||[],i=new Set(t.removeProviders),o=n.concat(r).filter((e=>{const t=e.name;return t?!i.has(t):(console.warn(Object(Jn.a)("media-embed-no-provider-name: The configured media provider has no name and cannot be used."),{provider:e}),!1)}));this.locale=e,this.providerDefinitions=o}hasMedia(e){return!!this._getMedia(e)}getMediaViewElement(e,t,n){return this._getMedia(t).getViewElement(e,n)}_getMedia(e){if(!e)return new iy(this.locale);e=e.trim();for(const t of this.providerDefinitions){const n=t.html;let r=t.url;Array.isArray(r)||(r=[r]);for(const t of r){const r=this._getUrlMatches(e,t);if(r)return new iy(this.locale,e,r,n)}}return null}_getUrlMatches(e,t){let n=e.match(t);if(n)return n;let r=e.replace(/^https?:\/\//,"");return n=r.match(t),n||(r=r.replace(/^www\./,""),n=r.match(t),n||null)}}class iy{constructor(e,t,n,r){this.url=this._getValidUrl(t),this._t=e.t,this._match=n,this._previewRenderer=r}getViewElement(e,t){const n={};if(t.renderForEditingView||t.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(n["data-oembed-url"]=this.url),t.renderForEditingView&&(n.class="ck-media__wrapper");const r=this._getPreviewHtml(t);return e.createUIElement("div",n,(function(e){const t=this.toDomElement(e);return t.innerHTML=r,t}))}return this.url&&(n.url=this.url),e.createEmptyElement("oembed",n)}_getPreviewHtml(e){return this._previewRenderer?this._previewRenderer(this._match):this.url&&e.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const e=new fl,t=new ll;return e.text=this._t("Open media in new tab"),t.content=ty,t.viewBox=ny,new xu({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[t]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]},e]}]}).render().outerHTML}_getValidUrl(e){return e?e.match(/^https?/)?e:"https://"+e:null}}n(78);class oy extends Rl{static get pluginName(){return"MediaEmbedEditing"}constructor(e){super(e),e.config.define("mediaEmbed",{providers:[{name:"dailymotion",url:/^dailymotion\.com\/video\/(\w+)/,html:e=>`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${e[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:e=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${e[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)/,/^youtube\.com\/embed\/([\w-]+)/,/^youtu\.be\/([\w-]+)/],html:e=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${e[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:e=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${e[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:/^google\.com\/maps/},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new ry(e.locale,e.config.get("mediaEmbed"))}init(){const e=this.editor,t=e.model.schema,n=e.t,r=e.conversion,i=e.config.get("mediaEmbed.previewsInData"),o=this.registry;e.commands.add("mediaEmbed",new ey(e)),t.register("media",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["url"]}),r.for("dataDowncast").elementToElement({model:"media",view:(e,t)=>{const n=e.getAttribute("url");return Km(t,o,n,{renderMediaPreview:n&&i})}}),r.for("dataDowncast").add(Jm(o,{renderMediaPreview:i})),r.for("editingDowncast").elementToElement({model:"media",view:(e,t)=>{const r=e.getAttribute("url");return function(e,t,n){return t.setCustomProperty("media",!0,e),bh(e,t,{label:n})}(Km(t,o,r,{renderForEditingView:!0}),t,n("ar"))}}),r.for("editingDowncast").add(Jm(o,{renderForEditingView:!0})),r.for("upcast").elementToElement({view:{name:"oembed",attributes:{url:!0}},model:(e,t)=>{const n=e.getAttribute("url");if(o.hasMedia(n))return t.createElement("media",{url:n})}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(e,t)=>{const n=e.getAttribute("data-oembed-url");if(o.hasMedia(n))return t.createElement("media",{url:n})}})}}const ay=/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w.-]+)+[\w\-._~:/?#[\]@!$&'()*+,;=]+$/;class sy extends Rl{static get requires(){return[Al,xf]}static get pluginName(){return"AutoMediaEmbed"}constructor(e){super(e),this._timeoutId=null,this._positionToInsert=null}init(){const e=this.editor,t=e.model.document;this.listenTo(e.plugins.get(Al),"inputTransformation",(()=>{const e=t.selection.getFirstRange(),n=Uc.fromPosition(e.start);n.stickiness="toPrevious";const r=Uc.fromPosition(e.end);r.stickiness="toNext",t.once("change:data",(()=>{this._embedMediaBetweenPositions(n,r),n.detach(),r.detach()}),{priority:"high"})})),e.commands.get("undo").on("execute",(()=>{this._timeoutId&&(no.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)}),{priority:"high"})}_embedMediaBetweenPositions(e,t){const n=this.editor,r=n.plugins.get(oy).registry,i=new cs(e,t),o=i.getWalker({ignoreElementEnd:!0});let a="";for(const e of o)e.item.is("textProxy")&&(a+=e.item.data);a=a.trim(),a.match(ay)&&r.hasMedia(a)&&n.commands.get("mediaEmbed").isEnabled&&(this._positionToInsert=Uc.fromPosition(e),this._timeoutId=no.window.setTimeout((()=>{n.model.change((e=>{let t;this._timeoutId=null,e.remove(i),"$graveyard"!==this._positionToInsert.root.rootName&&(t=this._positionToInsert),Xm(n.model,a,t),this._positionToInsert.detach(),this._positionToInsert=null}))}),100))}}n(80);class cy extends Wu{constructor(e,t){super(t);const n=t.t;this.focusTracker=new mu,this.keystrokes=new au,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(n("bf"),Ud,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(n("bg"),Hd,"ck-button-cancel","cancel"),this._focusables=new Ou,this._focusCycler=new el({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this._validators=e,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form"],tabindex:"-1"},children:[this.urlInputView,this.saveButtonView,this.cancelButtonView]})}render(){super.render(),Vd({view:this}),[this.urlInputView,this.saveButtonView,this.cancelButtonView].forEach((e=>{this._focusables.add(e),this.focusTracker.add(e.element)})),this.keystrokes.listenTo(this.element);const e=e=>e.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e),this.listenTo(this.urlInputView.element,"selectstart",((e,t)=>{t.stopPropagation()}),{priority:"high"})}focus(){this._focusCycler.focusFirst()}get url(){return this.urlInputView.inputView.element.value.trim()}set url(e){this.urlInputView.inputView.element.value=e.trim()}isValid(){this.resetFormStatus();for(const e of this._validators){const t=e(this);if(t)return this.urlInputView.errorText=t,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const e=this.locale.t,t=new Fd(this.locale,qd),n=t.inputView;return this._urlInputViewInfoDefault=e("bh"),this._urlInputViewInfoTip=e("bi"),t.label=e("bj"),t.infoText=this._urlInputViewInfoDefault,n.placeholder="https://example.com",n.on("input",(()=>{t.infoText=n.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault})),t}_createButton(e,t,n,r){const i=new hl(this.locale);return i.set({label:e,icon:t,tooltip:!0}),i.extendTemplate({attributes:{class:n}}),r&&i.delegate("execute").to(this,r),i}}var uy='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18.68 2.53c.6 0 .59-.03.59.55v12.84c0 .59.01.56-.59.56H1.29c-.6 0-.59.03-.59-.56V3.08c0-.58-.01-.55.6-.55h17.38zM15.77 14.5v-10H4.2v10h11.57zM2 4v1h1V4H2zm0 2v1h1V6H2zm0 2v1h1V8H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zM17 4v1h1V4h-1zm0 2v1h1V6h-1zm0 2v1h1V8h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zM7.5 6.677a.4.4 0 0 1 .593-.351l5.133 2.824a.4.4 0 0 1 0 .7l-5.133 2.824a.4.4 0 0 1-.593-.35V6.676z"/></svg>';class ly extends Rl{static get requires(){return[oy]}static get pluginName(){return"MediaEmbedUI"}init(){const e=this.editor,t=e.commands.get("mediaEmbed"),n=e.plugins.get(oy).registry;this.form=new cy(function(e,t){return[t=>{if(!t.url.length)return e("ap")},n=>{if(!t.hasMedia(n.url))return e("aq")}]}(e.t,n),e.locale),e.ui.componentFactory.add("mediaEmbed",(n=>{const r=wl(n);return this._setUpDropdown(r,this.form,t,e),this._setUpForm(this.form,r,t),r}))}_setUpDropdown(e,t,n){const r=this.editor,i=r.t,o=e.buttonView;function a(){r.editing.view.focus(),e.isOpen=!1}e.bind("isEnabled").to(n),e.panelView.children.add(t),o.set({label:i("ao"),icon:uy,tooltip:!0}),o.on("open",(()=>{t.url=n.value||"",t.urlInputView.select(),t.focus()}),{priority:"low"}),e.on("submit",(()=>{t.isValid()&&(r.execute("mediaEmbed",t.url),a())})),e.on("change:isOpen",(()=>t.resetFormStatus())),e.on("cancel",(()=>a()))}_setUpForm(e,t,n){e.delegate("submit","cancel").to(t),e.urlInputView.bind("value").to(n,"value"),e.urlInputView.bind("isReadOnly").to(n,"isEnabled",(e=>!e)),e.saveButtonView.bind("isEnabled").to(n)}}function fy(e,t){if(!e.childCount)return;const n=new _p,r=function(e,t){const n=t.createRangeIn(e),r=new br({name:/^p|h\d+$/,styles:{"mso-list":/.*/}}),i=[];for(const e of n)if("elementStart"===e.type&&r.match(e.item)){const t=hy(e.item);i.push({element:e.item,id:t.id,order:t.order,indent:t.indent})}return i}(e,n);if(!r.length)return;let i=null;r.forEach(((e,o)=>{if(!i||function(e,t){if(e.id!==t.id)return!0;const n=t.element.previousSibling;return!n||!((r=n).is("ol")||r.is("ul"));var r}(r[o-1],e)){const r=function(e,t){const n=/mso-level-number-format:([^;]*);/gi,r=new RegExp(`@list l${e.id}:level${e.indent}\\s*({[^}]*)`,"gi").exec(t);let i="decimal";if(r&&r[1]){const e=n.exec(r[1]);e&&e[1]&&(i=e[1].trim())}return{type:"bullet"!==i&&"image"!==i?"ol":"ul",style:i}}(e,t);i=function(e,t,n){const r=new wr(e.type),i=t.parent.getChildIndex(t);return n.insertChild(i,r,t.parent),r}(r,e.element,n)}const a=function(e,t){return function(e,t){const n=new br({name:"span",styles:{"mso-list":"Ignore"}}),r=t.createRangeIn(e);for(const e of r)"elementStart"===e.type&&n.match(e.item)&&t.remove(e.item)}(e,t),t.rename("li",e)}(e.element,n);n.appendChild(a,i)}))}function hy(e){const t={},n=e.getStyle("mso-list");if(n){const e=n.match(/(^|\s+)l(\d+)/i),r=n.match(/\s*lfo(\d+)/i),i=n.match(/\s*level(\d+)/i);e&&r&&i&&(t.id=e[2],t.order=r[1],t.indent=i[1])}return t}n(82);const dy=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;class py{isActive(e){return dy.test(e)}execute(e){const t=new _p;!function(e,t){for(const n of e.getChildren())if(n.is("b")&&"normal"===n.getStyle("font-weight")){const r=e.getChildIndex(n);t.remove(n),t.insertChild(r,n.getChildren(),e)}}(e.content,t),function(e,t){for(const n of t.createRangeIn(e)){const e=n.item;if(e.is("li")){const n=e.getChild(0);n.is("p")&&t.unwrapElement(n)}}}(e.content,t)}}function my(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,((e,t)=>1===t.length?" ":Array(t.length+1).join("  ").substr(0,t.length)))}function yy(e){const t=new DOMParser,n=function(e){return my(my(e)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[\s]*?)[\r\n]+(\s*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/ <\//g," </").replace(/ <o:p><\/o:p>/g," <o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>(\s*[\r\n]\s*)</g,"><")}(function(e){const t=e.match(/<\/body>(.*?)(<\/html>|$)/);return t&&t[1]&&(e=e.slice(0,t.index)+e.slice(t.index).replace(t[1],"")),e}(e=e.replace(/<!--\[if gte vml 1]>/g,""))),r=t.parseFromString(n,"text/html");!function(e){e.querySelectorAll("span[style*=spacerun]").forEach((e=>{const t=e.childNodes&&e.childNodes[0]&&e.childNodes[0].data&&e.childNodes[0].data.length||0;e.innerHTML=Array(t+1).join("  ").substr(0,t)}))}(r);const i=r.body.innerHTML,o=function(e){const t=new ao({blockFillerMode:"nbsp"}),n=e.createDocumentFragment(),r=e.body.childNodes;for(;r.length>0;)n.appendChild(r[0]);return t.domToView(n)}(r),a=function(e){const t=[],n=[],r=Array.from(e.getElementsByTagName("style"));for(const e of r)e.sheet&&e.sheet.cssRules&&e.sheet.cssRules.length&&(t.push(e.sheet),n.push(e.innerHTML));return{styles:t,stylesString:n.join(" ")}}(r);return{body:o,bodyString:i,styles:a.styles,stylesString:a.stylesString}}function gy(e,t){if(!e.childCount)return;const n=new _p;!function(e,t,n){const r=n.createRangeIn(t),i=new br({name:"img"}),o=[];for(const t of r)if(i.match(t.item)){const n=t.item,r=n.getAttribute("v:shapes")?n.getAttribute("v:shapes").split(" "):[];r.length&&r.every((t=>e.indexOf(t)>-1))?o.push(n):n.getAttribute("src")||o.push(n)}for(const e of o)n.remove(e)}(function(e,t){const n=t.createRangeIn(e),r=new br({name:/v:(.+)/}),i=[];for(const e of n){const t=e.item,n=t.previousSibling&&t.previousSibling.name||null;r.match(t)&&t.getAttribute("o:gfxdata")&&"v:shapetype"!==n&&i.push(e.item.getAttribute("id"))}return i}(e,n),e,n),function(e,t){const n=t.createRangeIn(e),r=new br({name:/v:(.+)/}),i=[];for(const e of n)r.match(e.item)&&i.push(e.item);for(const e of i)t.remove(e)}(e,n);const r=function(e,t){const n=t.createRangeIn(e),r=new br({name:"img"}),i=[];for(const e of n)r.match(e.item)&&e.item.getAttribute("src").startsWith("file://")&&i.push(e.item);return i}(e,n);r.length&&function(e,t,n){if(e.length===t.length)for(let i=0;i<e.length;i++){const o=`data:${t[i].type};base64,${r=t[i].hex,btoa(r.match(/\w{2}/g).map((e=>String.fromCharCode(parseInt(e,16)))).join(""))}`;n.setAttribute("src",o,e[i])}var r}(r,function(e){if(!e)return[];const t=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,n=new RegExp("(?:("+t.source+"))([\\da-fA-F\\s]+)\\}","g"),r=e.match(n),i=[];if(r)for(const e of r){let n=!1;e.includes("\\pngblip")?n="image/png":e.includes("\\jpegblip")&&(n="image/jpeg"),n&&i.push({hex:e.replace(t,"").replace(/[^\da-fA-F]/g,""),type:n})}return i}(t),n)}const by=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,vy=/xmlns:o="urn:schemas-microsoft-com/i;class wy{isActive(e){return by.test(e)||vy.test(e)}execute(e){const{body:t,stylesString:n}=yy(e.dataTransfer.getData("text/html"));fy(t,n),gy(t,e.dataTransfer.getData("text/rtf")),e.content=t}}function _y(e,t){let n=t.parent;for(;n;){if(n.name===e)return n;n=n.parent}}function ky(e,t,n,r,i=1){t>i?r.setAttribute(e,t,n):r.removeAttribute(e,n)}function Ey(e,t,n={}){const r=e.createElement("tableCell",n);e.insertElement("paragraph",r),e.insert(r,t)}function Oy(){return e=>{e.on("element:table",((e,t,n)=>{const r=t.viewItem;if(!n.consumable.test(r,{name:!0}))return;const{rows:i,headingRows:o,headingColumns:a}=function(e){const t={headingRows:0,headingColumns:0},n=[],r=[];let i;for(const o of Array.from(e.getChildren()))if("tbody"===o.name||"thead"===o.name||"tfoot"===o.name){"thead"!==o.name||i||(i=o);const e=Array.from(o.getChildren()).filter((e=>e.is("element","tr")));for(const o of e)if("thead"===o.parent.name&&o.parent===i)t.headingRows++,n.push(o);else{r.push(o);const e=xy(o);e>t.headingColumns&&(t.headingColumns=e)}}return t.rows=[...n,...r],t}(r),s={};a&&(s.headingColumns=a),o&&(s.headingRows=o);const c=n.writer.createElement("table",s),u=n.splitToAllowedParent(c,t.modelCursor);if(u){if(n.writer.insert(c,u.position),n.consumable.consume(r,{name:!0}),i.length)i.forEach((e=>n.convertItem(e,n.writer.createPositionAt(c,"end"))));else{const e=n.writer.createElement("tableRow");n.writer.insert(e,n.writer.createPositionAt(c,"end")),Ey(n.writer,n.writer.createPositionAt(e,"end"))}t.modelRange=n.writer.createRange(n.writer.createPositionBefore(c),n.writer.createPositionAfter(c)),u.cursorParent?t.modelCursor=n.writer.createPositionAt(u.cursorParent,0):t.modelCursor=t.modelRange.end}}))}}function Ty(e){return t=>{t.on(`element:${e}`,((e,t,n)=>{const r=t.viewItem;if(!n.consumable.test(r,{name:!0}))return;const i=n.writer.createElement("tableCell"),o=n.splitToAllowedParent(i,t.modelCursor);if(!o)return;n.writer.insert(i,o.position),n.consumable.consume(r,{name:!0});const a=n.writer.createPositionAt(i,0);n.convertChildren(r,a),i.childCount||n.writer.insertElement("paragraph",a),t.modelRange=n.writer.createRange(n.writer.createPositionBefore(i),n.writer.createPositionAfter(i)),t.modelCursor=t.modelRange.end}))}}function xy(e){let t=0,n=0;const r=Array.from(e.getChildren()).filter((e=>"th"===e.name||"td"===e.name));for(;n<r.length&&"th"===r[n].name;){const e=r[n];t+=parseInt(e.getAttribute("colspan")||1),n++}return t}class Sy{constructor(e,t={}){this.table=e,this.startRow=t.startRow||0,this.endRow="number"==typeof t.endRow?t.endRow:void 0,this.includeSpanned=!!t.includeSpanned,this.column="number"==typeof t.column?t.column:void 0,this._skipRows=new Set,this._row=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){const e=this.table.getChild(this._row);if(!e||this._isOverEndRow())return{done:!0};let t,n,r;if(this._isSpanned(this._row,this._column))t=this._getSpanned(this._row,this._column),n=!this.includeSpanned||this._shouldSkipRow()||this._shouldSkipColumn(),r=this._formatOutValue(t,this._column,!0);else{if(t=e.getChild(this._cellIndex),!t)return this._row++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next();const i=parseInt(t.getAttribute("colspan")||1),o=parseInt(t.getAttribute("rowspan")||1);(i>1||o>1)&&this._recordSpans(this._row,this._column,o,i,t),this._nextCellAtColumn=this._column+i,n=this._shouldSkipRow()||this._shouldSkipColumn(),r=this._formatOutValue(t,this._column,!1,o,i)}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,n?this.next():r}skipRow(e){this._skipRows.add(e)}_isOverEndRow(){return void 0!==this.endRow&&this._row>this.endRow}_formatOutValue(e,t,n,r=1,i=1){return{done:!1,value:{cell:e,row:this._row,column:t,isSpanned:n,rowspan:r,colspan:i,cellIndex:this._cellIndex}}}_shouldSkipRow(){const e=this._row<this.startRow,t=this._skipRows.has(this._row);return e||t}_shouldSkipColumn(){return void 0!==this.column&&this.column!=this._column}_isSpanned(e,t){return!!this._spannedCells.has(e)&&this._spannedCells.get(e).has(t)}_getSpanned(e,t){return this._spannedCells.get(e).get(t)}_recordSpans(e,t,n,r,i){for(let n=t+1;n<=t+r-1;n++)this._markSpannedCell(e,n,i);for(let o=e+1;o<e+n;o++)for(let e=t;e<=t+r-1;e++)this._markSpannedCell(o,e,i)}_markSpannedCell(e,t,n){this._spannedCells.has(e)||this._spannedCells.set(e,new Map),this._spannedCells.get(e).set(t,n)}}function Cy(e){return!!e.getCustomProperty("table")&&gh(e)}function Ry(e){const t=e.getSelectedElement();return t&&Cy(t)?t:null}function Py(e){const t=_y("table",e.getFirstPosition());return t&&Cy(t.parent)?t.parent:null}function Ny(e={}){return t=>t.on("insert:table",((t,n,r)=>{const i=n.item;if(!r.consumable.consume(i,"insert"))return;r.consumable.consume(i,"attribute:headingRows:table"),r.consumable.consume(i,"attribute:headingColumns:table");const o=e&&e.asWidget,a=r.writer.createContainerElement("figure",{class:"table"}),s=r.writer.createContainerElement("table");let c;r.writer.insert(r.writer.createPositionAt(a,0),s),o&&(c=function(e,t){return t.setCustomProperty("table",!0,e),bh(e,t,{hasSelectionHandle:!0})}(a,r.writer));const u=new Sy(i),l={headingRows:i.getAttribute("headingRows")||0,headingColumns:i.getAttribute("headingColumns")||0},f=new Map;for(const t of u){const{row:n,cell:o}=t,a=Uy(Vy(n,l),s,r),c=i.getChild(n),u=f.get(n)||Fy(c,n,a,r);f.set(n,u),r.consumable.consume(o,"insert"),By(t,l,r.writer.createPositionAt(u,"end"),r,e)}const h=r.mapper.toViewPosition(n.range.start);r.mapper.bindElements(i,o?c:a),r.writer.insert(h,o?c:a)}))}function My(e={}){return t=>t.on("insert:tableRow",((t,n,r)=>{const i=n.item;if(!r.consumable.consume(i,"insert"))return;const o=i.parent,a=Yy(r.mapper.toViewElement(o)),s=o.getChildIndex(i),c=new Sy(o,{startRow:s,endRow:s}),u={headingRows:o.getAttribute("headingRows")||0,headingColumns:o.getAttribute("headingColumns")||0},l=new Map;for(const t of c){const n=Uy(Vy(s,u),a,r),o=l.get(s)||Fy(i,s,n,r);l.set(s,o),r.consumable.consume(t.cell,"insert"),By(t,u,r.writer.createPositionAt(o,"end"),r,e)}}))}function Ay(e={}){return t=>t.on("insert:tableCell",((t,n,r)=>{const i=n.item;if(!r.consumable.consume(i,"insert"))return;const o=i.parent,a=o.parent,s=a.getChildIndex(o),c=new Sy(a,{startRow:s,endRow:s}),u={headingRows:a.getAttribute("headingRows")||0,headingColumns:a.getAttribute("headingColumns")||0};for(const t of c)if(t.cell===i){const n=r.mapper.toViewElement(o);return void By(t,u,r.writer.createPositionAt(n,o.getChildIndex(i)),r,e)}}))}function jy(e={}){const t=!!e.asWidget;return e=>e.on("attribute:headingRows:table",((e,n,r)=>{const i=n.item;if(!r.consumable.consume(n.item,e.name))return;const o=Yy(r.mapper.toViewElement(i)),a=n.attributeOldValue,s=n.attributeNewValue;if(s>a){const e=Array.from(i.getChildren()).filter((({index:e})=>c(e,a-1,s)));Wy(e,Uy("thead",o,r),r,"end");for(const n of e)for(const e of n.getChildren())Dy(e,"th",r,t);zy("tbody",o,r)}else{Wy(Array.from(i.getChildren()).filter((({index:e})=>c(e,s-1,a))).reverse(),Uy("tbody",o,r),r,0);const e=new Sy(i,{startRow:s?s-1:s,endRow:a-1}),n={headingRows:i.getAttribute("headingRows")||0,headingColumns:i.getAttribute("headingColumns")||0};for(const i of e)Ly(i,n,r,t);zy("thead",o,r)}function c(e,t,n){return e>t&&e<n}}))}function Iy(e={}){const t=!!e.asWidget;return e=>e.on("attribute:headingColumns:table",((e,n,r)=>{const i=n.item;if(!r.consumable.consume(n.item,e.name))return;const o={headingRows:i.getAttribute("headingRows")||0,headingColumns:i.getAttribute("headingColumns")||0},a=n.attributeOldValue,s=n.attributeNewValue,c=(a>s?a:s)-1;for(const e of new Sy(i))e.column>c||Ly(e,o,r,t)}))}function Dy(e,t,n,r){const i=n.writer,o=n.mapper.toViewElement(e);if(!o)return;let a;r?(a=wh(i.createEditableElement(t,o.getAttributes()),i),i.insert(i.createPositionAfter(o),a),i.move(i.createRangeIn(o),i.createPositionAt(a,0)),i.remove(i.createRangeOn(o))):a=i.rename(t,o),n.mapper.unbindViewElement(o),n.mapper.bindElements(e,a)}function Ly(e,t,n,r){const{cell:i}=e,o=qy(e,t),a=n.mapper.toViewElement(i);a&&a.name!==o&&Dy(i,o,n,r)}function By(e,t,n,r,i){const o=i&&i.asWidget,a=qy(e,t),s=o?wh(r.writer.createEditableElement(a),r.writer):r.writer.createContainerElement(a),c=e.cell,u=c.getChild(0),l=1===c.childCount&&"paragraph"===u.name;if(r.writer.insert(n,s),l&&![...u.getAttributeKeys()].length){const e=c.getChild(0),t=r.writer.createPositionAt(s,"end");if(r.consumable.consume(e,"insert"),i.asWidget){const n=r.writer.createContainerElement("span");r.mapper.bindElements(e,n),r.writer.insert(t,n),r.mapper.bindElements(c,s)}else r.mapper.bindElements(c,s),r.mapper.bindElements(e,s)}else r.mapper.bindElements(c,s)}function Fy(e,t,n,r){r.consumable.consume(e,"insert");const i=r.writer.createContainerElement("tr");r.mapper.bindElements(e,i);const o=e.parent.getAttribute("headingRows")||0,a=o>0&&t>=o?t-o:t,s=r.writer.createPositionAt(n,a);return r.writer.insert(s,i),i}function qy(e,t){const{row:n,column:r}=e,{headingColumns:i,headingRows:o}=t;return o&&o>n||i&&i>r?"th":"td"}function Vy(e,t){return e<t.headingRows?"thead":"tbody"}function Uy(e,t,n){return Hy(e,t)||function(e,t,n){const r=n.writer.createContainerElement(e),i=n.writer.createPositionAt(t,"tbody"==e?"end":0);return n.writer.insert(i,r),r}(e,t,n)}function Hy(e,t){for(const n of t.getChildren())if(n.name==e)return n}function zy(e,t,n){const r=Hy(e,t);r&&0===r.childCount&&n.writer.remove(n.writer.createRangeOn(r))}function Wy(e,t,n,r){for(const i of e){const e=n.mapper.toViewElement(i);e&&n.writer.move(n.writer.createRangeOn(e),n.writer.createPositionAt(t,r))}}function Yy(e){for(const t of e.getChildren())if("table"===t.name)return t}class Qy extends jl{refresh(){const e=this.editor.model,t=e.document.selection,n=e.schema,r=function(e){const t=e.parent;return t===t.root?t:t.parent}(t.getFirstPosition());this.isEnabled=n.checkChild(r,"table")}execute(e={}){const t=this.editor.model,n=t.document.selection,r=this.editor.plugins.get("TableUtils"),i=parseInt(e.rows)||2,o=parseInt(e.columns)||2,a=_h(n,t);t.change((e=>{const n=r.createTable(e,i,o);t.insertContent(n,a),e.setSelection(e.createPositionAt(n.getNodeByPath([0,0,0]),0))}))}}class Gy extends jl{constructor(e,t={}){super(e),this.order=t.order||"below"}refresh(){const e=_y("table",this.editor.model.document.selection.getFirstPosition());this.isEnabled=!!e}execute(){const e=this.editor,t=e.model.document.selection,n=e.plugins.get("TableUtils"),r=_y("tableCell",t.getFirstPosition()).parent,i=r.parent,o=i.getChildIndex(r),a="below"===this.order?o+1:o;n.insertRows(i,{rows:1,at:a})}}class Jy extends jl{constructor(e,t={}){super(e),this.order=t.order||"right"}refresh(){const e=_y("table",this.editor.model.document.selection.getFirstPosition());this.isEnabled=!!e}execute(){const e=this.editor,t=e.model.document.selection,n=e.plugins.get("TableUtils"),r=_y("tableCell",t.getFirstPosition()),i=r.parent.parent,{column:o}=n.getCellLocation(r),a="right"===this.order?o+1:o;n.insertColumns(i,{columns:1,at:a})}}class Ky extends jl{constructor(e,t={}){super(e),this.direction=t.direction||"horizontally"}refresh(){const e=_y("tableCell",this.editor.model.document.selection.getFirstPosition());this.isEnabled=!!e}execute(){const e=_y("tableCell",this.editor.model.document.selection.getFirstPosition()),t="horizontally"===this.direction,n=this.editor.plugins.get("TableUtils");t?n.splitCellHorizontally(e,2):n.splitCellVertically(e,2)}}class $y extends jl{constructor(e,t){super(e),this.direction=t.direction,this.isHorizontal="right"==this.direction||"left"==this.direction}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,t=_y("tableCell",e.document.selection.getFirstPosition()),n=this.value,r=this.direction;e.change((e=>{const i="right"==r||"down"==r,o=i?t:n,a=i?n:t,s=a.parent;!function(e,t,n){Xy(e)||(Xy(t)&&n.remove(n.createRangeIn(t)),n.move(n.createRangeIn(e),n.createPositionAt(t,"end"))),n.remove(e)}(a,o,e);const c=this.isHorizontal?"colspan":"rowspan",u=parseInt(t.getAttribute(c)||1),l=parseInt(n.getAttribute(c)||1);e.setAttribute(c,u+l,o),e.setSelection(e.createRangeIn(o)),s.childCount||function(e,t){const n=e.parent,r=n.getChildIndex(e);for(const{cell:e,row:i,rowspan:o}of new Sy(n,{endRow:r}))i+o-1>=r&&ky("rowspan",o-1,e,t);t.remove(e)}(s,e)}))}_getMergeableCell(){const e=_y("tableCell",this.editor.model.document.selection.getFirstPosition());if(!e)return;const t=this.editor.plugins.get("TableUtils"),n=this.isHorizontal?function(e,t,n){const r=e.parent.parent,i="right"==t?e.nextSibling:e.previousSibling,o=r.getAttribute("headingColumns")||0;if(!i)return;const a="right"==t?e:i,s="right"==t?i:e,{column:c}=n.getCellLocation(a),{column:u}=n.getCellLocation(s),l=parseInt(a.getAttribute("colspan")||1),f=parseInt(s.getAttribute("colspan")||1);return o&&("right"==t&&u+f>o||"left"==t&&c+l>o-1)?void 0:c+l===u?i:void 0}(e,this.direction,t):function(e,t){const n=e.parent,r=n.parent,i=r.getChildIndex(n);if("down"==t&&i===r.childCount-1||"up"==t&&0===i)return;const o=parseInt(e.getAttribute("rowspan")||1),a=r.getAttribute("headingRows")||0;if(a&&("down"==t&&i+o===a||"up"==t&&i===a))return;const s=parseInt(e.getAttribute("rowspan")||1),c="down"==t?i+s:i,u=[...new Sy(r,{endRow:c})],l=u.find((t=>t.cell===e)).column,f=u.find((({row:e,rowspan:n,column:r})=>r===l&&("down"==t?e===c:c===e+n)));return f&&f.cell}(e,this.direction);if(!n)return;const r=this.isHorizontal?"rowspan":"colspan",i=parseInt(e.getAttribute(r)||1);return parseInt(n.getAttribute(r)||1)===i?n:void 0}}function Xy(e){return 1==e.childCount&&e.getChild(0).is("paragraph")&&e.getChild(0).isEmpty}class Zy extends jl{refresh(){const e=_y("tableCell",this.editor.model.document.selection.getFirstPosition());this.isEnabled=!!e&&e.parent.parent.childCount>1}execute(){const e=this.editor.model,t=_y("tableCell",e.document.selection.getFirstPosition()).parent,n=t.parent,r=n.getChildIndex(t),i=n.getAttribute("headingRows")||0;e.change((e=>{i&&r<=i&&ky("headingRows",i-1,n,e,0);const o=[...new Sy(n,{endRow:r})],a=new Map;o.filter((({row:e,rowspan:t})=>e===r&&t>1)).forEach((({column:e,cell:t,rowspan:n})=>a.set(e,{cell:t,rowspanToSet:n-1}))),o.filter((({row:e,rowspan:t})=>e<=r-1&&e+t>r)).forEach((({cell:t,rowspan:n})=>ky("rowspan",n-1,t,e)));const s=r+1,c=new Sy(n,{includeSpanned:!0,startRow:s,endRow:s});let u;for(const{row:t,column:r,cell:i}of[...c])if(a.has(r)){const{cell:i,rowspanToSet:o}=a.get(r),s=u?e.createPositionAfter(u):e.createPositionAt(n.getChild(t),0);e.move(e.createRangeOn(i),s),ky("rowspan",o,i,e),u=i}else u=i;e.remove(t)}))}}class eg extends jl{refresh(){const e=this.editor,t=e.model.document.selection,n=e.plugins.get("TableUtils"),r=_y("tableCell",t.getFirstPosition());this.isEnabled=!!r&&n.getColumns(r.parent.parent)>1}execute(){const e=this.editor.model,t=_y("tableCell",e.document.selection.getFirstPosition()),n=t.parent,r=n.parent,i=r.getAttribute("headingColumns")||0,o=r.getChildIndex(n),a=[...new Sy(r)],s=a.find((e=>e.cell===t)).column;e.change((e=>{i&&o<=i&&e.setAttribute("headingColumns",i-1,r);for(const{cell:t,column:n,colspan:r}of a)n<=s&&r>1&&n+r>s?ky("colspan",r-1,t,e):n===s&&e.remove(t)}))}}class tg extends jl{refresh(){const e=_y("tableCell",this.editor.model.document.selection.getFirstPosition()),t=!!e;this.isEnabled=t,this.value=t&&this._isInHeading(e,e.parent.parent)}execute(e={}){const t=this.editor.model,n=_y("tableCell",t.document.selection.getFirstPosition()).parent,r=n.parent,i=r.getAttribute("headingRows")||0,o=n.index;if(e.forceValue===this.value)return;const a=this.value?o:o+1;t.change((e=>{if(a){const t=function(e,t,n){const r=[],i=new Sy(e,{startRow:t>n?n:0,endRow:t-1});for(const{row:e,rowspan:n,cell:o}of i)n>1&&e+n>t&&r.push(o);return r}(r,a,i);for(const n of t)ng(n,a,e)}ky("headingRows",a,r,e,0)}))}_isInHeading(e,t){const n=parseInt(t.getAttribute("headingRows")||0);return!!n&&e.parent.index<n}}function ng(e,t,n){const r=e.parent,i=r.parent,o=t-r.index,a={},s=parseInt(e.getAttribute("rowspan"))-o;s>1&&(a.rowspan=s);const c=parseInt(e.getAttribute("colspan")||1);c>1&&(a.colspan=c);const u=i.getChildIndex(r),l=u+o,f=[...new Sy(i,{startRow:u,endRow:l,includeSpanned:!0})];let h;for(const{row:t,column:r,cell:o,cellIndex:s}of f)if(o===e&&void 0===h&&(h=r),void 0!==h&&h===r&&t===l){const e=i.getChild(t),r=n.createPositionAt(e,s);Ey(n,r,a)}ky("rowspan",o,e,n)}class rg extends jl{refresh(){const e=_y("tableCell",this.editor.model.document.selection.getFirstPosition()),t=!!e;this.isEnabled=t,this.value=t&&this._isInHeading(e,e.parent.parent)}execute(e={}){const t=this.editor.model,n=t.document.selection,r=this.editor.plugins.get("TableUtils"),i=_y("tableCell",n.getFirstPosition()),o=i.parent.parent,{column:a}=r.getCellLocation(i);if(e.forceValue===this.value)return;const s=this.value?a:a+1;t.change((e=>{ky("headingColumns",s,o,e,0)}))}_isInHeading(e,t){const n=parseInt(t.getAttribute("headingColumns")||0),r=this.editor.plugins.get("TableUtils"),{column:i}=r.getCellLocation(e);return!!n&&i<n}}class ig extends Rl{static get pluginName(){return"TableUtils"}getCellLocation(e){const t=e.parent,n=t.parent,r=n.getChildIndex(t),i=new Sy(n,{startRow:r,endRow:r});for(const{cell:t,row:n,column:r}of i)if(t===e)return{row:n,column:r}}createTable(e,t,n){const r=e.createElement("table");return og(e,r,0,t,n),r}insertRows(e,t={}){const n=this.editor.model,r=t.at||0,i=t.rows||1;n.change((t=>{const n=e.getAttribute("headingRows")||0;if(n>r&&t.setAttribute("headingRows",n+i,e),0===r||r===e.childCount)return void og(t,e,r,i,this.getColumns(e));const o=new Sy(e,{endRow:r});let a=0;for(const{row:e,rowspan:n,colspan:s,cell:c}of o){const o=e+n>r;e<r&&o&&t.setAttribute("rowspan",n+i,c),e===r&&(a+=s)}og(t,e,r,i,a)}))}insertColumns(e,t={}){const n=this.editor.model,r=t.at||0,i=t.columns||1;n.change((t=>{const n=e.getAttribute("headingColumns");r<n&&t.setAttribute("headingColumns",n+i,e);const o=this.getColumns(e);if(0===r||o===r){for(const n of e.getChildren())ag(i,t,t.createPositionAt(n,r?"end":0));return}const a=new Sy(e,{column:r,includeSpanned:!0});for(const{row:n,cell:o,cellIndex:s}of a){const c=parseInt(o.getAttribute("rowspan")||1),u=parseInt(o.getAttribute("colspan")||1);if(o.index!==r&&u>1){if(t.setAttribute("colspan",u+i,o),a.skipRow(n),c>1)for(let e=n+1;e<n+c;e++)a.skipRow(e)}else{const r=t.createPositionAt(e.getChild(n),s);ag(i,t,r)}}}))}splitCellVertically(e,t=2){const n=this.editor.model,r=e.parent.parent,i=parseInt(e.getAttribute("rowspan")||1),o=parseInt(e.getAttribute("colspan")||1);n.change((n=>{if(o>1){const{newCellsSpan:r,updatedSpan:a}=sg(o,t);ky("colspan",a,e,n);const s={};r>1&&(s.colspan=r),i>1&&(s.rowspan=i),ag(o>t?t-1:o-1,n,n.createPositionAfter(e),s)}if(o<t){const a=t-o,s=[...new Sy(r)],{column:c}=s.find((({cell:t})=>t===e)),u=s.filter((({cell:t,colspan:n,column:r})=>t!==e&&r===c||r<c&&r+n>c));for(const{cell:e,colspan:t}of u)n.setAttribute("colspan",t+a,e);const l={};i>1&&(l.rowspan=i),ag(a,n,n.createPositionAfter(e),l);const f=r.getAttribute("headingColumns")||0;f>c&&ky("headingColumns",f+a,r,n)}}))}splitCellHorizontally(e,t=2){const n=this.editor.model,r=e.parent,i=r.parent,o=i.getChildIndex(r),a=parseInt(e.getAttribute("rowspan")||1),s=parseInt(e.getAttribute("colspan")||1);n.change((n=>{if(a>1){const r=[...new Sy(i,{startRow:o,endRow:o+a-1,includeSpanned:!0})],{newCellsSpan:c,updatedSpan:u}=sg(a,t);ky("rowspan",u,e,n);const{column:l}=r.find((({cell:t})=>t===e)),f={};c>1&&(f.rowspan=c),s>1&&(f.colspan=s);for(const{column:e,row:t,cellIndex:a}of r){const r=e===l,s=(t+o+u)%c==0;if(t>=o+u&&r&&s){const e=n.createPositionAt(i.getChild(t),a);ag(1,n,e,f)}}}if(a<t){const r=t-a,c=[...new Sy(i,{startRow:0,endRow:o})];for(const{cell:t,rowspan:i,row:a}of c)if(t!==e&&a+i>o){const e=i+r;n.setAttribute("rowspan",e,t)}const u={};s>1&&(u.colspan=s),og(n,i,o+1,r,1,u);const l=i.getAttribute("headingRows")||0;l>o&&ky("headingRows",l+r,i,n)}}))}getColumns(e){return[...e.getChild(0).getChildren()].reduce(((e,t)=>e+parseInt(t.getAttribute("colspan")||1)),0)}}function og(e,t,n,r,i,o={}){for(let a=0;a<r;a++){const r=e.createElement("tableRow");e.insert(r,t,n),ag(i,e,e.createPositionAt(r,"end"),o)}}function ag(e,t,n,r={}){for(let i=0;i<e;i++)Ey(t,n,r)}function sg(e,t){if(e<t)return{newCellsSpan:1,updatedSpan:1};const n=Math.floor(e/t);return{newCellsSpan:n,updatedSpan:e-n*t+n}}function cg(e){e.document.registerPostFixer((t=>function(e,t){const n=t.document.differ.getChanges();let r=!1;const i=new Set;for(const t of n){let n;"table"==t.name&&"insert"==t.type&&(n=t.position.nodeAfter),"tableRow"!=t.name&&"tableCell"!=t.name||(n=_y("table",t.position)),fg(t)&&(n=_y("table",t.range.start)),n&&!i.has(n)&&(r=ug(n,e)||r,r=lg(n,e)||r,i.add(n))}return r}(t,e)))}function ug(e,t){let n=!1;const r=function(e){const t=parseInt(e.getAttribute("headingRows")||0),n=e.childCount,r=[];for(const{row:i,rowspan:o,cell:a}of new Sy(e)){if(o<2)continue;const e=i<t?t:n;if(i+o>e){const t=e-i;r.push({cell:a,rowspan:t})}}return r}(e);if(r.length){n=!0;for(const e of r)ky("rowspan",e.rowspan,e.cell,t,1)}return n}function lg(e,t){let n=!1;const r=function(e){const t={};for(const{row:n}of new Sy(e,{includeSpanned:!0}))t[n]||(t[n]=0),t[n]+=1;return t}(e),i=r[0];if(!Object.values(r).every((e=>e===i))){const i=Object.values(r).reduce(((e,t)=>t>e?t:e),0);for(const[o,a]of Object.entries(r)){const r=i-a;if(r){for(let n=0;n<r;n++)Ey(t,t.createPositionAt(e.getChild(o),"end"));n=!0}}}return n}function fg(e){const t="attribute"===e.type,n=e.attributeKey;return t&&("headingRows"===n||"colspan"===n||"rowspan"===n)}function hg(e){e.document.registerPostFixer((t=>function(e,t){const n=t.document.differ.getChanges();let r=!1;for(const t of n)"insert"==t.type&&"table"==t.name&&(r=dg(t.position.nodeAfter,e)||r),"insert"==t.type&&"tableRow"==t.name&&(r=pg(t.position.nodeAfter,e)||r),"insert"==t.type&&"tableCell"==t.name&&(r=mg(t.position.nodeAfter,e)||r),yg(t)&&(r=mg(t.position.parent,e)||r);return r}(t,e)))}function dg(e,t){let n=!1;for(const r of e.getChildren())n=pg(r,t)||n;return n}function pg(e,t){let n=!1;for(const r of e.getChildren())n=mg(r,t)||n;return n}function mg(e,t){if(0==e.childCount)return t.insertElement("paragraph",e),!0;const n=Array.from(e.getChildren()).filter((e=>e.is("text")));for(const e of n)t.wrap(t.createRangeOn(e),"paragraph");return!!n.length}function yg(e){return!(!e.position||!e.position.parent.is("tableCell"))&&("insert"==e.type&&"$text"==e.name||"remove"==e.type)}function gg(e){e.document.registerPostFixer((()=>function(e){const t=e.document.differ,n=new Set;for(const e of t.getChanges()){const t="insert"==e.type||"remove"==e.type?e.position.parent:e.range.start.parent;t.is("tableCell")&&bg(t,e.type)&&n.add(t)}if(n.size){for(const e of n.values())t.refreshItem(e);return!0}return!1}(e)))}function bg(e,t){if(!Array.from(e.getChildren()).some((e=>e.is("paragraph"))))return!1;if("attribute"==t){const t=Array.from(e.getChild(0).getAttributeKeys()).length;return 1===e.childCount&&t<2}return e.childCount<=("insert"==t?2:1)}n(84);class vg extends Rl{static get pluginName(){return"TableEditing"}init(){const e=this.editor,t=e.model,n=t.schema,r=e.conversion;n.register("table",{allowWhere:"$block",allowAttributes:["headingRows","headingColumns"],isLimit:!0,isObject:!0,isBlock:!0}),n.register("tableRow",{allowIn:"table",isLimit:!0}),n.register("tableCell",{allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isLimit:!0}),n.extend("$block",{allowIn:"tableCell"}),n.addChildCheck(((e,t)=>{if("table"==t.name&&Array.from(e.getNames()).includes("table"))return!1})),r.for("upcast").add(Oy()),r.for("editingDowncast").add(Ny({asWidget:!0})),r.for("dataDowncast").add(Ny()),r.for("upcast").elementToElement({model:"tableRow",view:"tr"}),r.for("editingDowncast").add(My({asWidget:!0})),r.for("dataDowncast").add(My()),r.for("downcast").add((e=>e.on("remove:tableRow",((e,t,n)=>{e.stop();const r=n.writer,i=n.mapper,o=i.toViewPosition(t.position).getLastMatchingPosition((e=>!e.item.is("tr"))).nodeAfter,a=o.parent,s=r.createRangeOn(o),c=r.remove(s);for(const e of r.createRangeIn(c).getItems())i.unbindViewElement(e);a.childCount||r.remove(r.createRangeOn(a))}),{priority:"higher"}))),r.for("upcast").add(Ty("td")),r.for("upcast").add(Ty("th")),r.for("editingDowncast").add(Ay({asWidget:!0})),r.for("dataDowncast").add(Ay()),r.attributeToAttribute({model:"colspan",view:"colspan"}),r.attributeToAttribute({model:"rowspan",view:"rowspan"}),r.for("editingDowncast").add(Iy({asWidget:!0})),r.for("dataDowncast").add(Iy()),r.for("editingDowncast").add(jy({asWidget:!0})),r.for("dataDowncast").add(jy()),e.commands.add("insertTable",new Qy(e)),e.commands.add("insertTableRowAbove",new Gy(e,{order:"above"})),e.commands.add("insertTableRowBelow",new Gy(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new Jy(e,{order:"left"})),e.commands.add("insertTableColumnRight",new Jy(e,{order:"right"})),e.commands.add("removeTableRow",new Zy(e)),e.commands.add("removeTableColumn",new eg(e)),e.commands.add("splitTableCellVertically",new Ky(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new Ky(e,{direction:"horizontally"})),e.commands.add("mergeTableCellRight",new $y(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new $y(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new $y(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new $y(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new rg(e)),e.commands.add("setTableRowHeader",new tg(e)),cg(t),gg(t),hg(t),this.editor.keystrokes.set("Tab",((...e)=>this._handleTabOnSelectedTable(...e)),{priority:"low"}),this.editor.keystrokes.set("Tab",this._getTabHandler(!0),{priority:"low"}),this.editor.keystrokes.set("Shift+Tab",this._getTabHandler(!1),{priority:"low"})}static get requires(){return[ig]}_handleTabOnSelectedTable(e,t){const n=this.editor,r=n.model.document.selection;if(!r.isCollapsed&&1===r.rangeCount&&r.getFirstRange().isFlat){const e=r.getSelectedElement();if(!e||!e.is("table"))return;t(),n.model.change((t=>{t.setSelection(t.createRangeIn(e.getChild(0).getChild(0)))}))}}_getTabHandler(e){const t=this.editor;return(n,r)=>{const i=_y("tableCell",t.model.document.selection.getFirstPosition());if(!i)return;r();const o=i.parent,a=o.parent,s=a.getChildIndex(o),c=o.getChildIndex(i),u=0===c;if(!e&&u&&0===s)return;const l=c===o.childCount-1,f=s===a.childCount-1;if(e&&f&&l&&(t.execute("insertTableRowBelow"),s===a.childCount-1))return;let h;if(e&&l){const e=a.getChild(s+1);h=e.getChild(0)}else if(!e&&u){const e=a.getChild(s-1);h=e.getChild(e.childCount-1)}else h=o.getChild(c+(e?1:-1));t.model.change((e=>{e.setSelection(e.createRangeIn(h))}))}}}n(86);class wg extends Wu{constructor(e){super(e);const t=this.bindTemplate;this.items=this.createCollection(),this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",((e,t)=>`${t} × ${e}`)),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},children:this.items},{tag:"div",attributes:{class:["ck-insert-table-dropdown__label"]},children:[{text:t.to("label")}]}],on:{mousedown:t.to((e=>{e.preventDefault()})),click:t.to((()=>{this.fire("execute")}))}});for(let e=0;e<100;e++){const t=new _g;t.on("over",(()=>{const t=Math.floor(e/10),n=e%10;this.set("rows",t+1),this.set("columns",n+1)})),this.items.add(t)}this.on("change:columns",(()=>{this._highlightGridBoxes()})),this.on("change:rows",(()=>{this._highlightGridBoxes()}))}focus(){}focusLast(){}_highlightGridBoxes(){const e=this.rows,t=this.columns;this.items.map(((n,r)=>{const i=Math.floor(r/10)<e&&r%10<t;n.set("isOn",i)}))}}class _g extends Wu{constructor(e){super(e);const t=this.bindTemplate;this.set("isOn",!1),this.setTemplate({tag:"div",attributes:{class:["ck-insert-table-dropdown-grid-box",t.if("isOn","ck-on")]},on:{mouseover:t.to("over")}})}}var kg='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v3h4V6H3zm0 4v3h4v-3H3zm0 4v3h4v-3H3zm5 3h4v-3H8v3zm5 0h4v-3h-4v3zm4-4v-3h-4v3h4zm0-4V6h-4v3h4zm1.5 8a1.5 1.5 0 0 1-1.5 1.5H3A1.5 1.5 0 0 1 1.5 17V4c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13zM12 13v-3H8v3h4zm0-4V6H8v3h4z"/></svg>',Eg='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',Og='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',Tg='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>';class xg extends Rl{init(){const e=this.editor,t=this.editor.t,n="ltr"===e.locale.contentLanguageDirection;e.ui.componentFactory.add("insertTable",(n=>{const r=e.commands.get("insertTable"),i=wl(n);i.bind("isEnabled").to(r),i.buttonView.set({icon:kg,label:t("m"),tooltip:!0});const o=new wg(n);return i.panelView.children.add(o),o.delegate("execute").to(i),i.buttonView.on("open",(()=>{o.rows=0,o.columns=0})),i.on("execute",(()=>{e.execute("insertTable",{rows:o.rows,columns:o.columns}),e.editing.view.focus()})),i})),e.ui.componentFactory.add("tableColumn",(e=>{const r=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:t("n"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:n?"insertTableColumnLeft":"insertTableColumnRight",label:t("o")}},{type:"button",model:{commandName:n?"insertTableColumnRight":"insertTableColumnLeft",label:t("p")}},{type:"button",model:{commandName:"removeTableColumn",label:t("q")}}];return this._prepareDropdown(t("r"),Eg,r,e)})),e.ui.componentFactory.add("tableRow",(e=>{const n=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:t("s"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowBelow",label:t("t")}},{type:"button",model:{commandName:"insertTableRowAbove",label:t("u")}},{type:"button",model:{commandName:"removeTableRow",label:t("v")}}];return this._prepareDropdown(t("w"),Og,n,e)})),e.ui.componentFactory.add("mergeTableCells",(e=>{const r=[{type:"button",model:{commandName:"mergeTableCellUp",label:t("x")}},{type:"button",model:{commandName:n?"mergeTableCellRight":"mergeTableCellLeft",label:t("y")}},{type:"button",model:{commandName:"mergeTableCellDown",label:t("z")}},{type:"button",model:{commandName:n?"mergeTableCellLeft":"mergeTableCellRight",label:t("aa")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:t("ab")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:t("ac")}}];return this._prepareDropdown(t("ad"),Tg,r,e)}))}_prepareDropdown(e,t,n,r){const i=this.editor,o=wl(r),a=[],s=new oi;for(const e of n)Sg(e,i,a,s);return _l(o,s),o.buttonView.set({label:e,icon:t,tooltip:!0}),o.bind("isEnabled").toMany(a,"isEnabled",((...e)=>e.some((e=>e)))),this.listenTo(o,"execute",(e=>{i.execute(e.source.commandName),i.editing.view.focus()})),o}}function Sg(e,t,n,r){const i=e.model=new Dp(e.model),{commandName:o,bindIsOn:a}=e.model;if("separator"!==e.type){const e=t.commands.get(o);n.push(e),i.set({commandName:o}),i.bind("isEnabled").to(e),a&&i.bind("isOn").to(e,"value")}i.set({withText:!0}),r.add(e)}n(88),n.d(t,"default",(function(){return Cg}));class Cg extends Cl{}Cg.builtinPlugins=[class extends Rl{static get requires(){return[Al,ql,zl,of,xf]}static get pluginName(){return"Essentials"}},If,class extends Rl{static get pluginName(){return"Autoformat"}afterInit(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats()}_addListAutoformats(){const e=this.editor.commands;e.get("bulletedList")&&new Lf(this.editor,/^[*-]\s$/,"bulletedList"),e.get("numberedList")&&new Lf(this.editor,/^1[.|)]\s$/,"numberedList")}_addBasicStylesAutoformats(){const e=this.editor.commands;if(e.get("bold")){const e=qf(this.editor,"bold");new Bf(this.editor,/(\*\*)([^*]+)(\*\*)$/g,e),new Bf(this.editor,/(__)([^_]+)(__)$/g,e)}if(e.get("italic")){const e=qf(this.editor,"italic");new Bf(this.editor,/(?:^|[^*])(\*)([^*_]+)(\*)$/g,e),new Bf(this.editor,/(?:^|[^_])(_)([^_]+)(_)$/g,e)}if(e.get("code")){const e=qf(this.editor,"code");new Bf(this.editor,/(`)([^`]+)(`)$/g,e)}}_addHeadingAutoformats(){const e=this.editor.commands.get("heading");e&&e.modelElements.filter((e=>e.match(/^heading[1-6]$/))).forEach((t=>{const n=t[7],r=new RegExp(`^(#{${n}})\\s$`);new Lf(this.editor,r,(()=>{if(!e.isEnabled)return!1;this.editor.execute("heading",{value:t})}))}))}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&new Lf(this.editor,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){this.editor.commands.get("codeBlock")&&new Lf(this.editor,/^```$/,"codeBlock")}},class extends Rl{static get requires(){return[Hf,Yf]}static get pluginName(){return"Bold"}},class extends Rl{static get requires(){return[Gf,$f]}static get pluginName(){return"Italic"}},class extends Rl{static get requires(){return[rh,oh]}static get pluginName(){return"BlockQuote"}},class extends Rl{static get pluginName(){return"CKFinder"}static get requires(){return[Od,sh,If]}},class extends Rl{static get requires(){return[Nd,sp,xp]}static get pluginName(){return"EasyImage"}},class extends Rl{static get requires(){return[Ip,Lp]}static get pluginName(){return"Heading"}},sp,class extends Rl{static get requires(){return[qp]}static get pluginName(){return"ImageCaption"}},class extends Rl{static get requires(){return[tm,nm]}static get pluginName(){return"ImageStyle"}},class extends Rl{static get requires(){return[rm]}static get pluginName(){return"ImageToolbar"}afterInit(){const e=this.editor,t=e.t;e.plugins.get(rm).register("image",{ariaLabel:t("b"),items:e.config.get("image.toolbar")||[],getRelatedElement:Eh})}},xp,class extends Rl{static get pluginName(){return"Indent"}static get requires(){return[sm,lm]}},class extends Rl{static get requires(){return[wd,bm]}static get pluginName(){return"Link"}},class extends Rl{static get requires(){return[zm,Gm]}static get pluginName(){return"List"}},class extends Rl{static get requires(){return[oy,ly,sy,Id]}static get pluginName(){return"MediaEmbed"}},Rp,class extends Rl{static get pluginName(){return"PasteFromOffice"}static get requires(){return[Al]}init(){const e=this.editor,t=[];t.push(new wy),t.push(new py),e.plugins.get("Clipboard").on("inputTransformation",((e,n)=>{if(n.isTransformedWithPasteFromOffice)return;const r=n.dataTransfer.getData("text/html"),i=t.find((e=>e.isActive(r)));i&&(i.execute(n),n.isTransformedWithPasteFromOffice=!0)}),{priority:"high"})}},class extends Rl{static get requires(){return[vg,xg,Id]}static get pluginName(){return"Table"}},class extends Rl{static get requires(){return[rm]}static get pluginName(){return"TableToolbar"}afterInit(){const e=this.editor,t=e.t,n=e.plugins.get(rm),r=e.config.get("table.contentToolbar"),i=e.config.get("table.tableToolbar");r&&n.register("tableContent",{ariaLabel:t("c"),items:r,getRelatedElement:Py}),i&&n.register("table",{ariaLabel:t("c"),items:i,getRelatedElement:Ry})}}],Cg.defaultConfig={toolbar:{items:["heading","|","bold","italic","link","bulletedList","numberedList","|","indent","outdent","|","imageUpload","blockQuote","insertTable","mediaEmbed","undo","redo"]},image:{toolbar:["imageStyle:full","imageStyle:side","|","imageTextAlternative"]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]},language:"en"}}]).default},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="LockNotSupportedOnGivenDriverError",Object.setPrototypeOf(n,t.prototype),n.message="Locking not supported on given driver.",n}return Object(r.c)(t,e),t}(Error)},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports=!1},function(e,t,n){var r=n(216),i=n(171);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(77),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){var r=n(19),i=n(217),o=n(171),a=n(170)("IE_PROTO"),s=function(){},c=function(){var e,t=n(168)("iframe"),r=o.length;for(t.style.display="none",n(172).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;r--;)delete c.prototype[o[r]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[a]=e):n=c(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(216),i=n(171).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(60),i=n(46),o=n(170)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var r=n(25)("unscopables"),i=Array.prototype;null==i[r]&&n(61)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){var r=n(20);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){var r=n(106),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=a),o(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";(function(e){var r=n(499),i=n(500),o=n(501);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=s(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|d(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=s(e,t<0?0:0|d(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|d(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(r)return V(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){var o,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+c>s&&(n=s-c),o=n;o>=0;o--){for(var f=!0,h=0;h<c;h++)if(u(e,o+h)!==u(t,h)){f=!1;break}if(f)return o}return-1}function v(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function w(e,t,n,r){return H(V(t,e.length-n),e,n,r)}function _(e,t,n,r){return H(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function k(e,t,n,r){return _(e,t,n,r)}function E(e,t,n,r){return H(U(t),e,n,r)}function O(e,t,n,r){return H(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function T(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,c,u=e[i],l=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=n)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(c=(15&u)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=S));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return f(null,e)},c.allocUnsafeSlow=function(e){return f(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(r,i),l=e.slice(t,n),f=0;f<s;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function P(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=q(e[o]);return i}function N(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function j(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function I(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function D(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,o){return o||D(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,o){return o||D(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||A(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||A(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):I(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);A(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);A(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):I(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=c.isBuffer(e)?e:V(new c(e,r).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function q(e){return e<16?"0"+e.toString(16):e.toString(16)}function V(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function U(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(196))},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.OpenSubmenuAction=void 0;var f=n(121),h=n(22),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(e,t,n,r,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(o=c.call(this,e,(function(e){e.getSubmenu().toggle(),e.update()}),n,r,i))._submenu=t,t.setParentAction(u(o)),o}return t=f,(n=[{key:"copy",value:function(e){return e=h.Helper.nonNull(e,new f(null,this._submenu.copy())),(e=o(l(f.prototype),"copy",this).call(this,e))._submenu.setParentAction(e),e}},{key:"getSubmenu",value:function(){return this._submenu}}])&&i(t.prototype,n),r&&i(t,r),f}(f.MenuAction);t.OpenSubmenuAction=d},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="UpdateValuesMissingError",Object.setPrototypeOf(n,t.prototype),n.message='Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.',n}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EasySyncClientDb=void 0;var f=n(2),h=n(4),d=n(274),p=n(39),m=n(276),y=n(275),g=n(81),b=n(206),v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(l,e);var t,n,r,c=s(l);function l(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),c.call(this,e||"EasySync")}return t=l,(n=[{key:"_createConnectionOptions",value:function(e){JSObject.setPrototypeOf(p.EasySyncBaseModel,d.ClientModel),JSObject.setPrototypeOf(m.EasySyncPartialModel,y.ClientPartialModel),JSObject.setPrototypeOf(p.EasySyncBaseModel.prototype,d.ClientModel.prototype),JSObject.setPrototypeOf(m.EasySyncPartialModel.prototype,y.ClientPartialModel.prototype),JSObject.setPrototypeOf(g.FileMedium,b.ClientFileMedium),JSObject.setPrototypeOf(g.FileMedium.prototype,b.ClientFileMedium.prototype);var t=o(u(l.prototype),"_createConnectionOptions",this).call(this,e);return t.migrationsTableName="migrations",t}}])&&i(t.prototype,n),r&&i(t,r),l}(h.BaseDatabase);t.EasySyncClientDb=v,v.BASE_MODEL=null,f.App.addInitialization((function(){return l(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getInstance()._connectionPromise.catch((function(e){if("function"==typeof v.errorListener)return v.errorListener.apply(v,arguments);throw e}));case 2:case"end":return e.stop()}}),e)})))}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="OptimisticLockCanNotBeUsedError",Object.setPrototypeOf(n,t.prototype),n.message="The optimistic lock can be used only with getOne() method.",n}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseModel=void 0;var o=n(16),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this._isLoaded=!1}var t,n,a;return t=e,a=[{key:"getColumnDefinitions",value:function(){return{id:{primary:!0,type:o.BaseDatabase.TYPES.INTEGER,generated:!0}}}},{key:"getRelationDefinitions",value:function(){return{}}},{key:"getRelations",value:function(){return Object.keys(this.getRelationDefinitions())}},{key:"getSchemaDefinition",value:function(){var e=this.getColumnDefinitions();return Object.keys(e).forEach((function(t){"string"==typeof e[t]&&(e[t]={type:e[t]}),e[t].type!==o.BaseDatabase.TYPES.MY_JSON||e[t].transformer||(e[t].type=o.BaseDatabase.TYPES.MEDIUMTEXT,e[t].transformer={from:function(e){return e?JSON.parse(e):null},to:function(e){return e?JSON.stringify(e):""}}),e[t].type!==o.BaseDatabase.TYPES.BOOLEAN||e[t].transformer||(e[t].transformer={from:function(e){return"false"!==e&&("true"===e||e)},to:function(e){return e}})})),{name:this.getSchemaName(),target:this,columns:e,relations:this.getRelationDefinitions()}}},{key:"getSchemaName",value:function(){return this.SCHEMA_NAME||(this.SCHEMA_NAME=this.name),this.SCHEMA_NAME}},{key:"deleteMany",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._database.deleteEntity(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"saveMany",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._database.saveEntity(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"find",value:function(e,t,n,r,o){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",this._database.findEntities(this,e,t,n,r,o));case 1:case"end":return i.stop()}}),i,this)})))}},{key:"findAndCount",value:function(e,t,n,r,o){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",this._database.findAndCountEntities(this,e,t,n,r,o));case 1:case"end":return i.stop()}}),i,this)})))}},{key:"findOne",value:function(e,t,n,r){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",this._database.findOneEntity(this,e,t,n,r));case 1:case"end":return i.stop()}}),i,this)})))}},{key:"findById",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this._database.findById(this,e,t));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"findByIds",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this._database.findByIds(this,e,t));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"clear",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._database.clearModel(this));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"equals",value:function(e,t){var n=this;return e===t||null!==e&&null!==t&&(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length?e.every((function(e,r){n.equals(e,t[r])})):e instanceof this&&t instanceof this?e.constructor===t.constructor&&e.getId()===t.getId():void 0)}}],(n=[{key:"getId",value:function(){return this.id}},{key:"setId",value:function(e){this.id=e}},{key:"setLoaded",value:function(e){this._isLoaded=e}},{key:"save",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.constructor._database.saveEntity(this));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"delete",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.constructor._database.deleteEntity(this));case 1:case"end":return e.stop()}}),e,this)})))}}])&&r(t.prototype,n),a&&r(t,a),e}();t.BaseModel=a,a._database=null,a.RELATION={MANY_TO_MANY:"many-to-many",MANY_TO_ONE:"many-to-one",ONE_TO_MANY:"one-to-many",ONE_TO_ONE:"one-to-one"}},function(e,t,n){var r=n(37).f,i=n(60),o=n(25)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){var r=n(6),i=n(88),o=n(18),a=n(174),s="["+a+"]",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),l=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()})),c=i[e]=s?t(f):a[e];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},f=l.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=l},function(e,t){e.exports={}},function(e,t,n){"use strict";var r=n(17),i=n(37),o=n(36),a=n(25)("species");e.exports=function(e){var t=r[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(54);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t,n){var r=n(105).Buffer;function i(e,t){this._block=r.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}i.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=r.from(e,t));for(var n=this._block,i=this._blockSize,o=e.length,a=this._len,s=0;s<o;){for(var c=a%i,u=Math.min(o-s,i-c),l=0;l<u;l++)n[c+l]=e[s+l];s+=u,(a+=u)%i==0&&this._update(n)}return this._len+=o,this},i.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var o=this._hash();return e?o.toString(e):o},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=i},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;var o=n(22),a=n(43),s=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onViewLoadedCalled=!1,this._pauseParameters=[],this._view=null,this._fragments=[],this._state=e.STATE_CREATED,this._viewLoadedPromise=o.Helper.newPromiseWithResolve(),this._viewPromise=a.ViewInflater.getInstance().load(t).then((function(e){return n._view=e,e})).catch((function(e){n._viewLoadedPromise.reject(e)}))}var t,n,s;return t=e,(n=[{key:"getState",value:function(){return this._state}},{key:"onConstruct",value:function(t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(i in this._state=e.STATE_CONSTRUCTED,this.constructParameters=t,r=[],this._fragments)r.push(this._fragments[i].onConstruct.apply(this._fragments[i],[t])),r.push(this._fragments[i]._viewPromise);return n.abrupt("return",Promise.all(r));case 5:case"end":return n.stop()}}),n,this)})))}},{key:"callOnViewLoaded",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.onViewLoadedCalled){e.next=6;break}return this.onViewLoadedCalled=!0,e.next=4,this.onViewLoaded();case 4:t=e.sent,this._viewLoadedPromise.resolve(t);case 6:return e.abrupt("return",this._viewLoadedPromise);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"onViewLoaded",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i in this._state=e.STATE_VIEW_LOADED,n=[],r=function(e){n.push(o._fragments[e]._viewPromise.then((function(){return o._fragments[e].callOnViewLoaded()})).then((function(){return o._fragments[e]._viewLoadedPromise.resolve()})))},this._fragments)r(i);return t.abrupt("return",Promise.all(n));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"onStart",value:function(t){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._state=e.STATE_RUNNING,n=regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i._fragments[t],e.t0=n.onStart,e.t1=i._fragments[t],e.next=5,i._fragments[t]._pauseParameters;case 5:e.t2=e.sent,e.t3=[e.t2],e.t0.apply.call(e.t0,e.t1,e.t3),i._fragments[t]._viewPromise.then((function(e){n.isActive()?e.classList.remove("hidden"):e.classList.add("hidden")}));case 9:case"end":return e.stop()}}),e)})),t.t0=regeneratorRuntime.keys(this._fragments);case 3:if((t.t1=t.t0()).done){t.next=8;break}return r=t.t1.value,t.delegateYield(n(r),"t2",6);case 6:t.next=3;break;case 8:case"end":return t.stop()}}),t,this)})))}},{key:"onPause",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in this._state=e.STATE_PAUSED,this._fragments)i=this._fragments[r].onPause.apply(this._fragments[r],n),this._fragments[r].setPauseParameters(i);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"onDestroy",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in this._state=e.STATE_DESTROYED,this._fragments)this._fragments[r].onDestroy.apply(this._fragments[r],n);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"isShowing",value:function(){return this._state===e.STATE_RUNNING}},{key:"addFragment",value:function(t,n){var r=this;this._fragments.push(n),n.setViewQuery(t),this._viewPromise=Promise.all([this._viewPromise,n._viewPromise]).then((function(e){return e[0].querySelector(t).appendChild(e[1]),e[0]})).catch((function(e){return console.error(e)})),this._state>=e.STATE_CONSTRUCTED&&n.onConstruct(this.constructParameters),this._state>=e.STATE_VIEW_LOADED&&Promise.all([this._viewLoadedPromise,n.getViewPromise()]).then((function(){return n.callOnViewLoaded()})),this._state>=e.STATE_RUNNING&&n._viewLoadedPromise.then((function(){r._state>=e.STATE_RUNNING&&n.onStart()}))}},{key:"removeFragment",value:function(t){var n=this._fragments.indexOf(t);-1!==n&&this._fragments.splice(n,1),t._viewPromise.then((function(e){return e.remove()})),this._fragments.push(t),this._state<e.STATE_PAUSED&&t.onPause(),this._state<e.STATE_DESTROYING&&t.onDestroy()}},{key:"findBy",value:function(e,t,n){t=o.Helper.nonNull(t,!1),n=o.Helper.nonNull(n,!1);var r=function(n){var r=null;return t?(r=n.querySelectorAll(e),n.matches(e)&&r.push(n)):r=n.matches(e)?n:n.querySelector(e),r};return n?this._viewPromise.then((function(e){return r(e)})):r(this._view)}},{key:"find",value:function(e){return this._view.matches(e)?this._view:this._view.querySelector(e)}},{key:"findAll",value:function(e){var t=this._view.querySelectorAll(e);return this._view.matches(e)&&t.push(this._view),t}},{key:"setPauseParameters",value:function(e){this._pauseParameters=e}},{key:"getViewPromise",value:function(){return this._viewPromise}}])&&r(t.prototype,n),s&&r(t,s),e}();t.Context=s,s.STATE_CREATED=0,s.STATE_CONSTRUCTED=1,s.STATE_VIEW_LOADED=2,s.STATE_RUNNING=3,s.STATE_PAUSED=4,s.STATE_DESTROYING=5,s.STATE_DESTROYED=6},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.MenuAction=void 0;var i=n(22),o=function(){function e(t,n,r,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._liClass="",this._shouldTranslate=!0,this._visible=!0,this._activated=!0,this._copies=[],this._menu=null,this._name=t,this._action=n,this._showFor=i.Helper.nonNull(r,e.SHOW_FOR_MEDIUM),this._order=i.Helper.nonNull(o,1e3),this._icon=a,this._id=e.lastId++,this._liClass="",this._shouldTranslate=!0,this._visible=!0,this._activated=!0,this._menu=null,this._copies=[]}var t,n,o;return t=e,(n=[{key:"copy",value:function(t){var n=i.Helper.nonNull(t,new e);return n._name=this._name,n._action=this._action,n._showFor=this._showFor,n._order=this._order,n._liClass=this._liClass,n._shouldTranslate=this._shouldTranslate,n._visible=this._visible,n._activated=this._activated,n._icon=this._icon,n._id=e.lastId++,this._copies.push(n),n}},{key:"redraw",value:function(){i.Helper.isNotNull(this._menu)&&this._menu.redrawAction(this),this._copies.forEach((function(e){return e.redraw()}))}},{key:"update",value:function(){this._menu.updateAction(this),this._copies.forEach((function(e){return e.update()}))}},{key:"getOrder",value:function(){return this._order}},{key:"isActivated",value:function(){return this._activated}},{key:"isShouldTranslate",value:function(){return this._shouldTranslate}},{key:"setShouldTranslate",value:function(e){this._shouldTranslate=!0===e,this.redraw()}},{key:"setVisibility",value:function(e){this._visible=e,this.redraw(),this._copies.forEach((function(t){return t.setVisibility(e)}))}},{key:"isVisible",value:function(){return this._visible}},{key:"getName",value:function(){return this._name}},{key:"setName",value:function(e){this._name=e,this.redraw()}},{key:"getAction",value:function(){return this._action}},{key:"getId",value:function(){return this._id}},{key:"getIcon",value:function(){return this._icon}},{key:"setIcon",value:function(e){this._icon=e,this.redraw()}},{key:"getShowFor",value:function(){return this._showFor}},{key:"getLiClass",value:function(){return this._liClass}},{key:"setLiClass",value:function(e){this._liClass=e,this._copies.forEach((function(t){return t.setLiClass(e)})),this.redraw()}},{key:"getMenu",value:function(){return this._menu}},{key:"setMenu",value:function(e){this._menu=e}}])&&r(t.prototype,n),o&&r(t,o),e}();t.MenuAction=o,o.lastId=0,o.SHOW_ALWAYS="always",o.SHOW_FOR_SMEDIUM="smedium",o.SHOW_FOR_MEDIUM="medium",o.SHOW_FOR_LARGE="large",o.SHOW_NEVER="never"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(13),o=function(e){function t(n,r){var o,a=e.call(this)||this;a.name="EntityNotFound",Object.setPrototypeOf(a,t.prototype),o=n instanceof i.EntitySchema?n.options.name:"function"==typeof n||"object"==typeof n&&"name"in n?n.name:n;var s=a.stringifyCriteria(r);return a.message='Could not find any entity of type "'+o+'" matching: '+s,a}return Object(r.c)(t,e),t.prototype.stringifyCriteria=function(e){try{return JSON.stringify(e,null,4)}catch(e){}return""+e},t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="LimitOnUpdateNotSupportedError",Object.setPrototypeOf(n,t.prototype),n.message="Your database does not support LIMIT on UPDATE statements.",n}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(n){var r=e.call(this)||this;return r.name="EntityColumnNotFound",Object.setPrototypeOf(r,t.prototype),r.message='No entity column "'+n+'" was found.',r}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){this.generatedMaps=[]}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Singleton=void 0;var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"getInstance",value:function(){return this._instance||(this._instance=new this),this._instance}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();t.Singleton=i},function(e,t,n){"use strict";n.r(t),n.d(t,"SelectQueryBuilder",(function(){return T}));var r=n(0),i=n(1),o=n(290),a=n(160),s=n(158),c=n(137),u=n(110),l=n(166),f=n(128),h=n(129),d=n(23),p=function(){function e(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}return e.prototype.load=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n=this;return Object(r.d)(this,(function(i){return t=this.relationIdAttributes.map((function(t){return Object(r.b)(n,void 0,void 0,(function(){var n,i,o,a,s,c,u,l,f,h,p,m,y,g,b,v,w,_,k,E,O,T,x,S,C=this;return Object(r.d)(this,(function(R){switch(R.label){case 0:if(!t.relation.isManyToOne&&!t.relation.isOneToOneOwner)return[3,1];if(t.queryBuilderFactory)throw new Error("Additional condition can not be used with ManyToOne or OneToOne owner relations.");return n=[],S=e.map((function(e){var r={},i=[];t.relation.joinColumns.forEach((function(n){r[n.databaseName]=C.connection.driver.prepareHydratedValue(e[d.a.buildAlias(C.connection.driver,t.parentAlias,n.databaseName)],n.referencedColumn);var o=n.databaseName+":"+r[n.databaseName];-1===i.indexOf(o)&&i.push(o)})),t.relation.entityMetadata.primaryColumns.forEach((function(n){r[n.databaseName]=C.connection.driver.prepareHydratedValue(e[d.a.buildAlias(C.connection.driver,t.parentAlias,n.databaseName)],n);var o=n.databaseName+":"+r[n.databaseName];-1===i.indexOf(o)&&i.push(o)})),i.sort();var o=i.join("::");return-1!==n.indexOf(o)?null:(n.push(o),r)})).filter((function(e){return e})),[2,{relationIdAttribute:t,results:S}];case 1:return t.relation.isOneToMany||t.relation.isOneToOneNotOwner?(i=t.relation,o=i.isOwning?i.joinColumns:i.inverseRelation.joinColumns,a=i.inverseEntityMetadata.target,s=i.inverseEntityMetadata.tableName,c=t.alias||s,u=[],l={},(T=e.map((function(e,n){var r=[],i={},a=o.map((function(o){var a=o.databaseName+n,s=e[d.a.buildAlias(C.connection.driver,t.parentAlias,o.referencedColumn.databaseName)],u=c+":"+o.propertyPath+":"+s;return-1!==r.indexOf(u)?"":(r.push(u),i[a]=s,c+"."+o.propertyPath+" = :"+a)})).filter((function(e){return e})).join(" AND ");r.sort();var s=r.join("::");return-1!==u.indexOf(s)?"":(u.push(s),Object.assign(l,i),a)})).filter((function(e){return e})).map((function(e){return"("+e+")"})).join(" OR "))?(f=this.connection.createQueryBuilder(this.queryRunner),o.forEach((function(e){f.addSelect(c+"."+e.propertyPath,e.databaseName)})),i.inverseRelation.entityMetadata.primaryColumns.forEach((function(e){f.addSelect(c+"."+e.propertyPath,e.databaseName)})),f.from(a,c).where("("+T+")").setParameters(l),t.queryBuilderFactory&&t.queryBuilderFactory(f),[4,f.getRawMany()]):[2,{relationIdAttribute:t,results:[]}]):[3,3];case 2:return(S=R.sent()).forEach((function(e){o.forEach((function(t){e[t.databaseName]=C.connection.driver.prepareHydratedValue(e[t.databaseName],t.referencedColumn)})),i.inverseRelation.entityMetadata.primaryColumns.forEach((function(t){e[t.databaseName]=C.connection.driver.prepareHydratedValue(e[t.databaseName],t)}))})),[2,{relationIdAttribute:t,results:S}];case 3:return h=t.relation,p=h.isOwning?h.joinColumns:h.inverseRelation.inverseJoinColumns,m=h.isOwning?h.inverseJoinColumns:h.inverseRelation.joinColumns,y=t.junctionAlias,g=t.joinInverseSideMetadata.tableName,b=t.alias||g,v=h.isOwning?h.junctionEntityMetadata.tableName:h.inverseRelation.junctionEntityMetadata.tableName,0===(w=e.map((function(e){return p.reduce((function(n,r){return n[r.propertyPath]=e[d.a.buildAlias(C.connection.driver,t.parentAlias,r.referencedColumn.databaseName)],n}),{})}))).length?[2,{relationIdAttribute:t,results:[]}]:(_={},k=[],E=w.map((function(e,t){var n=[],r={},i=Object.keys(e).map((function(i){var o=i+t,a=e[i],s=y+":"+i+":"+a;return-1!==n.indexOf(s)?"":(n.push(s),r[o]=a,y+"."+i+" = :"+o)})).filter((function(e){return e})).join(" AND ");n.sort();var o=n.join("::");return-1!==k.indexOf(o)?"":(k.push(o),Object.assign(_,r),i)})).filter((function(e){return e})),O=m.map((function(e){return y+"."+e.propertyPath+" = "+b+"."+e.referencedColumn.propertyPath})).join(" AND "),T=E.map((function(e){return"("+e+" AND "+O+")"})).join(" OR "),x=this.connection.createQueryBuilder(this.queryRunner),m.forEach((function(e){x.addSelect(y+"."+e.propertyPath,e.databaseName).addOrderBy(y+"."+e.propertyPath)})),p.forEach((function(e){x.addSelect(y+"."+e.propertyPath,e.databaseName).addOrderBy(y+"."+e.propertyPath)})),x.from(g,b).innerJoin(v,y,T).setParameters(_),t.queryBuilderFactory&&t.queryBuilderFactory(x),[4,x.getRawMany()]);case 4:return(S=R.sent()).forEach((function(e){Object(r.f)(Object(r.f)([],Object(r.e)(p)),Object(r.e)(m)).forEach((function(t){e[t.databaseName]=C.connection.driver.prepareHydratedValue(e[t.databaseName],t.referencedColumn)}))})),[2,{relationIdAttribute:t,results:S}]}}))}))})),[2,Promise.all(t)]}))}))},e}(),m=function(){function e(e){this.expressionMap=e}return e.prototype.transform=function(){var e=this;this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach((function(t){var n=e.metadataToAttribute(e.expressionMap.mainAlias.name,t);e.expressionMap.relationIdAttributes.push(n)})),this.expressionMap.joinAttributes.forEach((function(t){t.metadata&&!t.metadata.isJunction&&t.metadata.relationIds.forEach((function(n){var r=e.metadataToAttribute(t.alias.name,n);e.expressionMap.relationIdAttributes.push(r)}))}))},e.prototype.metadataToAttribute=function(e,t){return new f.a(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})},e}(),y=function(){function e(e,t,n){this.connection=e,this.queryRunner=t,this.relationCountAttributes=n}return e.prototype.load=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i=this;return Object(r.d)(this,(function(o){return t=function(e,t,n){return n.indexOf(e)===t},n=this.relationCountAttributes.map((function(n){return Object(r.b)(i,void 0,void 0,(function(){var i,o,a,s,c,u,l,f,h,d,p,m,y,g,b,v,w,_;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n.relation.isOneToMany?(i=n.relation,o=i.inverseRelation,a=o.joinColumns[0].referencedColumn.propertyName,s=i.inverseEntityMetadata.target,m=i.inverseEntityMetadata.tableName,y=n.alias||m,c=o.propertyName,0===(d=(d=e.map((function(e){return e[n.parentAlias+"_"+a]})).filter((function(e){return!!e}))).filter(t)).length?[2,{relationCountAttribute:n,results:[]}]:((v=this.connection.createQueryBuilder(this.queryRunner)).select(y+"."+c,"parentId").addSelect("COUNT(*)","cnt").from(s,y).where(y+"."+c+" IN (:...ids)").addGroupBy(y+"."+c).setParameter("ids",d),n.queryBuilderFactory&&n.queryBuilderFactory(v),w={relationCountAttribute:n},[4,v.getRawMany()])):[3,2];case 1:return[2,(w.results=r.sent(),w)];case 2:return l=void 0,f=void 0,h=void 0,n.relation.isOwning?(u=n.relation.joinColumns[0].referencedColumn.databaseName,l=n.relation.inverseJoinColumns[0].referencedColumn.databaseName,f=n.relation.junctionEntityMetadata.columns[0],h=n.relation.junctionEntityMetadata.columns[1]):(u=n.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,l=n.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,f=n.relation.junctionEntityMetadata.columns[1],h=n.relation.junctionEntityMetadata.columns[0]),0===(d=(d=e.map((function(e){return e[n.parentAlias+"_"+u]})).filter((function(e){return!!e}))).filter(t)).length?[2,{relationCountAttribute:n,results:[]}]:(p=n.junctionAlias,m=n.joinInverseSideMetadata.tableName,y=n.alias||m,g=n.relation.junctionEntityMetadata.tableName,b=p+"."+f.propertyName+" IN ("+d.map((function(e){return isNaN(e)?"'"+e+"'":e}))+") AND "+p+"."+h.propertyName+" = "+y+"."+l,(v=this.connection.createQueryBuilder(this.queryRunner)).select(p+"."+f.propertyName,"parentId").addSelect("COUNT("+v.escape(y)+"."+v.escape(l)+")","cnt").from(m,y).innerJoin(g,p,b).addGroupBy(p+"."+f.propertyName),n.queryBuilderFactory&&n.queryBuilderFactory(v),_={relationCountAttribute:n},[4,v.getRawMany()]);case 3:return[2,(_.results=r.sent(),_)]}}))}))})),[2,Promise.all(n)]}))}))},e}(),g=function(){function e(e){this.expressionMap=e}return e.prototype.transform=function(){var e=this;this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach((function(t){var n=e.metadataToAttribute(e.expressionMap.mainAlias.name,t);e.expressionMap.relationCountAttributes.push(n)})),this.expressionMap.joinAttributes.forEach((function(t){t.metadata&&!t.metadata.isJunction&&t.metadata.relationCounts.forEach((function(n){var r=e.metadataToAttribute(t.alias.name,n);e.expressionMap.relationCountAttributes.push(r)}))}))},e.prototype.metadataToAttribute=function(e,t){return new h.a(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})},e}(),b=n(49),v=n(94),w=n(21),_=n(161),k=n(12),E=n(30),O=n(122),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.c)(t,e),t.prototype.getQuery=function(){var e=this.createComment();return e+=this.createSelectExpression(),e+=this.createJoinExpression(),e+=this.createWhereExpression(),e+=this.createGroupByExpression(),e+=this.createHavingExpression(),e+=this.createOrderByExpression(),e+=this.createLimitOffsetExpression(),e=(e+=this.createLockExpression()).trim(),this.expressionMap.subQuery&&(e="("+e+")"),e},t.prototype.subQuery=function(){var e=this.createQueryBuilder();return e.expressionMap.subQuery=!0,e.expressionMap.parentQueryBuilder=this,e},t.prototype.select=function(e,t){if(this.expressionMap.queryType="select",Array.isArray(e))this.expressionMap.selects=e.map((function(e){return{selection:e}}));else if(e instanceof Function){var n=e(this.subQuery());this.setParameters(n.getParameters()),this.expressionMap.selects.push({selection:n.getQuery(),aliasName:t})}else e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);return this},t.prototype.addSelect=function(e,t){if(!e)return this;if(Array.isArray(e))this.expressionMap.selects=this.expressionMap.selects.concat(e.map((function(e){return{selection:e}})));else if(e instanceof Function){var n=e(this.subQuery());this.setParameters(n.getParameters()),this.expressionMap.selects.push({selection:n.getQuery(),aliasName:t})}else e&&this.expressionMap.selects.push({selection:e,aliasName:t});return this},t.prototype.maxExecutionTime=function(e){return this.expressionMap.maxExecutionTime=e,this},t.prototype.distinct=function(e){return void 0===e&&(e=!0),this.expressionMap.selectDistinct=e,this},t.prototype.distinctOn=function(e){return this.expressionMap.selectDistinctOn=e,this},t.prototype.from=function(e,t){var n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this},t.prototype.addFrom=function(e,t){var n=this.createFromAlias(e,t);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(n),this},t.prototype.innerJoin=function(e,t,n,r){return void 0===n&&(n=""),this.join("INNER",e,t,n,r),this},t.prototype.leftJoin=function(e,t,n,r){return void 0===n&&(n=""),this.join("LEFT",e,t,n,r),this},t.prototype.innerJoinAndSelect=function(e,t,n,r){return void 0===n&&(n=""),this.addSelect(t),this.innerJoin(e,t,n,r),this},t.prototype.leftJoinAndSelect=function(e,t,n,r){return void 0===n&&(n=""),this.addSelect(t),this.leftJoin(e,t,n,r),this},t.prototype.innerJoinAndMapMany=function(e,t,n,r,i){return void 0===r&&(r=""),this.addSelect(n),this.join("INNER",t,n,r,i,e,!0),this},t.prototype.innerJoinAndMapOne=function(e,t,n,r,i){return void 0===r&&(r=""),this.addSelect(n),this.join("INNER",t,n,r,i,e,!1),this},t.prototype.leftJoinAndMapMany=function(e,t,n,r,i){return void 0===r&&(r=""),this.addSelect(n),this.join("LEFT",t,n,r,i,e,!0),this},t.prototype.leftJoinAndMapOne=function(e,t,n,r,i){return void 0===r&&(r=""),this.addSelect(n),this.join("LEFT",t,n,r,i,e,!1),this},t.prototype.loadRelationIdAndMap=function(e,t,n,r){var i=new f.a(this.expressionMap);return i.mapToProperty=e,i.relationName=t,"string"==typeof n&&(i.alias=n),n instanceof Object&&n.disableMixedMap&&(i.disableMixedMap=!0),i.queryBuilderFactory=r,this.expressionMap.relationIdAttributes.push(i),i.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:i.junctionAlias,metadata:i.relation.junctionEntityMetadata}),this},t.prototype.loadRelationCountAndMap=function(e,t,n,r){var i=new h.a(this.expressionMap);return i.mapToProperty=e,i.relationName=t,i.alias=n,i.queryBuilderFactory=r,this.expressionMap.relationCountAttributes.push(i),this.expressionMap.createAlias({type:"other",name:i.junctionAlias}),i.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:i.junctionAlias,metadata:i.relation.junctionEntityMetadata}),this},t.prototype.loadAllRelationIds=function(e){var t=this;return this.expressionMap.mainAlias.metadata.relations.forEach((function(n){void 0!==e&&void 0!==e.relations&&-1===e.relations.indexOf(n.propertyPath)||t.loadRelationIdAndMap(t.expressionMap.mainAlias.name+"."+n.propertyPath,t.expressionMap.mainAlias.name+"."+n.propertyPath,e)})),this},t.prototype.where=function(e,t){this.expressionMap.wheres=[];var n=this.computeWhereParameter(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this},t.prototype.andWhere=function(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.computeWhereParameter(e)}),t&&this.setParameters(t),this},t.prototype.orWhere=function(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.computeWhereParameter(e)}),t&&this.setParameters(t),this},t.prototype.whereInIds=function(e){return this.where(this.createWhereIdsExpression(e))},t.prototype.andWhereInIds=function(e){return this.andWhere(this.createWhereIdsExpression(e))},t.prototype.orWhereInIds=function(e){return this.orWhere(this.createWhereIdsExpression(e))},t.prototype.having=function(e,t){return this.expressionMap.havings.push({type:"simple",condition:e}),t&&this.setParameters(t),this},t.prototype.andHaving=function(e,t){return this.expressionMap.havings.push({type:"and",condition:e}),t&&this.setParameters(t),this},t.prototype.orHaving=function(e,t){return this.expressionMap.havings.push({type:"or",condition:e}),t&&this.setParameters(t),this},t.prototype.groupBy=function(e){return this.expressionMap.groupBys=e?[e]:[],this},t.prototype.addGroupBy=function(e){return this.expressionMap.groupBys.push(e),this},t.prototype.orderBy=function(e,t,n){var r,i;if(void 0===t&&(t="ASC"),void 0!==t&&"ASC"!==t&&"DESC"!==t)throw new Error('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(void 0!==n&&"NULLS FIRST"!==n&&"NULLS LAST"!==n)throw new Error('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return this.expressionMap.orderBys=e?e instanceof Object?e:n?((r={})[e]={order:t,nulls:n},r):((i={})[e]=t,i):{},this},t.prototype.addOrderBy=function(e,t,n){if(void 0===t&&(t="ASC"),void 0!==t&&"ASC"!==t&&"DESC"!==t)throw new Error('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(void 0!==n&&"NULLS FIRST"!==n&&"NULLS LAST"!==n)throw new Error('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return this.expressionMap.orderBys[e]=n?{order:t,nulls:n}:t,this},t.prototype.limit=function(e){if(this.expressionMap.limit=this.normalizeNumber(e),void 0!==this.expressionMap.limit&&isNaN(this.expressionMap.limit))throw new Error('Provided "limit" value is not a number. Please provide a numeric value.');return this},t.prototype.offset=function(e){if(this.expressionMap.offset=this.normalizeNumber(e),void 0!==this.expressionMap.offset&&isNaN(this.expressionMap.offset))throw new Error('Provided "offset" value is not a number. Please provide a numeric value.');return this},t.prototype.take=function(e){if(this.expressionMap.take=this.normalizeNumber(e),void 0!==this.expressionMap.take&&isNaN(this.expressionMap.take))throw new Error('Provided "take" value is not a number. Please provide a numeric value.');return this},t.prototype.skip=function(e){if(this.expressionMap.skip=this.normalizeNumber(e),void 0!==this.expressionMap.skip&&isNaN(this.expressionMap.skip))throw new Error('Provided "skip" value is not a number. Please provide a numeric value.');return this},t.prototype.setLock=function(e,t,n){return this.expressionMap.lockMode=e,this.expressionMap.lockVersion=t,this.expressionMap.lockTables=n,this},t.prototype.withDeleted=function(){return this.expressionMap.withDeleted=!0,this},t.prototype.getRawOne=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:return[4,this.getRawMany()];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.getRawMany=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new u.a;this.expressionMap.queryEntity=!1,e=this.obtainQueryRunner(),t=!1,r.label=1;case 1:return r.trys.push([1,7,12,15]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:r.sent(),t=!0,r.label=3;case 3:return[4,this.loadRawResults(e)];case 4:return n=r.sent(),t?[4,e.commitTransaction()]:[3,6];case 5:r.sent(),r.label=6;case 6:return[2,n];case 7:if(i=r.sent(),!t)return[3,11];r.label=8;case 8:return r.trys.push([8,10,,11]),[4,e.rollbackTransaction()];case 9:return r.sent(),[3,11];case 10:return r.sent(),[3,11];case 11:throw i;case 12:return e===this.queryRunner?[3,14]:[4,e.release()];case 13:r.sent(),r.label=14;case 14:return[7];case 15:return[2]}}))}))},t.prototype.getRawAndEntities=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:e=this.obtainQueryRunner(),t=!1,r.label=1;case 1:return r.trys.push([1,7,12,15]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:r.sent(),t=!0,r.label=3;case 3:return this.expressionMap.queryEntity=!0,[4,this.executeEntitiesAndRawResults(e)];case 4:return n=r.sent(),t?[4,e.commitTransaction()]:[3,6];case 5:r.sent(),r.label=6;case 6:return[2,n];case 7:if(i=r.sent(),!t)return[3,11];r.label=8;case 8:return r.trys.push([8,10,,11]),[4,e.rollbackTransaction()];case 9:return r.sent(),[3,11];case 10:return r.sent(),[3,11];case 11:throw i;case 12:return e===this.queryRunner?[3,14]:[4,e.release()];case 13:r.sent(),r.label=14;case 14:return[7];case 15:return[2]}}))}))},t.prototype.getOne=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.getRawAndEntities()];case 1:if(e=r.sent(),(t=e.entities[0])&&"optimistic"===this.expressionMap.lockMode&&this.expressionMap.lockVersion)if(n=this.expressionMap.mainAlias.metadata,this.expressionMap.lockVersion instanceof Date){if((i=n.updateDateColumn.getEntityValue(t)).getTime()!==this.expressionMap.lockVersion.getTime())throw new c.a(n.name,this.expressionMap.lockVersion,i)}else if((i=n.versionColumn.getEntityValue(t))!==this.expressionMap.lockVersion)throw new c.a(n.name,this.expressionMap.lockVersion,i);return[2,t]}}))}))},t.prototype.getOneOrFail=function(){return Object(r.b)(this,void 0,void 0,(function(){var e;return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.getOne()];case 1:if(!(e=t.sent()))throw new O.a(this.expressionMap.mainAlias.target,this);return[2,e]}}))}))},t.prototype.getMany=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){switch(e.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new u.a;return[4,this.getRawAndEntities()];case 1:return[2,e.sent().entities]}}))}))},t.prototype.getCount=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new u.a;e=this.obtainQueryRunner(),t=!1,r.label=1;case 1:return r.trys.push([1,7,12,15]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:r.sent(),t=!0,r.label=3;case 3:return this.expressionMap.queryEntity=!1,[4,this.executeCountQuery(e)];case 4:return n=r.sent(),t?[4,e.commitTransaction()]:[3,6];case 5:r.sent(),r.label=6;case 6:return[2,n];case 7:if(i=r.sent(),!t)return[3,11];r.label=8;case 8:return r.trys.push([8,10,,11]),[4,e.rollbackTransaction()];case 9:return r.sent(),[3,11];case 10:return r.sent(),[3,11];case 11:throw i;case 12:return e===this.queryRunner?[3,14]:[4,e.release()];case 13:r.sent(),r.label=14;case 14:return[7];case 15:return[2]}}))}))},t.prototype.getManyAndCount=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a;return Object(r.d)(this,(function(r){switch(r.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new u.a;e=this.obtainQueryRunner(),t=!1,r.label=1;case 1:return r.trys.push([1,8,13,16]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:r.sent(),t=!0,r.label=3;case 3:return this.expressionMap.queryEntity=!0,[4,this.executeEntitiesAndRawResults(e)];case 4:return n=r.sent(),this.expressionMap.queryEntity=!1,[4,this.executeCountQuery(e)];case 5:return i=r.sent(),o=[n.entities,i],t?[4,e.commitTransaction()]:[3,7];case 6:r.sent(),r.label=7;case 7:return[2,o];case 8:if(a=r.sent(),!t)return[3,12];r.label=9;case 9:return r.trys.push([9,11,,12]),[4,e.rollbackTransaction()];case 10:return r.sent(),[3,12];case 11:return r.sent(),[3,12];case 12:throw a;case 13:return e===this.queryRunner?[3,15]:[4,e.release()];case 14:r.sent(),r.label=15;case 15:return[7];case 16:return[2]}}))}))},t.prototype.stream=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c,u=this;return Object(r.d)(this,(function(l){switch(l.label){case 0:this.expressionMap.queryEntity=!1,e=Object(r.e)(this.getQueryAndParameters(),2),t=e[0],n=e[1],i=this.obtainQueryRunner(),o=!1,l.label=1;case 1:return l.trys.push([1,6,,11]),!0!==this.expressionMap.useTransaction||!1!==i.isTransactionActive?[3,3]:[4,i.startTransaction()];case 2:l.sent(),o=!0,l.label=3;case 3:return a=function(){if(i!==u.queryRunner)return i.release()},s=i.stream(t,n,a,a),o?[4,i.commitTransaction()]:[3,5];case 4:l.sent(),l.label=5;case 5:return[2,s];case 6:if(c=l.sent(),!o)return[3,10];l.label=7;case 7:return l.trys.push([7,9,,10]),[4,i.rollbackTransaction()];case 8:return l.sent(),[3,10];case 9:return l.sent(),[3,10];case 10:throw c;case 11:return[2]}}))}))},t.prototype.cache=function(e,t){return"boolean"==typeof e?this.expressionMap.cache=e:"number"==typeof e?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=e):"string"!=typeof e&&"number"!=typeof e||(this.expressionMap.cache=!0,this.expressionMap.cacheId=e),t&&(this.expressionMap.cacheDuration=t),this},t.prototype.setOption=function(e){return this.expressionMap.options.push(e),this},t.prototype.join=function(e,t,n,r,i,o,a){this.setParameters(i||{});var s=new l.a(this.connection,this.expressionMap);if(s.direction=e,s.mapToProperty=o,s.isMappingMany=a,s.entityOrProperty=t,s.condition=r,this.expressionMap.joinAttributes.push(s),s.metadata){if(s.metadata.deleteDateColumn&&!this.expressionMap.withDeleted){var c=n+"."+s.metadata.deleteDateColumn.propertyName+" IS NULL";s.condition+=s.condition?" AND "+c:""+c}s.alias=this.expressionMap.createAlias({type:"join",name:n,metadata:s.metadata}),s.relation&&s.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:s.junctionAlias,metadata:s.relation.junctionEntityMetadata})}else{var u="";if(t instanceof Function){var f=t(this.subQuery());this.setParameters(f.getParameters()),u=f.getQuery()}else u=t;var h=t instanceof Function||"("===t.substr(0,1)&&")"===t.substr(-1);s.alias=this.expressionMap.createAlias({type:"join",name:n,tablePath:!1===h?t:void 0,subQuery:!0===h?u:void 0})}},t.prototype.createSelectExpression=function(){var e=this;if(!this.expressionMap.mainAlias)throw new Error("Cannot build query because main alias is not set (call qb#from method)");var t=[],n=[];if(this.expressionMap.mainAlias.hasMetadata){var o=this.expressionMap.mainAlias.metadata;t.push.apply(t,Object(r.f)([],Object(r.e)(this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,o)))),n.push.apply(n,Object(r.f)([],Object(r.e)(this.findEntityColumnSelects(this.expressionMap.mainAlias.name,o))))}this.expressionMap.joinAttributes.forEach((function(i){if(i.metadata)t.push.apply(t,Object(r.f)([],Object(r.e)(e.buildEscapedEntityColumnSelects(i.alias.name,i.metadata)))),n.push.apply(n,Object(r.f)([],Object(r.e)(e.findEntityColumnSelects(i.alias.name,i.metadata))));else if(e.expressionMap.selects.some((function(e){return e.selection===i.alias.name}))){t.push({selection:e.escape(i.alias.name)+".*"});var o=e.expressionMap.selects.find((function(e){return e.selection===i.alias.name}));n.push(o)}})),this.expressionMap.selects.filter((function(e){return-1===n.indexOf(e)})).forEach((function(n){return t.push({selection:e.replacePropertyNames(n.selection),aliasName:n.aliasName})})),0===t.length&&t.push({selection:"*"});var a="";if(this.connection.driver instanceof i.m)switch(this.expressionMap.lockMode){case"pessimistic_read":a=" WITH (HOLDLOCK, ROWLOCK)";break;case"pessimistic_write":a=" WITH (UPDLOCK, ROWLOCK)";break;case"dirty_read":a=" WITH (NOLOCK)"}var s=this.expressionMap.aliases.filter((function(e){return"from"===e.type&&(e.tablePath||e.subQuery)})).map((function(t){return t.subQuery?t.subQuery+" "+e.escape(t.name):e.getTableName(t.tablePath)+" "+e.escape(t.name)}));return this.createSelectDistinctExpression()+t.map((function(t){return t.selection+(t.aliasName?" AS "+e.escape(t.aliasName):"")})).join(", ")+" FROM "+s.join(", ")+a},t.prototype.createSelectDistinctExpression=function(){var e=this,t=this.expressionMap,n=t.selectDistinct,r=t.selectDistinctOn,o=t.maxExecutionTime,a=this.connection.driver,s="SELECT ";(o>0&&a instanceof i.i&&(s+="/*+ MAX_EXECUTION_TIME("+this.expressionMap.maxExecutionTime+") */ "),a instanceof i.k&&r.length>0)?s="SELECT DISTINCT ON ("+r.map((function(t){return e.replacePropertyNames(t)})).join(", ")+") ":n&&(s="SELECT DISTINCT ");return s},t.prototype.createJoinExpression=function(){var e=this;return this.expressionMap.joinAttributes.map((function(t){var n=t.relation,r=t.tablePath,i=t.alias.name,o=t.condition?" AND ("+t.condition+")":"",a=t.parentAlias;if(!a||!n){var s=t.alias.subQuery?t.alias.subQuery:e.getTableName(r);return" "+t.direction+" JOIN "+s+" "+e.escape(i)+(t.condition?" ON "+e.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){var c=n.joinColumns.map((function(e){return i+"."+e.referencedColumn.propertyPath+"="+a+"."+n.propertyPath+"."+e.referencedColumn.propertyPath})).join(" AND ");return" "+t.direction+" JOIN "+e.getTableName(r)+" "+e.escape(i)+" ON "+e.replacePropertyNames(c+o)}if(n.isOneToMany||n.isOneToOneNotOwner){c=n.inverseRelation.joinColumns.map((function(e){return"entity-child"===n.inverseEntityMetadata.tableType&&n.inverseEntityMetadata.discriminatorColumn&&(o+=" AND "+i+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),i+"."+n.inverseRelation.propertyPath+"."+e.referencedColumn.propertyPath+"="+a+"."+e.referencedColumn.propertyPath})).join(" AND ");return" "+t.direction+" JOIN "+e.getTableName(r)+" "+e.escape(i)+" ON "+e.replacePropertyNames(c+o)}var u=n.junctionEntityMetadata.tablePath,l=t.junctionAlias,f="",h="";return n.isOwning?(f=n.joinColumns.map((function(e){return l+"."+e.propertyPath+"="+a+"."+e.referencedColumn.propertyPath})).join(" AND "),h=n.inverseJoinColumns.map((function(e){return i+"."+e.referencedColumn.propertyPath+"="+l+"."+e.propertyPath})).join(" AND ")):(f=n.inverseRelation.inverseJoinColumns.map((function(e){return l+"."+e.propertyPath+"="+a+"."+e.referencedColumn.propertyPath})).join(" AND "),h=n.inverseRelation.joinColumns.map((function(e){return i+"."+e.referencedColumn.propertyPath+"="+l+"."+e.propertyPath})).join(" AND "))," "+t.direction+" JOIN "+e.getTableName(u)+" "+e.escape(l)+" ON "+e.replacePropertyNames(f)+" "+t.direction+" JOIN "+e.getTableName(r)+" "+e.escape(i)+" ON "+e.replacePropertyNames(h+o)})).join(" ")},t.prototype.createGroupByExpression=function(){return this.expressionMap.groupBys&&this.expressionMap.groupBys.length?" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", ")):""},t.prototype.createOrderByExpression=function(){var e=this,t=this.expressionMap.allOrderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map((function(n){return"string"==typeof t[n]?e.replacePropertyNames(n)+" "+t[n]:e.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls})).join(", "):""},t.prototype.createLimitOffsetExpression=function(){var e=this.expressionMap.offset,t=this.expressionMap.limit;if(e||t||0!==this.expressionMap.joinAttributes.length||(e=this.expressionMap.skip,t=this.expressionMap.take),this.connection.driver instanceof i.m){var n="";if((t||e)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(n=" ORDER BY (SELECT NULL)"),t&&e)return n+" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return n+" OFFSET 0 ROWS FETCH NEXT "+t+" ROWS ONLY";if(e)return n+" OFFSET "+e+" ROWS"}else if(this.connection.driver instanceof i.i||this.connection.driver instanceof i.a||this.connection.driver instanceof i.l){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)throw new _.a}else if(this.connection.driver instanceof w.a){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" LIMIT -1 OFFSET "+e}else if(this.connection.driver instanceof i.j){if(t&&e)return" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return" FETCH NEXT "+t+" ROWS ONLY";if(e)return" OFFSET "+e+" ROWS"}else{if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" OFFSET "+e}return""},t.prototype.createLockExpression=function(){var e=this.connection.driver,t="";if(this.expressionMap.lockTables){if(!(e instanceof i.k))throw new Error("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new Error("lockTables cannot be an empty array");t=" OF "+this.expressionMap.lockTables.join(", ")}switch(this.expressionMap.lockMode){case"pessimistic_read":if(e instanceof i.i||e instanceof i.a)return" LOCK IN SHARE MODE";if(e instanceof i.k)return" FOR SHARE"+t;if(e instanceof i.j)return" FOR UPDATE";if(e instanceof i.m)return"";throw new v.a;case"pessimistic_write":if(e instanceof i.i||e instanceof i.a||e instanceof i.j)return" FOR UPDATE";if(e instanceof i.k)return" FOR UPDATE"+t;if(e instanceof i.m)return"";throw new v.a;case"pessimistic_partial_write":if(e instanceof i.k)return" FOR UPDATE"+t+" SKIP LOCKED";if(e instanceof i.i)return" FOR UPDATE SKIP LOCKED";throw new v.a;case"pessimistic_write_or_fail":if(e instanceof i.k)return" FOR UPDATE"+t+" NOWAIT";if(e instanceof i.i)return" FOR UPDATE NOWAIT";throw new v.a;case"for_no_key_update":if(e instanceof i.k)return" FOR NO KEY UPDATE"+t;throw new v.a;default:return""}},t.prototype.createHavingExpression=function(){var e=this;if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";var t=this.expressionMap.havings.map((function(t,n){switch(t.type){case"and":return(n>0?"AND ":"")+e.replacePropertyNames(t.condition);case"or":return(n>0?"OR ":"")+e.replacePropertyNames(t.condition);default:return e.replacePropertyNames(t.condition)}})).join(" ");return t.length?" HAVING "+t:""},t.prototype.buildEscapedEntityColumnSelects=function(e,t){var n=this,o=this.expressionMap.selects.some((function(t){return t.selection===e})),a=[];if(o&&a.push.apply(a,Object(r.f)([],Object(r.e)(t.columns.filter((function(e){return!0===e.isSelect}))))),a.push.apply(a,Object(r.f)([],Object(r.e)(t.columns.filter((function(t){return n.expressionMap.selects.some((function(n){return n.selection===e+"."+t.propertyPath}))}))))),0===a.length)return[];var s=this.expressionMap.queryEntity?t.primaryColumns.filter((function(e){return-1===a.indexOf(e)})):[];return Object(r.f)(Object(r.f)([],Object(r.e)(a)),Object(r.e)(s)).map((function(t){var r=n.expressionMap.selects.find((function(n){return n.selection===e+"."+t.propertyPath})),a=n.escape(e)+"."+n.escape(t.databaseName);if(-1!==n.connection.driver.spatialTypes.indexOf(t.type)){if(n.connection.driver instanceof i.i||n.connection.driver instanceof i.a)a=(n.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText")+"("+a+")";n.connection.driver instanceof i.k&&(a=t.precision?"ST_AsGeoJSON("+a+", "+t.precision+")::json":"ST_AsGeoJSON("+a+")::json"),n.connection.driver instanceof i.m&&(a+=".ToString()")}return{selection:a,aliasName:r&&r.aliasName?r.aliasName:d.a.buildAlias(n.connection.driver,e,t.databaseName),virtual:r?!0===r.virtual:!o}}))},t.prototype.findEntityColumnSelects=function(e,t){var n=this.expressionMap.selects.find((function(t){return t.selection===e}));return n?[n]:this.expressionMap.selects.filter((function(n){return t.columns.some((function(t){return n.selection===e+"."+t.propertyPath}))}))},t.prototype.computeCountExpression=function(){var e=this,t=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(t);if(0===this.expressionMap.joinAttributes.length&&0===this.expressionMap.relationIdAttributes.length&&0===this.expressionMap.relationCountAttributes.length)return"COUNT(1)";if(this.connection.driver instanceof i.d||this.connection.driver instanceof i.k)return"COUNT(DISTINCT("+n.map((function(t){return r+"."+e.escape(t.databaseName)})).join(", ")+"))";if(this.connection.driver instanceof i.i)return"COUNT(DISTINCT "+n.map((function(t){return r+"."+e.escape(t.databaseName)})).join(", ")+")";if(this.connection.driver instanceof i.m){var o=n.map((function(t){return r+"."+e.escape(t.databaseName)})).join(", '|;|', ");return 1===n.length?"COUNT(DISTINCT("+o+"))":"COUNT(DISTINCT(CONCAT("+o+")))"}return"COUNT(DISTINCT("+n.map((function(t){return r+"."+e.escape(t.databaseName)})).join(" || '|;|' || ")+"))"},t.prototype.executeCountQuery=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return t=this.computeCountExpression(),[4,this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(t,"cnt").setOption("disable-global-order").loadRawResults(e)];case 1:return(n=r.sent())&&n[0]&&n[0].cnt?[2,parseInt(n[0].cnt)]:[2,0]}}))}))},t.prototype.executeEntitiesAndRawResults=function(e){return Object(r.b)(this,void 0,void 0,(function(){var n,i,c,u,l,f,h,b,v,w,_,E,O,T,x,S,C,R,P,N=this;return Object(r.d)(this,(function(M){switch(M.label){case 0:if(!this.expressionMap.mainAlias)throw new Error('Alias is not set. Use "from" method to set an alias.');if(("pessimistic_read"===this.expressionMap.lockMode||"pessimistic_write"===this.expressionMap.lockMode||"pessimistic_partial_write"===this.expressionMap.lockMode||"pessimistic_write_or_fail"===this.expressionMap.lockMode||"for_no_key_update"===this.expressionMap.lockMode)&&!e.isTransactionActive)throw new a.a;if("optimistic"===this.expressionMap.lockMode&&!(n=this.expressionMap.mainAlias.metadata).versionColumn&&!n.updateDateColumn)throw new s.a(n.name);return i=new p(this.connection,e,this.expressionMap.relationIdAttributes),c=new y(this.connection,e,this.expressionMap.relationCountAttributes),new m(this.expressionMap).transform(),new g(this.expressionMap).transform(),u=[],l=[],(this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0?(f=Object(r.e)(this.createOrderByCombinedWithSelectExpression("distinctAlias"),2),h=f[0],b=f[1],v=this.expressionMap.mainAlias.metadata,w=this.expressionMap.mainAlias.name,_=v.primaryColumns.map((function(e){var t=N.escape("distinctAlias"),n=N.escape(d.a.buildAlias(N.connection.driver,w,e.databaseName));return b[n]||(b[n]="ASC"),t+"."+n+' as "'+d.a.buildAlias(N.connection.driver,"ids_"+w,e.databaseName)+'"'})),[4,new t(this.connection,e).select("DISTINCT "+_.join(", ")).addSelect(h).from("("+this.clone().orderBy().getQuery()+")","distinctAlias").offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(b).cache(this.expressionMap.cache?this.expressionMap.cache:this.expressionMap.cacheId,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany()]):[3,4];case 1:return(u=M.sent()).length>0?(E="",O={},v.hasMultiplePrimaryKeys?E=u.map((function(e,t){return v.primaryColumns.map((function(n){var r="orm_distinct_ids_"+t+"_"+n.databaseName;return O[r]=e["ids_"+w+"_"+n.databaseName],w+"."+n.propertyPath+"=:"+r})).join(" AND ")})).join(" OR "):(T=d.a.buildAlias(this.connection.driver,"ids_"+w,v.primaryColumns[0].databaseName),x=u.map((function(e){return e[T]})),x.every((function(e){return"number"==typeof e}))?E=w+"."+v.primaryColumns[0].propertyPath+" IN ("+x.join(", ")+")":(O.orm_distinct_ids=x,E=w+"."+v.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")),[4,this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:E}).setParameters(O).loadRawResults(e)]):[3,3];case 2:u=M.sent(),M.label=3;case 3:return[3,6];case 4:return[4,this.loadRawResults(e)];case 5:u=M.sent(),M.label=6;case 6:return u.length>0?[4,i.load(u)]:[3,10];case 7:return S=M.sent(),[4,c.load(u)];case 8:return C=M.sent(),R=new o.a(this.expressionMap,this.connection.driver,S,C,this.queryRunner),l=R.transform(u,this.expressionMap.mainAlias),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(P=new k.a,e.broadcaster.broadcastLoadEventsForAll(P,this.expressionMap.mainAlias.metadata,l),P.promises.length>0?[4,Promise.all(P.promises)]:[3,10]):[3,10];case 9:M.sent(),M.label=10;case 10:return[2,{raw:u,entities:l}]}}))}))},t.prototype.createOrderByCombinedWithSelectExpression=function(e){var t=this,n=this.expressionMap.allOrderBys,r=Object.keys(n).map((function(n){if(-1!==n.indexOf(".")){var r=n.split("."),i=r[0],o=r.slice(1).join("."),a=t.expressionMap.findAliasByName(i).metadata.findColumnWithPropertyPath(o);return t.escape(e)+"."+t.escape(d.a.buildAlias(t.connection.driver,i,a.databaseName))}return t.expressionMap.selects.find((function(e){return e.selection===n||e.aliasName===n}))?t.escape(e)+"."+n:""})).join(", "),i={};return Object.keys(n).forEach((function(r){if(-1!==r.indexOf(".")){var o=r.split("."),a=o[0],s=o.slice(1).join("."),c=t.expressionMap.findAliasByName(a).metadata.findColumnWithPropertyPath(s);i[t.escape(e)+"."+t.escape(d.a.buildAlias(t.connection.driver,a,c.databaseName))]=n[r]}else t.expressionMap.selects.find((function(e){return e.selection===r||e.aliasName===r}))?i[t.escape(e)+"."+r]=n[r]:i[r]=n[r]})),[r,i]},t.prototype.loadRawResults=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u,l,f;return Object(r.d)(this,(function(h){switch(h.label){case 0:if(t=Object(r.e)(this.getQueryAndParameters(),2),n=t[0],i=t[1],o=n+" -- PARAMETERS: "+JSON.stringify(i),a="object"==typeof this.connection.options.cache?this.connection.options.cache:{},s=void 0,c=!1,!this.connection.queryResultCache||!this.expressionMap.cache&&!a.alwaysEnabled)return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:o,duration:this.expressionMap.cacheDuration||a.duration||1e3},e)];case 2:return(s=h.sent())&&!this.connection.queryResultCache.isExpired(s)?[2,JSON.parse(s.result)]:[3,4];case 3:if(u=h.sent(),!a.ignoreErrors)throw u;return c=!0,[3,4];case 4:return[4,e.query(n,i)];case 5:if(l=h.sent(),c||!this.connection.queryResultCache||!this.expressionMap.cache&&!a.alwaysEnabled)return[3,9];h.label=6;case 6:return h.trys.push([6,8,,9]),[4,this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:o,time:(new Date).getTime(),duration:this.expressionMap.cacheDuration||a.duration||1e3,result:JSON.stringify(l)},s,e)];case 7:return h.sent(),[3,9];case 8:if(f=h.sent(),!a.ignoreErrors)throw f;return[3,9];case 9:return[2,l]}}))}))},t.prototype.mergeExpressionMap=function(e){return E.a.assign(this.expressionMap,e),this},t.prototype.normalizeNumber=function(e){return"number"==typeof e||null==e?e:Number(e)},t.prototype.obtainQueryRunner=function(){return this.queryRunner||this.connection.createQueryRunner("slave")},t}(b.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(59),o=n(30),a=function(){function e(e,t){this.queryExpressionMap=e,this.disableMixedMap=!1,o.a.assign(this,t||{})}return Object.defineProperty(e.prototype,"joinInverseSideMetadata",{get:function(){return this.relation.inverseEntityMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentAlias",{get:function(){if(!i.a.isAliasProperty(this.relationName))throw new Error("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relationPropertyPath",{get:function(){if(!i.a.isAliasProperty(this.relationName))throw new Error("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relation",{get:function(){if(!i.a.isAliasProperty(this.relationName))throw new Error("Given value must be a string representation of alias property");var e=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new Error("Relation with property path "+this.relationPropertyPath+" in entity was not found.");return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"junctionAlias",{get:function(){var e=Object(r.e)(this.relationName.split("."),2);return e[0]+"_"+e[1]+"_rid"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"junctionMetadata",{get:function(){return this.relation.junctionEntityMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapToPropertyParentAlias",{get:function(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapToPropertyPropertyPath",{get:function(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(59),o=n(30),a=function(){function e(e,t){this.expressionMap=e,o.a.assign(this,t||{})}return Object.defineProperty(e.prototype,"joinInverseSideMetadata",{get:function(){return this.relation.inverseEntityMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentAlias",{get:function(){if(!i.a.isAliasProperty(this.relationName))throw new Error("Given value must be a string representation of alias property");return this.relationName.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relationProperty",{get:function(){if(!i.a.isAliasProperty(this.relationName))throw new Error("Given value is a string representation of alias property");return this.relationName.split(".")[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"junctionAlias",{get:function(){var e=Object(r.e)(this.relationName.split("."),2);return e[0]+"_"+e[1]+"_rc"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relation",{get:function(){if(!i.a.isAliasProperty(this.relationName))throw new Error("Given value is a string representation of alias property");var e=Object(r.e)(this.relationName.split("."),2),t=e[0],n=e[1],o=this.expressionMap.findAliasByName(t).metadata.findRelationWithPropertyPath(n);if(!o)throw new Error("Relation with property path "+n+" in entity was not found.");return o},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){if(!i.a.isAliasProperty(this.relationName))throw new Error("Given value is a string representation of alias property");var e=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(e).metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapToPropertyPropertyName",{get:function(){return this.mapToProperty.split(".")[1]},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(9),o=n(1),a=function(){function e(e,t){this.queryRunner=e,this.expressionMap=t}return e.prototype.update=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,i=this;return Object(r.d)(this,(function(a){switch(a.label){case 0:return n=this.expressionMap.mainAlias.metadata,[4,Promise.all(t.map((function(t,a){return Object(r.b)(i,void 0,void 0,(function(){var i,s,c,u,l=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return this.queryRunner.connection.driver.isReturningSqlSupported()?(this.queryRunner.connection.driver instanceof o.j&&Array.isArray(e.raw)&&this.expressionMap.extraReturningColumns.length>0&&(e.raw=e.raw.reduce((function(e,t,n){return e[l.expressionMap.extraReturningColumns[n].databaseName]=t[0],e}),{})),i=Array.isArray(e.raw)?e.raw[a]:e.raw,(s=this.queryRunner.connection.driver.createGeneratedMap(n,i))&&(this.queryRunner.manager.merge(n.target,t,s),e.generatedMaps.push(s)),[3,3]):[3,1];case 1:if(!(this.getUpdationReturningColumns().length>0))return[3,3];if(!(c=this.expressionMap.mainAlias.metadata.getEntityIdMap(t)))throw new Error("Cannot update entity because entity id is not set in the entity.");return[4,this.queryRunner.manager.createQueryBuilder().select(n.primaryColumns.map((function(e){return n.targetName+"."+e.propertyPath}))).addSelect(this.getUpdationReturningColumns().map((function(e){return n.targetName+"."+e.propertyPath}))).from(n.target,n.targetName).where(c).setOption("create-pojo").getOne()];case 2:(u=r.sent())&&(this.queryRunner.manager.merge(n.target,t,u),e.generatedMaps.push(u)),r.label=3;case 3:return[2]}}))}))})))];case 1:return a.sent(),[2]}}))}))},e.prototype.insert=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,a,s,c,u,l=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return n=this.expressionMap.mainAlias.metadata,a=this.getInsertionReturningColumns(),s=t.map((function(r,a){l.queryRunner.connection.driver instanceof o.j&&Array.isArray(e.raw)&&l.expressionMap.extraReturningColumns.length>0&&(e.raw=e.raw.reduce((function(e,t,n){return e[l.expressionMap.extraReturningColumns[n].databaseName]=t[0],e}),{}));var s=Array.isArray(e.raw)?e.raw[a]:e.raw,c=l.queryRunner.connection.driver.createGeneratedMap(n,s,a,t.length)||{};return!1===l.queryRunner.connection.driver.isUUIDGenerationSupported()&&n.generatedColumns.forEach((function(e){if("uuid"===e.generationStrategy){var t=e.getEntityValue(r);t||(t=l.expressionMap.nativeParameters["uuid_"+e.databaseName+a]),i.a.mergeDeep(c,e.createValueMap(t))}})),l.queryRunner.manager.merge(n.target,r,c),c})),!1===this.queryRunner.connection.driver.isReturningSqlSupported()&&a.length>0?(c=t.map((function(e){var t=n.getEntityIdMap(e);if(!t)throw new Error("Cannot update entity because entity id is not set in the entity.");return t})),[4,this.queryRunner.manager.createQueryBuilder().select(n.primaryColumns.map((function(e){return n.targetName+"."+e.propertyPath}))).addSelect(a.map((function(e){return n.targetName+"."+e.propertyPath}))).from(n.target,n.targetName).where(c).setOption("create-pojo").getMany()]):[3,2];case 1:u=r.sent(),t.forEach((function(e,t){l.queryRunner.manager.merge(n.target,s[t],u[t])})),r.label=2;case 2:return t.forEach((function(t,r){var i=n.getEntityIdMap(t);e.identifiers.push(i),e.generatedMaps.push(s[r]),l.queryRunner.manager.merge(l.expressionMap.mainAlias.metadata.target,t,s[r],s[r])})),[2]}}))}))},e.prototype.getInsertionReturningColumns=function(){var e=this.queryRunner.connection.driver.isReturningSqlSupported();return this.expressionMap.mainAlias.metadata.columns.filter((function(t){return void 0!==t.default||e&&t.isGenerated||t.isCreateDate||t.isUpdateDate||t.isDeleteDate||t.isVersion}))},e.prototype.getUpdationReturningColumns=function(){return this.expressionMap.mainAlias.metadata.columns.filter((function(e){return e.isUpdateDate||e.isVersion}))},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.createTableColumnOptions=function(e,t){return{name:e.databaseName,length:e.length,width:e.width,charset:e.charset,collation:e.collation,precision:e.precision,scale:e.scale,zerofill:e.zerofill,unsigned:e.unsigned,asExpression:e.asExpression,generatedType:e.generatedType,default:t.normalizeDefault(e),onUpdate:e.onUpdate,comment:e.comment,isGenerated:e.isGenerated,generationStrategy:e.generationStrategy,isNullable:e.isNullable,type:t.normalizeType(e),isPrimary:e.isPrimary,isUnique:t.normalizeIsUnique(e),isArray:e.isArray||!1,enum:e.enum?e.enum.map((function(e){return e+""})):e.enum,enumName:e.enumName,spatialFeatureType:e.spatialFeatureType,srid:e.srid}},e}()},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(206),t),i(n(274),t),i(n(275),t),i(n(109),t),i(n(207),t),i(n(272),t),i(n(273),t),i(n(277),t),i(n(212),t),i(n(542),t),i(n(543),t)},function(e,t,n){var r=n(87);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(87),i=n(25)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var r=n(19),i=n(76),o=n(25)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[o])?t:i(n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(n,r,i){var o=e.call(this)||this;return o.name="OptimisticLockVersionMismatchError",Object.setPrototypeOf(o,t.prototype),o.message="The optimistic lock on entity "+n+" failed, version "+r+" was expected, but is actually "+i+".",o}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){this.identifiers=[],this.generatedMaps=[]}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmDialog=void 0;var f=n(64),h=n(22),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(e,t,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(i=c.call(this,e,t)).confirmButtonText=h.Helper.nonNull(n,"confirm-button"),i.cancelButtonText=h.Helper.nonNull(r,"cancel-button"),i}return t=f,(n=[{key:"show",value:function(){var e=this,t=Object.create(null,{show:{get:function(){return o(u(f.prototype),"show",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.addButton(this.confirmButtonText,!0),this.addButton(this.cancelButtonText,!1),e.abrupt("return",t.show.call(this));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){return h.Helper.isNull(this._result)&&(this._result=!1),o(u(f.prototype),"close",this).call(this)}}])&&i(t.prototype,n),r&&i(t,r),f}(f.Dialog);t.ConfirmDialog=d},function(e,t,n){var r=n(33),i=n(17),o="__core-js_shared__",a=i[o]||(i[o]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(97)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(62),i=n(29),o=n(99);e.exports=function(e){return function(t,n,a){var s,c=r(t),u=i(c.length),l=o(a,u);if(e&&n!=n){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(87);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(25)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(19);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(135),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";n(234);var r=n(54),i=n(61),o=n(18),a=n(88),s=n(25),c=n(189),u=s("species"),l=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),f=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var h=s(e),d=!o((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),p=d?!o((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[u]=function(){return n}),n[h](""),!t})):void 0;if(!d||!p||"replace"===e&&!l||"split"===e&&!f){var m=/./[h],y=n(a,h,""[e],(function(e,t,n,r,i){return t.exec===c?d&&!i?{done:!0,value:m.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),g=y[0],b=y[1];r(String.prototype,e,g),i(RegExp.prototype,h,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},function(e,t,n){var r=n(75),i=n(229),o=n(184),a=n(19),s=n(29),c=n(186),u={},l={};(t=e.exports=function(e,t,n,f,h){var d,p,m,y,g=h?function(){return e}:c(e),b=r(n,f,t?2:1),v=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(o(g)){for(d=s(e.length);d>v;v++)if((y=t?b(a(p=e[v])[0],p[1]):b(e[v]))===u||y===l)return y}else for(m=g.call(e);!(p=m.next()).done;)if((y=i(m,b,p.value,t))===u||y===l)return y}).BREAK=u,t.RETURN=l},function(e,t,n){var r=n(17).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){"use strict";var r=n(17),i=n(6),o=n(54),a=n(117),s=n(92),c=n(148),u=n(116),l=n(20),f=n(18),h=n(144),d=n(112),p=n(175);e.exports=function(e,t,n,m,y,g){var b=r[e],v=b,w=y?"set":"add",_=v&&v.prototype,k={},E=function(e){var t=_[e];o(_,e,"delete"==e||"has"==e?function(e){return!(g&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!l(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof v&&(g||_.forEach&&!f((function(){(new v).entries().next()})))){var O=new v,T=O[w](g?{}:-0,1)!=O,x=f((function(){O.has(1)})),S=h((function(e){new v(e)})),C=!g&&f((function(){for(var e=new v,t=5;t--;)e[w](t,t);return!e.has(-0)}));S||((v=t((function(t,n){u(t,v,e);var r=p(new b,t,v);return null!=n&&c(n,y,r[w],r),r}))).prototype=_,_.constructor=v),(x||C)&&(E("delete"),E("has"),y&&E("get")),(C||T)&&E(w),g&&_.clear&&delete _.clear}else v=m.getConstructor(t,e,y,w),a(v.prototype,n),s.NEED=!0;return d(v,e),k[e]=v,i(i.G+i.W+i.F*(v!=b),k),g||m.setStrong(v,e,y),v}},function(e,t,n){for(var r,i=n(17),o=n(61),a=n(96),s=a("typed_array"),c=a("view"),u=!(!i.ArrayBuffer||!i.DataView),l=u,f=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(r=i[h[f++]])?(o(r.prototype,s,!0),o(r.prototype,c,!0)):l=!1;e.exports={ABV:u,CONSTR:l,TYPED:s,VIEW:c}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractSite=void 0;var f=n(120),h=n(22),d=n(31),p=n(43),m=n(200),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(y,e);var t,n,r,c=s(y);function y(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(n=c.call(this,t))._isDestroying=!1,n._isDestroying=!1,n._finishPromiseResolver={resolve:null,reject:null},n._finishPromise=new Promise((function(e,t){n._finishPromiseResolver={resolve:e,reject:t}})),n._onConstructPromise=null,n._parameters={},n._result=null,n._siteManager=e,n._title={element:null,text:null},n._loadingSymbol=null,n._historyId=null,n}return t=y,(n=[{key:"getTitle",value:function(){return this._title}},{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return o(u(y.prototype),"onConstruct",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.onConstruct.call(this,e),this.setParameters(h.Helper.nonNull(e,{})),m.EventManager.trigger(y.EVENT.ON_CONSTRUCT,{site:this,params:e}),t.abrupt("return",r);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return o(u(y.prototype),"onStart",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.onStart.call(this,e);case 2:this._updateTitle(),this.updateUrl(this._parameters),m.EventManager.trigger(y.EVENT.ON_START,{site:this,params:e});case 5:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(u(y.prototype),"onViewLoaded",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),m.EventManager.trigger(y.EVENT.ON_VIEW_LOADED,{site:this}),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"onPause",value:function(){var e=this,t=Object.create(null,{onPause:{get:function(){return o(u(y.prototype),"onPause",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onPause.call(this),m.EventManager.trigger(y.EVENT.ON_PAUSE,{site:this}),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"onDestroy",value:function(){var e=this,t=Object.create(null,{onDestroy:{get:function(){return o(u(y.prototype),"onDestroy",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onDestroy.call(this),m.EventManager.trigger(y.EVENT.ON_DESTROY,{site:this}),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"setTitle",value:function(e,t){if("string"==typeof e){var n=t;t=e,e=d.Translator.makePersistentTranslation(t,n)}t=h.Helper.nonNull(t,e.textContent),this._title={element:e,text:t},this._updateTitle()}},{key:"setParameter",value:function(e,t){this._parameters[e]=t,this.updateUrl(this._parameters)}},{key:"setParameters",value:function(e){this._parameters=e,this.updateUrl(this._parameters)}},{key:"getParameters",value:function(){return this._parameters}},{key:"showLoadingSymbol",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h.Helper.isNull(this._loadingSymbol)){e.next=6;break}return this._loadingSymbol=p.ViewInflater.createLoadingSymbol("overlay"),e.next=4,this.getViewPromise();case 4:t=e.sent,h.Helper.isNotNull(this._loadingSymbol)&&t.appendChild(this._loadingSymbol);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"removeLoadingSymbol",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.Helper.isNotNull(this._loadingSymbol)&&(this._loadingSymbol.remove(),this._loadingSymbol=null);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"onBeforeUnload",value:function(e){return null}},{key:"_updateTitle",value:function(){this._state===f.Context.STATE_RUNNING&&this._siteManager.updateTitle(this._title.text)}},{key:"updateUrl",value:function(e){this._state===f.Context.STATE_RUNNING&&this._siteManager.updateUrl(this,e)}},{key:"startSite",value:function(e,t){return this._siteManager.startSite(e,t)}},{key:"finishAndStartSite",value:function(e,t,n){var r=this.startSite(e,t);return this.finish(n),r}},{key:"finish",value:function(e){if(!this._isDestroying&&this._state!==f.Context.STATE_DESTROYED)return this._isDestroying=!0,h.Helper.isNotNull(e)&&this.setResult(e),this._siteManager.endSite(this)}},{key:"goBack",value:function(){this._state===f.Context.STATE_RUNNING&&this._siteManager.goBack()}},{key:"onBackPressed",value:function(){}},{key:"onMenuPressed",value:function(){}},{key:"onSearchPressed",value:function(){}},{key:"getFinishPromise",value:function(){return this._finishPromise}},{key:"setResult",value:function(e){this._result=e}},{key:"getFinishResolver",value:function(){return this._finishPromiseResolver}},{key:"addEventListener",value:function(e,t){var n=this;return m.EventManager.getInstance().addListener(e,(function(e){e.site&&e.site instanceof n.constructor&&t(e)}))}},{key:"isDestroying",value:function(){return this._isDestroying}}])&&i(t.prototype,n),r&&i(t,r),y}(f.Context);t.AbstractSite=y,y.EVENT={ON_CONSTRUCT:"abstract-site-on-construct",ON_VIEW_LOADED:"abstract-site-on-view-loaded",ON_START:"abstract-site-on-start",ON_PAUSE:"abstract-site-on-pause",ON_DESTROY:"abstract-site-on-destroy"}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MenuSite=void 0;var h=n(201),d=n(526),p=n(261),m=n(120),y=n(22),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(h,e);var t,n,r,c=s(h);function h(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(r=c.call(this,e,t,y.Helper.nonNull(n,d),"#site-content"))._navbarFragment=new p.NavbarFragment(u(r)),r.addFragment("#navbar-fragment",r._navbarFragment),r}return t=h,(n=[{key:"getNavbarFragment",value:function(){return this._navbarFragment}},{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return o(l(h.prototype),"onConstruct",t)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.onConstruct.call(this,e);case 2:return r=t.sent,this.onCreateMenu(this._navbarFragment),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"onMenuPressed",value:function(){this._navbarFragment.openMenu()}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(l(h.prototype),"onViewLoaded",e)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this._navbarFragment.setScrollWidget(this.findBy("#main-content-container")),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"_updateTitle",value:function(){o(l(h.prototype),"_updateTitle",this).call(this),this._title.element&&this._state===m.Context.STATE_RUNNING&&this._navbarFragment.setTitleElement(this._title.element)}},{key:"onCreateMenu",value:function(e){}}])&&i(t.prototype,n),r&&i(t,r),h}(h.TemplateSite);t.MenuSite=g},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LoginSite=void 0;var h=n(56),d=n(2),p=n(553),m=n(209),y=n(34),g=n(155),b=n(279),v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(m,e);var t,n,r,c=s(m);function m(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(n=c.call(this,e,d.Helper.nonNull(t,p))).forgotPasswordSiteClass=b.ForgotPasswordSite,n.addDelegate(new h.UserSite(u(n),m.ACCESS)),n}return t=m,(n=[{key:"onViewLoaded",value:function(){var e,t,n,r=this,i=Object.create(null,{onViewLoaded:{get:function(){return o(l(m.prototype),"onViewLoaded",r)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,a,s,c=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=i.onViewLoaded.call(this),a=new d.Form(this.findBy("#login-form"),(function(e){return f(c,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.UserManager.getInstance().login(e.email,e.password,d.Helper.isNotNull(e.saveLogin));case 2:if(!t.sent){t.next=8;break}return new d.Toast("welcome back").show(),t.next=6,this.finish();case 6:t.next=8;break;case 8:case"end":return t.stop()}}),t,this)})))})),s=function(){return a.clearErrors()},null===(e=this.findBy("#login-form [name=email]"))||void 0===e||e.addEventListener("keydown",s),null===(t=this.findBy("#login-form [name=password]"))||void 0===t||t.addEventListener("keydown",s),null===(n=this.findBy("#forgot-pw"))||void 0===n||n.addEventListener("click",(function(){return f(c,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.startSite(this.forgotPasswordSiteClass));case 1:case"end":return e.stop()}}),e,this)})))})),r.abrupt("return",o);case 7:case"end":return r.stop()}}),r,this)})))}}])&&i(t.prototype,n),r&&i(t,r),m}(d.MenuSite);t.LoginSite=v,v.ACCESS="loggedOut",v.LOGOUT_ACCESS="loggedIn",v.ADD_LOGIN_ACTION=!0,v.ADD_LOGOUT_ACTION=!0,v.ADD_DEEP_LINK=!0,d.App.addInitialization((function(e){v.ADD_LOGIN_ACTION&&d.NavbarFragment.defaultActions.push(new m.StartUserSiteMenuAction("login",v.ACCESS,v)),v.ADD_LOGOUT_ACTION&&d.NavbarFragment.defaultActions.push(new g.UserMenuAction("logout",v.LOGOUT_ACCESS,(function(){return f(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.UserManager.getInstance().logout();case 2:case"end":return e.stop()}}),e)})))}))),v.ADD_DEEP_LINK&&e.addDeepLink("login",v)}))},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.UserMenuAction=void 0;var l=n(2),f=n(34),h=n(5),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(l,e);var t,n,r,c=s(l);function l(e,t,n,r,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(a=c.call(this,e,n,r,i,o))._access=t,a._loginChangedCallbackId=f.UserManager.getInstance().addLoginChangeCallback((function(){a.redraw()})),a}return t=l,(n=[{key:"isVisible",value:function(){return o(u(l.prototype),"isVisible",this).call(this)&&f.UserManager.getInstance().hasAccess(this._access)}},{key:"isActivated",value:function(){return o(u(l.prototype),"isActivated",this).call(this)&&f.UserManager.getInstance().hasAccess(this._access)}},{key:"copy",value:function(e){var t=h.Helper.nonNull(e,new l);return t._access=this._access,o(u(l.prototype),"copy",this).call(this,t)}}])&&i(t.prototype,n),r&&i(t,r),l}(l.MenuAction);t.UserMenuAction=d},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(n,r){var i=e.call(this)||this;i.name="CannotCreateEntityIdMapError",Object.setPrototypeOf(i,t.prototype);var o=n.primaryColumns.reduce((function(e,t,n){return t.setEntityValue(e,n+1),e}),{});return i.message='Cannot use given entity id "'+r+'" because "'+n.targetName+'" contains multiple primary columns, you must provide object in following form: '+JSON.stringify(o)+" as an id.",i}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(n){var r=e.call(this)||this;return r.name="MissingDeleteDateColumnError",Object.setPrototypeOf(r,t.prototype),r.message='Entity "'+n.name+'" does not have delete date columns.',r}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(n){var r=e.call(this)||this;return r.name="NoVersionOrUpdateDateColumnError",Object.setPrototypeOf(r,t.prototype),r.message="Entity "+n+" does not have version or update date columns.",r}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="InsertValuesMissingError",Object.setPrototypeOf(n,t.prototype),n.message='Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.',n}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="PessimisticLockTransactionRequiredError",Object.setPrototypeOf(n,t.prototype),n.message="An open transaction is required for pessimistic lock.",n}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),i=function(e){function t(){var n=e.call(this)||this;return n.name="OffsetWithoutLimitNotSupportedError",Object.setPrototypeOf(n,t.prototype),n.message="RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).",n}return Object(r.c)(t,e),t}(Error)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){this.whereFactory=e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(14);function i(e){return new r.a("in",e,!0,!0)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MatomoHelper=void 0;const r=n(5);t.MatomoHelper=class{static start(e,t,n){n=r.Helper.nonNull(n,"matomo");let i=window._paq=window._paq||[];i.push(["trackPageView"]),i.push(["enableLinkTracking"]),function(){var r=e+"/";i.push(["setTrackerUrl",r+n+".php"]),i.push(["setSiteId",t]);var o=document,a=o.createElement("script"),s=o.getElementsByTagName("script")[0];a.type="text/javascript",a.async=!0,a.src=r+n+".js",s.parentNode.insertBefore(a,s)}()}static log(e,t,n,r){return this.apiCall("trackEvent",...arguments)}static apiCall(e,...t){(window._paq=window._paq||[]).push([e,...t])}static execute(e){(window._paq=window._paq||[]).push([e])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(59),o=n(30),a=function(){function e(e,t,n){this.connection=e,this.queryExpressionMap=t,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,o.a.assign(this,n||{})}return Object.defineProperty(e.prototype,"isMany",{get:function(){return void 0!==this.isMappingMany?this.isMappingMany:!!this.relation&&(this.relation.isManyToMany||this.relation.isOneToMany)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSelected",{get:function(){var e=this;if(!this.isSelectedEvaluated){this.isSelectedCache=function(){var t,n,i=function(t){return t.selection===e.alias.name||e.metadata&&e.metadata.columns.find((function(n){return t.selection===e.alias.name+"."+n.propertyPath}))?{value:!0}:void 0};try{for(var o=Object(r.g)(e.queryExpressionMap.selects),a=o.next();!a.done;a=o.next()){var s=i(a.value);if("object"==typeof s)return s.value}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!1}(),this.isSelectedEvaluated=!0}return this.isSelectedCache},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tablePath",{get:function(){return this.metadata?this.metadata.tablePath:this.entityOrProperty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentAlias",{get:function(){if(i.a.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relationPropertyPath",{get:function(){if(i.a.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relation",{get:function(){var e=this;if(!this.relationEvaluated){this.relationCache=function(){if(i.a.isAliasProperty(e.entityOrProperty)){var t=e.queryExpressionMap.findAliasByName(e.parentAlias),n=t.metadata.findRelationWithPropertyPath(e.relationPropertyPath);if(n)return n;if(t.metadata.parentEntityMetadata&&(n=t.metadata.parentEntityMetadata.findRelationWithPropertyPath(e.relationPropertyPath)))return n;throw new Error("Relation with property path "+e.relationPropertyPath+" in entity was not found.")}}.bind(this)(),this.relationEvaluated=!0}return this.relationCache},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.relation?this.relation.inverseEntityMetadata:this.connection.hasMetadata(this.entityOrProperty)?this.connection.getMetadata(this.entityOrProperty):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"junctionAlias",{get:function(){if(!this.relation)throw new Error("Cannot get junction table for join without relation.");return this.relation.isOwning?this.parentAlias+"_"+this.alias.name:this.alias.name+"_"+this.parentAlias},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapToPropertyParentAlias",{get:function(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapToPropertyPropertyName",{get:function(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(3),o=function(){this.upQueries=[],this.downQueries=[]},a=function(){function e(){this.isReleased=!1,this.isTransactionActive=!1,this.data={},this.loadedTables=[],this.loadedViews=[],this.sqlMemoryMode=!1,this.sqlInMemory=new o}return e.prototype.getTable=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return t=this,[4,this.loadTables([e])];case 1:return t.loadedTables=n.sent(),[2,this.loadedTables.length>0?this.loadedTables[0]:void 0]}}))}))},e.prototype.getTables=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return t=this,[4,this.loadTables(e)];case 1:return t.loadedTables=n.sent(),[2,this.loadedTables]}}))}))},e.prototype.getView=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return t=this,[4,this.loadViews([e])];case 1:return t.loadedViews=n.sent(),[2,this.loadedViews.length>0?this.loadedViews[0]:void 0]}}))}))},e.prototype.getViews=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return t=this,[4,this.loadViews(e)];case 1:return t.loadedViews=n.sent(),[2,this.loadedViews]}}))}))},e.prototype.enableSqlMemory=function(){this.sqlInMemory=new o,this.sqlMemoryMode=!0},e.prototype.disableSqlMemory=function(){this.sqlInMemory=new o,this.sqlMemoryMode=!1},e.prototype.clearSqlMemory=function(){this.sqlInMemory=new o},e.prototype.getMemorySql=function(){return this.sqlInMemory},e.prototype.executeMemoryUpSql=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),e=Object(r.g)(this.sqlInMemory.upQueries),t=e.next(),u.label=1;case 1:return t.done?[3,4]:(n=t.value,i=n.query,o=n.parameters,[4,this.query(i,o)]);case 2:u.sent(),u.label=3;case 3:return t=e.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),s={error:a},[3,7];case 6:try{t&&!t.done&&(c=e.return)&&c.call(e)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},e.prototype.executeMemoryDownSql=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,c;return Object(r.d)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),e=Object(r.g)(this.sqlInMemory.downQueries.reverse()),t=e.next(),u.label=1;case 1:return t.done?[3,4]:(n=t.value,i=n.query,o=n.parameters,[4,this.query(i,o)]);case 2:u.sent(),u.label=3;case 3:return t=e.next(),[3,1];case 4:return[3,7];case 5:return a=u.sent(),s={error:a},[3,7];case 6:try{t&&!t.done&&(c=e.return)&&c.call(e)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},e.prototype.getCachedView=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(t=this.loadedViews.find((function(t){return t.name===e})))?[2,t]:[4,this.loadViews([e])];case 1:if((n=r.sent()).length>0)return this.loadedViews.push(n[0]),[2,n[0]];throw new Error('View "'+e+'" does not exist.')}}))}))},e.prototype.getCachedTable=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(t=this.loadedTables.find((function(t){return t.name===e})))?[2,t]:[4,this.loadTables([e])];case 1:if((n=r.sent()).length>0)return this.loadedTables.push(n[0]),[2,n[0]];throw new Error('Table "'+e+'" does not exist.')}}))}))},e.prototype.replaceCachedTable=function(e,t){var n=this.loadedTables.find((function(t){return t.name===e.name}));n&&(n.name=t.name,n.columns=t.columns,n.indices=t.indices,n.foreignKeys=t.foreignKeys,n.uniques=t.uniques,n.checks=t.checks,n.justCreated=t.justCreated,n.engine=t.engine)},e.prototype.getTypeormMetadataTableName=function(){var e=this.connection.driver.options;return this.connection.driver.buildTableName("typeorm_metadata",e.schema,e.database)},e.prototype.isColumnChanged=function(e,t,n,r){return e.charset!==t.charset||e.collation!==t.collation||e.precision!==t.precision||e.scale!==t.scale||e.width!==t.width||e.zerofill!==t.zerofill||e.unsigned!==t.unsigned||e.asExpression!==t.asExpression||n&&e.default!==t.default||e.onUpdate!==t.onUpdate||e.isNullable!==t.isNullable||r&&e.comment!==t.comment||e.enum!==t.enum},e.prototype.isDefaultColumnLength=function(e,t,n){if(this.connection.hasMetadata(e.name)){var r=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(r&&r.length)return!1}return!!(this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].length)&&this.connection.driver.dataTypeDefaults[t.type].length.toString()===n.toString()},e.prototype.isDefaultColumnPrecision=function(e,t,n){if(this.connection.hasMetadata(e.name)){var r=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(r&&null!==r.precision&&void 0!==r.precision)return!1}return!(!this.connection.driver.dataTypeDefaults||!this.connection.driver.dataTypeDefaults[t.type]||null===this.connection.driver.dataTypeDefaults[t.type].precision||void 0===this.connection.driver.dataTypeDefaults[t.type].precision)&&this.connection.driver.dataTypeDefaults[t.type].precision===n},e.prototype.isDefaultColumnScale=function(e,t,n){if(this.connection.hasMetadata(e.name)){var r=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(r&&null!==r.scale&&void 0!==r.scale)return!1}return!(!this.connection.driver.dataTypeDefaults||!this.connection.driver.dataTypeDefaults[t.type]||null===this.connection.driver.dataTypeDefaults[t.type].scale||void 0===this.connection.driver.dataTypeDefaults[t.type].scale)&&this.connection.driver.dataTypeDefaults[t.type].scale===n},e.prototype.executeQueries=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,o,a,s,c,u,l,f,h,d;return Object(r.d)(this,(function(p){switch(p.label){case 0:if(e instanceof i.a&&(e=[e]),t instanceof i.a&&(t=[t]),(l=this.sqlInMemory.upQueries).push.apply(l,Object(r.f)([],Object(r.e)(e))),(f=this.sqlInMemory.downQueries).push.apply(f,Object(r.f)([],Object(r.e)(t))),!0===this.sqlMemoryMode)return[2,Promise.resolve()];p.label=1;case 1:p.trys.push([1,6,7,8]),n=Object(r.g)(e),o=n.next(),p.label=2;case 2:return o.done?[3,5]:(a=o.value,s=a.query,c=a.parameters,[4,this.query(s,c)]);case 3:p.sent(),p.label=4;case 4:return o=n.next(),[3,2];case 5:return[3,8];case 6:return u=p.sent(),h={error:u},[3,8];case 7:try{o&&!o.done&&(d=n.return)&&d.call(n)}finally{if(h)throw h.error}return[7];case 8:return[2]}}))}))},e}()},function(e,t,n){var r=n(20),i=n(17).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){t.f=n(25)},function(e,t,n){var r=n(140)("keys"),i=n(96);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(17).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(20),i=n(19),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(75)(Function.call,n(78).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(20),i=n(173).set;e.exports=function(e,t,n){var o,a=t.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){"use strict";var r=n(77),i=n(88);e.exports=function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n},function(e,t,n){var r=n(77),i=n(88);e.exports=function(e){return function(t,n){var o,a,s=String(i(t)),c=r(n),u=s.length;return c<0||c>=u?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(97),i=n(6),o=n(54),a=n(61),s=n(114),c=n(228),u=n(112),l=n(102),f=n(25)("iterator"),h=!([].keys&&"next"in[].keys()),d="keys",p="values",m=function(){return this};e.exports=function(e,t,n,y,g,b,v){c(n,t,y);var w,_,k,E=function(e){if(!h&&e in S)return S[e];switch(e){case d:case p:return function(){return new n(this,e)}}return function(){return new n(this,e)}},O=t+" Iterator",T=g==p,x=!1,S=e.prototype,C=S[f]||S["@@iterator"]||g&&S[g],R=C||E(g),P=g?T?E("entries"):R:void 0,N="Array"==t&&S.entries||C;if(N&&(k=l(N.call(new e)))!==Object.prototype&&k.next&&(u(k,O,!0),r||"function"==typeof k[f]||a(k,f,m)),T&&C&&C.name!==p&&(x=!0,R=function(){return C.call(this)}),r&&!v||!h&&!x&&S[f]||a(S,f,R),s[t]=R,s[O]=m,g)if(w={values:T?R:E(p),keys:b?R:E(d),entries:P},v)for(_ in w)_ in S||o(S,_,w[_]);else i(i.P+i.F*(h||x),t,w);return w}},function(e,t,n){var r=n(182),i=n(88);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){var r=n(20),i=n(87),o=n(25)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(25)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){var r=n(114),i=n(25)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){"use strict";var r=n(37),i=n(95);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(135),i=n(25)("iterator"),o=n(114);e.exports=n(33).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){"use strict";var r=n(46),i=n(99),o=n(29);e.exports=function(e){for(var t=r(this),n=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),c=a>2?arguments[2]:void 0,u=void 0===c?n:i(c,n);u>s;)t[s++]=e;return t}},function(e,t,n){"use strict";var r=n(103),i=n(233),o=n(114),a=n(62);e.exports=n(180)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r,i,o=n(145),a=RegExp.prototype.exec,s=String.prototype.replace,c=a,u=(r=/a/,i=/b*/g,a.call(r,"a"),a.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),l=void 0!==/()??/.exec("")[1];(u||l)&&(c=function(e){var t,n,r,i,c=this;return l&&(n=new RegExp("^"+c.source+"$(?!\\s)",o.call(c))),u&&(t=c.lastIndex),r=a.call(c,e),u&&r&&(c.lastIndex=c.global?r.index+r[0].length:t),l&&r&&r.length>1&&s.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),e.exports=c},function(e,t,n){"use strict";var r=n(179)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r,i,o,a=n(75),s=n(222),c=n(172),u=n(168),l=n(17),f=l.process,h=l.setImmediate,d=l.clearImmediate,p=l.MessageChannel,m=l.Dispatch,y=0,g={},b="onreadystatechange",v=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},w=function(e){v.call(e.data)};h&&d||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++y]=function(){s("function"==typeof e?e:Function(e),t)},r(y),y},d=function(e){delete g[e]},"process"==n(87)(f)?r=function(e){f.nextTick(a(v,e,1))}:m&&m.now?r=function(e){m.now(a(v,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=w,r=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",w,!1)):r=b in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),v.call(e)}}:function(e){setTimeout(a(v,e,1),0)}),e.exports={set:h,clear:d}},function(e,t,n){"use strict";var r=n(17),i=n(36),o=n(97),a=n(151),s=n(61),c=n(117),u=n(18),l=n(116),f=n(77),h=n(29),d=n(241),p=n(101).f,m=n(37).f,y=n(187),g=n(112),b="ArrayBuffer",v="DataView",w="Wrong index!",_=r.ArrayBuffer,k=r.DataView,E=r.Math,O=r.RangeError,T=r.Infinity,x=_,S=E.abs,C=E.pow,R=E.floor,P=E.log,N=E.LN2,M="buffer",A="byteLength",j="byteOffset",I=i?"_b":M,D=i?"_l":A,L=i?"_o":j;function B(e,t,n){var r,i,o,a=new Array(n),s=8*n-t-1,c=(1<<s)-1,u=c>>1,l=23===t?C(2,-24)-C(2,-77):0,f=0,h=e<0||0===e&&1/e<0?1:0;for((e=S(e))!=e||e===T?(i=e!=e?1:0,r=c):(r=R(P(e)/N),e*(o=C(2,-r))<1&&(r--,o*=2),(e+=r+u>=1?l/o:l*C(2,1-u))*o>=2&&(r++,o/=2),r+u>=c?(i=0,r=c):r+u>=1?(i=(e*o-1)*C(2,t),r+=u):(i=e*C(2,u-1)*C(2,t),r=0));t>=8;a[f++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;a[f++]=255&r,r/=256,s-=8);return a[--f]|=128*h,a}function F(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,c=n-1,u=e[c--],l=127&u;for(u>>=7;s>0;l=256*l+e[c],c--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=t;s>0;r=256*r+e[c],c--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:u?-T:T;r+=C(2,t),l-=a}return(u?-1:1)*r*C(2,l-t)}function q(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function V(e){return[255&e]}function U(e){return[255&e,e>>8&255]}function H(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function z(e){return B(e,52,8)}function W(e){return B(e,23,4)}function Y(e,t,n){m(e.prototype,t,{get:function(){return this[n]}})}function Q(e,t,n,r){var i=d(+n);if(i+t>e[D])throw O(w);var o=e[I]._b,a=i+e[L],s=o.slice(a,a+t);return r?s:s.reverse()}function G(e,t,n,r,i,o){var a=d(+n);if(a+t>e[D])throw O(w);for(var s=e[I]._b,c=a+e[L],u=r(+i),l=0;l<t;l++)s[c+l]=u[o?l:t-l-1]}if(a.ABV){if(!u((function(){_(1)}))||!u((function(){new _(-1)}))||u((function(){return new _,new _(1.5),new _(NaN),_.name!=b}))){for(var J,K=(_=function(e){return l(this,_),new x(d(e))}).prototype=x.prototype,$=p(x),X=0;$.length>X;)(J=$[X++])in _||s(_,J,x[J]);o||(K.constructor=_)}var Z=new k(new _(2)),ee=k.prototype.setInt8;Z.setInt8(0,2147483648),Z.setInt8(1,2147483649),!Z.getInt8(0)&&Z.getInt8(1)||c(k.prototype,{setInt8:function(e,t){ee.call(this,e,t<<24>>24)},setUint8:function(e,t){ee.call(this,e,t<<24>>24)}},!0)}else _=function(e){l(this,_,b);var t=d(e);this._b=y.call(new Array(t),0),this[D]=t},k=function(e,t,n){l(this,k,v),l(e,_,v);var r=e[D],i=f(t);if(i<0||i>r)throw O("Wrong offset!");if(i+(n=void 0===n?r-i:h(n))>r)throw O("Wrong length!");this[I]=e,this[L]=i,this[D]=n},i&&(Y(_,A,"_l"),Y(k,M,"_b"),Y(k,A,"_l"),Y(k,j,"_o")),c(k.prototype,{getInt8:function(e){return Q(this,1,e)[0]<<24>>24},getUint8:function(e){return Q(this,1,e)[0]},getInt16:function(e){var t=Q(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Q(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return q(Q(this,4,e,arguments[1]))},getUint32:function(e){return q(Q(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return F(Q(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return F(Q(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){G(this,1,e,V,t)},setUint8:function(e,t){G(this,1,e,V,t)},setInt16:function(e,t){G(this,2,e,U,t,arguments[2])},setUint16:function(e,t){G(this,2,e,U,t,arguments[2])},setInt32:function(e,t){G(this,4,e,H,t,arguments[2])},setUint32:function(e,t){G(this,4,e,H,t,arguments[2])},setFloat32:function(e,t){G(this,4,e,W,t,arguments[2])},setFloat64:function(e,t){G(this,8,e,z,t,arguments[2])}});g(_,b),g(k,v),s(k.prototype,a.VIEW,!0),t.ArrayBuffer=_,t.DataView=k},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(246)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t),n.d(t,"InsertQueryBuilder",(function(){return m}));var r=n(0),i=n(1),o=n(49),a=n(73),s=n(138),c=n(84),u=n(159),l=n(130),f=n(21),h=n(50),d=n(12),p=n(86),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.c)(t,e),t.prototype.getQuery=function(){var e=this.createComment();return(e+=this.createInsertExpression()).trim()},t.prototype.execute=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,o,a,c,u,f,p,m,y,g,b,v,w,_=this;return Object(r.d)(this,(function(k){switch(k.label){case 0:if(0===(e=this.getValueSets()).length)return[2,new s.a];t=this.obtainQueryRunner(),n=!1,k.label=1;case 1:return k.trys.push([1,13,18,23]),!0!==this.expressionMap.useTransaction||!1!==t.isTransactionActive?[3,3]:[4,t.startTransaction()];case 2:k.sent(),n=!0,k.label=3;case 3:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(o=new d.a,e.forEach((function(e){t.broadcaster.broadcastBeforeInsertEvent(o,_.expressionMap.mainAlias.metadata,e)})),o.promises.length>0?[4,Promise.all(o.promises)]:[3,5]):[3,5];case 4:k.sent(),k.label=5;case 5:return a=null,c=null,u=new l.a(t,this.expressionMap),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&(e.length>1&&this.connection.driver instanceof i.j||(this.expressionMap.extraReturningColumns=u.getInsertionReturningColumns()),this.expressionMap.extraReturningColumns.length>0&&this.connection.driver instanceof i.m&&(a=this.connection.driver.buildTableVariableDeclaration("@OutputTable",this.expressionMap.extraReturningColumns),c="SELECT * FROM @OutputTable")),f=Object(r.e)(this.getQueryAndParameters(),2),p=f[0],m=f[1],y=new s.a,g=[a,p,c],b=y,[4,t.query(g.filter((function(e){return null!=e})).join(";\n\n"),m)];case 6:return b.raw=k.sent(),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata?[4,u.insert(y,e)]:[3,8];case 7:k.sent(),k.label=8;case 8:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(v=new d.a,e.forEach((function(e){t.broadcaster.broadcastAfterInsertEvent(v,_.expressionMap.mainAlias.metadata,e)})),v.promises.length>0?[4,Promise.all(v.promises)]:[3,10]):[3,10];case 9:k.sent(),k.label=10;case 10:return n?[4,t.commitTransaction()]:[3,12];case 11:k.sent(),k.label=12;case 12:return[2,y];case 13:if(w=k.sent(),!n)return[3,17];k.label=14;case 14:return k.trys.push([14,16,,17]),[4,t.rollbackTransaction()];case 15:return k.sent(),[3,17];case 16:return k.sent(),[3,17];case 17:throw w;case 18:return t===this.queryRunner?[3,20]:[4,t.release()];case 19:k.sent(),k.label=20;case 20:return this.connection.driver instanceof h.a&&!t.isTransactionActive?[4,this.connection.driver.autoSave()]:[3,22];case 21:k.sent(),k.label=22;case 22:return[7];case 23:return[2]}}))}))},t.prototype.into=function(e,t){e=e instanceof p.a?e.options.name:e;var n=this.createFromAlias(e);return this.expressionMap.setMainAlias(n),this.expressionMap.insertColumns=t||[],this},t.prototype.values=function(e){return this.expressionMap.valuesSet=e,this},t.prototype.output=function(e){return this.returning(e)},t.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new c.a;return this.expressionMap.returning=e,this},t.prototype.updateEntity=function(e){return this.expressionMap.updateEntity=e,this},t.prototype.onConflict=function(e){return this.expressionMap.onConflict=e,this},t.prototype.orIgnore=function(e){return void 0===e&&(e=!0),this.expressionMap.onIgnore=e,this},t.prototype.orUpdate=function(e){var t=this;return this.expressionMap.onUpdate={},e&&Array.isArray(e.conflict_target)&&(this.expressionMap.onUpdate.conflict=" ( "+e.conflict_target.map((function(e){return t.escape(e)})).join(", ")+" ) "),e&&"string"==typeof e.conflict_target&&(this.expressionMap.onUpdate.conflict=" ON CONSTRAINT "+this.escape(e.conflict_target)+" "),e&&Array.isArray(e.columns)&&(this.expressionMap.onUpdate.columns=e.columns.map((function(e){return t.escape(e)+" = :"+e})).join(", ")),e&&Array.isArray(e.overwrite)&&(this.connection.driver instanceof i.i||this.connection.driver instanceof i.a?this.expressionMap.onUpdate.overwrite=e.overwrite.map((function(e){return e+" = VALUES("+e+")"})).join(", "):(this.connection.driver instanceof i.k||this.connection.driver instanceof f.a||this.connection.driver instanceof i.d)&&(this.expressionMap.onUpdate.overwrite=e.overwrite.map((function(e){return t.escape(e)+" = EXCLUDED."+t.escape(e)})).join(", "))),this},t.prototype.createInsertExpression=function(){var e=this,t=this.getTableName(this.getMainTableName()),n=this.createValuesExpression(),r=this.connection.driver instanceof i.j&&this.getValueSets().length>1?null:this.createReturningExpression(),o=this.createColumnNamesExpression(),a="INSERT ";if((this.connection.driver instanceof i.i||this.connection.driver instanceof i.a)&&(a+=this.expressionMap.onIgnore?" IGNORE ":""),a+="INTO "+t,o?a+="("+o+")":!n&&(this.connection.driver instanceof i.i||this.connection.driver instanceof i.a)&&(a+="()"),r&&this.connection.driver instanceof i.m&&(a+=" OUTPUT "+r),n?this.connection.driver instanceof i.j&&this.getValueSets().length>1?a+=" "+n:a+=" VALUES "+n:this.connection.driver instanceof i.i||this.connection.driver instanceof i.a?a+=" VALUES ()":a+=" DEFAULT VALUES",this.connection.driver instanceof i.k||this.connection.driver instanceof f.a||this.connection.driver instanceof i.d){if(a+=this.expressionMap.onIgnore?" ON CONFLICT DO NOTHING ":"",a+=this.expressionMap.onConflict?" ON CONFLICT "+this.expressionMap.onConflict:"",this.expressionMap.onUpdate){var s=this.expressionMap.onUpdate,c=s.overwrite,u=s.columns,l=s.conflict;a+=u?" ON CONFLICT "+l+" DO UPDATE SET "+u:"",a+=c?" ON CONFLICT "+l+" DO UPDATE SET "+c:""}}else if((this.connection.driver instanceof i.i||this.connection.driver instanceof i.a)&&this.expressionMap.onUpdate){var h=this.expressionMap.onUpdate;c=h.overwrite;a+=(u=h.columns)?" ON DUPLICATE KEY UPDATE "+u:"",a+=c?" ON DUPLICATE KEY UPDATE "+c:""}return r&&(this.connection.driver instanceof i.k||this.connection.driver instanceof i.j||this.connection.driver instanceof i.d)&&(a+=" RETURNING "+r),this.connection.driver instanceof i.m&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter((function(t){return e.expressionMap.insertColumns.length>0?-1!==e.expressionMap.insertColumns.indexOf(t.propertyPath):t.isInsert})).some((function(t){return e.isOverridingAutoIncrementBehavior(t)}))&&(a="SET IDENTITY_INSERT "+t+" ON; "+a+"; SET IDENTITY_INSERT "+t+" OFF"),a},t.prototype.getInsertedColumns=function(){var e=this;return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter((function(t){return e.expressionMap.insertColumns.length?-1!==e.expressionMap.insertColumns.indexOf(t.propertyPath):!!t.isInsert&&!!(!t.isGenerated||"increment"!==t.generationStrategy||e.connection.driver instanceof i.j||e.connection.driver instanceof f.a||e.connection.driver instanceof i.i||e.connection.driver instanceof i.a||e.connection.driver instanceof i.m&&e.isOverridingAutoIncrementBehavior(t))})):[]},t.prototype.createColumnNamesExpression=function(){var e=this,t=this.getInsertedColumns();if(t.length>0)return t.map((function(t){return e.escape(t.databaseName)})).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){var n=this.getValueSets();if(1===n.length)return Object.keys(n[0]).map((function(t){return e.escape(t)})).join(", ")}return this.expressionMap.insertColumns.map((function(t){return e.escape(t)})).join(", ")},t.prototype.createValuesExpression=function(){var e=this,t=this.getValueSets(),n=this.getInsertedColumns();if(n.length>0){var r="",o=Object.keys(this.expressionMap.nativeParameters).length;return t.forEach((function(s,c){n.forEach((function(u,l){0===l&&(e.connection.driver instanceof i.j&&t.length>1?r+=" SELECT ":r+="(");var h="i"+c+"_"+u.databaseName,d=u.getEntityValue(s);if(d instanceof Function||(d=e.connection.driver.preparePersistentValue(d,u)),u.isVersion&&void 0===d)r+="1";else if(u.isDiscriminator)e.expressionMap.nativeParameters["discriminator_value_"+o]=e.expressionMap.mainAlias.metadata.discriminatorValue,r+=e.connection.driver.createParameter("discriminator_value_"+o,o),o++;else if(u.isGenerated&&"uuid"===u.generationStrategy&&!e.connection.driver.isUUIDGenerationSupported()&&void 0===d){var p="uuid_"+u.databaseName+c;d=a.a.uuid4(),e.expressionMap.nativeParameters[p]=d,r+=e.connection.driver.createParameter(p,o),o++}else if(void 0===d)e.connection.driver instanceof i.j&&t.length>1||e.connection.driver instanceof f.a||e.connection.driver instanceof i.l?void 0!==u.default&&null!==u.default?r+=e.connection.driver.normalizeDefault(u):r+="NULL":r+="DEFAULT";else if(d instanceof Function)r+=d();else{if(e.connection.driver instanceof i.m&&(d=e.connection.driver.parametrizeValue(u,d)),e.expressionMap.nativeParameters[h]=d,(e.connection.driver instanceof i.i||e.connection.driver instanceof i.a)&&-1!==e.connection.driver.spatialTypes.indexOf(u.type)){var m=e.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";null!=u.srid?r+=m+"("+e.connection.driver.createParameter(h,o)+", "+u.srid+")":r+=m+"("+e.connection.driver.createParameter(h,o)+")"}else e.connection.driver instanceof i.k&&-1!==e.connection.driver.spatialTypes.indexOf(u.type)?null!=u.srid?r+="ST_SetSRID(ST_GeomFromGeoJSON("+e.connection.driver.createParameter(h,o)+"), "+u.srid+")::"+u.type:r+="ST_GeomFromGeoJSON("+e.connection.driver.createParameter(h,o)+")::"+u.type:e.connection.driver instanceof i.m&&-1!==e.connection.driver.spatialTypes.indexOf(u.type)?r+=u.type+"::STGeomFromText("+e.connection.driver.createParameter(h,o)+", "+(u.srid||"0")+")":r+=e.connection.driver.createParameter(h,o);o++}l===n.length-1?c===t.length-1?e.connection.driver instanceof i.j&&t.length>1?r+=" FROM DUAL ":r+=")":e.connection.driver instanceof i.j&&t.length>1?r+=" FROM DUAL UNION ALL ":r+="), ":r+=", "}))})),"()"===r?"":r}var s="",c=Object.keys(this.expressionMap.nativeParameters).length;return t.forEach((function(n,r){Object.keys(n).forEach((function(o,a){0===a&&(s+="(");var u="i"+r+"_"+o,l=n[o];l instanceof Function?s+=l():void 0===l?e.connection.driver instanceof f.a||e.connection.driver instanceof i.l?s+="NULL":s+="DEFAULT":(e.expressionMap.nativeParameters[u]=l,s+=e.connection.driver.createParameter(u,c),c++),a===Object.keys(n).length-1?r===t.length-1?s+=")":s+="), ":s+=", "}))})),"()"===s?"":s},t.prototype.getValueSets=function(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(this.expressionMap.valuesSet instanceof Object)return[this.expressionMap.valuesSet];throw new u.a},t.prototype.isOverridingAutoIncrementBehavior=function(e){return e.isPrimary&&e.isGenerated&&"increment"===e.generationStrategy&&this.getValueSets().some((function(t){return void 0!==e.getEntityValue(t)&&null!==e.getEntityValue(t)}))},t}(o.a)},function(e,t,n){"use strict";n.r(t),n.d(t,"UpdateQueryBuilder",(function(){return y}));var r=n(0),i=n(1),o=n(49),a=n(44),s=n(125),c=n(84),u=n(130),l=n(50),f=n(12),h=n(21),d=n(123),p=n(108),m=n(124),y=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.expressionMap.aliasNamePrefixingEnabled=!1,r}return Object(r.c)(t,e),t.prototype.getQuery=function(){var e=this.createComment();return e+=this.createUpdateExpression(),e+=this.createOrderByExpression(),(e+=this.createLimitExpression()).trim()},t.prototype.execute=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,o,a,c,h,d,p,m,y,g,b;return Object(r.d)(this,(function(v){switch(v.label){case 0:e=this.obtainQueryRunner(),t=!1,v.label=1;case 1:return v.trys.push([1,13,18,23]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:v.sent(),t=!0,v.label=3;case 3:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(g=new f.a,e.broadcaster.broadcastBeforeUpdateEvent(g,this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),g.promises.length>0?[4,Promise.all(g.promises)]:[3,5]):[3,5];case 4:v.sent(),v.label=5;case 5:return n=null,o=null,a=new u.a(e,this.expressionMap),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=a.getUpdationReturningColumns(),this.expressionMap.extraReturningColumns.length>0&&this.connection.driver instanceof i.m&&(n=this.connection.driver.buildTableVariableDeclaration("@OutputTable",this.expressionMap.extraReturningColumns),o="SELECT * FROM @OutputTable")),c=Object(r.e)(this.getQueryAndParameters(),2),h=c[0],d=c[1],p=new s.a,m=[n,h,o],[4,e.query(m.filter((function(e){return null!=e})).join(";\n\n"),d)];case 6:return y=v.sent(),this.connection.driver instanceof i.k?(p.raw=y[0],p.affected=y[1]):this.connection.driver instanceof i.i?(p.raw=y,p.affected=y.affectedRows):this.connection.driver instanceof i.a?(p.raw=y,p.affected=y.numberOfRecordsUpdated):this.connection.driver instanceof i.c?(p.raw=y,p.affected=y.changes):p.raw=y,!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0?[4,a.update(p,this.expressionMap.whereEntities)]:[3,8];case 7:v.sent(),v.label=8;case 8:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(g=new f.a,e.broadcaster.broadcastAfterUpdateEvent(g,this.expressionMap.mainAlias.metadata),g.promises.length>0?[4,Promise.all(g.promises)]:[3,10]):[3,10];case 9:v.sent(),v.label=10;case 10:return t?[4,e.commitTransaction()]:[3,12];case 11:v.sent(),v.label=12;case 12:return[2,p];case 13:if(b=v.sent(),!t)return[3,17];v.label=14;case 14:return v.trys.push([14,16,,17]),[4,e.rollbackTransaction()];case 15:return v.sent(),[3,17];case 16:return v.sent(),[3,17];case 17:throw b;case 18:return e===this.queryRunner?[3,20]:[4,e.release()];case 19:v.sent(),v.label=20;case 20:return this.connection.driver instanceof l.a&&!e.isTransactionActive?[4,this.connection.driver.autoSave()]:[3,22];case 21:v.sent(),v.label=22;case 22:return[7];case 23:return[2]}}))}))},t.prototype.set=function(e){return this.expressionMap.valuesSet=e,this},t.prototype.where=function(e,t){this.expressionMap.wheres=[];var n=this.computeWhereParameter(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this},t.prototype.andWhere=function(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.computeWhereParameter(e)}),t&&this.setParameters(t),this},t.prototype.orWhere=function(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.computeWhereParameter(e)}),t&&this.setParameters(t),this},t.prototype.whereInIds=function(e){return this.where(this.createWhereIdsExpression(e))},t.prototype.andWhereInIds=function(e){return this.andWhere(this.createWhereIdsExpression(e))},t.prototype.orWhereInIds=function(e){return this.orWhere(this.createWhereIdsExpression(e))},t.prototype.output=function(e){return this.returning(e)},t.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new c.a;return this.expressionMap.returning=e,this},t.prototype.orderBy=function(e,t,n){var r,i;return void 0===t&&(t="ASC"),this.expressionMap.orderBys=e?e instanceof Object?e:n?((r={})[e]={order:t,nulls:n},r):((i={})[e]=t,i):{},this},t.prototype.addOrderBy=function(e,t,n){return void 0===t&&(t="ASC"),this.expressionMap.orderBys[e]=n?{order:t,nulls:n}:t,this},t.prototype.limit=function(e){return this.expressionMap.limit=e,this},t.prototype.whereEntity=function(e){var t=this;if(!this.expressionMap.mainAlias.hasMetadata)throw new Error(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];var n=Array.isArray(e)?e:[e];return n.forEach((function(e){var n=t.expressionMap.mainAlias.metadata.getEntityIdMap(e);if(!n)throw new Error("Provided entity does not have ids set, cannot perform operation.");t.orWhereInIds(n)})),this.expressionMap.whereEntities=n,this},t.prototype.updateEntity=function(e){return this.expressionMap.updateEntity=e,this},t.prototype.createUpdateExpression=function(){var e=this,t=this.getValueSet(),n=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,r=[],o=[],s={},c=this.connection.driver instanceof i.i||this.connection.driver instanceof i.a||this.connection.driver instanceof i.j||this.connection.driver instanceof h.a||this.connection.driver instanceof i.l?0:Object.keys(this.expressionMap.nativeParameters).length;if(n?(a.a.createPropertyPath(n,t).forEach((function(a){var u=n.findColumnsWithPropertyPath(a);if(u.length<=0)throw new m.a(a);u.forEach((function(n){if(n.isUpdate){o.push(n);var a="upd_"+n.databaseName,u=n.getEntityValue(t);if(n.referencedColumn&&u instanceof Object?u=n.referencedColumn.getEntityValue(u):u instanceof Function||(u=e.connection.driver.preparePersistentValue(u,n)),u instanceof Function)r.push(e.escape(n.databaseName)+" = "+u());else if(e.connection.driver instanceof i.l&&null===u)r.push(e.escape(n.databaseName)+" = NULL");else{e.connection.driver instanceof i.m&&(u=e.connection.driver.parametrizeValue(n,u)),e.connection.driver instanceof i.i||e.connection.driver instanceof i.a||e.connection.driver instanceof i.j||e.connection.driver instanceof h.a||e.connection.driver instanceof i.l?s[a]=u:e.expressionMap.nativeParameters[a]=u;var l=null;if((e.connection.driver instanceof i.i||e.connection.driver instanceof i.a)&&-1!==e.connection.driver.spatialTypes.indexOf(n.type)){var f=e.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";l=null!=n.srid?f+"("+e.connection.driver.createParameter(a,c)+", "+n.srid+")":f+"("+e.connection.driver.createParameter(a,c)+")"}else l=e.connection.driver instanceof i.k&&-1!==e.connection.driver.spatialTypes.indexOf(n.type)?null!=n.srid?"ST_SetSRID(ST_GeomFromGeoJSON("+e.connection.driver.createParameter(a,c)+"), "+n.srid+")::"+n.type:"ST_GeomFromGeoJSON("+e.connection.driver.createParameter(a,c)+")::"+n.type:e.connection.driver instanceof i.m&&-1!==e.connection.driver.spatialTypes.indexOf(n.type)?n.type+"::STGeomFromText("+e.connection.driver.createParameter(a,c)+", "+(n.srid||"0")+")":e.connection.driver.createParameter(a,c);r.push(e.escape(n.databaseName)+" = "+l),c++}}}))})),n.versionColumn&&-1===o.indexOf(n.versionColumn)&&r.push(this.escape(n.versionColumn.databaseName)+" = "+this.escape(n.versionColumn.databaseName)+" + 1"),n.updateDateColumn&&-1===o.indexOf(n.updateDateColumn)&&r.push(this.escape(n.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP")):Object.keys(t).map((function(n){var o=t[n];o instanceof Function?r.push(e.escape(n)+" = "+o()):e.connection.driver instanceof i.l&&null===o?r.push(e.escape(n)+" = NULL"):(e.connection.driver instanceof i.i||e.connection.driver instanceof i.a||e.connection.driver instanceof i.j||e.connection.driver instanceof h.a||e.connection.driver instanceof i.l?s[n]=o:e.expressionMap.nativeParameters[n]=o,r.push(e.escape(n)+" = "+e.connection.driver.createParameter(n,c)),c++)})),r.length<=0)throw new p.a;(this.connection.driver instanceof i.i||this.connection.driver instanceof i.a||this.connection.driver instanceof i.j||this.connection.driver instanceof h.a||this.connection.driver instanceof i.l)&&(this.expressionMap.nativeParameters=Object.assign(s,this.expressionMap.nativeParameters));var u=this.createWhereExpression(),l=this.createReturningExpression();return l&&(this.connection.driver instanceof i.k||this.connection.driver instanceof i.j||this.connection.driver instanceof i.d)?"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+r.join(", ")+u+" RETURNING "+l:l&&this.connection.driver instanceof i.m?"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+r.join(", ")+" OUTPUT "+l+u:"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+r.join(", ")+u},t.prototype.createOrderByExpression=function(){var e=this,t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map((function(n){return"string"==typeof t[n]?e.replacePropertyNames(n)+" "+t[n]:e.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls})).join(", "):""},t.prototype.createLimitExpression=function(){var e=this.expressionMap.limit;if(e){if(this.connection.driver instanceof i.i||this.connection.driver instanceof i.a)return" LIMIT "+e;throw new d.a}return""},t.prototype.getValueSet=function(){if(this.expressionMap.valuesSet instanceof Object)return this.expressionMap.valuesSet;throw new p.a},t}(o.a)},function(e,t,n){"use strict";n.r(t),n.d(t,"DeleteQueryBuilder",(function(){return f}));var r=n(0),i=n(1),o=n(49),a=n(164),s=n(84),c=n(50),u=n(12),l=n(13),f=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.expressionMap.aliasNamePrefixingEnabled=!1,r}return Object(r.c)(t,e),t.prototype.getQuery=function(){var e=this.createComment();return(e+=this.createDeleteExpression()).trim()},t.prototype.execute=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,o,s,l,f,h,d,p;return Object(r.d)(this,(function(m){switch(m.label){case 0:e=Object(r.e)(this.getQueryAndParameters(),2),t=e[0],n=e[1],o=this.obtainQueryRunner(),s=!1,m.label=1;case 1:return m.trys.push([1,11,16,21]),!0!==this.expressionMap.useTransaction||!1!==o.isTransactionActive?[3,3]:[4,o.startTransaction()];case 2:m.sent(),s=!0,m.label=3;case 3:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(d=new u.a,o.broadcaster.broadcastBeforeRemoveEvent(d,this.expressionMap.mainAlias.metadata),d.promises.length>0?[4,Promise.all(d.promises)]:[3,5]):[3,5];case 4:m.sent(),m.label=5;case 5:return l=new a.a,[4,o.query(t,n)];case 6:return f=m.sent(),(h=o.connection.driver)instanceof i.i?(l.raw=f,l.affected=f.affectedRows):h instanceof i.a?(l.raw=f,l.affected=f.numberOfRecordsUpdated):h instanceof i.m||h instanceof i.k||h instanceof i.d?(l.raw=f[0]?f[0]:null,l.affected="number"==typeof f[1]?f[1]:null):h instanceof i.j?l.affected=f:h instanceof i.c?(l.raw=f,l.affected=f.changes):l.raw=f,!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(d=new u.a,o.broadcaster.broadcastAfterRemoveEvent(d,this.expressionMap.mainAlias.metadata),d.promises.length>0?[4,Promise.all(d.promises)]:[3,8]):[3,8];case 7:m.sent(),m.label=8;case 8:return s?[4,o.commitTransaction()]:[3,10];case 9:m.sent(),m.label=10;case 10:return[2,l];case 11:if(p=m.sent(),!s)return[3,15];m.label=12;case 12:return m.trys.push([12,14,,15]),[4,o.rollbackTransaction()];case 13:return m.sent(),[3,15];case 14:return m.sent(),[3,15];case 15:throw p;case 16:return o===this.queryRunner?[3,18]:[4,o.release()];case 17:m.sent(),m.label=18;case 18:return this.connection.driver instanceof c.a&&!o.isTransactionActive?[4,this.connection.driver.autoSave()]:[3,20];case 19:m.sent(),m.label=20;case 20:return[7];case 21:return[2]}}))}))},t.prototype.from=function(e,t){e=e instanceof l.EntitySchema?e.options.name:e;var n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this},t.prototype.where=function(e,t){this.expressionMap.wheres=[];var n=this.computeWhereParameter(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this},t.prototype.andWhere=function(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.computeWhereParameter(e)}),t&&this.setParameters(t),this},t.prototype.orWhere=function(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.computeWhereParameter(e)}),t&&this.setParameters(t),this},t.prototype.whereInIds=function(e){return this.where(this.createWhereIdsExpression(e))},t.prototype.andWhereInIds=function(e){return this.andWhere(this.createWhereIdsExpression(e))},t.prototype.orWhereInIds=function(e){return this.orWhere(this.createWhereIdsExpression(e))},t.prototype.output=function(e){return this.returning(e)},t.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new s.a;return this.expressionMap.returning=e,this},t.prototype.createDeleteExpression=function(){var e=this.getTableName(this.getMainTableName()),t=this.createWhereExpression(),n=this.createReturningExpression();return n&&(this.connection.driver instanceof i.k||this.connection.driver instanceof i.d)?"DELETE FROM "+e+t+" RETURNING "+n:""!==n&&this.connection.driver instanceof i.m?"DELETE FROM "+e+" OUTPUT "+n+t:"DELETE FROM "+e+t},t}(o.a)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.EventManager=void 0;var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(n,e);var t=a(n);function n(){return i(this,n),t.apply(this,arguments)}return n}(n(513).EventManager);t.EventManager=u},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.TemplateSite=void 0;var c=n(43),u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e,r,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e,i))._viewPromise=Promise.all([a._viewPromise,c.ViewInflater.getInstance().load(r)]).then((function(e){return e[0].querySelector(o).replaceWith(e[1]),c.ViewInflater.replaceWithChildren(e[1]),a._view=e[0],e[0]})).catch((function(e){return console.error(e)})),a}return n}(n(258).MasterSite);t.TemplateSite=u},function(e,t,n){e.exports=n.p+"html/container.html"},function(e,t,n){e.exports=n.p+"html/alphabeticListFragment.html"},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Menu=void 0;var i=n(22),o=n(121),a=n(107),s=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._actions=[],this._renderers=[],this._submenus=[],Array.isArray(t)?this._renderers=t:this._renderers=[t],this._onClickListener=this._generateOnClickListener(),i.Helper.nonNull(n,[]).forEach((function(e){r.addAction(e,!1)})),this._openSubmenuListener=null}var t,n,s;return t=e,(n=[{key:"copy",value:function(t){return(t=i.Helper.nonNull(t,new e))._actions=[],this._actions.forEach((function(e){t.addAction(e.copy())})),t._renderers=this._renderers,t._onClickListener=this._onClickListener,t}},{key:"close",value:function(){this._submenus.forEach((function(e){e.close()}))}},{key:"addAction",value:function(e,t){e instanceof o.MenuAction&&-1===this._actions.indexOf(e)&&(e instanceof a.OpenSubmenuAction&&this._submenus.push(e.getSubmenu()),this._actions.push(e),e.setMenu(this),i.Helper.nonNull(t,!0)&&this.redraw())}},{key:"removeAllActions",value:function(e){this._actions.forEach((function(e){return e.setMenu(null)})),this._actions=[],this._submenus=[],i.Helper.nonNull(e,!0)&&this.redraw()}},{key:"draw",value:function(){var e=this;try{this.sortActions(),this._renderers.forEach((function(t){t.render(e)}))}catch(e){console.error(e)}}},{key:"sortActions",value:function(){this._actions=this._actions.sort((function(e,t){return e.getOrder()-t.getOrder()}))}},{key:"openSubmenu",value:function(e){this._openSubmenuListener&&this._openSubmenuListener(e)}},{key:"setOpenSubmenuListener",value:function(e){this._openSubmenuListener=e}},{key:"_generateOnClickListener",value:function(){var e=this;return function(t){var n=t.target;if(n.matches("li")||n.matches("li *")){n=n.closest("li");for(var r=parseInt(n.dataset.id),i=0,o=e._actions.length;i<o;i++)if(e._actions[i].getId()===r)return"function"==typeof e._actions[i].getAction()&&e._actions[i].isActivated()&&(e._actions[i].getAction()(e._actions[i],t),t.preventDefault()),e._actions[i];for(var a=0,s=e._submenus.length;a<s;a++){var c=e._submenus[a].click(r,t);if(c)return c}}return null}}},{key:"setOnClickListener",value:function(e){this._onClickListener=e}},{key:"getOnClickListener",value:function(){return this._onClickListener}},{key:"getActions",value:function(){return this._actions}},{key:"redrawAction",value:function(e){this._renderers.forEach((function(t){t._triggerRenderAction(e)}))}},{key:"updateAction",value:function(e){this._renderers.forEach((function(t){t.updateAction(e)}))}},{key:"redraw",value:function(){this.draw()}}])&&r(t.prototype,n),s&&r(t,s),e}();t.Menu=s},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.AccordionRenderer=void 0;var d=n(107),p=n(263),m=n(22),y=n(31),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(f,e);var t,n,r,o=l(f);function f(){return a(this,f),o.apply(this,arguments)}return t=f,(n=[{key:"renderAction",value:function(e){var t=this.renderLinkElement(e),n=this.renderLiElement(e);return n.insertBefore(t,n.firstChild),n}},{key:"renderLinkElement",value:function(e){var t=document.createElement("a");if("string"==typeof e.getAction()&&(t.href=e.getAction()),m.Helper.isNotNull(e.getIcon())){var n=document.createElement("img");n.src=e.getIcon(),n.classList.add("action-image"),e.isShouldTranslate()?(n.dataset.translationTitle=e.getName(),n.classList.add(y.Translator.getInstance().getTranslationClass())):n.title=e.getName(),t.appendChild(n)}var r=e.getName();return r=e.isShouldTranslate()?y.Translator.makePersistentTranslation(r):document.createTextNode(r),t.appendChild(r),t}},{key:"renderLiElement",value:function(e){var t,n=document.createElement("li");return""!==e.getLiClass().trim()&&(t=n.classList).add.apply(t,i(e.getLiClass().split(" "))),n.dataset.id=e.getId(),m.Helper.isNotNull(e.getIcon())&&n.classList.add("img"),e.isVisible()||n.classList.add("hidden"),n.classList.add(e.getShowFor()),n}},{key:"renderSubmenuAction",value:function(e){var t=c(h(f.prototype),"renderSubmenuAction",this).call(this,e);return t.classList.remove("is-dropdown-submenu-parent"),t.classList.add("is-accordion-submenu-parent"),t}},{key:"createSubmenuParentElement",value:function(e){var t=document.createElement("ul");return t.classList.add("menu"),t.classList.add("vertical"),t.classList.add("submenu"),t.classList.add("accordion-menu"),t.classList.add("is-accordion-submenu"),t.classList.add("first-sub"),t}},{key:"updateAction",value:function(e){if(e instanceof d.OpenSubmenuAction){var t=this.getElementForAction(e).querySelector(".submenu");e.getSubmenu().isOpen()?(this.getElementForAction(e).setAttribute("aria-expanded",!0),t.classList.add("js-active"),t.style=""):(this.getElementForAction(e).removeAttribute("aria-expanded"),t.classList.remove("js-activ"),t.style="display:none;")}}}])&&s(t.prototype,n),r&&s(t,r),f}(p.MenuRenderer);t.AccordionRenderer=g},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ClientFileMedium=void 0;var h=n(39),d=n(272),p=n(5),m=n(7),y=n(207),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(h,e);var t,n,r,u=c(h);function h(){var e;return i(this,h),(e=u.apply(this,arguments)).saveOffline=!0,e._isDownloaded=!1,e._isDownloadedPromise=new m.PromiseWithHandlers,e}return t=h,r=[{key:"saveMany",value:function(e){var t=this,n=Object.create(null,{saveMany:{get:function(){return a(l(h),"saveMany",t)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.saveMany.call(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"_handleImages",value:function(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Array.isArray(e)||(e=[e]),t.next=4,p.Helper.asyncForEach(e,(function(e){return f(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.saveOffline||"browser"===device.platform||e.src.startsWith("data")||e.src.startsWith("http")||e.src.startsWith("//")){t.next=4;break}return t.next=3,new d.FileTransferPromise(e.getServerUrl(!1),e.src).download().catch((function(e){return console.log(e)}));case 3:e._isDownloaded=!0;case 4:case"end":return t.stop()}}),t)})))}),!0);case 4:case"end":return t.stop()}}),t)})))}},{key:"deleteMany",value:function(e){var t=this,n=Object.create(null,{deleteMany:{get:function(){return a(l(h),"deleteMany",t)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("browser"===device.platform){t.next=5;break}return t.next=3,p.Helper.asyncForEach(e,(function(e){return y.FilePromise.delete(e.src).catch((function(e){return console.error(e)}))}),!0);case 3:r=t.sent,console.log("res",r);case 5:return t.abrupt("return",n.deleteMany.call(this,e));case 6:case"end":return t.stop()}}),t,this)})))}}],(n=[{key:"isDownloadedState",value:function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._isDownloadedPromise);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"setLoaded",value:function(e){var t=this;a(l(h.prototype),"setLoaded",this).call(this,e),y.FilePromise.open(this.src,{create:!1}).then((function(){return t._isDownloaded=!0})).catch((function(e){console.log("not downloaded, yet!"),t._isDownloaded=!1})).finally((function(){t._isDownloadedPromise.resolve(t._isDownloaded)}))}},{key:"getUrlWithoutDownload",value:function(){return""}},{key:"getUrl",value:function(){return h._handleImages(this),this.getUrlWithoutDownload()}},{key:"save",value:function(){var e=this,t=Object.create(null,{save:{get:function(){return a(l(h.prototype),"save",e)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.save.call(this));case 1:case"end":return e.stop()}}),e,this)})))}}])&&o(t.prototype,n),r&&o(t,r),h}(h.EasySyncBaseModel);t.ClientFileMedium=g},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FilePromise=void 0;var o=n(5),a=n(273),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fileEntry=t}var t,n,s;return t=e,s=[{key:"open",value:function(t,n){return i(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=o.Helper.nonNull(n,{create:!0,exclusive:!1}),r.abrupt("return",new Promise((function(r,i){window.resolveLocalFileSystemURL("cdvfile://localhost/persistent/",(function(o){o.getFile(t,n,(function(t){r(new e(t))}),i)}),i)})));case 2:case"end":return r.stop()}}),r)})))}},{key:"delete",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){window.resolveLocalFileSystemURL("cdvfile://localhost/persistent/",(function(r){r.getFile(e,{create:!1},(function(e){e.remove(t,n,t)}),n)}),n)})));case 1:case"end":return t.stop()}}),t)})))}}],(n=[{key:"createWriter",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.fileEntry.createWriter((function(t){e(new a.FileWriterPromise(t))}))})));case 1:case"end":return e.stop()}}),e)})))}}])&&r(t.prototype,n),s&&r(t,s),e}();t.FilePromise=s},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var l=n(10),f=n(4),h=n(278),User=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(User,e);var t,n,r,c=s(User);function User(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,User),(e=c.call(this)).username=null,e.email=null,e.password=null,e.roles=null,e.activated=!1,e.blocked=!1,e.salt=null,e}return t=User,r=[{key:"getColumnDefinitions",value:function(){var e=o(u(User),"getColumnDefinitions",this).call(this);return e.username={type:f.BaseDatabase.TYPES.STRING,unique:!0},e.email={type:f.BaseDatabase.TYPES.STRING,unique:!0},e.password={type:f.BaseDatabase.TYPES.STRING},e.activated=f.BaseDatabase.TYPES.BOOLEAN,e.blocked=f.BaseDatabase.TYPES.BOOLEAN,e.salt={type:f.BaseDatabase.TYPES.STRING},e}},{key:"getRelationDefinitions",value:function(){var e=o(u(User),"getRelationDefinitions",this).call(this);return e.roles={target:h.Role.getSchemaName(),type:"many-to-many",joinTable:{name:"userRole"},cascade:!1},e}},{key:"prepareSync",value:function(e){var t=[];return e.forEach((function(e){var n={};n.id=e.id,n.createdAt=new Date,n.updatedAt=new Date,n.username="",n.email="",n.password="",n.salt="",n.activated=1,n.blocked=1,n.version=1,n.deleted=0,t.push(n)})),t}}],(n=[{key:"toJSON",value:function(){return{id:this.id,username:this.username}}}])&&i(t.prototype,n),r&&i(t,r),User}(l.EasySyncBaseModel);t.User=User,f.BaseDatabase.addModel(User)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.StartUserSiteMenuAction=void 0;var c=n(155),u=n(2),l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e,r,i,o,a,s){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e,r,(function(){u.StartSiteMenuAction._app&&(Array.isArray(i)&&i.length>=2?u.StartSiteMenuAction._app.startSite(i[0],i[1]):u.StartSiteMenuAction._app.startSite(i))}),o,a,s)}return n}(c.UserMenuAction);t.StartUserSiteMenuAction=l},function(e,t,n){"use strict";n.r(t),n.d(t,"RelationQueryBuilder",(function(){return c}));var r=n(0),i=n(49),o=n(1),a=function(){function e(e,t){this.queryBuilder=e,this.expressionMap=t}return e.prototype.update=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,a,s,c,u,l,f,h,d,p,m,y=this;return Object(r.d)(this,(function(r){switch(r.label){case 0:return(t=this.expressionMap.relationMetadata).isManyToOne||t.isOneToOneOwner?(u=t.joinColumns.reduce((function(t,n){var r=e instanceof Object?n.referencedColumn.getEntityValue(e):e;return n.setEntityValue(t,r),t}),{}),!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length?[2]:[4,this.queryBuilder.createQueryBuilder().update(t.entityMetadata.target).set(u).whereInIds(this.expressionMap.of).execute()]):[3,2];case 1:return r.sent(),[3,10];case 2:return!t.isOneToOneNotOwner&&!t.isOneToMany||null!==e?[3,4]:(n={},t.inverseRelation.joinColumns.forEach((function(e){n[e.propertyName]=null})),f=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],i={},a=[],f.forEach((function(e,n){t.inverseRelation.joinColumns.map((function(t,r){var o="joinColumn_"+n+"_"+r;i[o]=e instanceof Object?t.referencedColumn.getEntityValue(e):e,a.push(t.propertyPath+" = :"+o)}))})),(s=a.map((function(e){return"("+e+")"})).join(" OR "))?[4,this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(n).where(s).setParameters(i).execute()]:[2]);case 3:return r.sent(),[3,10];case 4:if(!t.isOneToOneNotOwner&&!t.isOneToMany)return[3,6];if(Array.isArray(this.expressionMap.of))throw new Error("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");return c=this.expressionMap.of,u=t.inverseRelation.joinColumns.reduce((function(e,t){var n=c instanceof Object?t.referencedColumn.getEntityValue(c):c;return t.setEntityValue(e,n),e}),{}),!e||Array.isArray(e)&&!e.length?[2]:[4,this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(u).whereInIds(e).execute()];case 5:return r.sent(),[3,10];case 6:return l=t.junctionEntityMetadata,f=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],h=Array.isArray(e)?e:[e],d=t.isManyToManyOwner?f:h,p=t.isManyToManyOwner?h:f,m=[],d.forEach((function(e){p.forEach((function(t){var n={};l.ownerColumns.forEach((function(t){n[t.databaseName]=e instanceof Object?t.referencedColumn.getEntityValue(e):e})),l.inverseColumns.forEach((function(e){n[e.databaseName]=t instanceof Object?e.referencedColumn.getEntityValue(t):t})),m.push(n)}))})),m.length?this.queryBuilder.connection.driver instanceof o.j||this.queryBuilder.connection.driver instanceof o.l?[4,Promise.all(m.map((function(e){return y.queryBuilder.createQueryBuilder().insert().into(l.tableName).values(e).execute()})))]:[3,8]:[2];case 7:return r.sent(),[3,10];case 8:return[4,this.queryBuilder.createQueryBuilder().insert().into(l.tableName).values(m).execute()];case 9:r.sent(),r.label=10;case 10:return[2]}}))}))},e}(),s=function(){function e(e,t){this.queryBuilder=e,this.expressionMap=t}return e.prototype.remove=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,i,o,a,s,c,u,l,f,h,d,p;return Object(r.d)(this,(function(m){switch(m.label){case 0:return(t=this.expressionMap.relationMetadata).isOneToMany?(c=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],n=Array.isArray(e)?e:[e],i={},t.inverseRelation.joinColumns.forEach((function(e){i[e.propertyName]=null})),o={},a=[],c.forEach((function(e,i){a.push.apply(a,Object(r.f)([],Object(r.e)(n.map((function(n,a){return Object(r.f)(Object(r.f)([],Object(r.e)(t.inverseRelation.joinColumns.map((function(t,n){var r="joinColumn_"+i+"_"+a+"_"+n;return o[r]=e instanceof Object?t.referencedColumn.getEntityValue(e):e,t.propertyPath+" = :"+r})))),Object(r.e)(t.inverseRelation.entityMetadata.primaryColumns.map((function(e,t){var r="primaryColumn_"+a+"_"+a+"_"+t;return o[r]=n instanceof Object?e.getEntityValue(n):n,e.propertyPath+" = :"+r})))).join(" AND ")})))))})),(p=a.map((function(e){return"("+e+")"})).join(" OR "))?[4,this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(i).where(p).setParameters(o).execute()]:[2]):[3,2];case 1:return m.sent(),[3,4];case 2:return s=t.junctionEntityMetadata,c=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],u=Array.isArray(e)?e:[e],l=t.isManyToManyOwner?c:u,f=t.isManyToManyOwner?u:c,h={},d=[],l.forEach((function(e,t){d.push.apply(d,Object(r.f)([],Object(r.e)(f.map((function(n,i){return Object(r.f)(Object(r.f)([],Object(r.e)(s.ownerColumns.map((function(n,r){var o="firstValue_"+t+"_"+i+"_"+r;return h[o]=e instanceof Object?n.referencedColumn.getEntityValue(e):e,n.databaseName+" = :"+o})))),Object(r.e)(s.inverseColumns.map((function(e,r){var o="secondValue_"+t+"_"+i+"_"+r;return h[o]=n instanceof Object?e.referencedColumn.getEntityValue(n):n,e.databaseName+" = :"+o})))).join(" AND ")})))))})),p=d.map((function(e){return"("+e+")"})).join(" OR "),[4,this.queryBuilder.createQueryBuilder().delete().from(s.tableName).where(p).setParameters(h).execute()];case 3:m.sent(),m.label=4;case 4:return[2]}}))}))},e}(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.c)(t,e),t.prototype.getQuery=function(){return""},t.prototype.of=function(e){return this.expressionMap.of=e,this},t.prototype.set=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){if(t=this.expressionMap.relationMetadata,!this.expressionMap.of)throw new Error("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToMany||t.isOneToMany)throw new Error('Set operation is only supported for many-to-one and one-to-one relations. However given "'+t.propertyPath+'" has '+t.relationType+" relation. Use .add() method instead.");if(t.joinColumns&&t.joinColumns.length>1&&(!(e instanceof Object)||Object.keys(e).length<t.joinColumns.length))throw new Error('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return[2,new a(this,this.expressionMap).update(e)]}))}))},t.prototype.add=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){if(Array.isArray(e)&&0===e.length)return[2];if(t=this.expressionMap.relationMetadata,!this.expressionMap.of)throw new Error("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToOne||t.isOneToOne)throw new Error('Add operation is only supported for many-to-many and one-to-many relations. However given "'+t.propertyPath+'" has '+t.relationType+" relation. Use .set() method instead.");if(t.joinColumns&&t.joinColumns.length>1&&(!(e instanceof Object)||Object.keys(e).length<t.joinColumns.length))throw new Error('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return[2,new a(this,this.expressionMap).update(e)]}))}))},t.prototype.remove=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){if(Array.isArray(e)&&0===e.length)return[2];if(t=this.expressionMap.relationMetadata,!this.expressionMap.of)throw new Error("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToOne||t.isOneToOne)throw new Error('Add operation is only supported for many-to-many and one-to-many relations. However given "'+t.propertyPath+'" has '+t.relationType+" relation. Use .set(null) method instead.");return[2,new s(this,this.expressionMap).remove(e)]}))}))},t.prototype.addAndRemove=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,this.remove(t)];case 1:return n.sent(),[4,this.add(e)];case 2:return n.sent(),[2]}}))}))},t.prototype.loadOne=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return[2,this.loadMany().then((function(e){return e[0]}))]}))}))},t.prototype.loadMany=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t;return Object(r.d)(this,(function(n){if(!((e=this.expressionMap.of)instanceof Object)){if((t=this.expressionMap.mainAlias.metadata).hasMultiplePrimaryKeys)throw new Error("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");e=t.primaryColumns[0].createValueMap(e)}return[2,this.connection.relationLoader.load(this.expressionMap.relationMetadata,e,this.queryRunner)]}))}))},t}(i.a)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChooseDialog=void 0;var c=n(64),u=n(43),l=n(266),f=n(31),h=n(5),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e,r,i){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var a=u.ViewInflater.getInstance().load(l).then((function(t){i=h.Helper.nonNull(i,!0);var n=t.querySelector("#choose-value-template");n.remove(),n.removeAttribute("id");var r=t.querySelector("#choose-container"),a=function(t){var a=n.cloneNode(!0),s=null;i?s=f.Translator.makePersistentTranslation(e[t]):(s=document.createElement("span")).innerText=e[t],a.querySelector(".choose-dialog-value").appendChild(s),a.dataset.value=t,a.addEventListener("click",(function(){o._result=t,o.close()})),r.appendChild(a)};for(var s in e)a(s);return t}));return o=t.call(this,a,r)}return n}(c.Dialog);t.ChooseDialog=d},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SyncJob=void 0;var o=n(277),a=n(2),s=n(7),c=n(109),u=n(13),l=n(39),f=n(206),h=n(81),d=n(16),p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._syncedModels={},this._modelNames=[],this._relationshipModels={},this._lastSyncDates={},this._keyedModelClasses={},this._savePromise=Promise.resolve(),this._queryRunner=null,this._finalRes={},this._manyToManyRelations={}}var t,n,p;return t=e,p=[{key:"_fetchModel",value:function(t,n){return i(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,a.DataManager.load(e.SYNC_PATH_PREFIX+a.DataManager.buildQuery({queries:JSON.stringify(t),offset:n}));case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})))}}],(n=[{key:"syncInBackgroundIfDataExists",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this._keyedModelClasses=c.EasySyncClientDb.getModel(),r=s.JsonHelper.deepCopy(e),i=this._buildRequestQuery(r),n.next=5,this._getLastSyncModels(this._modelNames,i);case 5:if(this._lastSyncDates=n.sent,this._syncPromise=this.sync(e,t),!Object.values(this._lastSyncDates).some((function(e){return 0===e.getLastSynced()}))){n.next=10;break}return n.next=10,this._syncPromise;case 10:case"end":return n.stop()}}),n,this)})))}},{key:"getSyncPromise",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._syncPromise);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"sync",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=s.Helper.nonNull(t,!0),this._keyedModelClasses=c.EasySyncClientDb.getModel(),r=this._buildRequestQuery(e),0!==Object.keys(this._lastSyncDates).length){n.next=7;break}return n.next=6,this._getLastSyncModels(this._modelNames,r);case 6:this._lastSyncDates=n.sent;case 7:return n.next=9,this._doRuns(r);case 9:return i=[],Object.keys(this._lastSyncDates).forEach((function(e){i.push(o._lastSyncDates[e].save())})),n.next=13,Promise.all(i);case 13:return n.next=15,c.EasySyncClientDb.getInstance().rawQuery("PRAGMA foreign_keys = ON;");case 15:if(!(this._finalRes.FileMedium&&this._finalRes.FileMedium.changed&&t)){n.next=22;break}return n.t0=f.ClientFileMedium,n.next=19,h.FileMedium.findByIds(this._finalRes.FileMedium.changed);case 19:return n.t1=n.sent,n.next=22,n.t0._handleImages.call(n.t0,n.t1);case 22:return n.abrupt("return",this._finalRes);case 23:case"end":return n.stop()}}),n,this)})))}},{key:"_doRuns",value:function(t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,a,u,l,f=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,o=null,a=0,n.next=5,c.EasySyncClientDb.getInstance().createQueryRunner();case 5:this._queryRunner=n.sent,this._savePromise=this._queryRunner.query("PRAGMA foreign_keys = OFF;").then((function(){return f._queryRunner.startTransaction()})),l=regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u=!1,n.next=3,e._fetchModel(t,a);case 3:o=n.sent,a=o.nextOffset,s.Helper.isNull(r)&&(r=parseInt(o.newLastSynced),Object.keys(f._lastSyncDates).forEach((function(e){f._lastSyncDates[e].setLastSynced(r)}))),i=[],o.results.forEach((function(e,n){e&&e.shouldAskAgain&&(u=!0,i.push(t[n])),f._extractEntities(e)})),t=i;case 9:case"end":return n.stop()}}),n)}));case 8:return n.delegateYield(l(),"t0",9);case 9:if(u){n.next=8;break}case 10:return n.next=12,this._handleManyToManyRelations();case 12:return n.abrupt("return",this._savePromise.then((function(){return i(f,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._queryRunner.commitTransaction();case 2:case"end":return e.stop()}}),e,this)})))})).catch((function(e){return i(f,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.error(e),t.next=3,this._queryRunner.rollbackTransaction();case 3:case"end":return t.stop()}}),t,this)})))})).finally((function(){return i(f,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._queryRunner.release();case 2:case"end":return e.stop()}}),e,this)})))})));case 13:case"end":return n.stop()}}),n,this)})))}},{key:"_extractEntities",value:function(e){var t,n,r=this;if(e){var o=this._keyedModelClasses[e.model],a=o.getSchemaName(),c=[],u=[];e.entities.forEach((function(e){e.deleted?c.push(e.id):u.push(e)})),this._syncedModels[a]=s.Helper.nonNull(this._syncedModels[a],{});var l=o.getSchemaDefinition(),f=l.relations,h=l.columns,d=[];u.forEach((function(e){Object.keys(f).forEach((function(t){if("many-to-many"===f[t].type&&Array.isArray(e[t])){var n,i,a=f[t].joinTable;n=a.joinColumn&&a.joinColumn.name?a.joinColumn.name:(n=o.getSchemaName()).substr(0,1).toLowerCase()+n.substr(1)+"Id",i=a.inverseJoinColumn&&a.inverseJoinColumn.name?a.inverseJoinColumn.name:(i=f[t].target).substr(0,1).toLowerCase()+i.substr(1)+"Id",r._manyToManyRelations[a.name]=s.Helper.nonNull(r._manyToManyRelations[a.name],{}),r._manyToManyRelations[a.name].values=s.Helper.nonNull(r._manyToManyRelations[a.name].values,[]),r._manyToManyRelations[a.name]["delete_"+n]=s.Helper.nonNull(r._manyToManyRelations[a.name]["delete_"+n],[]),r._manyToManyRelations[a.name]["delete_"+n].push(e.id);var c=[];r._manyToManyRelations[a.name].values.filter((function(t){return t[n]===e.id})).forEach((function(e){return c.push(e[i])})),e[t].forEach((function(t){if(-1===c.indexOf(t)){var o={};o[n]=e.id,o[i]=t,r._manyToManyRelations[a.name].values.push(o)}}))}else if("many-to-one"===f[t].type||"one-to-one"===f[t].type&&f[t].joinColumn){var u;u=f[t].joinColumn&&f[t].joinColumn.name?f[t].joinColumn.name:t+"Id",e[u]=e[t]}delete e[t]})),Object.keys(h).forEach((function(t){h[t].escapeHTML&&(e[t]=s.XSSHelper.escapeHTML(e[t])),h[t].escapeJS&&(e[t]=s.XSSHelper.escapeJS(e[t]))})),d.push(e.id)})),this._savePromise=this._savePromise.then((function(){return i(r,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._insertOrReplace(o,u);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))})),this._savePromise=this._savePromise.then((function(){return i(r,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._deleteModels(o,c);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))})),this._finalRes[a]=s.Helper.nonNull(this._finalRes[a],{deleted:[],changed:[]}),(t=this._finalRes[a].deleted).push.apply(t,c),(n=this._finalRes[a].changed).push.apply(n,d)}}},{key:"_buildRequestQuery",value:function(e){var t=this,n=[];return e.forEach((function(e){e.prototype instanceof l.EasySyncBaseModel&&(e={model:e,where:{}}),e.model=e.model.getSchemaName(),t._modelNames.push(e.model),n.push(e);var r=""+e.model+JSON.stringify(e.where);s.Helper.isNotNull(t._lastSyncDates[r])&&(e.lastSynced=t._lastSyncDates[r].getLastSynced())})),n}},{key:"_getLastSyncModels",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.LastSyncDates.find({model:u.In(e)});case 2:return r=n.sent,i=s.Helper.arrayToObject(r,(function(e){return""+e.getModel()+JSON.stringify(e.where)})),t.forEach((function(e){var t=""+e.model+JSON.stringify(e.where);if(s.Helper.isNull(i[t])){var n=new o.LastSyncDates;n.setModel(e.model),n.where=e.where,n.setLastSynced(0),i[t]=n}e.lastSynced=i[t].getLastSynced()})),n.abrupt("return",i);case 6:case"end":return n.stop()}}),n)})))}},{key:"_insertOrReplace",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,a,c,u,l,f,h,p=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=50,0!==t.length){n.next=3;break}return n.abrupt("return");case 3:return o=e.getSchemaDefinition(),a=o.name,a=s.Helper.toSnakeCase(a),c=o.columns,u=Object.keys(t[0]),l=[],f=[],n.next=12,s.Helper.asyncForEach(t,(function(e){return i(p,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],u.forEach((function(t){var r=e[t];c[t]&&c[t].transformer&&(r=c[t].transformer.to(r)),c[t]&&c[t].type===d.BaseDatabase.TYPES.SIMPLE_JSON&&(r=JSON.stringify(r)),l.push(r),n.push("?")})),f.push("("+n.join(",")+")"),!(f.length>=r)){t.next=11;break}return console.log("value string",f.length),i="INSERT OR REPLACE INTO "+a+" ("+u.join(",")+") VALUES "+f.join(","),t.next=9,this._queryRunner.query(i,l);case 9:f=[],l=[];case 11:case"end":return t.stop()}}),t,this)})))}));case 12:if(!(f.length>0)){n.next=17;break}return console.log("value string 2",f.length),h="INSERT OR REPLACE INTO "+a+" ("+u.join(",")+") VALUES "+f.join(","),n.next=17,this._queryRunner.query(h,l);case 17:case"end":return n.stop()}}),n,this)})))}},{key:"_deleteModels",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,a,c,u,l=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=300,0!==t.length){n.next=3;break}return n.abrupt("return");case 3:return o=e.getSchemaName(),o=s.Helper.toSnakeCase(o),a=[],c=[],n.next=9,s.Helper.asyncForEach(t,(function(e){return i(l,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.push(e),c.push("?"),!(c.length>=r)){t.next=8;break}return n="DELETE FROM "+o+" WHERE id IN ("+a.join(",")+")",t.next=6,this._queryRunner.query(n);case 6:c=[],a=[];case 8:case"end":return t.stop()}}),t,this)})))}));case 9:if(!(c.length>0)){n.next=13;break}return u="DELETE FROM "+o+" WHERE id IN ("+a.join(",")+")",n.next=13,this._queryRunner.query(u);case 13:case"end":return n.stop()}}),n,this)})))}},{key:"_handleManyToManyRelations",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._savePromise;case 2:return t=[],Object.keys(this._manyToManyRelations).forEach((function(e){var r="DELETE FROM "+e+" WHERE ",i=[];Object.keys(n._manyToManyRelations[e]).forEach((function(t){t.startsWith("delete_")&&i.push(t.substr(7)+" IN ("+n._manyToManyRelations[e][t].join(",")+")")})),r+=i.join(" OR ")+";",t.push(n._queryRunner.query(r).then((function(){if(n._manyToManyRelations[e].values.length>0){var t=Object.keys(n._manyToManyRelations[e].values[0]),r=[];n._manyToManyRelations[e].values.forEach((function(e){var n=[];t.forEach((function(t){n.push(e[t])})),r.push("("+n.join(",")+")")}));var i="INSERT OR REPLACE INTO "+e+"("+t.join(",")+") VALUES "+r.join(",")+";";return n._queryRunner.query(i)}})))})),e.next=6,Promise.all(t);case 6:case"end":return e.stop()}}),e,this)})))}}])&&r(t.prototype,n),p&&r(t,p),e}();t.SyncJob=p,p.SYNC_PATH_PREFIX="sync"},function(e){e.exports=JSON.parse('[{"vers":"So spricht der Herr: \\"Auch jetzt noch könnt ihr zu mir umkehren! Tut es von ganzem Herzen, fastet, weint und klagt!\\"","stelle":"Joel 2,11","uebersetzung":"Hoffnung für Alle"},{"vers":"Genauso müsst ihr von euch selbst denken: Ihr seid tot für die Sünde, aber weil ihr mit Jesus Christus verbunden seid, lebt ihr für Gott.","stelle":"Römer 6,11","uebersetzung":"Gute Nachricht"},{"vers":"Mehr als auf alles andere achte auf deine Gedanken, denn sie entscheiden über dein Leben.","stelle":"Sprichwörter 4,23","uebersetzung":"Gute Nachricht"},{"vers":"Was bleibt sind Glaube, Hoffnung und Liebe. Von diesen dreien aber ist die Liebe das Größte.","stelle":"1. Korinther 13,13","uebersetzung":"Hoffnung für Alle"},{"vers":"Ich bin überzeugt: Was wir in der gegenwärtigen Zeit noch leiden müssen, fällt überhaupt nicht ins Gewicht im Vergleich mit der Herrlichkeit, die Gott uns zugedacht hat und die er in der Zukunft offenbar machen wird.","stelle":"Römer 8,18","uebersetzung":"Gute Nachricht"},{"vers":"Redet nicht schlecht voneinander, sondern habt ein gutes Wort für jeden, der es braucht. Was ihr sagt, soll hilfreich und ermutigend sein, eine Wohltat für alle.","stelle":"Epheser 4,29","uebersetzung":"Hoffnung für Alle"},{"vers":"Sechs Dinge verabscheut der HERR und das siebte kann er erst recht nicht ausstehen: überhebliche Augen, eine lügnerische Zunge, Hände, die schuldlose Menschen töten, einen Kopf, der böse Pläne ausheckt, Füße, die auf verbrecherischen Wegen laufen, einen Zeugen, der nicht die Wahrheit sagt, und einen Menschen, der Brüder gegeneinander aufhetzt.","stelle":"Sprichwörter 6,16-19","uebersetzung":"Gute Nachricht"},{"vers":"Gesegnet ist der Mann, der sich auf den HERRN verlässt und dessen Zuversicht der HERR ist. Der ist wie ein Baum, am Wasser gepflanzt, der seine Wurzeln zum Bach hin streckt. Denn obgleich die Hitze kommt, fürchtet er sich doch nicht, sondern seine Blätter bleiben grün; und er sorgt sich nicht, wenn ein dürres Jahr kommt, sondern bringt ohne Aufhören Früchte.","stelle":"Jeremia 17,7-8","uebersetzung":"Lutherbibel 2017"}]')},function(e,t,n){e.exports=!n(36)&&!n(18)((function(){return 7!=Object.defineProperty(n(168)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(17),i=n(33),o=n(97),a=n(169),s=n(37).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){var r=n(60),i=n(62),o=n(141)(!1),a=n(170)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),c=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~o(u,n)||u.push(n));return u}},function(e,t,n){var r=n(37),i=n(19),o=n(98);e.exports=n(36)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,c=0;s>c;)r.f(e,n=a[c++],t[n]);return e}},function(e,t,n){var r=n(62),i=n(101).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t,n){"use strict";var r=n(36),i=n(98),o=n(142),a=n(134),s=n(46),c=n(133),u=Object.assign;e.exports=!u||n(18)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r}))?function(e,t){for(var n=s(e),u=arguments.length,l=1,f=o.f,h=a.f;u>l;)for(var d,p=c(arguments[l++]),m=f?i(p).concat(f(p)):i(p),y=m.length,g=0;y>g;)d=m[g++],r&&!h.call(p,d)||(n[d]=p[d]);return n}:u},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){"use strict";var r=n(76),i=n(20),o=n(222),a=[].slice,s={},c=function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),s=function(){var r=n.concat(a.call(arguments));return this instanceof s?c(t,r.length,r):o(t,r,e)};return i(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(17).parseInt,i=n(113).trim,o=n(174),a=/^[-+]?0[xX]/;e.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(a.test(n)?16:10))}:r},function(e,t,n){var r=n(17).parseFloat,i=n(113).trim;e.exports=1/r(n(174)+"-0")!=-1/0?function(e){var t=i(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},function(e,t,n){var r=n(87);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},function(e,t,n){var r=n(20),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){"use strict";var r=n(100),i=n(95),o=n(112),a={};n(61)(a,n(25)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(19);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(404);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(76),i=n(46),o=n(133),a=n(29);e.exports=function(e,t,n,s,c){r(t);var u=i(e),l=o(u),f=a(u.length),h=c?f-1:0,d=c?-1:1;if(n<2)for(;;){if(h in l){s=l[h],h+=d;break}if(h+=d,c?h<0:f<=h)throw TypeError("Reduce of empty array with no initial value")}for(;c?h>=0:f>h;h+=d)h in l&&(s=t(s,l[h],h,u));return s}},function(e,t,n){"use strict";var r=n(46),i=n(99),o=n(29);e.exports=[].copyWithin||function(e,t){var n=r(this),a=o(n.length),s=i(e,a),c=i(t,a),u=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===u?a:i(u,a))-c,a-s),f=1;for(c<s&&s<c+l&&(f=-1,c+=l-1,s+=l-1);l-- >0;)c in n?n[s]=n[c]:delete n[s],s+=f,c+=f;return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(189);n(6)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){n(36)&&"g"!=/./g.flags&&n(37).f(RegExp.prototype,"flags",{configurable:!0,get:n(145)})},function(e,t,n){"use strict";var r,i,o,a,s=n(97),c=n(17),u=n(75),l=n(135),f=n(6),h=n(20),d=n(76),p=n(116),m=n(148),y=n(136),g=n(191).set,b=n(424)(),v=n(237),w=n(425),_=n(149),k=n(238),E="Promise",O=c.TypeError,T=c.process,x=T&&T.versions,S=x&&x.v8||"",C=c.Promise,R="process"==l(T),P=function(){},N=i=v.f,M=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[n(25)("species")]=function(e){e(P,P)};return(R||"function"==typeof PromiseRejectionEvent)&&e.then(P)instanceof t&&0!==S.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(e){}}(),A=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},j=function(e,t){if(!e._n){e._n=!0;var n=e._c;b((function(){for(var r=e._v,i=1==e._s,o=0,a=function(t){var n,o,a,s=i?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{s?(i||(2==e._h&&L(e),e._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),a=!0)),n===t.promise?u(O("Promise-chain cycle")):(o=A(n))?o.call(n,c,u):c(n)):u(r)}catch(e){l&&!a&&l.exit(),u(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&I(e)}))}},I=function(e){g.call(c,(function(){var t,n,r,i=e._v,o=D(e);if(o&&(t=w((function(){R?T.emit("unhandledRejection",i,e):(n=c.onunhandledrejection)?n({promise:e,reason:i}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=R||D(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},D=function(e){return 1!==e._h&&0===(e._a||e._c).length},L=function(e){g.call(c,(function(){var t;R?T.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},B=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),j(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw O("Promise can't be resolved itself");(t=A(e))?b((function(){var r={_w:n,_d:!1};try{t.call(e,u(F,r,1),u(B,r,1))}catch(e){B.call(r,e)}})):(n._v=e,n._s=1,j(n,!1))}catch(e){B.call({_w:n,_d:!1},e)}}};M||(C=function(e){p(this,C,E,"_h"),d(e),r.call(this);try{e(u(F,this,1),u(B,this,1))}catch(e){B.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(117)(C.prototype,{then:function(e,t){var n=N(y(this,C));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=R?T.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&j(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=u(F,e,1),this.reject=u(B,e,1)},v.f=N=function(e){return e===C||e===a?new o(e):i(e)}),f(f.G+f.W+f.F*!M,{Promise:C}),n(112)(C,E),n(115)(E),a=n(33).Promise,f(f.S+f.F*!M,E,{reject:function(e){var t=N(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(s||!M),E,{resolve:function(e){return k(s&&this===a?C:this,e)}}),f(f.S+f.F*!(M&&n(144)((function(e){C.all(e).catch(P)}))),E,{all:function(e){var t=this,n=N(t),r=n.resolve,i=n.reject,o=w((function(){var n=[],o=0,a=1;m(e,!1,(function(e){var s=o++,c=!1;n.push(void 0),a++,t.resolve(e).then((function(e){c||(c=!0,n[s]=e,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=N(t),r=n.reject,i=w((function(){m(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t,n){"use strict";var r=n(76);function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},function(e,t,n){var r=n(19),i=n(20),o=n(237);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(37).f,i=n(100),o=n(117),a=n(75),s=n(116),c=n(148),u=n(180),l=n(233),f=n(115),h=n(36),d=n(92).fastKey,p=n(104),m=h?"_s":"size",y=function(e,t){var n,r=d(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,u){var l=e((function(e,r){s(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[m]=0,null!=r&&c(r,n,e[u],e)}));return o(l.prototype,{clear:function(){for(var e=p(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var n=p(this,t),r=y(n,e);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[m]--}return!!r},forEach:function(e){p(this,t);for(var n,r=a(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!y(p(this,t),e)}}),h&&r(l.prototype,"size",{get:function(){return p(this,t)[m]}}),l},def:function(e,t,n){var r,i,o=y(e,t);return o?o.v=n:(e._l=o={i:i=d(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[m]++,"F"!==i&&(e._i[i]=o)),e},getEntry:y,setStrong:function(e,t,n){u(e,t,(function(e,n){this._t=p(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?l(0,"keys"==t?n.k:"values"==t?n.v:[n.k,n.v]):(e._t=void 0,l(1))}),n?"entries":"values",!n,!0),f(t)}}},function(e,t,n){"use strict";var r=n(117),i=n(92).getWeak,o=n(19),a=n(20),s=n(116),c=n(148),u=n(80),l=n(60),f=n(104),h=u(5),d=u(6),p=0,m=function(e){return e._l||(e._l=new y)},y=function(){this.a=[]},g=function(e,t){return h(e.a,(function(e){return e[0]===t}))};y.prototype={get:function(e){var t=g(this,e);if(t)return t[1]},has:function(e){return!!g(this,e)},set:function(e,t){var n=g(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=d(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var u=e((function(e,r){s(e,u,t,"_i"),e._t=t,e._i=p++,e._l=void 0,null!=r&&c(r,n,e[o],e)}));return r(u.prototype,{delete:function(e){if(!a(e))return!1;var n=i(e);return!0===n?m(f(this,t)).delete(e):n&&l(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=i(e);return!0===n?m(f(this,t)).has(e):n&&l(n,this._i)}}),u},def:function(e,t,n){var r=i(o(t),!0);return!0===r?m(e).set(t,n):r[e._i]=n,e},ufstore:m}},function(e,t,n){var r=n(77),i=n(29);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=i(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){var r=n(101),i=n(142),o=n(19),a=n(17).Reflect;e.exports=a&&a.ownKeys||function(e){var t=r.f(o(e)),n=i.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(29),i=n(176),o=n(88);e.exports=function(e,t,n,a){var s=String(o(e)),c=s.length,u=void 0===n?" ":String(n),l=r(t);if(l<=c||""==u)return s;var f=l-c,h=i.call(u,Math.ceil(f/u.length));return h.length>f&&(h=h.slice(0,f)),a?h+s:s+h}},function(e,t,n){var r=n(36),i=n(98),o=n(62),a=n(134).f;e.exports=function(e){return function(t){for(var n,s=o(t),c=i(s),u=c.length,l=0,f=[];u>l;)n=c[l++],r&&!a.call(s,n)||f.push(e?[n,s[n]]:s[n]);return f}}},function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Translator=void 0;var o=n(7),a=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{translations:{},fallbackLanguage:"en",markUntranslatedTranslations:!0,markTranslations:!1,logMissingTranslations:!0};r(this,e),this._dynamicKey=0,this._translations={},this.addDynamicTranslations(e._translations),this.addDynamicTranslations(n.translations),this._fallbackLanguage=n.fallbackLanguage,this._markUntranslatedTranslations=n.markUntranslatedTranslations,this._markTranslations=n.markTranslations,!0===n.logMissingTranslations?this._logMissingTranslationsFunction=function(e,n){n===t._fallbackLanguage?console.error("missing base translation for key "+e):console.warn("missing translation for language >"+n+"< and key >"+e+"<")}:"function"==typeof n.logMissingTranslations?this._logMissingTranslationsFunction=n.logMissingTranslations:this._logMissingTranslationsFunction=null,this._translationCallbacks=new Map,this._lastTranslationCallbackId=0}var t,n,a;return t=e,a=[{key:"translate",value:function(t,n,r){var i=e.getInstance();return i?i.translate(t,n,r):""}},{key:"addDynamicTranslations",value:function(t){var n=e.getInstance();if(n)return n.addDynamicTranslations(t);Object.keys(t).forEach((function(n){o.Helper.isNull(e._translations[n])&&(e._translations[n]={}),Object.assign(e._translations[n],t[n])}))}},{key:"init",value:function(t){e.instance=new e(t)}},{key:"getInstance",value:function(){return e.instance}},{key:"_isValid",value:function(e){return"string"==typeof e}},{key:"_format",value:function(e,t){return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}}],(n=[{key:"createDynamicKey",value:function(){return this._dynamicKey++,"translator-dynamic-"+(new Date).getTime()+"-"+this._dynamicKey}},{key:"translate",value:function(t,n,r){if(o.Helper.isNull(t))return"";r=o.Helper.nonNull(r,n,this._fallbackLanguage);var i=null;return t=t.toLowerCase(),o.Helper.isNotNull(this._translations[r])&&o.Helper.isNotNull(this._translations[r][t])&&(i=this._translations[r][t]),e._isValid(i)||(null!==this._logMissingTranslationsFunction&&this._logMissingTranslationsFunction(t,r),this._translations[this._fallbackLanguage]&&(i=this._translations[this._fallbackLanguage][t]),e._isValid(i)||(null!==this._logMissingTranslationsFunction&&this._logMissingTranslationsFunction(t,r),i=t),this._markUntranslatedTranslations&&(i="&gt;&gt;"+i+"&lt;&lt;")),this._markTranslations&&(i="$"+i+"$"),void 0!==n&&(i=e._format(i,n)),i}},{key:"addDynamicTranslations",value:function(e){for(var t in e)for(var n in this._translations[t]||(this._translations[t]={}),e[t])this._translations[t][n.toLowerCase()]=e[t][n]}},{key:"getLanguages",value:function(){return Object.keys(this._translations)}},{key:"getFallbackLanguage",value:function(){return this._fallbackLanguage}}])&&i(t.prototype,n),a&&i(t,a),e}();t.Translator=a,a._translations={},a.instance=null},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,f=-1;function h(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&d())}function d(){if(!l){var e=s(h);l=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){var r=n(118),i=n(119),o=n(105).Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=new Array(64);function c(){this.init(),this._w=s,i.call(this,64,56)}function u(e,t,n){return n^e&(t^n)}function l(e,t,n){return e&t|n&(e|t)}function f(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function h(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function d(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}r(c,i),c.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},c.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,c=0|this._e,p=0|this._f,m=0|this._g,y=0|this._h,g=0;g<16;++g)n[g]=e.readInt32BE(4*g);for(;g<64;++g)n[g]=0|(((t=n[g-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[g-7]+d(n[g-15])+n[g-16];for(var b=0;b<64;++b){var v=y+h(c)+u(c,p,m)+a[b]+n[b]|0,w=f(r)+l(r,i,o)|0;y=m,m=p,p=c,c=s+v|0,s=o,o=i,i=r,r=v+w|0}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=c+this._e|0,this._f=p+this._f|0,this._g=m+this._g|0,this._h=y+this._h|0},c.prototype._hash=function(){var e=o.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=c},function(e,t,n){var r=n(118),i=n(119),o=n(105).Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],s=new Array(160);function c(){this.init(),this._w=s,i.call(this,128,112)}function u(e,t,n){return n^e&(t^n)}function l(e,t,n){return e&t|n&(e|t)}function f(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function h(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function d(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function m(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function y(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function g(e,t){return e>>>0<t>>>0?1:0}r(c,i),c.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},c.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,o=0|this._dh,s=0|this._eh,c=0|this._fh,b=0|this._gh,v=0|this._hh,w=0|this._al,_=0|this._bl,k=0|this._cl,E=0|this._dl,O=0|this._el,T=0|this._fl,x=0|this._gl,S=0|this._hl,C=0;C<32;C+=2)t[C]=e.readInt32BE(4*C),t[C+1]=e.readInt32BE(4*C+4);for(;C<160;C+=2){var R=t[C-30],P=t[C-30+1],N=d(R,P),M=p(P,R),A=m(R=t[C-4],P=t[C-4+1]),j=y(P,R),I=t[C-14],D=t[C-14+1],L=t[C-32],B=t[C-32+1],F=M+D|0,q=N+I+g(F,M)|0;q=(q=q+A+g(F=F+j|0,j)|0)+L+g(F=F+B|0,B)|0,t[C]=q,t[C+1]=F}for(var V=0;V<160;V+=2){q=t[V],F=t[V+1];var U=l(n,r,i),H=l(w,_,k),z=f(n,w),W=f(w,n),Y=h(s,O),Q=h(O,s),G=a[V],J=a[V+1],K=u(s,c,b),$=u(O,T,x),X=S+Q|0,Z=v+Y+g(X,S)|0;Z=(Z=(Z=Z+K+g(X=X+$|0,$)|0)+G+g(X=X+J|0,J)|0)+q+g(X=X+F|0,F)|0;var ee=W+H|0,te=z+U+g(ee,W)|0;v=b,S=x,b=c,x=T,c=s,T=O,s=o+Z+g(O=E+X|0,E)|0,o=i,E=k,i=r,k=_,r=n,_=w,n=Z+te+g(w=X+ee|0,X)|0}this._al=this._al+w|0,this._bl=this._bl+_|0,this._cl=this._cl+k|0,this._dl=this._dl+E|0,this._el=this._el+O|0,this._fl=this._fl+T|0,this._gl=this._gl+x|0,this._hl=this._hl+S|0,this._ah=this._ah+n+g(this._al,w)|0,this._bh=this._bh+r+g(this._bl,_)|0,this._ch=this._ch+i+g(this._cl,k)|0,this._dh=this._dh+o+g(this._dl,E)|0,this._eh=this._eh+s+g(this._el,O)|0,this._fh=this._fh+c+g(this._fl,T)|0,this._gh=this._gh+b+g(this._gl,x)|0,this._hh=this._hh+v+g(this._hl,S)|0},c.prototype._hash=function(){var e=o.allocUnsafe(64);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=c},function(e,t,n){"use strict";n.r(t),n.d(t,"SoftDeleteQueryBuilder",(function(){return y}));var r=n(0),i=n(1),o=n(49),a=n(125),s=n(84),c=n(130),u=n(50),l=n(12),f=n(21),h=n(123),d=n(157),p=n(108),m=n(86),y=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.expressionMap.aliasNamePrefixingEnabled=!1,r}return Object(r.c)(t,e),t.prototype.getQuery=function(){var e=this.createUpdateExpression();return e+=this.createOrderByExpression(),(e+=this.createLimitExpression()).trim()},t.prototype.execute=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,o,s,f,h,d,p,m;return Object(r.d)(this,(function(y){switch(y.label){case 0:e=this.obtainQueryRunner(),t=!1,y.label=1;case 1:return y.trys.push([1,13,18,23]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:y.sent(),t=!0,y.label=3;case 3:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(p=new l.a,e.broadcaster.broadcastBeforeUpdateEvent(p,this.expressionMap.mainAlias.metadata),p.promises.length>0?[4,Promise.all(p.promises)]:[3,5]):[3,5];case 4:y.sent(),y.label=5;case 5:return n=new c.a(e,this.expressionMap),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=n.getUpdationReturningColumns()),o=Object(r.e)(this.getQueryAndParameters(),2),s=o[0],f=o[1],h=new a.a,[4,e.query(s,f)];case 6:return d=y.sent(),e.connection.driver instanceof i.k?(h.raw=d[0],h.affected=d[1]):h.raw=d,!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0?[4,n.update(h,this.expressionMap.whereEntities)]:[3,8];case 7:y.sent(),y.label=8;case 8:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(p=new l.a,e.broadcaster.broadcastAfterUpdateEvent(p,this.expressionMap.mainAlias.metadata),p.promises.length>0?[4,Promise.all(p.promises)]:[3,10]):[3,10];case 9:y.sent(),y.label=10;case 10:return t?[4,e.commitTransaction()]:[3,12];case 11:y.sent(),y.label=12;case 12:return[2,h];case 13:if(m=y.sent(),!t)return[3,17];y.label=14;case 14:return y.trys.push([14,16,,17]),[4,e.rollbackTransaction()];case 15:return y.sent(),[3,17];case 16:return y.sent(),[3,17];case 17:throw m;case 18:return e===this.queryRunner?[3,20]:[4,e.release()];case 19:y.sent(),y.label=20;case 20:return this.connection.driver instanceof u.a&&!e.isTransactionActive?[4,this.connection.driver.autoSave()]:[3,22];case 21:y.sent(),y.label=22;case 22:return[7];case 23:return[2]}}))}))},t.prototype.from=function(e,t){e=e instanceof m.a?e.options.name:e;var n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this},t.prototype.where=function(e,t){this.expressionMap.wheres=[];var n=this.computeWhereParameter(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this},t.prototype.andWhere=function(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.computeWhereParameter(e)}),t&&this.setParameters(t),this},t.prototype.orWhere=function(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.computeWhereParameter(e)}),t&&this.setParameters(t),this},t.prototype.whereInIds=function(e){return this.where(this.createWhereIdsExpression(e))},t.prototype.andWhereInIds=function(e){return this.andWhere(this.createWhereIdsExpression(e))},t.prototype.orWhereInIds=function(e){return this.orWhere(this.createWhereIdsExpression(e))},t.prototype.output=function(e){return this.returning(e)},t.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new s.a;return this.expressionMap.returning=e,this},t.prototype.orderBy=function(e,t,n){var r,i;return void 0===t&&(t="ASC"),this.expressionMap.orderBys=e?e instanceof Object?e:n?((r={})[e]={order:t,nulls:n},r):((i={})[e]=t,i):{},this},t.prototype.addOrderBy=function(e,t,n){return void 0===t&&(t="ASC"),this.expressionMap.orderBys[e]=n?{order:t,nulls:n}:t,this},t.prototype.limit=function(e){return this.expressionMap.limit=e,this},t.prototype.whereEntity=function(e){var t=this;if(!this.expressionMap.mainAlias.hasMetadata)throw new Error(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];var n=Array.isArray(e)?e:[e];return n.forEach((function(e){var n=t.expressionMap.mainAlias.metadata.getEntityIdMap(e);if(!n)throw new Error("Provided entity does not have ids set, cannot perform operation.");t.orWhereInIds(n)})),this.expressionMap.whereEntities=n,this},t.prototype.updateEntity=function(e){return this.expressionMap.updateEntity=e,this},t.prototype.createUpdateExpression=function(){var e=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!e)throw new Error('Cannot get entity metadata for the given alias "'+this.expressionMap.mainAlias+'"');if(!e.deleteDateColumn)throw new d.a(e);var t=[];switch(this.expressionMap.queryType){case"soft-delete":t.push(this.escape(e.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":t.push(this.escape(e.deleteDateColumn.databaseName)+" = NULL");break;default:throw new Error('The queryType must be "soft-delete" or "restore"')}if(e.versionColumn&&t.push(this.escape(e.versionColumn.databaseName)+" = "+this.escape(e.versionColumn.databaseName)+" + 1"),e.updateDateColumn&&t.push(this.escape(e.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),t.length<=0)throw new p.a;(this.connection.driver instanceof i.i||this.connection.driver instanceof i.j||this.connection.driver instanceof f.a)&&(this.expressionMap.nativeParameters=Object.assign({},this.expressionMap.nativeParameters));var n=this.createWhereExpression(),r=this.createReturningExpression();return r&&(this.connection.driver instanceof i.k||this.connection.driver instanceof i.j||this.connection.driver instanceof i.d)?"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+t.join(", ")+n+" RETURNING "+r:r&&this.connection.driver instanceof i.m?"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+t.join(", ")+" OUTPUT "+r+n:"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+t.join(", ")+n},t.prototype.createOrderByExpression=function(){var e=this,t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map((function(n){return"string"==typeof t[n]?e.replacePropertyNames(n)+" "+t[n]:e.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls})).join(", "):""},t.prototype.createLimitExpression=function(){var e=this.expressionMap.limit;if(e){if(this.connection.driver instanceof i.i)return" LIMIT "+e;throw new h.a}return""},t}(o.a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XSSHelper=void 0;t.XSSHelper=class{static escapeHTML(e){if("string"!=typeof e)return e;const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,(function(e){return t[e]}))}static escapeJS(e){return"string"!=typeof e?e:e.replace(/[<]([\\s]*\\\/?[\\s]*)script([^<]*)[>]/g,(function(e,t,n){return"&lt;"+t+"sc&zwnj;ript"+n+"&gt;"}))}}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SiteManager=void 0;var o=n(22),a=n(152),s=n(43),c=n(120),u=n(31),l=n(63),f=n(256),h=n(200),d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._isInit=!1}var t,n,d;return t=e,d=[{key:"getInstance",value:function(){return this._instance||(this._instance=new e),this._instance}}],(n=[{key:"init",value:function(e,t){var n=this;this._siteDiv=null,this._siteStack=[],this._siteDiv=document.getElementById(e),this._titleTranslationCallbackId=null,this._appEndedListener=null,this._inversedDeepLinks=o.Helper.invertKeyValues(t),f.HistoryManager.getInstance().setOnPopStateListener((function(e,t){t===f.HistoryManager.BACK?n.goBack():f.HistoryManager.FORWARD===t&&(-1!==n._siteStack.indexOf(e.state.site)?n.toForeground(e.state.site):n.startSite(e.state.site.constructor,e.state.parameters))})),document.addEventListener("pause",(function(){return n._pauseSite()}),!1),document.addEventListener("resume",(function(){return i(n,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._resumeSite();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}),!1),document.addEventListener("menubutton",(function(){var e=n.getCurrentSite();o.Helper.isNotNull(e)&&e.onMenuPressed()}),!1),document.addEventListener("searchbutton",(function(){var e=n.getCurrentSite();o.Helper.isNotNull(e)&&e.onSearchPressed()}),!1),window.addEventListener("beforeunload",(function(e){var t=n.beforeUnload(e);if(null!==t)return e.preventDefault(),e.returnValue=t,t})),this._isInit=!0}},{key:"setAppEndedListener",value:function(e){this._appEndedListener=e}},{key:"goBack",value:function(){if(this._siteStack.length>=1){var e=this.getCurrentSite();e&&!1!==e.onBackPressed()&&this.endSite(e)}}},{key:"getCurrentSite",value:function(){return this._siteStack.length>=1?this._siteStack[this._siteStack.length-1]:null}},{key:"startSite",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,u,l=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.prototype instanceof a.AbstractSite){n.next=2;break}throw{error:"wrong class given! Expected AbstractSite, given "+e.name};case 2:return h.EventManager.trigger("site-manager-start-site",{site:e,paramPromise:t}),r=s.ViewInflater.createLoadingSymbol("overlay"),this._siteDiv.appendChild(r),u=new e(this),this._siteStack.unshift(u),Promise.resolve(t).then((function(e){return i(l,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u._onConstructPromise=u.onConstruct(o.Helper.nonNull(e,{})),t.next=3,Promise.all([u._onConstructPromise,u.getViewPromise()]);case 3:if(u._state===c.Context.STATE_DESTROYED||u._state===c.Context.STATE_DESTROYING){t.next=8;break}return t.next=6,u.callOnViewLoaded();case 6:return u._viewLoadedPromise.resolve(),t.abrupt("return",this._show(u));case 8:r.remove();case 9:case"end":return t.stop()}}),t,this)})))})).catch((function(t){console.error("site start error for site ",e.name,t),u.getFinishResolver().reject(t),r.remove();for(var n=l._siteStack.length-1;n>=0;n--)if(l._siteStack[n]!==u)return l._show(l._siteStack[n]);u._viewLoadedPromise.reject()})),n.abrupt("return",u.getFinishPromise());case 9:case"end":return n.stop()}}),n,this)})))}},{key:"updateUrl",value:function(e,t){var n=this._generateUrl(e,t);f.HistoryManager.getInstance().replaceState({site:e,parameters:t},e.constructor.name,n)}},{key:"_generateUrl",value:function(e,t){var n=this.getDeepLinkFor(e),r=[location.protocol,"//",location.host,location.pathname].join("");return o.Helper.isNotNull(n)&&(t.s=n,r=[r,l.DataManager.buildQuery(t)].join("")),r}},{key:"getDeepLinkFor",value:function(e){return this._inversedDeepLinks[e.constructor]}},{key:"_pauseSite",value:function(e){e=o.Helper.nonNull(e,this.getCurrentSite()),o.Helper.isNotNull(e)&&e._state===c.Context.STATE_RUNNING&&(e._pauseParameters=e.onPause(),o.Helper.removeAllChildren(this._siteDiv).appendChild(s.ViewInflater.createLoadingSymbol()))}},{key:"_resumeSite",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=o.Helper.nonNull(e,this.getCurrentSite()),!o.Helper.isNotNull(e)||e._state!==c.Context.STATE_PAUSED&&e._state!==c.Context.STATE_VIEW_LOADED){t.next=10;break}return t.next=4,e.getViewPromise();case 4:return o.Helper.removeAllChildren(this._siteDiv).appendChild(e._view),t.next=7,u.Translator.getInstance().updateTranslations();case 7:return o.Helper.isNull(e._historyId)?e._historyId=f.HistoryManager.getInstance().pushState({site:e,parameters:e.getParameters()},e.constructor.name,this._generateUrl(e,e.getParameters())):f.HistoryManager.getInstance().stateToCurrentPosition(e._historyId),t.next=10,e.onStart(e._pauseParameters);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"_show",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._state!==c.Context.STATE_DESTROYING&&e._state!==c.Context.STATE_DESTROYED){t.next=2;break}return t.abrupt("return");case 2:if(e._state!==c.Context.STATE_RUNNING||this.getCurrentSite()!==e){t.next=4;break}return t.abrupt("return");case 4:return this._pauseSite(),o.Helper.removeAllChildren(this._siteDiv).appendChild(s.ViewInflater.createLoadingSymbol()),-1!==(n=this._siteStack.indexOf(e))&&this._siteStack.splice(n,1),this._siteStack.push(e),t.abrupt("return",e.getViewPromise().then((function(){return i(r,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.getCurrentSite()!==e){t.next=3;break}return t.next=3,this._resumeSite(e);case 3:case"end":return t.stop()}}),t,this)})))})));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"endSite",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._siteStack.indexOf(e),this._siteStack.splice(n,1),n===this._siteStack.length&&(this._pauseSite(e),this._siteDiv.appendChild(s.ViewInflater.createLoadingSymbol("overlay")),e.getFinishPromise().then((function(){var e=r.getCurrentSite();o.Helper.isNotNull(e)&&r.toForeground(e)}))),this._siteStack.length<=0&&(console.log("stack is empty, starting normal site!"),f.HistoryManager.getInstance().cutStack(0),f.HistoryManager.getInstance().go(-1*history.length,!0),o.Helper.removeAllChildren(this._siteDiv).appendChild(document.createTextNode("App ist beendet")),"function"==typeof this._appEndedListener&&this._appEndedListener(this)),e._context=c.Context.STATE_DESTROYING,t.next=7,e.onDestroy();case 7:e._context=c.Context.STATE_DESTROYED,e.getFinishResolver().resolve(e._result);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"toForeground",value:function(e){return this._show(e)}},{key:"updateTitle",value:function(e,t,n){n=o.Helper.nonNull(n,o.Helper.isNull(e)?"document-title-empty":"document-title"),o.Helper.isNotNull(this._titleTranslationCallbackId)&&u.Translator.removeTranslationCallback(this._titleTranslationCallbackId),this._titleTranslationCallbackId=u.Translator.addTranslationCallback((function(){!1!==t&&(e=u.Translator.translate(e,t)),document.title=u.Translator.translate(n,[e])}))}},{key:"beforeUnload",value:function(e){return this.getCurrentSite().onBeforeUnload(e)}}])&&r(t.prototype,n),d&&r(t,d),e}();t.SiteManager=d,d._instance=null},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DraggedElement=void 0;t.DraggedElement=class{constructor(e){this.isDragging=!1,this.element=e}onStart(e){return this.startListener=e,this}onStop(e){return this.stopListener=e,this}onMove(e){return this.moveListener=e,this}start(){if(this.isDragging=!0,!this.previewElement){this.previewElement=this.element.cloneNode(!0);const e=getComputedStyle(this.element);for(let t=0;t<e.length;t++)this.previewElement.style[e[t]]=e.getPropertyValue(e[t]);this.previewElement.style.opacity="0.6",this.previewElement.style.position="fixed"}const e=this.element.getBoundingClientRect();this.startPosition={x:e.left,y:e.top},this.previewElement.style.top=e.top+"px",this.previewElement.style.left=e.left+"px",this.previewElement.style.width=e.right-e.left+"px",this.previewElement.style.height=e.bottom-e.top+"px",document.body.appendChild(this.previewElement),this.startListener&&this.startListener(this.element)}stop(e){this.isDragging=!1,this.previewElement&&this.previewElement.remove();const t=document.elementFromPoint(e.x,e.y);this.stopListener&&this.stopListener(this.element,t)}moved(){this.isDragging&&this.moveListener&&this.moveListener(this.element)}moveRelativeTo(e){if(this.startPosition&&this.previewElement){const t={x:this.startPosition.x+e.x,y:this.startPosition.y+e.y};this.previewElement.style.left=t.x+"px",this.previewElement.style.top=t.y+"px",this.moved()}}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){var t="function"==typeof Map?new Map:void 0;return(o=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return a(e,arguments,u(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,e)})(e)}function a(e,t,n){return(a=s()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&c(i,n.prototype),i}).apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.NotOnlineError=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(o,e);var t,n,r=(t=o,n=s(),function(){var e,r=u(t);if(n){var o=u(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return i(this,e)});function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e+" for url "+t))._url=t,n}return o}(o(Error));t.NotOnlineError=l},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryManager=void 0;var i=n(22),o=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._lastStateId=-1,this._states={},this._stack=[],this._ignoreOnPopState=!1,this._isUpdateNativeStack=!1,this._onPopStateListener=null,this._currentStackIndex=-1,window.onpopstate=function(e){if(t._isUpdateNativeStack)t._isUpdateNativeStack=!1;else{var n=e.state.type;if(t._currentStackIndex+=n,t._updateNativeHistoryStack(),t._ignoreOnPopState)t._ignoreOnPopState=!1;else if("function"==typeof t._onPopStateListener){var r={};t._stack.length>t._currentStackIndex&&t._currentStackIndex>=0&&(r=t._states[t._stack[t._currentStackIndex]]),t._onPopStateListener(r,n,e)}}},this._updateNativeHistoryStack()}var t,n,o;return t=e,o=[{key:"getInstance",value:function(){return i.Helper.isNull(e._instance)&&(e._instance=new e),e._instance}}],(n=[{key:"_updateNativeHistoryStack",value:function(t){t=i.Helper.nonNull(t,window.location.href),this._currentStackIndex>=0&&history.pushState({type:e.BACK},"back",t),history.pushState({type:e.CURRENT},"current",t),this._currentStackIndex<this._stack.length-1&&(history.pushState({type:e.FORWARD},"forward",t),this._isUpdateNativeStack=!0,history.go(-1))}},{key:"pushState",value:function(e,t,n){var r={state:e,title:t,url:n};return this._lastStateId++,this._states[this._lastStateId]=r,this._currentStackIndex++,this._stack.splice(this._currentStackIndex,this._stack.length,this._lastStateId),this._updateNativeHistoryStack(n),this._lastStateId}},{key:"replaceState",value:function(e,t,n,r){r=i.Helper.nonNull(r,this._stack[this._currentStackIndex]),this._stack.length>this._currentStackIndex&&this._currentStackIndex>=0&&(this._states[r]={state:e,title:t,url:n},this._updateNativeHistoryStack(n))}},{key:"stateToCurrentPosition",value:function(e){if(i.Helper.isNotNull(this._states[e])){var t=this._stack.indexOf(e);-1!==t&&(this._stack.splice(t,1),this._stack.splice(this._currentStackIndex+(t<=this._currentStackIndex?-1:0),0,e))}}},{key:"go",value:function(e,t){this._ignoreOnPopState=!0===i.Helper.nonNull(t,!1),history.go(e)}},{key:"cutStack",value:function(e){e=i.Helper.nonNull(e,this._currentStackIndex+1),this._stack.splice(e),this._currentStackIndex=Math.min(this._currentStackIndex,this._stack.length-1),this._updateNativeHistoryStack()}},{key:"back",value:function(){this.go(-1)}},{key:"forward",value:function(){this.go(1)}},{key:"setOnPopStateListener",value:function(e){this._onPopStateListener=e}}])&&r(t.prototype,n),o&&r(t,o),e}();t.HistoryManager=o,o.BACK=-1,o.FORWARD=1,o.CURRENT=0},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ColorIndicator=void 0;var l=n(126),f=n(22),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(l,e);var t,n,c,u=s(l);function l(){return i(this,l),u.apply(this,arguments)}return t=l,(n=[{key:"getAverageImgColor",value:function(e,t,n){var r,i,o,a,s={r:255,g:255,b:255},c=document.createElement("canvas"),u=c.getContext&&c.getContext("2d"),l=-20,h={r:0,g:0,b:0},d=0;if(!u)return s;o=c.height=e.naturalHeight||e.offsetHeight||e.height,i=c.width=e.naturalWidth||e.offsetWidth||e.width,t=f.Helper.nonNull(t,i),n=f.Helper.nonNull(t,o),u.drawImage(e,0,0);try{r=u.getImageData(0,0,Math.min(i,t),Math.min(o,n))}catch(e){return console.error(e),s}for(a=r.data.length;(l+=20)<a;)++d,h.r+=r.data[l],h.g+=r.data[l+1],h.b+=r.data[l+2];return h.r=~~(h.r/d),h.g=~~(h.g/d),h.b=~~(h.b/d),h}},{key:"invertColorBW",value:function(e,t,n){return this.invertColor(e,t,n,!0)}},{key:"invertColor",value:function(e,t,n,i){return"object"===r(e)&&(i=t||i,t=e.g,n=e.b,e=e.r),i?.299*e+.587*t+.114*n>186?{r:0,g:0,b:0}:{r:255,g:255,b:255}:{r:e=255-e,g:t=255-t,b:n=255-n}}},{key:"toHEX",value:function(e,t,n){return"object"===r(e)&&(t=e.g,n=e.b,e=e.r),e=e.toString(16),t=t.toString(16),n=n.toString(16),"#"+f.Helper.padZero(e)+f.Helper.padZero(t)+f.Helper.padZero(n)}}])&&o(t.prototype,n),c&&o(t,c),l}(l.Singleton);t.ColorIndicator=h},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MasterSite=void 0;var f=n(152),h=n(22),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,e,t))._delegates=[],n}return t=f,(n=[{key:"addDelegate",value:function(e){this._delegates.push(e)}},{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return o(u(f.prototype),"onConstruct",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.onConstruct.call(this,e),t.next=3,h.Helper.asyncForEach(this._delegates,(function(t){return l(i,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.onConstruct(e);case 2:case"end":return n.stop()}}),n)})))}));case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return o(u(f.prototype),"onStart",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.onStart.call(this,e);case 2:return t.next=4,h.Helper.asyncForEach(this._delegates,(function(t){return l(r,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.onStart(e);case 2:case"end":return n.stop()}}),n)})))}));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"onBackPressed",value:function(){o(u(f.prototype),"onBackPressed",this).call(this),this._delegates.forEach((function(e){e.onBackPressed()}))}},{key:"onMenuPressed",value:function(){o(u(f.prototype),"onMenuPressed",this).call(this),this._delegates.forEach((function(e){e.onMenuPressed()}))}},{key:"onSearchPressed",value:function(){o(u(f.prototype),"onSearchPressed",this).call(this),this._delegates.forEach((function(e){e.onSearchPressed()}))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(u(f.prototype),"onViewLoaded",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),e.next=3,h.Helper.asyncForEach(this._delegates,(function(e){return l(r,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onViewLoaded();case 2:case"end":return t.stop()}}),t)})))}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"onPause",value:function(){var e=this,t=Object.create(null,{onPause:{get:function(){return o(u(f.prototype),"onPause",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onPause.call(this);case 2:return e.next=4,h.Helper.asyncForEach(this._delegates,(function(e){return l(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onPause();case 2:case"end":return t.stop()}}),t)})))}));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"onDestroy",value:function(){var e=this,t=Object.create(null,{onDestroy:{get:function(){return o(u(f.prototype),"onDestroy",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onDestroy.call(this);case 2:return e.next=4,h.Helper.asyncForEach(this._delegates,(function(e){return l(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onDestroy();case 2:case"end":return t.stop()}}),t)})))}));case 4:case"end":return e.stop()}}),e,this)})))}}])&&i(t.prototype,n),r&&i(t,r),f}(f.AbstractSite);t.MasterSite=d},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DelegateSite=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,n,r,s=a(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,void 0,document.createElement("span")))._site=e,t}return t=c,(n=[{key:"setTitle",value:function(e,t){return this._site.setTitle(e,t)}},{key:"setParameter",value:function(e,t){}},{key:"setParameters",value:function(e){}},{key:"getParameters",value:function(){return this._site.getParameters()}},{key:"showLoadingSymbol",value:function(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._site.showLoadingSymbol());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"removeLoadingSymbol",value:function(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._site.removeLoadingSymbol());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"_updateTitle",value:function(){return this._site._updateTitle()}},{key:"updateUrl",value:function(e){}},{key:"startSite",value:function(e,t){return this._site.startSite(e,t)}},{key:"finishAndStartSite",value:function(e,t,n){return this._site.finishAndStartSite(e,t,n)}},{key:"finish",value:function(e){return this._site.finish(e)}},{key:"goBack",value:function(){return this._site.goBack()}},{key:"getFinishPromise",value:function(){return this._site.getFinishPromise()}},{key:"setResult",value:function(e){return this._site.setResult(e)}},{key:"getFinishResolver",value:function(){return this._site.getFinishResolver()}},{key:"addFragment",value:function(e,t){return this._site.addFragment(e,t)}},{key:"findBy",value:function(e,t,n){return this._site.findBy(e,t,n)}},{key:"setPauseParameters",value:function(e){return this._site.setPauseParameters(e)}},{key:"getViewPromise",value:function(){return this._site.getViewPromise()}},{key:"getState",value:function(){return this._site.getState()}},{key:"getTitle",value:function(){return this._site.getTitle()}},{key:"isShowing",value:function(){return this._site.isShowing()}},{key:"isDestroying",value:function(){return this._site.isDestroying()}}])&&i(t.prototype,n),r&&i(t,r),c}(n(152).AbstractSite);t.DelegateSite=l},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ToastManager=void 0;var o=n(22),a=n(31),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._toastContainer=document.querySelector(e._toastContainerSelector),this._toastTemplate=this._toastContainer.querySelector(".toast-template"),this._toastTemplate.classList.remove("toast-template"),this._toastTemplate.remove()}var t,n,s;return t=e,s=[{key:"setToastContainerSelector",value:function(t){e._toastContainerSelector=t}},{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}],(n=[{key:"showToast",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getMessage(),n=e.isShouldTranslate()?a.Translator.makePersistentTranslation(n,e.getTranslationArgs()):document.createTextNode(n),(r=this._toastTemplate.cloneNode(!0)).querySelector(".message").appendChild(n),e.setToastElement(r),this._toastContainer.appendChild(r),r.style.opacity=1,t.abrupt("return",new Promise((function(t){r.querySelector(".message").onclick=function(){i.hideToast(e),t(!0)},setTimeout((function(){i.hideToast(e),t(!1)}),e.getDuration())})));case 8:case"end":return t.stop()}}),t,this)})))}},{key:"hideToast",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.getToastElement(),!o.Helper.isNotNull(n)){t.next=4;break}return n.style.opacity=0,t.abrupt("return",new Promise((function(e){setTimeout((function(){n.remove(),e()}),250)})));case 4:return t.abrupt("return",Promise.reject("toast is not showing"));case 5:case"end":return t.stop()}}),t)})))}}])&&r(t.prototype,n),s&&r(t,s),e}();t.ToastManager=s,s._instance=null,s._toastContainerSelector="#toast-container"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NavbarFragment=void 0;var f=n(68),h=n(525),d=n(121),p=n(22),m=n(120),y=n(204),g=n(107),b=n(262),v=n(205),w=n(257),_=n(38),k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(k,e);var t,n,c,f=s(k);function k(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,k),(n=f.call(this,e,p.Helper.nonNull(t,h)))._menu=null,n._responsiveMenu=null,n._backgroundImage="",n._menuActions=[],k.defaultActions.forEach((function(e){n._menuActions.push(e.copy())})),n._scrollWidget=null,n._canGoBack=!0,n._logo=_.App.getLogo(),n}return t=k,c=[{key:"_getCurrentSize",value:function(){for(var e,t=k._getViewQueries(),n=0;n<t.length;n++){var i=t[n];matchMedia(i._value).matches&&(e=i)}return"object"===r(e)?e._name:e}},{key:"_getViewQueries",value:function(){return 0===k.queries.length&&(k.queries=k._calculateViewQueries()),k.queries}},{key:"_calculateViewQueries",value:function(){var e=document.getElementsByClassName("foundation-mq");if(0!==e.length){var t,n,r=[],i=(t=window.getComputedStyle(e[0]).getPropertyValue("font-family"),n={},"string"!=typeof t?n:(t=t.trim().slice(1,-1))?n=t.split("&").reduce((function(e,t){var n=t.replace(/\+/g," ").split("="),r=n[0],i=n[1];return r=decodeURIComponent(r),i=void 0===i?null:decodeURIComponent(i),e.hasOwnProperty(r)?Array.isArray(e[r])?e[r].push(i):e[r]=[e[r],i]:e[r]=i,e}),{}):n);for(var o in i)i.hasOwnProperty(o)&&r.push({_name:o,_value:"only screen and (min-width: "+i[o]+")"});return r}}},{key:"setOnLogoClickListener",value:function(e){this.onLogoClickListener=e}}],(n=[{key:"setLogo",value:function(e){this._logo=e,this._view&&(p.Helper.isNotNull(this._logo)?(this.findBy(".logo").classList.remove("hidden"),this.findBy(".logo-img").src=this._logo):this.findBy(".logo").classList.add("hidden"))}},{key:"setCanGoBack",value:function(e){this._canGoBack=e,this._view&&(this._canGoBack?this.findBy(".back-button").classList.remove("hidden"):this.findBy(".back-button").classList.add("hidden"))}},{key:"setScrollWidget",value:function(e){var t=this;if(this._scrollWidget=e,this._view&&this._scrollWidget){var n=this.findBy(".top-bar > span"),r=this.findBy(".background-img"),i=function(){var e=t.findBy("nav.top-bar");n.getBoundingClientRect().bottom>=r.getBoundingClientRect().bottom?e.classList.add("solid"):e.classList.remove("solid")};r.addEventListener("load",i),e.addEventListener("scroll",i),requestAnimationFrame(i)}}},{key:"setBackgroundImage",value:function(e){var t=this;if(this._backgroundImage=e,this._view){var n=this.findBy("nav.top-bar");if(p.Helper.isNotNull(this._backgroundImage)){var r=this.findBy(".background-img"),i=w.ColorIndicator.getInstance();r.addEventListener("load",(function(){if(""!==t._backgroundImage){var e=i.getAverageImgColor(r,void 0,150),o=i.invertColorBW(e);0===o.r&&0===o.g&&0===o.b?(n.classList.remove("color-white"),n.classList.add("color-black")):(n.classList.remove("color-black"),n.classList.add("color-white"))}else n.classList.remove("color-black"),n.classList.remove("color-white")})),requestAnimationFrame((function(){var e=n.querySelector(".grid-container");n.style="min-height:"+e.getBoundingClientRect().height+"px","ResizeObserver"in window&&new ResizeObserver((function(e){e.forEach((function(e){e.borderBoxSize?n.style="min-height:"+e.borderBoxSize[0].blockSize+"px":e.contentRect?n.style="min-height:"+e.contentRect.height+"px":console.log("entry",e)}))})).observe(e),setTimeout((function(){n.style="min-height:"+e.getBoundingClientRect().height+"px"}),500),setTimeout((function(){n.style="min-height:"+e.getBoundingClientRect().height+"px"}),1e3),setTimeout((function(){n.style="min-height:"+e.getBoundingClientRect().height+"px"}),1500)})),r.src=this._backgroundImage,n.classList.add("with-image")}else n.classList.remove("with-image")}}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(u(k.prototype),"onViewLoaded",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,o,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this.setTitleElement(document.createTextNode(k.title)),(r=[]).push(new b.DropdownRenderer(this.findBy("#navbar-menu-visible"))),r.push(new v.AccordionRenderer(this.findBy("#navbar-menu-hidden"))),this._menu=new y.Menu(r,this._menuActions),this._closeListenerContainer=this.findBy("#navbar-close-listener-container"),this._menu.setOpenSubmenuListener((function(){a._showCloseListener()})),i=this._menu.getOnClickListener(),this._menu.setOnClickListener((function(e){i(e)instanceof g.OpenSubmenuAction||a.closeMenu()})),this._responsiveMenu=this.findBy("#responsive-menu"),this.findBy("#responsive-menu-toggle").onclick=function(){a._responsiveMenu.classList.contains("visible")?a.closeMenu():a.openMenu()},o=this,this.findBy("#navbar-close-listener").addEventListener("click",(function(e){e.target===this&&o.closeMenu()})),window.addEventListener("resize",(function(){a._state===m.Context.STATE_RUNNING&&a.updateToggleButton()})),this.drawMenu(),this.findBy(".back-button").addEventListener("click",(function(){a.goBack()})),this.findBy(".logo").addEventListener("click",(function(){k.onLogoClickListener&&k.onLogoClickListener(a.getSite())})),this.setCanGoBack(this._canGoBack),this.setBackgroundImage(this._backgroundImage),this.setScrollWidget(this._scrollWidget),this.setLogo(this._logo),e.abrupt("return",n);case 23:case"end":return e.stop()}}),e,this)})))}},{key:"goBack",value:function(){this._canGoBack&&this.getSite().goBack()}},{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return o(u(k.prototype),"onStart",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.onStart.call(this,e),this.updateToggleButton();case 2:case"end":return t.stop()}}),t,this)})))}},{key:"_showCloseListener",value:function(){this._closeListenerContainer&&(this._closeListenerContainer.style.display="block")}},{key:"closeMenu",value:function(){p.Helper.isNotNull(this._responsiveMenu)&&(this._responsiveMenu.classList.remove("visible"),this._view.classList.remove("navbar-is-open")),this._closeListenerContainer&&(this._closeListenerContainer.style.display="none"),this._menu&&this._menu.close()}},{key:"openMenu",value:function(){p.Helper.isNotNull(this._responsiveMenu)&&(this._responsiveMenu.classList.add("visible"),this._view.classList.add("navbar-is-open")),this._showCloseListener()}},{key:"drawMenu",value:function(){p.Helper.isNotNull(this._menu)&&this._menu.draw()}},{key:"updateToggleButton",value:function(){var e=k._getCurrentSize(),t=this.findBy("#navbar-menu-visible");("medium"===e||"smedium"===e||"small"===e)&&t.querySelectorAll("."+d.MenuAction.SHOW_FOR_LARGE+":not(.hidden)").length>0||("smedium"===e||"small"===e)&&t.querySelectorAll("."+d.MenuAction.SHOW_FOR_MEDIUM+":not(.hidden)").length>0||"small"===e&&t.querySelectorAll("."+d.MenuAction.SHOW_FOR_SMEDIUM+":not(.hidden)").length>0||t.querySelectorAll("."+d.MenuAction.SHOW_NEVER+":not(.hidden)").length>0?document.getElementById("responsive-menu-toggle").style.display="block":(document.getElementById("responsive-menu-toggle").style.display="none",this.closeMenu())}},{key:"addAction",value:function(e){this._menuActions.push(e),p.Helper.isNotNull(this._menu)&&this._menu.addAction(e)}},{key:"removeAllActions",value:function(e){this._menuActions=[],p.Helper.isNotNull(this._menu)&&this._menu.removeAllActions(e)}},{key:"setTitleElement",value:function(e){p.Helper.removeAllChildren(this.findBy("#title-element-container")).appendChild(e)}}])&&i(t.prototype,n),c&&i(t,c),k}(f.AbstractFragment);t.NavbarFragment=k,k.queries=[],k.onLogoClickListener=function(){return _.App.addInitialization((function(e){return e.startStartingSite()}))},k.title="MeinBerufBau",k.defaultActions=[]},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.DropdownRenderer=void 0;var l=n(107),f=n(205),h=n(264),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(d,e);var t,n,r,c=s(d);function d(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=c.call(this,e))._accordionMenuRenderer=new f.AccordionRenderer,t}return t=d,(n=[{key:"renderSubmenuAction",value:function(e){if(e.getMenu()instanceof h.Submenu)return o(u(d.prototype),"renderSubmenuAction",this).call(this,e);var t=o(u(d.prototype),"renderSubmenuAction",this).call(this,e);return t.classList.add("is-dropdown-submenu-parent"),t.classList.add("opens-right"),t}},{key:"createSubmenuParentElement",value:function(e){if(e.getMenu()instanceof h.Submenu)return o(u(d.prototype),"createSubmenuParentElement",this).call(this,e);var t=document.createElement("ul");return t.classList.add("menu"),t.classList.add("vertical"),t.classList.add("submenu"),t.classList.add("accordion-menu"),t.classList.add("is-dropdown-submenu"),t.classList.add("first-sub"),t}},{key:"updateAction",value:function(e){if(e.getMenu()instanceof h.Submenu)return o(u(d.prototype),"updateAction",this).call(this,e);if(e instanceof l.OpenSubmenuAction){var t=this.getElementForAction(e).querySelector(".submenu");e.getSubmenu().isOpen()?t.classList.add("js-dropdown-active"):t.classList.remove("js-dropdown-active")}}}])&&i(t.prototype,n),r&&i(t,r),d}(f.AccordionRenderer);t.DropdownRenderer=d},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.MenuRenderer=void 0;var i=n(22),o=n(107),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._parentElement=t,this._renderedElements={}}var t,n,a;return t=e,(n=[{key:"render",value:function(e,t){var n=this,r=e.getActions();t=i.Helper.nonNull(t,this._parentElement),i.Helper.isNotNull(t)&&(i.Helper.removeAllChildren(t),r.forEach((function(e){t.appendChild(n.getElementForAction(e))})),t.onclick=function(t){"function"==typeof e.getOnClickListener()&&e.getOnClickListener()(t)})}},{key:"_triggerRenderAction",value:function(e){var t=this._renderedElements[e.getId()];return e instanceof o.OpenSubmenuAction?this._renderedElements[e.getId()]=this.renderSubmenuAction(e):this._renderedElements[e.getId()]=this.renderAction(e),this.updateAction(e),i.Helper.isNotNull(t)&&t.replaceWith(this._renderedElements[e.getId()]),this._renderedElements[e.getId()]}},{key:"getElementForAction",value:function(e){return i.Helper.isNull(this._renderedElements[e.getId()])&&this._triggerRenderAction(e),this._renderedElements[e.getId()]}},{key:"renderAction",value:function(e){return null}},{key:"updateAction",value:function(e){}},{key:"renderSubmenuAction",value:function(e){var t=this.renderAction(e);e.getSubmenu().sortActions();var n=this.createSubmenuParentElement(e);return this.render(e.getSubmenu(),n),t.appendChild(n),t}},{key:"createSubmenuParentElement",value:function(e){return document.createElement("ul")}}])&&r(t.prototype,n),a&&r(t,a),e}();t.MenuRenderer=a},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Submenu=void 0;var f=n(204),h=n(22),d=n(107),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(e,t,n,r,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(o=c.call(this,h.Helper.nonNull(i,[])))._parentAction=new d.OpenSubmenuAction(e,u(o),t,n,r),o._isOpen=!1,o}return t=f,(n=[{key:"copy",value:function(e){return e=h.Helper.nonNull(e,new f),(e=o(l(f.prototype),"copy",this).call(this,e))._isOpen=this._isOpen,e}},{key:"setParentAction",value:function(e){this._parentAction=e}},{key:"getParentMenu",value:function(){return this._parentAction.getMenu()}},{key:"_generateOnClickListener",value:function(){return null}},{key:"click",value:function(e,t){for(var n=0,r=this._actions.length;n<r;n++)if(this._actions[n].getId()===e)return"function"==typeof this._actions[n].getAction()&&this._actions[n].isActivated()&&(this._actions[n].getAction()(this._actions[n],t),t.preventDefault()),this._actions[n]instanceof d.OpenSubmenuAction||this.close(),this._actions[n];for(var i=0,o=this._submenus.length;i<o;i++){var a=this._submenus[i].click(e,t);if(a)return a}return null}},{key:"toggle",value:function(){this._isOpen?this.close():this.open()}},{key:"open",value:function(){this._isOpen=!0,this.openSubmenu(this),h.Helper.isNotNull(this._parentAction)&&this._parentAction.update()}},{key:"openSubmenu",value:function(e){this.getParentMenu().openSubmenu(e)}},{key:"close",value:function(){this._isOpen=!1,o(l(f.prototype),"close",this).call(this),h.Helper.isNotNull(this._parentAction)&&this._parentAction.update()}},{key:"getParentAction",value:function(){return this._parentAction}},{key:"updateAction",value:function(e){var t=this.getParentMenu();t&&t.updateAction(e)}},{key:"redrawAction",value:function(e){var t=this.getParentMenu();t&&t.redrawAction(e)}},{key:"isOpen",value:function(){return this._isOpen}}])&&i(t.prototype,n),r&&i(t,r),f}(f.Menu);t.Submenu=p},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SwipeChildFragment=void 0;var l=n(68),f=n(22),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,n,r,s=a(c);function c(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=s.call(this,e,t))._parent=null,n}return t=c,(n=[{key:"onSwipeRight",value:function(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.previousFragment();case 1:case"end":return e.stop()}}),e,this)})))}},{key:"onSwipeLeft",value:function(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.nextFragment();case 1:case"end":return e.stop()}}),e,this)})))}},{key:"setParent",value:function(e){this._parent=e}},{key:"nextFragment",value:function(){f.Helper.isNotNull(this._parent)&&this._parent.nextFragment()}},{key:"previousFragment",value:function(){f.Helper.isNotNull(this._parent)&&this._parent.previousFragment()}}])&&i(t.prototype,n),r&&i(t,r),c}(l.AbstractFragment);t.SwipeChildFragment=h},function(e,t,n){e.exports=n.p+"html/chooseDialog.html"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ElemChooseDialog=void 0;var c=n(64),u=n(43),l=n(266),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e,r){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var o=u.ViewInflater.getInstance().load(l).then((function(t){var n=t.querySelector("#choose-value-template");n.remove(),n.removeAttribute("id");var r=t.querySelector("#choose-container"),o=function(t){var o=n.cloneNode(!0);o.querySelector(".choose-dialog-value").appendChild(e[t]),o.dataset.value=t,o.addEventListener("click",(function(){i._result=t,i.close()})),r.appendChild(o)};for(var a in e)o(a);return t}));return i=t.call(this,o,r)}return n}(c.Dialog);t.ElemChooseDialog=f},function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ImageSelectionElement=void 0;var s=n(43),c=n(7),u=n(85),l=n(532),f=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.images={},this.name=t,this.viewLoadedPromise=s.ViewInflater.getInstance().load(c.Helper.nonNull(n,l)).then((function(e){return a(r,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.view=e,t.next=3,this.prepareView();case 3:return this.showSelection(),t.abrupt("return",e);case 5:case"end":return t.stop()}}),t,this)})))}))}var t,n,i;return t=e,(n=[{key:"prepareView",value:function(){var e=this;this.imageContainerTemplate=this.view.querySelector(".image-selection-image-container"),this.imageContainerTemplate.remove(),this.categoryTemplate=this.view.querySelector(".image-selection-category"),this.categoryTemplate.remove(),this.imageSelectionContainer=this.view.querySelector(".image-selection-category-container"),this.imageSelectionPreviewContainer=this.view.querySelector(".image-selection-preview"),this.inputElement=this.view.querySelector(".image-selection-value"),this.inputElement.name=this.name;var t=this.view.querySelector(".image-selection");t.addEventListener("dragenter",(function(e){e.preventDefault(),e.stopPropagation(),t.classList.add("highlight")})),t.addEventListener("dragover",(function(e){e.preventDefault(),e.stopPropagation(),t.classList.add("highlight")})),t.addEventListener("dragleave",(function(e){e.preventDefault(),e.stopPropagation(),t.classList.remove("highlight")})),t.addEventListener("drop",(function(n){return a(e,void 0,void 0,regeneratorRuntime.mark((function e(){var r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),n.stopPropagation(),t.classList.remove("highlight"),!(n instanceof DragEvent)){e.next=15;break}if(r=null,n.dataTransfer.items&&n.dataTransfer.items.length>=1?"file"===n.dataTransfer.items[0].kind&&(r=n.dataTransfer.items[0].getAsFile()):n.dataTransfer.files&&n.dataTransfer.files.length>=1&&(r=n.dataTransfer.files[0]),r&&r.type.startsWith("image/")){e.next=8;break}return e.abrupt("return");case 8:return i=null,e.next=11,new Promise((function(e,t){var n=new FileReader;n.onload=function(){e(n.result)},n.onerror=function(e){return t(e)},n.readAsDataURL(r)}));case 11:o=e.sent,i={src:o,name:r.name},this.addImages({Uploads:[i]}),this.setValue(i);case 15:case"end":return e.stop()}}),e,this)})))}))}},{key:"showSelection",value:function(){var e=this;u.ViewHelper.removeAllChildren(this.imageSelectionContainer),Object.keys(this.images).sort((function(e,t){return"uploads"===e.toLowerCase()?-1:"uploads"===t.toLowerCase()?1:e.localeCompare(t)})).forEach((function(t){var n=e.categoryTemplate.cloneNode(!0);n.querySelector(".image-selection-category-name").innerText=t,e.images[t].forEach((function(t){var r=e.createImageElement(t);r.addEventListener("click",(function(){return e.setValue(t)})),n.appendChild(r)})),e.imageSelectionContainer.appendChild(n)}))}},{key:"createImageElement",value:function(e){var t=this.imageContainerTemplate.cloneNode(!0);return t.querySelector(".image-selection-image").src=e.src,e.name&&(t.querySelector(".image-selection-image-name").innerText=e.name),t}},{key:"setImages",value:function(e){this.images=e,this.view&&this.showSelection()}},{key:"addImages",value:function(e){var t=this;Object.keys(e).forEach((function(n){if(t.images[n]){var i,o=t.images[n].map((function(e){return e.src})),a=e[n].filter((function(e){return-1===o.indexOf(e.src)}));(i=t.images[n]).push.apply(i,r(a))}else t.images[n]=e[n]})),this.view&&this.showSelection()}},{key:"getView",value:function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.viewLoadedPromise);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"setValue",value:function(e){return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,"string"==typeof e&&(e=JSON.parse(e)),t.next=4,this.viewLoadedPromise;case 4:u.ViewHelper.removeAllChildren(this.imageSelectionPreviewContainer),e.src&&this.imageSelectionPreviewContainer.appendChild(this.createImageElement(e)),this.inputElement.value=JSON.stringify(e),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,this,[[0,9]])})))}}])&&o(t.prototype,n),i&&o(t,i),e}();t.ImageSelectionElement=f},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDialog=void 0;var c=n(64),u=n(43),l=n(536),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),r=t.call(this,u.ViewInflater.getInstance().load(l).then((function(t){return t.querySelector("#whatsapp-share").addEventListener("click",(function(){var t;t="https://web.whatsapp.com/send?text="+encodeURIComponent(e),window.open(t,"_blank","noopener"),r.close()})),t.querySelector("#telegram-share").addEventListener("click",(function(){var t="https://t.me/share/url?url="+encodeURIComponent(e);window.open(t,"_blank","noopener"),r.close()})),t})),"Share")}return n}(c.Dialog);t.ShareDialog=f},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AudioChain=void 0;var o=n(5),a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._buffer=n,this._shouldLoop=!1,this._loopStart=null,this._loopEnd=null,this._chainFunction=r,this._context=t,this._startTime=null,this._pauseTime=null,this._source=null,this._running=!1}var t,n,a;return t=e,(n=[{key:"setBuffer",value:function(e){this._buffer=e}},{key:"setLooping",value:function(e,t,n){this._shouldLoop=e,o.Helper.isNotNull(t)&&(this._loopStart=t),o.Helper.isNotNull(n)&&(this._loopEnd=n)}},{key:"start",value:function(e,t,n){return i(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=o.Helper.nonNull(e,0),t=o.Helper.nonNull(t,0),(i=this._context.createBufferSource()).loop=this._shouldLoop,o.Helper.isNotNull(this._loopStart)&&(i.loopStart=this._loopStart),o.Helper.isNotNull(this._loopEnd)&&(i.loopEnd=this._loopEnd),i.buffer=this._buffer,r.next=9,this._chainFunction(i);case 9:o.Helper.isNull(n)?i.start(e,t):i.start(e,t,n),this._startTime=(new Date).getTime()-1e3*o.Helper.nonNull(t,0),this._source=i,this._running=!0;case 13:case"end":return r.stop()}}),r,this)})))}},{key:"stop",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o.Helper.isNotNull(this._source)){t.next=5;break}return e=o.Helper.nonNull(e,0),this._pauseTime=(new Date).getTime()-this._startTime,this._running=!1,t.abrupt("return",this._source.stop(e));case 5:return t.abrupt("return",null);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"resume",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._running){e.next=2;break}return e.abrupt("return",this.start(null,o.Helper.nonNull(this._pauseTime,0)/1e3));case 2:case"end":return e.stop()}}),e,this)})))}}])&&r(t.prototype,n),a&&r(t,a),e}();t.AudioChain=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),i=n(31),o=n(540),a=n(541);r.App.addInitialization((function(){console.log("user trsnslation"),i.Translator.addDynamicTranslations({de:o,en:a})}))},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FileTransferPromise=void 0;var o=n(5),a=n(207),s=n(63),c=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.downloadUrl=t,o.Helper.isNull(n)){var r=this.downloadUrl.split("/");r.length>0&&(n=r[r.length-1])}this.storagePath=n}var t,n,c;return t=e,(n=[{key:"download",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.DataManager.fetchBlob(this.downloadUrl),e.next=3,a.FilePromise.open(this.storagePath);case 3:return n=e.sent,e.next=6,n.createWriter();case 6:return r=e.sent,e.t0=r,e.next=10,t;case 10:return e.t1=e.sent,e.next=13,e.t0.write.call(e.t0,e.t1);case 13:case"end":return e.stop()}}),e,this)})))}}])&&r(t.prototype,n),c&&r(t,c),e}();t.FileTransferPromise=c},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FileWriterPromise=void 0;var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fileWriter=t,this._isWritingPromise=Promise.resolve()}var t,n,o;return t=e,(n=[{key:"write",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._isWritingPromise.then((function(){return new Promise((function(t,n){r.fileWriter.onwriteend=t,r.fileWriter.onerror=n,r.fileWriter.write(e)}))})),this._isWritingPromise=n.catch(console.error),t.abrupt("return",n);case 3:case"end":return t.stop()}}),t,this)})))}}])&&r(t.prototype,n),o&&r(t,o),e}();t.FileWriterPromise=o},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ClientModel=void 0;var h=n(4),d=n(2),p=n(7),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(m,e);var t,n,r,u=c(m);function m(){return i(this,m),u.apply(this,arguments)}return t=m,r=[{key:"getColumnDefinitions",value:function(){var e=a(l(m),"getColumnDefinitions",this).call(this);return e.id&&e.id.generated&&(e.id.generated=!1),e}},{key:"_fromJson",value:function(e,t,n){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"saveMany",value:function(e,t){var n=this,r=Object.create(null,{saveMany:{get:function(){return a(l(m),"saveMany",n)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=11;break}return i=[],e.forEach((function(e){i.push(e.toJSON())})),n.next=5,d.DataManager.send(this.SAVE_PATH,{model:this.getSchemaName(),values:i});case 5:if(!1!==(o=n.sent).success){n.next=8;break}throw new Error(o.errors);case 8:return n.next=10,this._fromJson(o,void 0,!0);case 10:e=n.sent;case 11:return n.abrupt("return",r.saveMany.call(this,e));case 12:case"end":return n.stop()}}),n,this)})))}},{key:"getSchemaDefinition",value:function(){var e=[h.BaseDatabase.TYPES.MEDIUMTEXT,h.BaseDatabase.TYPES.STRING,h.BaseDatabase.TYPES.TEXT],t=a(l(m),"getSchemaDefinition",this).call(this),n=t.columns;return Object.keys(n).forEach((function(t){n[t].type===h.BaseDatabase.TYPES.MEDIUMTEXT&&(n[t].type=h.BaseDatabase.TYPES.TEXT),n[t].type===h.BaseDatabase.TYPES.JSON&&(n[t].type=h.BaseDatabase.TYPES.SIMPLE_JSON),-1!==e.indexOf(n[t].type)&&(n[t].escapeJS=p.Helper.nonNull(n[t].escapeJS,!0),n[t].escapeHTML=p.Helper.nonNull(n[t].escapeHTML,!0))})),t}}],(n=[{key:"toJSON",value:function(e){}},{key:"save",value:function(e){var t=this,n=Object.create(null,{save:{get:function(){return a(l(m.prototype),"save",t)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=9;break}return r=this.toJSON(),t.next=4,d.DataManager.send(this.constructor.SAVE_PATH,{model:this.constructor.getSchemaName(),values:r});case 4:if(!1!==(i=t.sent).success){t.next=7;break}throw new Error(i.errors);case 7:return t.next=9,this.constructor._fromJson(i,this,!0);case 9:return t.abrupt("return",n.save.call(this));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"delete",value:function(e){var t=this,n=Object.create(null,{delete:{get:function(){return a(l(m.prototype),"delete",t)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=6;break}return t.next=3,d.DataManager.send(this.constructor.DELETE_PATH,{model:this.constructor.getSchemaName(),id:this.id});case 3:if(!1!==(r=t.sent).success){t.next=6;break}throw new Error(r.errors);case 6:return t.abrupt("return",n.delete.call(this));case 7:case"end":return t.stop()}}),t,this)})))}}])&&o(t.prototype,n),r&&o(t,r),m}(h.BaseModel);t.ClientModel=m,m.SAVE_PATH="/sync",m.DELETE_PATH="/sync/delete"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ClientPartialModel=void 0;var f=n(39),h=n(4),d=n(2),p=n(5),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(e=c.call(this)).clientId=null,e}return t=f,r=[{key:"getColumnDefinitions",value:function(){var e=o(u(f),"getColumnDefinitions",this).call(this);return e.id&&(e.id.primary=!1,e.id.generated=!1,e.id.nullable=!0,e.id.unique=!0),e.clientId={type:"integer",primary:!0,generated:!0},e}},{key:"saveMany",value:function(e,t){var n=this,r=Object.create(null,{saveMany:{get:function(){return o(u(f),"saveMany",n)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=p.Helper.nonNull(t,!0),e.forEach((function(e){"number"!=typeof e.clientId&&(e.clientId=void 0)})),t){n.next=12;break}return i=[],e.forEach((function(e){i.push(e.toJSON())})),n.next=7,d.DataManager.send(this.SAVE_PATH,{model:this.getSchemaName(),values:i});case 7:if(!1===(o=n.sent).success){n.next=12;break}return n.next=11,this._fromJson(o,e,!0);case 11:e=n.sent;case 12:return n.abrupt("return",r.saveMany.call(this,e,!0));case 13:case"end":return n.stop()}}),n,this)})))}}],(n=[{key:"toJSON",value:function(e){var t=this,n=this.constructor.getRelationDefinitions(),r=this.constructor.getColumnDefinitions(),i={};return Object.keys(r).forEach((function(e){"clientId"!==e&&(i[e]=t[e])})),Object.keys(n).forEach((function(n){if(!0===e)i[n]=t[n];else if(Array.isArray(t[n])){var r=[];t[n].forEach((function(e){return e&&r.push(e.id)})),i[n]=r}else t[n]instanceof h.BaseModel?i[n]=t[n].id:i[n]=null})),i}},{key:"save",value:function(e){var t=this,n=Object.create(null,{save:{get:function(){return o(u(f.prototype),"save",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=p.Helper.nonNull(e,!0),"number"!=typeof this.clientId&&(this.clientId=void 0),e){t.next=10;break}return r=this.toJSON(),t.next=6,d.DataManager.send(this.constructor.SAVE_PATH,{model:this.constructor.getSchemaName(),values:r});case 6:if(!1===(i=t.sent).success){t.next=10;break}return t.next=10,this.constructor._fromJson(i,this,!0);case 10:return t.abrupt("return",n.save.call(this,!0));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"delete",value:function(e){var t=this,n=Object.create(null,{delete:{get:function(){return o(u(f.prototype),"delete",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=6;break}return t.next=3,d.DataManager.send(this.constructor.DELETE_PATH,{model:this.constructor.getSchemaName(),id:this.id});case 3:if(!1!==(r=t.sent).success){t.next=6;break}throw new Error(r.errors);case 6:return t.abrupt("return",n.delete.call(this,!0));case 7:case"end":return t.stop()}}),t,this)})))}}])&&i(t.prototype,n),r&&i(t,r),f}(f.EasySyncBaseModel);t.ClientPartialModel=m},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EasySyncPartialModel=void 0;var h=n(39),d=n(13),p=n(5),m=n(252),y=n(4),g=d,b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(h,e);var t,n,r,u=c(h);function h(){return i(this,h),u.apply(this,arguments)}return t=h,r=[{key:"findByIds",value:function(e,t){return f(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.find({id:g.In(e)},null,null,null,t));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"findById",value:function(e,t){return f(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.findOne({id:e},null,null,t));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"findByClientId",value:function(e,t){var n=this,r=Object.create(null,{findById:{get:function(){return a(l(h),"findById",n)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",r.findById.call(this,e,t));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"findByClientIds",value:function(e,t){var n=this,r=Object.create(null,{findById:{get:function(){return a(l(h),"findById",n)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",r.findById.call(this,e,t));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"_fromJson",value:function(e,t,n){return f(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,o,a,s=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=t||[],(i=Array.isArray(e))||(e=[e]),Array.isArray(t)||(t=[t]),o=[],a=[],e.forEach((function(e,r){a.push(new Promise((function(i){return f(s,void 0,void 0,regeneratorRuntime.mark((function a(){var s;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s=null,!(t.length>r)){a.next=5;break}s=t[r],a.next=9;break;case 5:if(!p.Helper.isNotNull(e.id)){a.next=9;break}return a.next=8,this.findById(e.id,this.getRelations());case 8:s=a.sent;case 9:null===s&&(s=new this),e.version||(e.version=1),t[r]=Object.assign(s,e),this._handleColumns_(t[r]),this._handleRelations_(t[r],n,o),i();case 15:case"end":return a.stop()}}),a,this)})))})))})),r.next=9,Promise.all(a);case 9:return r.next=11,Promise.all(o);case 11:return i||(t=t.length>0?t[0]:null),r.abrupt("return",t);case 13:case"end":return r.stop()}}),r)})))}},{key:"_handleRelations_",value:function(e,t,n){var r=this.getRelationDefinitions();Object.keys(r).forEach((function(i){var o=e[i];if("number"==typeof o||Array.isArray(o)&&o.length>=1&&"number"==typeof o[0])if(!0===t){var a=null;a=Array.isArray(o)?y.BaseDatabase.getModel(r[i].target).findByIds(o):y.BaseDatabase.getModel(r[i].target).findById(o),n.push(a.then((function(t){e[i]=t})))}else!1===t&&("many-to-many"===r[i].type||"one-to-many"===r[i].type?e[i]=[]:e[i]=null)}))}},{key:"_handleColumns_",value:function(e){var t=this.getSchemaDefinition().columns;Object.keys(t).forEach((function(n){t[n].escapeHTML&&(e[n]=m.XSSHelper.escapeHTML(e[n])),t[n].escapeJS&&(e[n]=m.XSSHelper.escapeJS(e[n]))}))}}],(n=[{key:"toJSON",value:function(e){var t=this,n=this.constructor.getRelationDefinitions(),r=this.constructor.getColumnDefinitions(),i={};return Object.keys(r).forEach((function(e){"clientId"!==e&&(i[e]=t[e])})),Object.keys(n).forEach((function(n){if(!0===e)i[n]=t[n];else if(Array.isArray(t[n])){var r=[];t[n].forEach((function(e){return e&&r.push(e.id)})),i[n]=r}else t[n]instanceof y.BaseModel?i[n]=t[n].id:i[n]=null})),i}}])&&o(t.prototype,n),r&&o(t,r),h}(h.EasySyncBaseModel);t.EasySyncPartialModel=b,b.CAN_BE_SYNCED=!0},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.LastSyncDates=void 0;var l=n(4),LastSyncDates=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(LastSyncDates,e);var t,n,r,c=s(LastSyncDates);function LastSyncDates(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LastSyncDates),(e=c.call(this)).model="",e.lastSynced=0,e.where={},e}return t=LastSyncDates,r=[{key:"getColumnDefinitions",value:function(){var e=o(u(LastSyncDates),"getColumnDefinitions",this).call(this);return e.model={type:l.BaseDatabase.TYPES.STRING,nullable:!0},e.lastSynced={type:l.BaseDatabase.TYPES.INTEGER,nullable:!0},e.where={type:l.BaseDatabase.TYPES.SIMPLE_JSON},e}}],(n=[{key:"getModel",value:function(){return this.model}},{key:"setModel",value:function(e){this.model=e}},{key:"getLastSynced",value:function(){return this.lastSynced}},{key:"setLastSynced",value:function(e){this.lastSynced=e}}])&&i(t.prototype,n),r&&i(t,r),LastSyncDates}(l.BaseModel);t.LastSyncDates=LastSyncDates,LastSyncDates.SCHEMA_NAME="easy-sync-last-sync-dates",l.BaseDatabase.addModel(LastSyncDates)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Role=void 0;var l=n(10),f=n(4),h=n(552),Role=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(Role,e);var t,n,r,c=s(Role);function Role(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Role),(e=c.call(this)).name=null,e.description=null,e.accesses=null,e.parents=null,e.children=null,e}return t=Role,r=[{key:"getColumnDefinitions",value:function(){var e=o(u(Role),"getColumnDefinitions",this).call(this);return e.name={type:f.BaseDatabase.TYPES.STRING},e.description={type:f.BaseDatabase.TYPES.STRING},e}},{key:"getRelationDefinitions",value:function(){var e=o(u(Role),"getRelationDefinitions",this).call(this);return e.accesses={target:h.Access.getSchemaName(),type:"many-to-many",joinTable:{name:"roleAccess"},cascade:!1},e.parents={target:Role.getSchemaName(),type:"many-to-many",joinTable:{name:"roleChildren",joinColumn:{name:"childId",referencedColumnName:"id"},inverseJoinColumn:{name:"parentId",referencedColumnName:"id"}},cascade:!1},e.children={target:Role.getSchemaName(),type:"many-to-many",joinTable:{name:"roleChildren",joinColumn:{name:"parentId",referencedColumnName:"id"},inverseJoinColumn:{name:"childId",referencedColumnName:"id"}},cascade:!1},e}}],(n=null)&&i(t.prototype,n),r&&i(t,r),Role}(l.EasySyncBaseModel);t.Role=Role,Role.CAN_BE_SYNCED=!1,f.BaseDatabase.addModel(Role)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ForgotPasswordSite=void 0;var h=n(56),d=n(2),p=n(554),m=n(34),y=n(154),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(g,e);var t,n,r,c=s(g);function g(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(t=c.call(this,e,p)).addDelegate(new h.UserSite(u(t),y.LoginSite.ACCESS)),t}return t=g,(n=[{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return o(l(g.prototype),"onConstruct",t)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.onConstruct.call(this,e),d.Helper.isSet(e.t)&&(this._token=e.t),t.abrupt("return",r);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(l(g.prototype),"onViewLoaded",e)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),r=new d.Form(this.findBy("#forgot-password-form"),(function(e){return f(i,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.UserManager.getInstance().sendForgotPasswordEmail(e.email);case 2:if(!t.sent){t.next=8;break}return new d.Toast("forgot-password-mail sent").show(),t.next=6,this.finish();case 6:t.next=9;break;case 8:r.setErrors({email:"email is not in our database"});case 9:case"end":return t.stop()}}),t,this)})))})),new d.Form(this.findBy("#reset-password-form"),(function(e){return f(i,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.UserManager.getInstance().resetPassword(this._token,e.password1);case 2:if(!t.sent){t.next=8;break}return new d.Toast("password resetted").show(),t.next=6,this.finish();case 6:t.next=10;break;case 8:return t.next=10,new d.Toast("token is not valid!").show();case 10:case"end":return t.stop()}}),t,this)})))})).addValidator((function(e){var t={},n=!1;return""===e.password1.trim()&&(n=!0,t.password1="no password set"),e.password1!==e.password2&&(n=!0,t.password2="not equal to password1"),!n||t})),this._token&&(this.findBy("#reset-password").classList.remove("hidden"),this.findBy("#forgot-password").classList.add("hidden")),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})))}}])&&i(t.prototype,n),r&&i(t,r),g}(d.MenuSite);t.ForgotPasswordSite=g,d.App.addInitialization((function(e){e.addDeepLink("forgotPW",g)}))},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NotAllowedSite=void 0;var f=n(153),h=n(555),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),c.call(this,e,h)}return t=f,(n=[{key:"onConstruct",value:function(e){return o(u(f.prototype),"onConstruct",this).call(this,e)}},{key:"onCreateMenu",value:function(e){return o(u(f.prototype),"onCreateMenu",this).call(this,e)}},{key:"onPause",value:function(){var e=this,t=Object.create(null,{onPause:{get:function(){return o(u(f.prototype),"onPause",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onPause.call(this),e.next=3,this.finish();case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})))}}])&&i(t.prototype,n),r&&i(t,r),f}(f.MenuSite);t.NotAllowedSite=d},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?c(e):t}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectUserDialog=void 0;var f=n(64),h=n(43),d=n(63),p=n(57),m=n(5),y=n(556),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(u,e);var t,n,r,s=a(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),e=s.call(this,h.ViewInflater.getInstance().load(y).then((function(t){return l(c(e),void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._loadUserTimeout=null,this._usernameInput=t.querySelector("#username-input"),this._usernameInput.addEventListener("keydown",(function(){clearTimeout(n._loadUserTimeout),n._loadUserTimeout=setTimeout((function(){return l(n,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadUsers(this._usernameInput.value);case 2:case"end":return e.stop()}}),e,this)})))}),500)})),this._userContainer=t.querySelector("#user-container"),this._userTemplate=t.querySelector("#user-template"),this._userTemplate.remove(),this._userTemplate.removeAttribute("id"),this._loadUsers(),e.abrupt("return",t);case 9:case"end":return e.stop()}}),e,this)})))})),"select user")}return t=u,(n=[{key:"_loadUsers",value:function(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,d.DataManager.load("user/listUsers"+d.DataManager.buildQuery({username:m.Helper.nonNull(e,"")}));case 3:(n=t.sent).success&&(p.ViewHelper.removeAllChildren(this._userContainer),n.data.forEach((function(e){var t=r._userTemplate.cloneNode(!0);t.querySelector(".name").innerText=e.username,t.addEventListener("click",(function(){r._result=e,r.close()})),r._userContainer.appendChild(t)})));case 5:case"end":return t.stop()}}),t,this)})))}}])&&i(t.prototype,n),r&&i(t,r),u}(f.Dialog);t.SelectUserDialog=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(562),o=n(563),a=n(564);r.App.addInitialization((function(){i.Translator.addDynamicTranslations({de:o,en:a})}))},function(e,t,n){e.exports=n.p+"html/filterDialog.html"},function(e){e.exports=JSON.parse('{"events":"Events","churches":"Veranstalter","fsjs":"FSJ","about us":"Über uns","language":"<img class=\'icon\' src=\'./img/flag_german.svg\'>","contact":"Kontakt","privacy policy":"Datenschutz","imprint":"Impressum & Datenschutz","churchoverview":"Veranstalter Übersicht","Here you can find all churches and organizations in Cologne that share their events through ECHO.":"Hier findest du alle Gemeinden und Organisationen in Köln, die ihre Veranstaltungen über ECHO teilen.","fsjoverview":"FSJ Übersicht","here you can find some fsjs.":"Hier kannst du dich über ein paar FSJ-Stellen informieren.","Find out more":"Mehr erfahren","multiple locations":"mehrere Standorte","document-title":"ECHO","document-title-empty":"ECHO","uhr":"UHR","no events":"Keine Events vorhanden","merkliste":"Merkliste","vergangene Veranstaltungen":"Vergangene Veranstaltungen","name de":"Name (DE)","name en":"Name (EN)","description de":"Beschreibung (DE)","description en":"Beschreibung (EN)","start time":"Start:","end time":"Ende:","type":"Typ","Bild":"Bild","places":"Orte","name":"Name","Query":"Query","add place":"Neuer Ort","speichern":"Speichern","add event":"Neuer Termin","gottesdienst":"Gottesdienst","konzert":"Konzert","event":"Veranstaltung","organiser":"Veranstalter","search":"Suchen","hauskreis":"Hauskreis","konferenz":"Konferenz","gebetskreis":"Gebetskreis","sport":"Sport","jugendkreis":"Jugendkreis","studentenkreis":"Studierendenkreis","sonstiges":"Sonstiges","email-header-usermanager-password-forgotten":"ECHO - Passwort vergessen","email-usermanager-password-forgotten":"Hallo {0},\\n\\nUm dein Passwort zu ändern, besuche folgenden Link: {1}","modify":"Bearbeiten","delete":"Löschen","event löschen?":"Event löschen?","möchtest du das event wirklich löschen? es wird unwiederbringlich verloren gehen!":"Möchtest du das Event wirklich löschen? Es wird unwiederbringlich verloren gehen!","event wurde erfolgreich gelöscht":"Das Event wurde erfolgreich gelöscht.","kirche löschen?":"Kirche löschen?","möchtest du die kirche wirklich löschen? sie wird unwiederbringlich verloren gehen!":"Möchtest du die Kirche wirklich löschen? Sie wird unwiederbringlich verloren gehen!","kirche erfolgreich gelöscht":"Die Kirche wurde erfolgreich gelöscht.","cancel-button":"Abbrechen","confirm-button":"OK","add church":"Neuer Veranstalter","add post":"Neuer Post","website url":"Website","today":"Heute","tomorrow":"Morgen","settings":"Einstellungen","settings-dialog-heading":"Einstellungen","send notifications for favorites":"Benachrichtigungen für Favoriten?","time before start prefix":"","time before start suffix":" vorher benachrichtigen","min":"Min.","hour":"Std.","days":"Tag(e)","no event found":"Kein Event gefunden :(","edit event or event series":"Veranstaltung oder Terminserie bearbeiten?","series":"Serie","abort":"Abbruch","add fsj":"Neues FSJ","post de":"Post (DE)","post en":"Post (EN)","kalender":"Kalender","select-calendar":"Kalender aussuchen","mit dem laden der karte akzeptieren sie die datenschutzerklärung von google.":"Mit dem Laden der Karte akzeptieren Sie die Datenschutzerklärung von Google.","mehr erfahren":"Mehr erfahren","karte laden":"Karte laden","cookies für externe medien immer zulassen":"Cookies für externe Medien immer zulassen.","cookie-einstellungen":"Cookie Einstellungen","diese website setzt cookies ein. einige davon sind essenziell, während andere dazu dienen, diese website und ihre erfahrung zu verbessern.":"Diese Website setzt Cookies ein. Einige davon sind essenziell, während andere dazu dienen, diese Website und Ihre Erfahrung zu verbessern.","alle akzeptieren":"Alle akzeptieren","cookie einstellungen":"Weitere Einstellungen","notwendige cookies":"Notwendige Cookies","funktionale cookies":"Funktionale Cookies","statistische cookies":"Statistische Cookies","externe medien cookies":"Externe Medien Cookies","diese cookies werden für die grundlegende funktionen dieser website benötigt und müssen daher akzeptiert werden.":"Diese Cookies werden für die grundlegende Funktionen dieser Website benötigt und müssen daher akzeptiert werden.","diese cookies dienen dazu, um weitere funktionalitäten dieser website sicherzustellen, wie z.b. das speichern der sprache":"Diese Cookies dienen dazu, um weitere Funktionalitäten dieser Website sicherzustellen, wie z.B. das Speichern der Sprache.","statistische cookies helfen uns anonymisiert informationen über die nutzung unserer website zu erfassen und so die website zu verbessern.":"Statistische Cookies helfen uns anonymisiert Informationen über die Nutzung unserer Website zu erfassen und so die Website zu verbessern.","inhalte von drittparteien, wie google-maps hinterlegen cookies. um diese dienste zu nutzen, müssen die cookies von drittanbietern akzeptiert werden.":"Inhalte von Drittparteien, wie Google-Maps hinterlegen Cookies. Um diese Inhalte anzusehen, müssen die Cookies von Drittanbietern akzeptiert werden.","save":"Speichern","kontakt":"Kontakt","Datenschutzbestimmung":"Datenschutzbestimmung","Nachricht":"Nachricht","e-mailadresse":"E-Mailadresse","senden":"Senden","contact privacy policy accepted":"gelesen und akzeptiert","contact text":"Du möchtest Kontakt mit uns aufnehmen? Kein Problem, nutze einfach das Kontaktformular oder sende uns eine E-Mail an <a href=\'mailto:{0}\'>{0}</a>.\\n    Egal, ob du uns eine E-Mail sendest oder das Kontaktformular benutzt, akzeptierst du unsere <a href=\\"index.html?s=impressum\\">Datenschutzbestimmung","about us 1":"Wir sind Silas, Laura, Fabienne, Susanne und Jonas (von links nach rechts). Was uns verbindet ist unser Glaube und die Lust gemeinsam diesen Glauben zu leben und Gott zu feiern. Gemeinschaft ist unsere Priorität und Menschen in unserem Umfeld glücklich und zufrieden zu sehen. Wir wollen alle Menschen zusammenbringen – egal ob Christ oder Nicht-Christ, jung oder alt, arm oder reich, Frau oder Mann. \\nSo bunt zusammengewürfelt ist auch unsere Truppe: \\nSilas studiert Informatik an der RWTH, Laura ist eingestiegen als Projektmanagerin und studiert jetzt Lehramt im Master, Fabienne ist Dozentin für Lehramt an der Universität zu Köln, Susanne ist UX Designerin und Jonas arbeitet als Polizist in Köln.<br/>Vor über zwei Jahren gab es diesen einen Moment, da kam uns die Idee auf, alle christlichen Events im Kölner Umland in einer App zu bündeln.","about us 2":"Wir möchten mit unserem Projekt „ECHO“ dazu beitragen, dass Christen in Köln und im Kölner Umland schneller und einfacher christliche Events online finden können, um so ein Netzwerk entstehen zu lassen, was nicht nur Menschen gemeinsam verbindet, sondern auch Gemeinden. Dass unsere Familie, Freunde, Kommilitonen und Bekannte Gott kennenlernen dürfen, liegt uns am Herzen.","about us 3":"ECHO gibt einen Überblick über christliche Events und bietet einen leichten Zugang für Kölner und Zugezogene.","das sind wir":"Das sind wir","wiederholen?":"Wiederholen?","repeat until":"Wiederholen bis","mo":"Mo","di":"Di","mi":"Mi","do":"Do","fr":"Fr","sa":"Sa","so":"So","":"","Sunday":"Sonntag","Monday":"Montag","Tuesday":"Dienstag","Wednesday":"Mittwoch","Thursday":"Donnerstag","Friday":"Freitag","Saturday":"Samstag","Sun":"So","Mon":"Mo","Tue":"Di","Wed":"Mi","Thu":"Do","Fri":"Fr","Sat":"Sa","January":"Januar","February":"Februar","March":"März","April":"April","May":"Mai","June":"Juni","July":"Juli","August":"August","September":"September","October":"Oktober","November":"November","December":"Dezember","Jan":"Jan","Feb":"Feb","Mar":"Mär","Apr":"Apr","Jun":"Jun","Jul":"Jul","Aug":"Aug","Sep":"Sep","Oct":"Okt","Nov":"Nov","Dec":"Dez","website":"Webseite","die nachricht wurde gesendet!":"Die Nachricht wurde gesendet!","filter":"Filter","change user":"User bearbeiten","insert favorites to calendar":"Favoriten dem Systemkalender hinzufügen?","insert favorites":"Favoriten einfügen?","should favorites inserted to system calendar":"Sollen die Favoriten dem Systemkalender hinzugefügt werden?","no":"Nein","Yes":"Ja","willkommen":"Willkommen","willkommenstext":"Unsere Mission ist es Menschen in Köln zu verbinden und den Austausch zwischen Gemeinden zu fördern.","News":"News","welcome-text":"Wir freuen uns und danken dir jetzt schon für deinen Support! Wir wollen mit dir gemeinsam die App und die Vision dahinter vergrößern! Wenn du Gemeinden oder Events kennst, die in der App noch fehlen, dann schreib uns unbedingt! Wir freuen uns auch sonst über jede Art von Feedback!","welcome-statement":"Lasst uns Gott in Köln groß machen!","welcome-hint":"Hinweis:<br/>Die App wird stetig weiterentwickelt und verbessert. Bitte habe ein wenig Rücksicht, wenn am Anfang noch nicht alles perfekt funktioniert. <br/><br/>Dein Echo-Team","Sie werden in kürze weitergeleitet. Funktioniert das nicht, klicken Sie bitte hier:":"Sie werden in kürze weitergeleitet. Funktioniert das nicht, klicken Sie bitte hier:","Weiterleitung":"Weiterleitung"}')},function(e){e.exports=JSON.parse('{"events":"Events","churches":"Communities","fsjs":"VSY","about us":"About Us","language":"<img class=\'icon\' src=\'./img/flag_usa.svg\'>","contact":"Contact","privacy policy":"Privacy Regulations","imprint":"Imprint & Privacy Regulations","churchoverview":"Communities Overview","Here you can find all churches and organizations in Cologne that share their events through ECHO.":"Here you can find all communities and organisations in Cologne who share their events through ECHO.","fsjoverview":"Voluntary Social Year","here you can find some fsjs.":"Here you can inform yourself about some VSY jobs.","Find out more":"Learn More","multiple locations":"Multiple Locations","document-title":"ECHO","uhr":"Uhr","no events":"No Events available","document-title-empty":"ECHO","merkliste":"Watchlist","vergangene Veranstaltungen":"Past Events","name de":"Name (DE)","name en":"Name (EN)","description de":"Description (DE)","description en":"Description (EN)","start time":"Start:","end time":"End:","type":"Type","Bild":"Picture","places":"Place","name":"Name","Query":"Query","add place":"New Place","speichern":"Save","add event":"Add Event","gottesdienst":"Church Service","konzert":"Concert","event":"Event","organiser":"Organiser","search":"Search","hauskreis":"Bible Study Group","konferenz":"Conference","gebetskreis":"Prayer Group","sport":"Sport","jugendkreis":"Youth Group","studentenkreis":"Student Group","sonstiges":"Other","email-header-usermanager-password-forgotten":"ECHO - Forgot Password","email-usermanager-password-forgotten":"Hello {0},\\n\\nTo reset your password, please visit the following link: {1}","modify":"Edit","delete":"Delete","event löschen?":"Delete Event?","möchtest du das event wirklich löschen? es wird unwiederbringlich verloren gehen!":"Do you really want to delete the event? It will be irretrievably lost!","event wurde erfolgreich gelöscht":"The event was successfully deleted.","kirche löschen?":"Delete Community?","möchtest du die kirche wirklich löschen? sie wird unwiederbringlich verloren gehen!":"Do you really want to delete the community? It will be irretrievably lost!","kirche erfolgreich gelöscht":"The community was successfully deleted","cancel-button":"Abort","confirm-button":"OK","add church":"New Community","add post":"New Post","website url":"Website","today":"Today","tomorrow":"Tomorrow","settings":"Settings","settings-dialog-heading":"Settings","send notifications for favorites":"Notifications for favorites?","time before start prefix":"Inform ","time before start suffix":" beforehand","min":"Min.","hour":"Hour(s)","days":"Day(s)","no event found":"No Event found :(","edit event or event series":"Edit event or series?","series":"Serie","abort":"Abort","add fsj":"New VSY","post de":"Post (DE)","post en":"Post (EN)","kalender":"Calendar","select-calendar":"Select Calendar","mit dem laden der karte akzeptieren sie die datenschutzerklärung von google.":"By loading the map you accept the privacy policy of Google.","mehr erfahren":"Learn More","karte laden":"Load Map","cookies für externe medien immer zulassen":"Always allow cookies for external media.","cookie-einstellungen":"Cookie Settings","diese website setzt cookies ein. einige davon sind essenziell, während andere dazu dienen, diese website und ihre erfahrung zu verbessern.":"This website uses cookies. Some of them are essential, while others are used to improve this site and your experience.","alle akzeptieren":"Accept All","cookie einstellungen":"More Settings","notwendige cookies":"Necessary cookies","funktionale cookies":"Functional Cookies","statistische cookies":"Statistical cookies","externe medien cookies":"External Media Cookies","diese cookies werden für die grundlegende funktionen dieser website benötigt und müssen daher akzeptiert werden.":"These cookies are required for the basic functions of this website and must therefore be accepted.","diese cookies dienen dazu, um weitere funktionalitäten dieser website sicherzustellen, wie z.b. das speichern der sprache":"These cookies are used to ensure further functionalities of this website, such as saving the language.","statistische cookies helfen uns anonymisiert informationen über die nutzung unserer website zu erfassen und so die website zu verbessern.":"Statistical cookies help us to collect anonymous information about the use of our website and thus improve the website.","inhalte von drittparteien, wie google-maps hinterlegen cookies. um diese dienste zu nutzen, müssen die cookies von drittanbietern akzeptiert werden.":"Content from third parties, such as Google Maps, deposit cookies. In order to view this content, you must accept cookies from third parties.","save":"Speichern","Sunday":"Sunday","Monday":"Monday","Tuesday":"Tuesday","Wednesday":"Wednesday","Thursday":"Thursday","Friday":"Friday","Saturday":"Saturday","Sun":"Sun","Mon":"Mon","Tue":"Tue","Wed":"Wed","Thu":"Thu","Fri":"Fri","Sat":"Sat","January":"January","February":"February","March":"March","April":"April","May":"May","June":"June","July":"July","August":"August","September":"September","October":"October","November":"November","December":"December","Jan":"Jan","Feb":"Feb","Mar":"Mar","Apr":"Apr","Jun":"Jun","Jul":"Jul","Aug":"Aug","Sep":"Sep","Oct":"Oct","Nov":"Nov","Dec":"Dec","website":"Website","filter":"Filter","insert favorites to calendar":"Insert favorites into the system calendar?","insert favorites":"Insert Favorites?","should favorites inserted to system calendar":"Should favorites inserted into the system calendar?","no":"No","Yes":"Yes","willkommen":"Welcome","willkommenstext":"Our mission is to connect people in Cologne and promote exchange between churches.","News":"News"}')},function(e,t,n){(t=e.exports=function(e){e=e.toLowerCase();var n=t[e];if(!n)throw new Error(e+" is not supported (we accept pull requests)");return new n}).sha=n(498),t.sha1=n(502),t.sha224=n(503),t.sha256=n(249),t.sha384=n(504),t.sha512=n(250)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(35),o=n(65),a=n(51),s=n(45),c=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new a.a(n),n}return Object(r.c)(t,e),t.prototype.commitTransaction=function(){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,e.prototype.commitTransaction.call(this)];case 1:return t.sent(),[4,this.driver.autoSave()];case 2:return t.sent(),[2]}}))}))},t.prototype.query=function(e,t){var n=this;if(void 0===t&&(t=[]),this.isReleased)throw new i.a;return new Promise((function(i,o){return Object(r.b)(n,void 0,void 0,(function(){var n,a,c,u,l,f,h;return Object(r.d)(this,(function(r){n=this.driver.databaseConnection,this.driver.connection.logger.logQuery(e,t,this),a=+new Date;try{for(c=n.prepare(e),t&&(t=t.map((function(e){return void 0!==e?e:null})),c.bind(t)),u=this.driver.connection.options.maxQueryExecutionTime,l=+new Date,f=l-a,u&&f>u&&this.driver.connection.logger.logQuerySlow(f,e,t,this),h=[];c.step();)h.push(c.getAsObject());c.free(),i(h)}catch(n){c&&c.free(),this.driver.connection.logger.logQueryError(n,e,t,this),o(new s.a(e,t,n))}return[2]}))}))}))},t}(o.a)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var r=n(0),i=n(21),o=n(289),a=n(47),s=n(83),c=function(t){function n(e){var n=t.call(this,e)||this;if(n.connection=e,n.options=e.options,n.database=n.options.database,n.driver=n.options.driver,!n.options.database)throw new a.a("database");return n.loadDependencies(),n}return Object(r.c)(n,t),n.prototype.disconnect=function(){return Object(r.b)(this,void 0,void 0,(function(){var e=this;return Object(r.d)(this,(function(t){return[2,new Promise((function(t,n){e.queryRunner=void 0,e.databaseConnection.close().then(t).catch(n)}))]}))}))},n.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new o.a(this)),this.queryRunner},n.prototype.normalizeType=function(n){return n.type===e?"blob":t.prototype.normalizeType.call(this,n)},n.prototype.createDatabaseConnection=function(){var e=this;return new Promise((function(t,n){var r=Object.assign({},{readOnly:e.options.readOnly,key:e.options.key,multithreading:e.options.multithreading,migrate:e.options.migrate,iosFlags:e.options.iosFlags,androidFlags:e.options.androidFlags},e.options.extra||{});new e.sqlite(e.options.database,r,(function(r,i){if(r)return n(r);i.resultType(e.sqlite.RESULTSASOBJECT),i.execSQL("PRAGMA foreign_keys = ON;",[],(function(e,r){if(e)return n(e);t(i)}))}))}))},n.prototype.loadDependencies=function(){if(this.sqlite=this.driver,!this.driver)throw new s.a("Nativescript","nativescript-sqlite")},n}(i.a)}).call(this,n(106).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(35),o=n(45),a=n(65),s=n(51),c=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new s.a(n),n}return Object(r.c)(t,e),t.prototype.query=function(e,t){var n=this;if(this.isReleased)throw new i.a;var r=this.driver.connection;return new Promise((function(i,a){var s="INSERT INTO"===e.substr(0,11),c=function(n,s){var c=r.options.maxQueryExecutionTime,l=+new Date-u;c&&l>c&&r.logger.logQuerySlow(l,e,t,this),n?(r.logger.logQueryError(n,e,t,this),a(new o.a(e,t,n))):i(s)};n.driver.connection.logger.logQuery(e,t,n);var u=+new Date;n.connect().then((function(n){s?n.execSQL(e,t,c):n.all(e,t,c)}))}))},t.prototype.parametrize=function(e,t){return void 0===t&&(t=0),Object.keys(e).map((function(e,t){return'"'+e+'"=?'}))},t}(a.a)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var r=n(0),i=n(9),o=n(23),a=function(){function t(e,t,n,r,i){this.expressionMap=e,this.driver=t,this.rawRelationIdResults=n,this.rawRelationCountResults=r,this.queryRunner=i}return t.prototype.transform=function(e,t){var n=this,r=this.group(e,t),i=[];return r.forEach((function(e){var r=n.transformRawResultsGroup(e,t);void 0===r||Object.values(r).every((function(e){return null===e}))||i.push(r)})),i},t.prototype.group=function(t,n){var i=this,a=new Map,s=[];return"view"===n.metadata.tableType?s.push.apply(s,Object(r.f)([],Object(r.e)(n.metadata.columns.map((function(e){return o.a.buildAlias(i.driver,n.name,e.databaseName)}))))):s.push.apply(s,Object(r.f)([],Object(r.e)(n.metadata.primaryColumns.map((function(e){return o.a.buildAlias(i.driver,n.name,e.databaseName)}))))),t.forEach((function(t){var n=s.map((function(n){var r=t[n];return e.isBuffer(r)?r.toString("hex"):"object"==typeof r?JSON.stringify(r):r})).join("_"),r=a.get(n);r?r.push(t):a.set(n,[t])})),a},t.prototype.transformRawResultsGroup=function(e,t){var n=this,r=t.metadata;if(r.discriminatorColumn){var i=e.map((function(e){return e[o.a.buildAlias(n.driver,t.name,t.metadata.discriminatorColumn.databaseName)]})),a=r.childEntityMetadatas.find((function(e){return void 0!==i.find((function(t){return t===e.discriminatorValue}))}));a&&(r=a)}var s=-1!==this.expressionMap.options.indexOf("create-pojo")?{}:r.create(this.queryRunner),c=this.transformColumns(e,t,s,r),u=this.transformJoins(e,s,t,r),l=this.transformRelationIds(e,t,s,r),f=this.transformRelationCounts(e,t,s);return c||0===r.primaryColumns.filter((function(e){return!1===e.isVirtual})).length&&(u||l||f)?s:void 0},t.prototype.transformColumns=function(e,t,n,r){var i=this,a=!1;return r.columns.forEach((function(s){if(!(r.childEntityMetadatas.length>0&&-1!==r.childEntityMetadatas.map((function(e){return e.target})).indexOf(s.target))){var c=e[0][o.a.buildAlias(i.driver,t.name,s.databaseName)];void 0===c||s.isVirtual||i.expressionMap.selects.find((function(e){return e.selection===t.name||e.selection===t.name+"."+s.propertyPath}))&&(s.setEntityValue(n,i.driver.prepareHydratedValue(c,s)),null!==c&&(a=!0))}})),a},t.prototype.transformJoins=function(e,t,n,r){var i=this,o=!1;return this.expressionMap.joinAttributes.forEach((function(a){if(a.metadata&&a.isSelected){if(a.relation){var s=r.relations.find((function(e){return e.propertyPath===a.relation.propertyPath}));if(!s)return;s.inverseEntityMetadata&&(a.alias.metadata=s.inverseEntityMetadata)}if(a.mapToProperty){if(a.mapToPropertyParentAlias!==n.name)return}else if(!a.relation||a.parentAlias!==n.name||a.relationPropertyPath!==a.relation.propertyPath)return;var c=i.transform(e,a.alias);c=a.isMany?c:c[0],void 0!==(c=a.isMany||void 0!==c?c:null)&&(a.mapToPropertyPropertyName?t[a.mapToPropertyPropertyName]=c:a.relation.setEntityValue(t,c),o=!0)}})),o},t.prototype.transformRelationIds=function(e,t,n,r){var o=this,a=!1;return this.rawRelationIdResults.forEach((function(r){if(r.relationIdAttribute.parentAlias===t.name){var s=r.relationIdAttribute.relation,c=o.createValueMapFromJoinColumns(s,r.relationIdAttribute.parentAlias,e);if(null!=c){var u=r.results.map((function(e){var t=o.extractEntityPrimaryIds(s,e);if(!1!==i.a.compareIds(t,c)){var n,a=(n=s.isManyToOne||s.isOneToOneOwner?s.joinColumns.map((function(e){return e})):s.isOneToMany||s.isOneToOneNotOwner?s.inverseEntityMetadata.primaryColumns.map((function(e){return e})):s.isOwning?s.inverseJoinColumns.map((function(e){return e})):s.inverseRelation.joinColumns.map((function(e){return e}))).reduce((function(t,n){var r=e[n.databaseName];return s.isOneToMany||s.isOneToOneNotOwner?(n.isVirtual&&n.referencedColumn&&n.referencedColumn.propertyName!==n.propertyName&&(r=n.referencedColumn.createValueMap(r)),i.a.mergeDeep(t,n.createValueMap(r))):(n.referencedColumn.referencedColumn&&(r=n.referencedColumn.referencedColumn.createValueMap(r)),i.a.mergeDeep(t,n.referencedColumn.createValueMap(r)))}),{});return 1===n.length&&!1===r.relationIdAttribute.disableMixedMap?s.isOneToMany||s.isOneToOneNotOwner?n[0].getEntityValue(a):n[0].referencedColumn.getEntityValue(a):a}})).filter((function(e){return void 0!==e})),l=r.relationIdAttribute.mapToPropertyPropertyPath.split("."),f=function(e,t,n){var r=e.shift();return r&&0===e.length?(t[r]=n,t):r&&e.length>0?void f(e,t[r],n):t};s.isOneToOne||s.isManyToOne?void 0!==u[0]&&(f(l,n,u[0]),a=!0):(f(l,n,u),u.length>0&&(a=!0))}}})),a},t.prototype.transformRelationCounts=function(e,t,n){var r=this,i=!1;return this.rawRelationCountResults.filter((function(e){return e.relationCountAttribute.parentAlias===t.name})).forEach((function(a){var s,c=a.relationCountAttribute.relation;s=c.isOneToMany?c.inverseRelation.joinColumns[0].referencedColumn.databaseName:c.isOwning?c.joinColumns[0].referencedColumn.databaseName:c.inverseRelation.joinColumns[0].referencedColumn.databaseName;var u=e[0][o.a.buildAlias(r.driver,t.name,s)];null!=u&&(n[a.relationCountAttribute.mapToPropertyPropertyName]=0,a.results.filter((function(e){return e.parentId===u})).forEach((function(e){n[a.relationCountAttribute.mapToPropertyPropertyName]=parseInt(e.cnt),i=!0})))})),i},t.prototype.createValueMapFromJoinColumns=function(e,t,n){var r=this;return(e.isManyToOne||e.isOneToOneOwner?e.entityMetadata.primaryColumns.map((function(e){return e})):e.isOneToMany||e.isOneToOneNotOwner?e.inverseRelation.joinColumns.map((function(e){return e})):e.isOwning?e.joinColumns.map((function(e){return e})):e.inverseRelation.inverseJoinColumns.map((function(e){return e}))).reduce((function(i,a){return n.forEach((function(n){e.isManyToOne||e.isOneToOneOwner?i[a.databaseName]=r.driver.prepareHydratedValue(n[o.a.buildAlias(r.driver,t,a.databaseName)],a):i[a.databaseName]=r.driver.prepareHydratedValue(n[o.a.buildAlias(r.driver,t,a.referencedColumn.databaseName)],a)})),i}),{})},t.prototype.extractEntityPrimaryIds=function(e,t){return(e.isManyToOne||e.isOneToOneOwner?e.entityMetadata.primaryColumns.map((function(e){return e})):e.isOneToMany||e.isOneToOneNotOwner?e.inverseRelation.joinColumns.map((function(e){return e})):e.isOwning?e.joinColumns.map((function(e){return e})):e.inverseRelation.inverseJoinColumns.map((function(e){return e}))).reduce((function(e,n){return e[n.databaseName]=t[n.databaseName],e}),{})},t}()}).call(this,n(106).Buffer)},function(e,t,n){e.exports=n.p+"html/footerFragment.html"},function(e,t,n){e.exports=n.p+"html/cookieDialog.html"},function(e,t,n){e.exports=n.p+"html/menuFooterSiteTemplate.html"},function(e,t,n){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["So","Mo","Di","Mi","Do","Fr","Sa"],longhand:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},months:{shorthand:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],longhand:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},firstDayOfWeek:1,weekAbbreviation:"KW",rangeSeparator:" bis ",scrollTitle:"Zum Ändern scrollen",toggleTitle:"Zum Umschalten klicken",time_24hr:!0};t.l10ns.de=n;var r=t.l10ns;e.German=n,e.default=r,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){e.exports=n.p+"html/favoritesSite.html"},function(e,t,n){e.exports=n.p+"html/modifyPostSite.html"},function(e,t,n){e.exports=n.p+"html/churchListFragment.html"},function(e,t,n){e.exports=n.p+"html/impressumSite.html"},function(e,t){e.exports="./img/logo.png"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SetupUserManagement1000000001000=void 0;var a=n(13),s=n(4),SetupUserManagement1000000001000=function(){function SetupUserManagement1000000001000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SetupUserManagement1000000001000)}var e,t,n;return e=SetupUserManagement1000000001000,(t=[{key:"_isServer",value:function(){return"object"!==("undefined"==typeof document?"undefined":r(document))}},{key:"up",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._addAccess(e);case 2:return t.next=4,this._addRole(e);case 4:return t.next=6,this._addUser(e);case 6:return t.next=8,this._addRoleAccess(e);case 8:return t.next=10,this._addRoleChildren(e);case 10:return t.next=12,this._addUserRole(e);case 12:if(!this._isServer()){t.next=15;break}return t.next=15,this._addUserAccess(e);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"_addAccess",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new a.Table({name:"access",columns:[{name:"id",isPrimary:!0,type:s.BaseDatabase.TYPES.INTEGER,isGenerated:this._isServer(),generationStrategy:"increment"},{name:"createdAt",type:s.BaseDatabase.TYPES.DATE},{name:"updatedAt",type:s.BaseDatabase.TYPES.DATE},{name:"version",type:s.BaseDatabase.TYPES.INTEGER},{name:"deleted",type:s.BaseDatabase.TYPES.BOOLEAN},{name:"name",type:s.BaseDatabase.TYPES.STRING,isUnique:!0},{name:"description",type:s.BaseDatabase.TYPES.STRING}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_addRole",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new a.Table({name:"role",columns:[{name:"id",isPrimary:!0,type:s.BaseDatabase.TYPES.INTEGER,isGenerated:this._isServer(),generationStrategy:"increment"},{name:"createdAt",type:s.BaseDatabase.TYPES.DATE},{name:"updatedAt",type:s.BaseDatabase.TYPES.DATE},{name:"version",type:s.BaseDatabase.TYPES.INTEGER},{name:"deleted",type:s.BaseDatabase.TYPES.BOOLEAN},{name:"name",type:s.BaseDatabase.TYPES.STRING},{name:"description",type:s.BaseDatabase.TYPES.STRING}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_addUser",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new a.Table({name:"user",columns:[{name:"id",isPrimary:!0,type:s.BaseDatabase.TYPES.INTEGER,isGenerated:this._isServer(),generationStrategy:"increment"},{name:"createdAt",type:s.BaseDatabase.TYPES.DATE},{name:"updatedAt",type:s.BaseDatabase.TYPES.DATE},{name:"version",type:s.BaseDatabase.TYPES.INTEGER},{name:"deleted",type:s.BaseDatabase.TYPES.BOOLEAN},{name:"username",type:s.BaseDatabase.TYPES.STRING,isUnique:!0},{name:"email",type:s.BaseDatabase.TYPES.STRING,isUnique:!0},{name:"password",type:s.BaseDatabase.TYPES.STRING},{name:"activated",type:s.BaseDatabase.TYPES.BOOLEAN},{name:"blocked",type:s.BaseDatabase.TYPES.BOOLEAN},{name:"salt",type:s.BaseDatabase.TYPES.STRING}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_addRoleAccess",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new a.Table({name:"roleAccess",columns:[{name:"roleId",isPrimary:!0,type:s.BaseDatabase.TYPES.INTEGER},{name:"accessId",isPrimary:!0,type:s.BaseDatabase.TYPES.INTEGER}],indices:[{name:"IDX_38300dd4683a436f8db90b42bd",columnNames:["roleId"]},{name:"IDX_bd55fc382ad2480f75a17e33cb",columnNames:["accessId"]}],foreignKeys:[{name:"FK_38300dd4683a436f8db90b42bd9",columnNames:["roleId"],referencedTableName:"role",referencedColumnNames:["id"],onDelete:"cascade"},{name:"FK_bd55fc382ad2480f75a17e33cb5",columnNames:["accessId"],referencedTableName:"access",referencedColumnNames:["id"],onDelete:"cascade"}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))}},{key:"_addRoleChildren",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new a.Table({name:"roleChildren",columns:[{name:"childId",isPrimary:!0,type:s.BaseDatabase.TYPES.INTEGER},{name:"parentId",isPrimary:!0,type:s.BaseDatabase.TYPES.INTEGER}],indices:[{name:"IDX_030234c342756c67cefa480687",columnNames:["childId"]},{name:"IDX_35741f2d68a65c2765047705f8",columnNames:["parentId"]}],foreignKeys:[{name:"FK_roleChildren_childId",columnNames:["childId"],referencedTableName:"role",referencedColumnNames:["id"],onDelete:"cascade"},{name:"FK_roleChildren_parentId",columnNames:["parentId"],referencedTableName:"role",referencedColumnNames:["id"],onDelete:"cascade"}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))}},{key:"_addUserRole",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new a.Table({name:"userRole",columns:[{name:"userId",isPrimary:!0,type:s.BaseDatabase.TYPES.INTEGER},{name:"roleId",isPrimary:!0,type:s.BaseDatabase.TYPES.INTEGER}],indices:[{name:"IDX_userRole_userId",columnNames:["userId"]},{name:"IDX_userRole_roleId",columnNames:["roleId"]}],foreignKeys:[{name:"FK_userRole_userId",columnNames:["userId"],referencedTableName:"user",referencedColumnNames:["id"],onDelete:"cascade"},{name:"FK_userRole_roleId",columnNames:["roleId"],referencedTableName:"role",referencedColumnNames:["id"],onDelete:"cascade"}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))}},{key:"_addUserAccess",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new a.Table({name:"user_access",columns:[{name:"id",isPrimary:!0,isGenerated:this._isServer(),generationStrategy:"increment",type:s.BaseDatabase.TYPES.INTEGER},{name:"userId",type:s.BaseDatabase.TYPES.INTEGER,isNullable:!0},{name:"accessId",type:s.BaseDatabase.TYPES.INTEGER,isNullable:!0}],indices:[{name:"IDX_userAccess_userId",columnNames:["userId"]},{name:"IDX_userAccess_accessId",columnNames:["accessId"]}],foreignKeys:[{name:"FK_userAccess_userId",columnNames:["userId"],referencedTableName:"user",referencedColumnNames:["id"],onDelete:"cascade"},{name:"FK_userAccess_accessId",columnNames:["accessId"],referencedTableName:"access",referencedColumnNames:["id"],onDelete:"cascade"}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"down",value:function(e){}}])&&i(e.prototype,t),n&&i(e,n),SetupUserManagement1000000001000}();t.SetupUserManagement1000000001000=SetupUserManagement1000000001000},function(e,t,n){e.exports=n.p+"html/modifyFsjSite.html"},function(e,t,n){e.exports=n.p+"html/showFsjChurchSite.html"},function(e,t,n){e.exports=n.p+"html/listFsjsSite.html"},function(e,t,n){e.exports=n.p+"html/settingsSite.html"},function(e,t,n){e.exports=n.p+"html/notificationsSettingsFragment.html"},function(e,t,n){e.exports=n.p+"html/aboutUsSite.html"},,,function(e,t,n){n(310),n(579),e.exports=n(578)},function(e,t,n){"use strict";n(311);var r,i=(r=n(483))&&r.__esModule?r:{default:r};i.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),i.default._babelPolyfill=!0},function(e,t,n){"use strict";n(312),n(455),n(457),n(460),n(462),n(464),n(466),n(468),n(470),n(472),n(474),n(476),n(478),n(482)},function(e,t,n){n(313),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355),n(356),n(357),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(385),n(386),n(387),n(388),n(389),n(390),n(391),n(392),n(394),n(395),n(397),n(398),n(399),n(400),n(401),n(402),n(403),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(188),n(418),n(234),n(419),n(235),n(420),n(421),n(422),n(423),n(236),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),e.exports=n(33)},function(e,t,n){"use strict";var r=n(17),i=n(60),o=n(36),a=n(6),s=n(54),c=n(92).KEY,u=n(18),l=n(140),f=n(112),h=n(96),d=n(25),p=n(169),m=n(215),y=n(315),g=n(143),b=n(19),v=n(20),w=n(46),_=n(62),k=n(91),E=n(95),O=n(100),T=n(218),x=n(78),S=n(142),C=n(37),R=n(98),P=x.f,N=C.f,M=T.f,A=r.Symbol,j=r.JSON,I=j&&j.stringify,D=d("_hidden"),L=d("toPrimitive"),B={}.propertyIsEnumerable,F=l("symbol-registry"),q=l("symbols"),V=l("op-symbols"),U=Object.prototype,H="function"==typeof A&&!!S.f,z=r.QObject,W=!z||!z.prototype||!z.prototype.findChild,Y=o&&u((function(){return 7!=O(N({},"a",{get:function(){return N(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=P(U,t);r&&delete U[t],N(e,t,n),r&&e!==U&&N(U,t,r)}:N,Q=function(e){var t=q[e]=O(A.prototype);return t._k=e,t},G=H&&"symbol"==typeof A.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof A},J=function(e,t,n){return e===U&&J(V,t,n),b(e),t=k(t,!0),b(n),i(q,t)?(n.enumerable?(i(e,D)&&e[D][t]&&(e[D][t]=!1),n=O(n,{enumerable:E(0,!1)})):(i(e,D)||N(e,D,E(1,{})),e[D][t]=!0),Y(e,t,n)):N(e,t,n)},K=function(e,t){b(e);for(var n,r=y(t=_(t)),i=0,o=r.length;o>i;)J(e,n=r[i++],t[n]);return e},$=function(e){var t=B.call(this,e=k(e,!0));return!(this===U&&i(q,e)&&!i(V,e))&&(!(t||!i(this,e)||!i(q,e)||i(this,D)&&this[D][e])||t)},X=function(e,t){if(e=_(e),t=k(t,!0),e!==U||!i(q,t)||i(V,t)){var n=P(e,t);return!n||!i(q,t)||i(e,D)&&e[D][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=M(_(e)),r=[],o=0;n.length>o;)i(q,t=n[o++])||t==D||t==c||r.push(t);return r},ee=function(e){for(var t,n=e===U,r=M(n?V:_(e)),o=[],a=0;r.length>a;)!i(q,t=r[a++])||n&&!i(U,t)||o.push(q[t]);return o};H||(s((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(n){this===U&&t.call(V,n),i(this,D)&&i(this[D],e)&&(this[D][e]=!1),Y(this,e,E(1,n))};return o&&W&&Y(U,e,{configurable:!0,set:t}),Q(e)}).prototype,"toString",(function(){return this._k})),x.f=X,C.f=J,n(101).f=T.f=Z,n(134).f=$,S.f=ee,o&&!n(97)&&s(U,"propertyIsEnumerable",$,!0),p.f=function(e){return Q(d(e))}),a(a.G+a.W+a.F*!H,{Symbol:A});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)d(te[ne++]);for(var re=R(d.store),ie=0;re.length>ie;)m(re[ie++]);a(a.S+a.F*!H,"Symbol",{for:function(e){return i(F,e+="")?F[e]:F[e]=A(e)},keyFor:function(e){if(!G(e))throw TypeError(e+" is not a symbol!");for(var t in F)if(F[t]===e)return t},useSetter:function(){W=!0},useSimple:function(){W=!1}}),a(a.S+a.F*!H,"Object",{create:function(e,t){return void 0===t?O(e):K(O(e),t)},defineProperty:J,defineProperties:K,getOwnPropertyDescriptor:X,getOwnPropertyNames:Z,getOwnPropertySymbols:ee});var oe=u((function(){S.f(1)}));a(a.S+a.F*oe,"Object",{getOwnPropertySymbols:function(e){return S.f(w(e))}}),j&&a(a.S+a.F*(!H||u((function(){var e=A();return"[null]"!=I([e])||"{}"!=I({a:e})||"{}"!=I(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(v(t)||void 0!==e)&&!G(e))return g(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!G(t))return t}),r[1]=t,I.apply(j,r)}}),A.prototype[L]||n(61)(A.prototype,L,A.prototype.valueOf),f(A,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(e,t,n){e.exports=n(140)("native-function-to-string",Function.toString)},function(e,t,n){var r=n(98),i=n(142),o=n(134);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,s=n(e),c=o.f,u=0;s.length>u;)c.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,n){var r=n(6);r(r.S,"Object",{create:n(100)})},function(e,t,n){var r=n(6);r(r.S+r.F*!n(36),"Object",{defineProperty:n(37).f})},function(e,t,n){var r=n(6);r(r.S+r.F*!n(36),"Object",{defineProperties:n(217)})},function(e,t,n){var r=n(62),i=n(78).f;n(79)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(r(e),t)}}))},function(e,t,n){var r=n(46),i=n(102);n(79)("getPrototypeOf",(function(){return function(e){return i(r(e))}}))},function(e,t,n){var r=n(46),i=n(98);n(79)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t,n){n(79)("getOwnPropertyNames",(function(){return n(218).f}))},function(e,t,n){var r=n(20),i=n(92).onFreeze;n(79)("freeze",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(20),i=n(92).onFreeze;n(79)("seal",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(20),i=n(92).onFreeze;n(79)("preventExtensions",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(20);n(79)("isFrozen",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(20);n(79)("isSealed",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(20);n(79)("isExtensible",(function(e){return function(t){return!!r(t)&&(!e||e(t))}}))},function(e,t,n){var r=n(6);r(r.S+r.F,"Object",{assign:n(219)})},function(e,t,n){var r=n(6);r(r.S,"Object",{is:n(220)})},function(e,t,n){var r=n(6);r(r.S,"Object",{setPrototypeOf:n(173).set})},function(e,t,n){"use strict";var r=n(135),i={};i[n(25)("toStringTag")]="z",i+""!="[object z]"&&n(54)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){var r=n(6);r(r.P,"Function",{bind:n(221)})},function(e,t,n){var r=n(37).f,i=Function.prototype,o=/^\s*function ([^ (]*)/,a="name";a in i||n(36)&&r(i,a,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(20),i=n(102),o=n(25)("hasInstance"),a=Function.prototype;o in a||n(37).f(a,o,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){var r=n(6),i=n(223);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(e,t,n){var r=n(6),i=n(224);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(e,t,n){"use strict";var r=n(17),i=n(60),o=n(87),a=n(175),s=n(91),c=n(18),u=n(101).f,l=n(78).f,f=n(37).f,h=n(113).trim,d="Number",p=r.Number,m=p,y=p.prototype,g=o(n(100)(y))==d,b="trim"in String.prototype,v=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){var n,r,i,o=(t=b?t.trim():h(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var a,c=t.slice(2),u=0,l=c.length;u<l;u++)if((a=c.charCodeAt(u))<48||a>i)return NaN;return parseInt(c,r)}}return+t};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof p&&(g?c((function(){y.valueOf.call(n)})):o(n)!=d)?a(new m(v(t)),n,p):v(t)};for(var w,_=n(36)?u(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;_.length>k;k++)i(m,w=_[k])&&!i(p,w)&&f(p,w,l(m,w));p.prototype=y,y.constructor=p,n(54)(r,d,p)}},function(e,t,n){"use strict";var r=n(6),i=n(77),o=n(225),a=n(176),s=1..toFixed,c=Math.floor,u=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",f="0",h=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*u[n],u[n]=r%1e7,r=c(r/1e7)},d=function(e){for(var t=6,n=0;--t>=0;)n+=u[t],u[t]=c(n/e),n=n%e*1e7},p=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==u[e]){var n=String(u[e]);t=""===t?n:t+a.call(f,7-n.length)+n}return t},m=function(e,t,n){return 0===t?n:t%2==1?m(e,t-1,n*e):m(e*e,t/2,n)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(18)((function(){s.call({})}))),"Number",{toFixed:function(e){var t,n,r,s,c=o(this,l),u=i(e),y="",g=f;if(u<0||u>20)throw RangeError(l);if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(y="-",c=-c),c>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(c*m(2,69,1))-69)<0?c*m(2,-t,1):c/m(2,t,1),n*=4503599627370496,(t=52-t)>0){for(h(0,n),r=u;r>=7;)h(1e7,0),r-=7;for(h(m(10,r,1),0),r=t-1;r>=23;)d(1<<23),r-=23;d(1<<r),h(1,1),d(2),g=p()}else h(0,n),h(1<<-t,0),g=p()+a.call(f,u);return g=u>0?y+((s=g.length)<=u?"0."+a.call(f,u-s)+g:g.slice(0,s-u)+"."+g.slice(s-u)):y+g}})},function(e,t,n){"use strict";var r=n(6),i=n(18),o=n(225),a=1..toPrecision;r(r.P+r.F*(i((function(){return"1"!==a.call(1,void 0)}))||!i((function(){a.call({})}))),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?a.call(t):a.call(t,e)}})},function(e,t,n){var r=n(6);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var r=n(6),i=n(17).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,n){var r=n(6);r(r.S,"Number",{isInteger:n(226)})},function(e,t,n){var r=n(6);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(6),i=n(226),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},function(e,t,n){var r=n(6);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(6);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(6),i=n(224);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,n){var r=n(6),i=n(223);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,n){var r=n(6),i=n(227),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},function(e,t,n){var r=n(6),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,n){var r=n(6),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var r=n(6),i=n(177);r(r.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){var r=n(6);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var r=n(6),i=Math.exp;r(r.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},function(e,t,n){var r=n(6),i=n(178);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,n){var r=n(6);r(r.S,"Math",{fround:n(358)})},function(e,t,n){var r=n(177),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),c=i(2,-126);e.exports=Math.fround||function(e){var t,n,i=Math.abs(e),u=r(e);return i<c?u*(i/c/a+1/o-1/o)*c*a:(n=(t=(1+a/o)*i)-(t-i))>s||n!=n?u*(1/0):u*n}},function(e,t,n){var r=n(6),i=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,o=0,a=0,s=arguments.length,c=0;a<s;)c<(n=i(arguments[a++]))?(o=o*(r=c/n)*r+1,c=n):o+=n>0?(r=n/c)*r:n;return c===1/0?1/0:c*Math.sqrt(o)}})},function(e,t,n){var r=n(6),i=Math.imul;r(r.S+r.F*n(18)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(e,t){var n=65535,r=+e,i=+t,o=n&r,a=n&i;return 0|o*a+((n&r>>>16)*a+o*(n&i>>>16)<<16>>>0)}})},function(e,t,n){var r=n(6);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){var r=n(6);r(r.S,"Math",{log1p:n(227)})},function(e,t,n){var r=n(6);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var r=n(6);r(r.S,"Math",{sign:n(177)})},function(e,t,n){var r=n(6),i=n(178),o=Math.exp;r(r.S+r.F*n(18)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},function(e,t,n){var r=n(6),i=n(178),o=Math.exp;r(r.S,"Math",{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},function(e,t,n){var r=n(6);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){var r=n(6),i=n(99),o=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,a=0;r>a;){if(t=+arguments[a++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var r=n(6),i=n(62),o=n(29);r(r.S,"String",{raw:function(e){for(var t=i(e.raw),n=o(t.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(t[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(e,t,n){"use strict";n(113)("trim",(function(e){return function(){return e(this,3)}}))},function(e,t,n){"use strict";var r=n(179)(!0);n(180)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var r=n(6),i=n(179)(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(6),i=n(29),o=n(181),a="endsWith",s="".endsWith;r(r.P+r.F*n(183)(a),"String",{endsWith:function(e){var t=o(this,e,a),n=arguments.length>1?arguments[1]:void 0,r=i(t.length),c=void 0===n?r:Math.min(i(n),r),u=String(e);return s?s.call(t,u,c):t.slice(c-u.length,c)===u}})},function(e,t,n){"use strict";var r=n(6),i=n(181),o="includes";r(r.P+r.F*n(183)(o),"String",{includes:function(e){return!!~i(this,e,o).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(6);r(r.P,"String",{repeat:n(176)})},function(e,t,n){"use strict";var r=n(6),i=n(29),o=n(181),a="startsWith",s="".startsWith;r(r.P+r.F*n(183)(a),"String",{startsWith:function(e){var t=o(this,e,a),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return s?s.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(55)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},function(e,t,n){"use strict";n(55)("big",(function(e){return function(){return e(this,"big","","")}}))},function(e,t,n){"use strict";n(55)("blink",(function(e){return function(){return e(this,"blink","","")}}))},function(e,t,n){"use strict";n(55)("bold",(function(e){return function(){return e(this,"b","","")}}))},function(e,t,n){"use strict";n(55)("fixed",(function(e){return function(){return e(this,"tt","","")}}))},function(e,t,n){"use strict";n(55)("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}}))},function(e,t,n){"use strict";n(55)("fontsize",(function(e){return function(t){return e(this,"font","size",t)}}))},function(e,t,n){"use strict";n(55)("italics",(function(e){return function(){return e(this,"i","","")}}))},function(e,t,n){"use strict";n(55)("link",(function(e){return function(t){return e(this,"a","href",t)}}))},function(e,t,n){"use strict";n(55)("small",(function(e){return function(){return e(this,"small","","")}}))},function(e,t,n){"use strict";n(55)("strike",(function(e){return function(){return e(this,"strike","","")}}))},function(e,t,n){"use strict";n(55)("sub",(function(e){return function(){return e(this,"sub","","")}}))},function(e,t,n){"use strict";n(55)("sup",(function(e){return function(){return e(this,"sup","","")}}))},function(e,t,n){var r=n(6);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(6),i=n(46),o=n(91);r(r.P+r.F*n(18)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=i(this),n=o(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(6),i=n(393);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,n){"use strict";var r=n(18),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(e){return e>9?e:"0"+e};e.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-50000000000001))}))||!r((function(){o.call(new Date(NaN))}))?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:o},function(e,t,n){var r=Date.prototype,i="Invalid Date",o="toString",a=r.toString,s=r.getTime;new Date(NaN)+""!=i&&n(54)(r,o,(function(){var e=s.call(this);return e==e?a.call(this):i}))},function(e,t,n){var r=n(25)("toPrimitive"),i=Date.prototype;r in i||n(61)(i,r,n(396))},function(e,t,n){"use strict";var r=n(19),i=n(91),o="number";e.exports=function(e){if("string"!==e&&e!==o&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),e!=o)}},function(e,t,n){var r=n(6);r(r.S,"Array",{isArray:n(143)})},function(e,t,n){"use strict";var r=n(75),i=n(6),o=n(46),a=n(229),s=n(184),c=n(29),u=n(185),l=n(186);i(i.S+i.F*!n(144)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,f,h=o(e),d="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,y=void 0!==m,g=0,b=l(h);if(y&&(m=r(m,p>2?arguments[2]:void 0,2)),null==b||d==Array&&s(b))for(n=new d(t=c(h.length));t>g;g++)u(n,g,y?m(h[g],g):h[g]);else for(f=b.call(h),n=new d;!(i=f.next()).done;g++)u(n,g,y?a(f,m,[i.value,g],!0):i.value);return n.length=g,n}})},function(e,t,n){"use strict";var r=n(6),i=n(185);r(r.S+r.F*n(18)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)i(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(6),i=n(62),o=[].join;r(r.P+r.F*(n(133)!=Object||!n(67)(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(6),i=n(172),o=n(87),a=n(99),s=n(29),c=[].slice;r(r.P+r.F*n(18)((function(){i&&c.call(i)})),"Array",{slice:function(e,t){var n=s(this.length),r=o(this);if(t=void 0===t?n:t,"Array"==r)return c.call(this,e,t);for(var i=a(e,n),u=a(t,n),l=s(u-i),f=new Array(l),h=0;h<l;h++)f[h]="String"==r?this.charAt(i+h):this[i+h];return f}})},function(e,t,n){"use strict";var r=n(6),i=n(76),o=n(46),a=n(18),s=[].sort,c=[1,2,3];r(r.P+r.F*(a((function(){c.sort(void 0)}))||!a((function(){c.sort(null)}))||!n(67)(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},function(e,t,n){"use strict";var r=n(6),i=n(80)(0),o=n(67)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,n){var r=n(20),i=n(143),o=n(25)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(6),i=n(80)(1);r(r.P+r.F*!n(67)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(6),i=n(80)(2);r(r.P+r.F*!n(67)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(6),i=n(80)(3);r(r.P+r.F*!n(67)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(6),i=n(80)(4);r(r.P+r.F*!n(67)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(6),i=n(231);r(r.P+r.F*!n(67)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(6),i=n(231);r(r.P+r.F*!n(67)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(6),i=n(141)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(67)(o)),"Array",{indexOf:function(e){return a?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(6),i=n(62),o=n(77),a=n(29),s=[].lastIndexOf,c=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(c||!n(67)(s)),"Array",{lastIndexOf:function(e){if(c)return s.apply(this,arguments)||0;var t=i(this),n=a(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){var r=n(6);r(r.P,"Array",{copyWithin:n(232)}),n(103)("copyWithin")},function(e,t,n){var r=n(6);r(r.P,"Array",{fill:n(187)}),n(103)("fill")},function(e,t,n){"use strict";var r=n(6),i=n(80)(5),o="find",a=!0;o in[]&&Array(1).find((function(){a=!1})),r(r.P+r.F*a,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(103)(o)},function(e,t,n){"use strict";var r=n(6),i=n(80)(6),o="findIndex",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r(r.P+r.F*a,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(103)(o)},function(e,t,n){n(115)("Array")},function(e,t,n){var r=n(17),i=n(175),o=n(37).f,a=n(101).f,s=n(182),c=n(145),u=r.RegExp,l=u,f=u.prototype,h=/a/g,d=/a/g,p=new u(h)!==h;if(n(36)&&(!p||n(18)((function(){return d[n(25)("match")]=!1,u(h)!=h||u(d)==d||"/a/i"!=u(h,"i")})))){u=function(e,t){var n=this instanceof u,r=s(e),o=void 0===t;return!n&&r&&e.constructor===u&&o?e:i(p?new l(r&&!o?e.source:e,t):l((r=e instanceof u)?e.source:e,r&&o?c.call(e):t),n?this:f,u)};for(var m=function(e){e in u||o(u,e,{configurable:!0,get:function(){return l[e]},set:function(t){l[e]=t}})},y=a(l),g=0;y.length>g;)m(y[g++]);f.constructor=u,u.prototype=f,n(54)(r,"RegExp",u)}n(115)("RegExp")},function(e,t,n){"use strict";n(235);var r=n(19),i=n(145),o=n(36),a="toString",s=/./.toString,c=function(e){n(54)(RegExp.prototype,a,e,!0)};n(18)((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?c((function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)})):s.name!=a&&c((function(){return s.call(this)}))},function(e,t,n){"use strict";var r=n(19),i=n(29),o=n(190),a=n(146);n(147)("match",1,(function(e,t,n,s){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=s(n,e,this);if(t.done)return t.value;var c=r(e),u=String(this);if(!c.global)return a(c,u);var l=c.unicode;c.lastIndex=0;for(var f,h=[],d=0;null!==(f=a(c,u));){var p=String(f[0]);h[d]=p,""===p&&(c.lastIndex=o(u,i(c.lastIndex),l)),d++}return 0===d?null:h}]}))},function(e,t,n){"use strict";var r=n(19),i=n(46),o=n(29),a=n(77),s=n(190),c=n(146),u=Math.max,l=Math.min,f=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g;n(147)("replace",2,(function(e,t,n,p){return[function(r,i){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(e,t){var i=p(n,e,this,t);if(i.done)return i.value;var f=r(e),h=String(this),d="function"==typeof t;d||(t=String(t));var y=f.global;if(y){var g=f.unicode;f.lastIndex=0}for(var b=[];;){var v=c(f,h);if(null===v)break;if(b.push(v),!y)break;""===String(v[0])&&(f.lastIndex=s(h,o(f.lastIndex),g))}for(var w,_="",k=0,E=0;E<b.length;E++){v=b[E];for(var O=String(v[0]),T=u(l(a(v.index),h.length),0),x=[],S=1;S<v.length;S++)x.push(void 0===(w=v[S])?w:String(w));var C=v.groups;if(d){var R=[O].concat(x,T,h);void 0!==C&&R.push(C);var P=String(t.apply(void 0,R))}else P=m(O,h,T,x,C,t);T>=k&&(_+=h.slice(k,T)+P,k=T+O.length)}return _+h.slice(k)}];function m(e,t,r,o,a,s){var c=r+e.length,u=o.length,l=d;return void 0!==a&&(a=i(a),l=h),n.call(s,l,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(c);case"<":s=a[i.slice(1,-1)];break;default:var l=+i;if(0===l)return n;if(l>u){var h=f(l/10);return 0===h?n:h<=u?void 0===o[h-1]?i.charAt(1):o[h-1]+i.charAt(1):n}s=o[l-1]}return void 0===s?"":s}))}}))},function(e,t,n){"use strict";var r=n(19),i=n(220),o=n(146);n(147)("search",1,(function(e,t,n,a){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=a(n,e,this);if(t.done)return t.value;var s=r(e),c=String(this),u=s.lastIndex;i(u,0)||(s.lastIndex=0);var l=o(s,c);return i(s.lastIndex,u)||(s.lastIndex=u),null===l?-1:l.index}]}))},function(e,t,n){"use strict";var r=n(182),i=n(19),o=n(136),a=n(190),s=n(29),c=n(146),u=n(189),l=n(18),f=Math.min,h=[].push,d=4294967295,p=!l((function(){RegExp(d,"y")}));n(147)("split",2,(function(e,t,n,l){var m;return m="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(i,e,t);for(var o,a,s,c=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,p=void 0===t?d:t>>>0,m=new RegExp(e.source,l+"g");(o=u.call(m,i))&&!((a=m.lastIndex)>f&&(c.push(i.slice(f,o.index)),o.length>1&&o.index<i.length&&h.apply(c,o.slice(1)),s=o[0].length,f=a,c.length>=p));)m.lastIndex===o.index&&m.lastIndex++;return f===i.length?!s&&m.test("")||c.push(""):c.push(i.slice(f)),c.length>p?c.slice(0,p):c}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,r){var i=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):m.call(String(i),n,r)},function(e,t){var r=l(m,e,this,t,m!==n);if(r.done)return r.value;var u=i(e),h=String(this),y=o(u,RegExp),g=u.unicode,b=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(p?"y":"g"),v=new y(p?u:"^(?:"+u.source+")",b),w=void 0===t?d:t>>>0;if(0===w)return[];if(0===h.length)return null===c(v,h)?[h]:[];for(var _=0,k=0,E=[];k<h.length;){v.lastIndex=p?k:0;var O,T=c(v,p?h:h.slice(k));if(null===T||(O=f(s(v.lastIndex+(p?0:k)),h.length))===_)k=a(h,k,g);else{if(E.push(h.slice(_,k)),E.length===w)return E;for(var x=1;x<=T.length-1;x++)if(E.push(T[x]),E.length===w)return E;k=_=O}}return E.push(h.slice(_)),E}]}))},function(e,t,n){var r=n(17),i=n(191).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,c="process"==n(87)(a);e.exports=function(){var e,t,n,u=function(){var r,i;for(c&&(r=a.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){a.nextTick(u)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);n=function(){l.then(u)}}else n=function(){i.call(r,u)};else{var f=!0,h=document.createTextNode("");new o(u).observe(h,{characterData:!0}),n=function(){h.data=f=!f}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){"use strict";var r=n(239),i=n(104),o="Map";e.exports=n(150)(o,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=r.getEntry(i(this,o),e);return t&&t.v},set:function(e,t){return r.def(i(this,o),0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";var r=n(239),i=n(104);e.exports=n(150)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r,i=n(17),o=n(80)(0),a=n(54),s=n(92),c=n(219),u=n(240),l=n(20),f=n(104),h=n(104),d=!i.ActiveXObject&&"ActiveXObject"in i,p="WeakMap",m=s.getWeak,y=Object.isExtensible,g=u.ufstore,b=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(e){if(l(e)){var t=m(e);return!0===t?g(f(this,p)).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(f(this,p),e,t)}},w=e.exports=n(150)(p,b,v,u,!0,!0);h&&d&&(c((r=u.getConstructor(b,p)).prototype,v),s.NEED=!0,o(["delete","has","get","set"],(function(e){var t=w.prototype,n=t[e];a(t,e,(function(t,i){if(l(t)&&!y(t)){this._f||(this._f=new r);var o=this._f[e](t,i);return"set"==e?this:o}return n.call(this,t,i)}))})))},function(e,t,n){"use strict";var r=n(240),i=n(104),o="WeakSet";n(150)(o,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,o),e,!0)}},r,!1,!0)},function(e,t,n){"use strict";var r=n(6),i=n(151),o=n(192),a=n(19),s=n(99),c=n(29),u=n(20),l=n(17).ArrayBuffer,f=n(136),h=o.ArrayBuffer,d=o.DataView,p=i.ABV&&l.isView,m=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";r(r.G+r.W+r.F*(l!==h),{ArrayBuffer:h}),r(r.S+r.F*!i.CONSTR,g,{isView:function(e){return p&&p(e)||u(e)&&y in e}}),r(r.P+r.U+r.F*n(18)((function(){return!new h(2).slice(1,void 0).byteLength})),g,{slice:function(e,t){if(void 0!==m&&void 0===t)return m.call(a(this),e);for(var n=a(this).byteLength,r=s(e,n),i=s(void 0===t?n:t,n),o=new(f(this,h))(c(i-r)),u=new d(this),l=new d(o),p=0;r<i;)l.setUint8(p++,u.getUint8(r++));return o}}),n(115)(g)},function(e,t,n){var r=n(6);r(r.G+r.W+r.F*!n(151).ABV,{DataView:n(192).DataView})},function(e,t,n){n(89)("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(89)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(89)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0)},function(e,t,n){n(89)("Int16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(89)("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(89)("Int32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(89)("Uint32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(89)("Float32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(89)("Float64",8,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){var r=n(6),i=n(76),o=n(19),a=(n(17).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(18)((function(){a((function(){}))})),"Reflect",{apply:function(e,t,n){var r=i(e),c=o(n);return a?a(r,t,c):s.call(r,t,c)}})},function(e,t,n){var r=n(6),i=n(100),o=n(76),a=n(19),s=n(20),c=n(18),u=n(221),l=(n(17).Reflect||{}).construct,f=c((function(){function e(){}return!(l((function(){}),[],e)instanceof e)})),h=!c((function(){l((function(){}))}));r(r.S+r.F*(f||h),"Reflect",{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(h&&!f)return l(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(u.apply(e,r))}var c=n.prototype,d=i(s(c)?c:Object.prototype),p=Function.apply.call(e,d,t);return s(p)?p:d}})},function(e,t,n){var r=n(37),i=n(6),o=n(19),a=n(91);i(i.S+i.F*n(18)((function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,n){o(e),t=a(t,!0),o(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(6),i=n(78).f,o=n(19);r(r.S,"Reflect",{deleteProperty:function(e,t){var n=i(o(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){"use strict";var r=n(6),i=n(19),o=function(e){this._t=i(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(228)(o,"Object",(function(){var e,t=this,n=t._k;do{if(t._i>=n.length)return{value:void 0,done:!0}}while(!((e=n[t._i++])in t._t));return{value:e,done:!1}})),r(r.S,"Reflect",{enumerate:function(e){return new o(e)}})},function(e,t,n){var r=n(78),i=n(102),o=n(60),a=n(6),s=n(20),c=n(19);a(a.S,"Reflect",{get:function e(t,n){var a,u,l=arguments.length<3?t:arguments[2];return c(t)===l?t[n]:(a=r.f(t,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(l):void 0:s(u=i(t))?e(u,n,l):void 0}})},function(e,t,n){var r=n(78),i=n(6),o=n(19);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(o(e),t)}})},function(e,t,n){var r=n(6),i=n(102),o=n(19);r(r.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},function(e,t,n){var r=n(6);r(r.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){var r=n(6),i=n(19),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},function(e,t,n){var r=n(6);r(r.S,"Reflect",{ownKeys:n(242)})},function(e,t,n){var r=n(6),i=n(19),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},function(e,t,n){var r=n(37),i=n(78),o=n(102),a=n(60),s=n(6),c=n(95),u=n(19),l=n(20);s(s.S,"Reflect",{set:function e(t,n,s){var f,h,d=arguments.length<4?t:arguments[3],p=i.f(u(t),n);if(!p){if(l(h=o(t)))return e(h,n,s,d);p=c(0)}if(a(p,"value")){if(!1===p.writable||!l(d))return!1;if(f=i.f(d,n)){if(f.get||f.set||!1===f.writable)return!1;f.value=s,r.f(d,n,f)}else r.f(d,n,c(0,s));return!0}return void 0!==p.set&&(p.set.call(d,s),!0)}})},function(e,t,n){var r=n(6),i=n(173);i&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},function(e,t,n){n(456),e.exports=n(33).Array.includes},function(e,t,n){"use strict";var r=n(6),i=n(141)(!0);r(r.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(103)("includes")},function(e,t,n){n(458),e.exports=n(33).Array.flatMap},function(e,t,n){"use strict";var r=n(6),i=n(459),o=n(46),a=n(29),s=n(76),c=n(230);r(r.P,"Array",{flatMap:function(e){var t,n,r=o(this);return s(e),t=a(r.length),n=c(r,0),i(n,r,r,t,0,1,e,arguments[1]),n}}),n(103)("flatMap")},function(e,t,n){"use strict";var r=n(143),i=n(20),o=n(29),a=n(75),s=n(25)("isConcatSpreadable");e.exports=function e(t,n,c,u,l,f,h,d){for(var p,m,y=l,g=0,b=!!h&&a(h,d,3);g<u;){if(g in c){if(p=b?b(c[g],g,n):c[g],m=!1,i(p)&&(m=void 0!==(m=p[s])?!!m:r(p)),m&&f>0)y=e(t,n,p,o(p.length),y,f-1)-1;else{if(y>=9007199254740991)throw TypeError();t[y]=p}y++}g++}return y}},function(e,t,n){n(461),e.exports=n(33).String.padStart},function(e,t,n){"use strict";var r=n(6),i=n(243),o=n(149),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*a,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){n(463),e.exports=n(33).String.padEnd},function(e,t,n){"use strict";var r=n(6),i=n(243),o=n(149),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*a,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){n(465),e.exports=n(33).String.trimLeft},function(e,t,n){"use strict";n(113)("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart")},function(e,t,n){n(467),e.exports=n(33).String.trimRight},function(e,t,n){"use strict";n(113)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},function(e,t,n){n(469),e.exports=n(169).f("asyncIterator")},function(e,t,n){n(215)("asyncIterator")},function(e,t,n){n(471),e.exports=n(33).Object.getOwnPropertyDescriptors},function(e,t,n){var r=n(6),i=n(242),o=n(62),a=n(78),s=n(185);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=o(e),c=a.f,u=i(r),l={},f=0;u.length>f;)void 0!==(n=c(r,t=u[f++]))&&s(l,t,n);return l}})},function(e,t,n){n(473),e.exports=n(33).Object.values},function(e,t,n){var r=n(6),i=n(244)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){n(475),e.exports=n(33).Object.entries},function(e,t,n){var r=n(6),i=n(244)(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},function(e,t,n){"use strict";n(236),n(477),e.exports=n(33).Promise.finally},function(e,t,n){"use strict";var r=n(6),i=n(33),o=n(17),a=n(136),s=n(238);r(r.P+r.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then((function(){return n}))}:e,n?function(n){return s(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){n(479),n(480),n(481),e.exports=n(33)},function(e,t,n){var r=n(17),i=n(6),o=n(149),a=[].slice,s=/MSIE .\./.test(o),c=function(e){return function(t,n){var r=arguments.length>2,i=!!r&&a.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};i(i.G+i.B+i.F*s,{setTimeout:c(r.setTimeout),setInterval:c(r.setInterval)})},function(e,t,n){var r=n(6),i=n(191);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t,n){for(var r=n(188),i=n(98),o=n(54),a=n(17),s=n(61),c=n(114),u=n(25),l=u("iterator"),f=u("toStringTag"),h=c.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(d),m=0;m<p.length;m++){var y,g=p[m],b=d[g],v=a[g],w=v&&v.prototype;if(w&&(w[l]||s(w,l,h),w[f]||s(w,f,g),c[g]=h,b))for(y in r)w[y]||o(w,y,r[y],!0)}},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),a=new C(r||[]);return o._invoke=function(e,t,n){var r=f;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return P()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var c=l(e,t,n);if("normal"===c.type){if(r=n.done?p:h,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}(e,n,a),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var f="suspendedStart",h="suspendedYield",d="executing",p="completed",m={};function y(){}function g(){}function b(){}var v={};v[o]=function(){return this};var w=Object.getPrototypeOf,_=w&&w(w(R([])));_&&_!==n&&r.call(_,o)&&(v=_);var k=b.prototype=y.prototype=Object.create(v);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(i,o,a,s){var c=l(e[i],e,o);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(f).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function T(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function R(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:P}}function P(){return{value:t,done:!0}}return g.prototype=k.constructor=b,b.constructor=g,g.displayName=c(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,s,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},E(O.prototype),O.prototype[a]=function(){return this},e.AsyncIterator=O,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new O(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(k),c(k,s,"Generator"),k[o]=function(){return this},k.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:R(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){n(484),e.exports=n(245).global},function(e,t,n){var r=n(485);r(r.G,{global:n(193)})},function(e,t,n){var r=n(193),i=n(245),o=n(486),a=n(488),s=n(495),c=function(e,t,n){var u,l,f,h=e&c.F,d=e&c.G,p=e&c.S,m=e&c.P,y=e&c.B,g=e&c.W,b=d?i:i[t]||(i[t]={}),v=b.prototype,w=d?r:p?r[t]:(r[t]||{}).prototype;for(u in d&&(n=t),n)(l=!h&&w&&void 0!==w[u])&&s(b,u)||(f=l?w[u]:n[u],b[u]=d&&"function"!=typeof w[u]?n[u]:y&&l?o(f,r):g&&w[u]==f?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(f):m&&"function"==typeof f?o(Function.call,f):f,m&&((b.virtual||(b.virtual={}))[u]=f,e&c.R&&v&&!v[u]&&a(v,u,f)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){var r=n(487);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(489),i=n(494);e.exports=n(195)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(490),i=n(491),o=n(493),a=Object.defineProperty;t.f=n(195)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(194);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(195)&&!n(246)((function(){return 7!=Object.defineProperty(n(492)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(194),i=n(193).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(194);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Counter=void 0;const r=n(5);class i{constructor(e){this._value=0,e instanceof i&&(e=e.current),this._value=r.Helper.nonNull(e,0)}next(){return this._value++,this._value}current(){return this._value}}t.Counter=i},function(e,t,n){(function(e,t){var n;!function(n){!function(r){var i="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=a(n);function a(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===i.Reflect?i.Reflect=n:o=a(i.Reflect,o),function(t){var n=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,s={__proto__:[]}instanceof Array,c=!a&&!s,u={create:a?function(){return ie(Object.create(null))}:s?function(){return ie({__proto__:null})}:function(){return ie({})},has:c?function(e,t){return n.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return n.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),f="object"==typeof e&&e.env&&"true"===e.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=f||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?te():Map,d=f||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?ne():Set,p=new(f||"function"!=typeof WeakMap?re():WeakMap);function m(e,t,n,r){if(D(n)){if(!W(e))throw new TypeError;if(!Q(t))throw new TypeError;return T(e,t)}if(!W(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(r)&&!D(r)&&!L(r))throw new TypeError;return L(r)&&(r=void 0),x(e,t,n=z(n),r)}function y(e,t){function n(n,r){if(!F(n))throw new TypeError;if(!D(r)&&!G(r))throw new TypeError;M(e,t,n,r)}return n}function g(e,t,n,r){if(!F(n))throw new TypeError;return D(r)||(r=z(r)),M(e,t,n,r)}function b(e,t,n){if(!F(t))throw new TypeError;return D(n)||(n=z(n)),C(e,t,n)}function v(e,t,n){if(!F(t))throw new TypeError;return D(n)||(n=z(n)),R(e,t,n)}function w(e,t,n){if(!F(t))throw new TypeError;return D(n)||(n=z(n)),P(e,t,n)}function _(e,t,n){if(!F(t))throw new TypeError;return D(n)||(n=z(n)),N(e,t,n)}function k(e,t){if(!F(e))throw new TypeError;return D(t)||(t=z(t)),A(e,t)}function E(e,t){if(!F(e))throw new TypeError;return D(t)||(t=z(t)),j(e,t)}function O(e,t,n){if(!F(t))throw new TypeError;D(n)||(n=z(n));var r=S(t,n,!1);if(D(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=p.get(t);return i.delete(n),i.size>0||p.delete(t),!0}function T(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!D(r)&&!L(r)){if(!Q(r))throw new TypeError;t=r}}return t}function x(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!D(o)&&!L(o)){if(!F(o))throw new TypeError;r=o}}return r}function S(e,t,n){var r=p.get(e);if(D(r)){if(!n)return;r=new h,p.set(e,r)}var i=r.get(t);if(D(i)){if(!n)return;i=new h,r.set(t,i)}return i}function C(e,t,n){if(R(e,t,n))return!0;var r=ee(t);return!L(r)&&C(e,r,n)}function R(e,t,n){var r=S(t,n,!1);return!D(r)&&U(r.has(e))}function P(e,t,n){if(R(e,t,n))return N(e,t,n);var r=ee(t);return L(r)?void 0:P(e,r,n)}function N(e,t,n){var r=S(t,n,!1);if(!D(r))return r.get(e)}function M(e,t,n,r){S(n,r,!0).set(e,t)}function A(e,t){var n=j(e,t),r=ee(e);if(null===r)return n;var i=A(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new d,a=[],s=0,c=n;s<c.length;s++){var u=c[s];o.has(u)||(o.add(u),a.push(u))}for(var l=0,f=i;l<f.length;l++){u=f[l];o.has(u)||(o.add(u),a.push(u))}return a}function j(e,t){var n=[],r=S(e,t,!1);if(D(r))return n;for(var i=K(r.keys()),o=0;;){var a=X(i);if(!a)return n.length=o,n;var s=$(a);try{n[o]=s}catch(e){try{Z(i)}finally{throw e}}o++}}function I(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function D(e){return void 0===e}function L(e){return null===e}function B(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function q(e,t){switch(I(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",r=J(e,i);if(void 0!==r){var o=r.call(e,n);if(F(o))throw new TypeError;return o}return V(e,"default"===n?"number":n)}function V(e,t){if("string"===t){var n=e.toString;if(Y(n))if(!F(i=n.call(e)))return i;if(Y(r=e.valueOf))if(!F(i=r.call(e)))return i}else{var r;if(Y(r=e.valueOf))if(!F(i=r.call(e)))return i;var i,o=e.toString;if(Y(o))if(!F(i=o.call(e)))return i}throw new TypeError}function U(e){return!!e}function H(e){return""+e}function z(e){var t=q(e,3);return B(t)?t:H(t)}function W(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function Y(e){return"function"==typeof e}function Q(e){return"function"==typeof e}function G(e){switch(I(e)){case 3:case 4:return!0;default:return!1}}function J(e,t){var n=e[t];if(null!=n){if(!Y(n))throw new TypeError;return n}}function K(e){var t=J(e,o);if(!Y(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function $(e){return e.value}function X(e){var t=e.next();return!t.done&&t}function Z(e){var t=e.return;t&&t.call(e)}function ee(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function te(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function a(e,t){return[e,t]}}function ne(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}()}function re(){var e=16,t=u.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&u.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?u.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+c()}while(u.has(t,e));return t[e]=!0,e}function o(e,t){if(!n.call(e,r)){if(!t)return;Object.defineProperty(e,r,{value:u.create()})}return e[r]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function c(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}t("decorate",m),t("metadata",y),t("defineMetadata",g),t("hasMetadata",b),t("hasOwnMetadata",v),t("getMetadata",w),t("getOwnMetadata",_),t("getMetadataKeys",k),t("getOwnMetadataKeys",E),t("deleteMetadata",O)}(o)}()}(n||(n={}))}).call(this,n(248),n(196))},function(e,t,n){var r=n(118),i=n(119),o=n(105).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function c(){this.init(),this._w=s,i.call(this,64,56)}function u(e){return e<<30|e>>>2}function l(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(c,i),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,c=0|this._e,f=0;f<16;++f)n[f]=e.readInt32BE(4*f);for(;f<80;++f)n[f]=n[f-3]^n[f-8]^n[f-14]^n[f-16];for(var h=0;h<80;++h){var d=~~(h/20),p=0|((t=r)<<5|t>>>27)+l(d,i,o,s)+c+n[h]+a[d];c=s,s=o,o=u(i),i=r,r=p}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var e=o.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=c},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),a=r[0],s=r[1],c=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),l=0,f=s>0?a-4:a;for(n=0;n<f;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=16383,s=0,c=n-i;s<c;s+=a)o.push(l(e,s,s+a>c?c:s+a));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=e[t+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+f],f+=h,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=u}return(d?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+f>=1?h/c:h*Math.pow(2,1-f))*c>=2&&(a++,c/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*c-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+d]=255&a,d+=p,a/=256,u-=8);e[n+d-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){var r=n(118),i=n(119),o=n(105).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function c(){this.init(),this._w=s,i.call(this,64,56)}function u(e){return e<<5|e>>>27}function l(e){return e<<30|e>>>2}function f(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(c,i),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,c=0|this._e,h=0;h<16;++h)n[h]=e.readInt32BE(4*h);for(;h<80;++h)n[h]=(t=n[h-3]^n[h-8]^n[h-14]^n[h-16])<<1|t>>>31;for(var d=0;d<80;++d){var p=~~(d/20),m=u(r)+f(p,i,o,s)+c+n[d]+a[p]|0;c=s,s=o,o=l(i),i=r,r=m}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var e=o.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=c},function(e,t,n){var r=n(118),i=n(249),o=n(119),a=n(105).Buffer,s=new Array(64);function c(){this.init(),this._w=s,o.call(this,64,56)}r(c,i),c.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},c.prototype._hash=function(){var e=a.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=c},function(e,t,n){var r=n(118),i=n(250),o=n(119),a=n(105).Buffer,s=new Array(160);function c(){this.init(),this._w=s,o.call(this,128,112)}r(c,i),c.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},c.prototype._hash=function(){var e=a.allocUnsafe(48);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=c},function(e,t,n){e.exports=function(e){function t(e){let n,i=null;function o(...e){if(!o.enabled)return;const r=o,i=Number(new Date),a=i-(n||i);r.diff=a,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];n=o.call(r,t),e.splice(s,1),s--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=r,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null===i?t.enabled(e):i,set:e=>{i=e}}),"function"==typeof t.init&&t.init(o),o}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(506),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},function(e,t){var n=1e3,r=60*n,i=60*r,o=24*i,a=7*o,s=365.25*o;function c(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*a;case"days":case"day":case"d":return c*o;case"hours":case"hour":case"hrs":case"hr":case"h":return c*i;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=o)return c(e,t,o,"day");if(t>=i)return c(e,t,i,"hour");if(t>=r)return c(e,t,r,"minute");if(t>=n)return c(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=i)return Math.round(e/i)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Prioritized=void 0;const i=n(5);t.Prioritized=class{constructor(e){if(this._lastPriority=0,this._status=0,this._lastResult=null,this._success={},this._highestPromise=null,e=i.Helper.nonNull(e,{}),this._callbacks=[],Array.isArray(e)){let t={};e.forEach(((e,n)=>{t[10*(n+1)]=e})),e=t}let t=null;this._highestPromise=new Promise((e=>{t=e})),Object.keys(e).forEach((n=>{this._success[n]=null,e[n].then((e=>{this._success[n]=!0,parseInt(n)>this._lastPriority&&(this._lastResult=e,this._lastPriority=parseInt(n),this._callCallbacks(),this._checkHighest()?(this._status=2,t()):this._status=1)})).catch((e=>{this._success[n]=e,this._checkHighest()&&(this._status=2,t())}))})),this._promises=e}_callCallbacks(){this._callbacks.forEach((e=>{e(this._lastResult,this._lastPriority)}))}_checkHighest(){let e=!1;return Object.keys(this._success).reverse().some((t=>!!i.Helper.isNull(this._success[t])||(!0===this._success[t]?(e=!0,!0):void 0))),e}do(e){this._status<2&&this._callbacks.push(e),this._status>0&&e(this._lastResult,this._lastPriority)}highest(e){return r(this,void 0,void 0,(function*(){return yield this._highestPromise,i.Helper.isNotNull(e)?Promise.resolve(this._lastResult).then(e):Promise.resolve(this._lastResult)}))}first(e){return r(this,void 0,void 0,(function*(){return 0===this._status?i.Helper.isNotNull(e)?Promise.race(Object.values(this._promises)).then(e):Promise.race(Object.values(this._promises)):Promise.resolve(this._lastResult)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseWithHandlers=void 0;t.PromiseWithHandlers=class extends Promise{constructor(e){let t=null,n=null;super(((r,i)=>{t=r,n=i,e&&e(t,n)})),this.resolver=t,this.rejecter=n}resolve(e){this.resolver&&this.resolver(e)}reject(e){this.rejecter&&this.rejecter(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Random=void 0;const r=n(5);class i{static seedRandom(e){this._seed=e}static getRandom(){let e=this._seed+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}static getIntRandom(e){return Math.floor(i.getRandom()*(e+1))}static getStringRandom(e,t){let n="";const o=(t=r.Helper.nonNull(t,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")).length-1;for(let r=0;r<e;r++)n+=t[i.getIntRandom(o)];return n}}t.Random=i,i._seed=(new Date).getTime()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DragHelper=void 0;const r=n(254);class i{constructor(){this.startPosition=null,this.currentDraggedElement=null,window.addEventListener("mousemove",(e=>{this.currentDraggedElement&&this.dragMove({x:e.clientX,y:e.clientY})})),window.addEventListener("touchmove",(e=>{this.currentDraggedElement&&this.dragMove({x:e.touches[0].clientX,y:e.touches[0].clientY})})),window.addEventListener("mouseup",(e=>{0===e.button&&this.dragStop({x:e.clientX,y:e.clientY})})),window.addEventListener("touchend",(e=>{0===e.touches.length&&this.dragStop({x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY})}))}static getInstance(){return this.instance||(this.instance=new i),this.instance}draggable(e){const t=new r.DraggedElement(e);return e.addEventListener("mousedown",(e=>{e.preventDefault(),console.log("mousedown",e.button),0===e.button&&this.dragStart({x:e.clientX,y:e.clientY},t)})),e.addEventListener("touchstart",(e=>{e.preventDefault(),1===e.touches.length&&this.dragStart({x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY},t)})),t}dragStart(e,t){this.currentDraggedElement=t,this.startPosition=e,this.currentDraggedElement.start()}dragMove(e){if(this.currentDraggedElement){const t={x:e.x-this.startPosition.x,y:e.y-this.startPosition.y};this.currentDraggedElement.moveRelativeTo(t)}}dragStop(e){this.currentDraggedElement&&(this.currentDraggedElement.stop(e),this.currentDraggedElement=null,this.startPosition=null)}}t.DragHelper=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HotkeyManager=void 0;class r{constructor(){this._keys={},this._callbacks={},this._lastCallbackId=0,this._active=!1,this.mousePosition=null,this._addListeners(),this.ignoreFormElements=!1}static isFormElement(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement}getMousePosition(){return this.mousePosition}_addListeners(){window.addEventListener("keydown",(e=>{!this.ignoreFormElements&&r.isFormElement(e.target)||(this._keys[e.key.toLowerCase()]=!0,this._active&&this._checkCallbacks(e))})),window.addEventListener("keyup",(e=>{e.key&&(this._keys[e.key.toLowerCase()]=!1)})),document.addEventListener("mousemove",(e=>{this.mousePosition={x:e.clientX,y:e.clientY}}))}activate(){this._active=!0}deactivate(){this._active=!1}addCallback(e,t){this._lastCallbackId++,this._callbacks[this._lastCallbackId]={keys:e,callback:t}}isKeyPressed(e){return this._active&&this._keys[e]&&!0===this._keys[e]}_checkCallbacks(e){Object.values(this._callbacks).forEach((t=>{t.keys.every((e=>!0===this._keys[e]))&&t.callback(e)}))}removeCallback(e){delete this._callbacks[e]}}t.HotkeyManager=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InputSelect=void 0;const r=n(5),i=n(57);t.InputSelect=class{constructor(e,t){this.onChangeListeners=[],"string"==typeof e&&(e=document.querySelector(e)),this.options=new Map,this.inputElement=e,t.forEach((e=>("string"==typeof e&&(e={value:e,label:e}),e.selected=r.Helper.nonNull(e.selected,!1),this.options.set(e.value,e),e))),this.buildElement()}onChange(e){this.onChangeListeners.push(e)}buildElement(){const e=this.inputElement.parentElement;this.container=document.createElement("div"),this.container.classList.add("input-select-container");const t=document.createElement("div");t.classList.add("input-select-flex"),this.selectedOptionsContainer=document.createElement("span"),this.selectedOptionsContainer.classList.add("input-select-selected-options");const n=[];if(this.inputElement.classList.forEach((e=>{this.container.classList.add(e),n.push(e)})),this.inputElement.classList.remove(...n),this.inputElement.classList.add("input-select-input"),this.optionsContainer=document.createElement("div"),this.optionsContainer.classList.add("input-select-options"),e.insertBefore(this.container,this.inputElement),this.inputElement.remove(),this.container.appendChild(t),this.container.appendChild(this.optionsContainer),t.appendChild(this.selectedOptionsContainer),t.appendChild(this.inputElement),this.inputElement.addEventListener("input",(()=>this.updateOptions())),"ResizeObserver"in window){new ResizeObserver((e=>{e.forEach((e=>{this.optionsContainer.style.width=e.borderBoxSize[0].inlineSize+"px"}))})).observe(this.container)}window.addEventListener("scroll",(()=>console.log("scrolling"))),this.container.addEventListener("click",(()=>{const e=this.container.getBoundingClientRect();this.optionsContainer.style.top=e.top+e.height+"px"})),this.updateOptions()}updateOptions(){i.ViewHelper.removeAllChildren(this.selectedOptionsContainer),i.ViewHelper.removeAllChildren(this.optionsContainer);const e=this.inputElement.value;this.options.forEach((t=>{const n=document.createElement("span");n.classList.add("input-select-option"),n.dataset.value=t.value,n.innerText=t.label,t.selected?this.selectedOptionsContainer.appendChild(n):-1!==t.label.indexOf(e)&&this.optionsContainer.appendChild(n),n.addEventListener("click",(e=>{e.stopPropagation(),e.preventDefault(),e.cancelBubble=!0,this.toggle(t.value),this.inputElement.focus()}))}))}toggle(e){const t=this.options.get(e);t&&(t.selected=!t.selected,this.updateOptions(),this.onChangeListeners.forEach((e=>{e(t,this)})))}getOptions(){return Array.from(this.options.values())}getSelectedOptions(){return this.getOptions().filter((e=>e.selected))}getSelectedValues(){return this.getSelectedOptions().map((e=>e.value))}updateSelection(e){Object.keys(e).forEach((t=>{const n=this.options.get(t);n&&(n.selected=e[t])})),this.updateOptions()}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(514),t)},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EventManager=void 0;const i=n(7);class o{constructor(){this._listeners={},this._lastListenerId=0}static getInstance(){return this._instance||(this._instance=new o),this._instance}addListener(e,t){if("function"!=typeof t)throw new Error("can only add functions as listeners!");return this._lastListenerId++,this._listeners[e]||(this._listeners[e]={},this._listeners[e][this._lastListenerId]=t),this._lastListenerId}removeListener(e,t){this._listeners[e]&&this._listeners[e][t]&&delete this._listeners[e][t]}trigger(e,t){return r(this,void 0,void 0,(function*(){this._listeners[e]&&(yield i.Helper.asyncForEach(Object.keys(this._listeners[e]),(n=>r(this,void 0,void 0,(function*(){yield this._listeners[e][n](t)}))),!0))}))}static trigger(e,t){return r(this,void 0,void 0,(function*(){return this.getInstance().trigger(e,t)}))}}t.EventManager=o,o._instance=null},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerSite=void 0;var c=n(201),u=n(202),l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e,r,u,"#site-content")}return n}(c.TemplateSite);t.ContainerSite=l},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractWindowFragment=void 0;var f=n(68),h=n(43),d=n(5),p=n(57),m=n(31),y=n(11),g=n(69),b=n(517),v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(e,t,n,r,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(o=c.call(this,e,b)).position={x:0,y:0,anchorY:"top",anchorX:"left"},o.title="",o._margin={x:0,y:0},o.saveData={},o.state="normal",o.popupWindow=null,o.translateTitle=!0,o.position=Object.assign({anchorY:"top",anchorX:"left"},n),o.title=d.Helper.nonNull(r,"&nbsp;"),i&&(o.id="window-"+i),o._viewPromise=Promise.all([o._viewPromise,h.ViewInflater.getInstance().load(t)]).then((function(e){return e[0].querySelector("#child-view").replaceWith(e[1]),h.ViewInflater.replaceWithChildren(e[1]),o._view=e[0],e[0]})).catch((function(e){return console.error(e)})),o}return t=f,(n=[{key:"setTitle",value:function(e){this._titleElement&&(p.ViewHelper.removeAllChildren(this._titleElement),this._titleElement.appendChild(this.translateTitle?m.Translator.makePersistentTranslation(e):document.createTextNode(e))),this.title=e}},{key:"getDimension",value:function(){var e=window.getComputedStyle(this._container),t=parseFloat(e.getPropertyValue("width")),n=parseFloat(e.getPropertyValue("height"));return isNaN(t)&&(t=parseFloat(this._container.style.width)),isNaN(n)&&(n=parseFloat(this._container.style.height)),{x:Math.ceil(t)-this._margin.x,y:Math.ceil(n)-this._margin.y}}},{key:"setDimension",value:function(e,t){e+=this._margin.x,t+=this._margin.y,this._container.style.width=e+"px",this._container.style.height=t+"px",this.saveData.dimension={x:e,y:t},this.save()}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(u(f.prototype),"onViewLoaded",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this._container=this.findBy(".window-container"),(this.position.width||this.position.height)&&(this._container.style.width=this.position.width+"px",this._container.style.height=this.position.height+"px"),this._window=this.findBy(".window"),this._titleElement=this.findBy("#title"),this._resizeElements={x:[this._window,this.findBy(".window-resize.left"),this.findBy(".window-resize.right")],y:[this._window,this._titleElement,this.findBy(".window-resize.top"),this.findBy(".window-resize.bottom")]},e.next=8,this.load();case 8:return this._checkPositionAndDimension(),this.setTitle(this.title),this.addListeners(),(r=this.findBy("#title-buttons"))&&(r.remove(),this._titleElement.parentNode.appendChild(r),r.querySelectorAll(".title-button").forEach((function(e){e.addEventListener("click",(function(t){i.onButtonClick(e.id,e,t)}))}))),e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)})))}},{key:"addListeners",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,s,c,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=null,i=function(e,i,o){if(o.target.classList.contains("window-resize")){o.stopPropagation(),t={x:e,y:i};var a=o.target.dataset.direction.split(",");n={x:parseInt(a[0]),y:parseInt(a[1])},r=u.getDimension()}},this.findBy(".window-resize",!0).forEach((function(e){e.addEventListener("mousedown",(function(e){i(e.clientX,e.clientY,e)}))})),o=null,a=function(e,t,n){n.target!==u._container&&n.target.closest("#title")!==u._titleElement||(o={x:e,y:t},Object.assign({},u.getPosition()),u._container.classList.add("moving")),u.makeActiveWindow()},this._container.addEventListener("mousedown",(function(e){a(e.clientX,e.clientY,e)})),this._container.addEventListener("touchstart",(function(e){1===e.touches.length&&a(e.touches[0].clientX,e.touches[0].clientY,e)})),s=function(e,i){if(null!==t){var a={x:n.x,y:n.y},s={x:(e-t.x)*a.x,y:(i-t.y)*a.y};r={x:r.x+s.x,y:r.y+s.y},u.setDimension(r.x,r.y);var c=u.getDimension();r.x!==c.x&&(a.x=0),r.y!==c.y&&(a.y=0),u._checkPositionAndDimension();var l={x:0,y:0};0!==a.x&&("center"===u.position.anchorX?l.x=s.x*a.x/2:a.x*("left"===u.position.anchorX?1:-1)<0&&(l.x=s.x*a.x)),0!==a.y&&("center"===u.position.anchorY?l.y=s.y*a.y/2:a.y*("top"===u.position.anchorY?1:-1)<0&&(l.y=s.y*a.y)),u.moveAt(l.x,l.y),t={x:e,y:i}}else if(null!==o){var f={x:e-o.x,y:i-o.y};o={x:e,y:i},u.moveAt(f.x,f.y)}},window.addEventListener("mousemove",(function(e){s(e.clientX,e.clientY)})),window.addEventListener("touchmove",(function(e){1===e.touches.length&&s(e.touches[0].clientX,e.touches[0].clientY)})),c=function(e,n,r){o=null,t=null,u._container.classList.remove("moving")},window.addEventListener("mouseup",(function(e){c(e.clientX,e.clientY)})),window.addEventListener("touchend",(function(e){0===e.touches.length&&1===e.changedTouches.length&&c(e.changedTouches[0].clientX,e.changedTouches[0].clientY)})),this._container.addEventListener("dblclick",(function(e){e.target!==u._container&&e.target.closest("#title")!==u._titleElement||u.toggleMinimize()})),window.addEventListener("resize",(function(){u._checkPositionAndDimension()})),window.addEventListener("beforeunload",(function(){u.popupWindow&&(u.id=null,u.popupWindow.close())}));case 17:case"end":return e.stop()}}),e,this)})))}},{key:"makeActiveWindow",value:function(){var e=document.querySelector(".window-container.active-window");e&&e!==this._container&&e.classList.remove("active-window"),this._container.classList.add("active-window")}},{key:"load",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.id){e.next=19;break}return e.next=3,y.NativeStoragePromise.getItem(this.id);case 3:if(!(t=e.sent)){e.next=19;break}if(t.dimension&&this.setDimension(t.dimension.x,t.dimension.y),t.position&&(this.position=t.position,this._checkPositionAndDimension()),!t.state){e.next=17;break}e.t0=t.state,e.next="minimized"===e.t0?11:"maximized"===e.t0?13:"popup"===e.t0?15:17;break;case 11:return this.toggleMinimize(),e.abrupt("break",17);case 13:return this.toggleMaximize(),e.abrupt("break",17);case 15:return this._viewLoadedPromise.then((function(){n.openInNewWindow()})),e.abrupt("break",17);case 17:this.saveData=t,this.save();case 19:case"end":return e.stop()}}),e,this)})))}},{key:"save",value:function(){return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.id){e.next=3;break}return e.next=3,y.NativeStoragePromise.setItem(this.id,this.saveData);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"toggleMinimize",value:function(){"popup"!==this.state&&(this._container.classList.toggle("minimized"),this._container.classList.remove("maximized"),this._container.classList.contains("minimized")?this.state="minimized":(this.resizeToContent(),this.state="normal"),this.saveData.state=this.state,this.save())}},{key:"toggleMaximize",value:function(){"popup"!==this.state&&(this._container.classList.toggle("maximized"),this._container.classList.remove("minimized"),this._container.classList.contains("maximized")?this.state="maximized":(this.resizeToContent(),this.state="normal"),this.saveData.state=this.state,this.save())}},{key:"resizeToContent",value:function(){if(this._window){var e={x:this._window.scrollWidth-this._window.clientWidth,y:this._window.scrollHeight-this._window.clientHeight},t=this.getDimension();if(0===e.x){var n=0;this._resizeElements.x.forEach((function(e){return n+=parseFloat(window.getComputedStyle(e).getPropertyValue("width"))})),e.x=Math.ceil(n)-t.x}if(0===e.y){var r=0;this._resizeElements.y.forEach((function(e){return r+=parseFloat(window.getComputedStyle(e).getPropertyValue("height"))})),e.y=Math.ceil(r)-t.y}t.x+=e.x,t.y+=e.y,"normal"===this.state&&this.setDimension(t.x,t.y),this._checkPositionAndDimension()}}},{key:"getTopLeftCornerPosition",value:function(){var e=this.getDimension(),t=this.position.x;"center"===this.position.anchorX?t+=window.innerWidth/2-e.x/2:"right"===this.position.anchorX&&(t+=window.innerWidth-e.x);var n=this.position.y;return"center"===this.position.anchorY?n+=window.innerHeight/2-e.y/2:"bottom"===this.position.anchorY&&(n+=window.innerHeight-e.y),t<0&&(t=0),n<0&&(n=0),{x:t,y:n}}},{key:"getCenterCenterPosition",value:function(){var e=this.getDimension(),t=this.getTopLeftCornerPosition();return{x:t.x+e.x/2-window.innerWidth/2,y:t.y+e.y/2-window.innerHeight/2}}},{key:"getBottomRightPosition",value:function(){var e=this.getDimension(),t=this.getTopLeftCornerPosition();return{x:Math.min(t.x+e.x-window.innerWidth,0),y:Math.min(t.y+e.y-window.innerHeight,0)}}},{key:"_checkPositionAndDimension",value:function(){var e=this.getDimension(),t=!0,n=!1;isNaN(e.x)&&(e.x=0,t=!1),isNaN(e.y)&&(e.y=0,t=!1);var r=this.getTopLeftCornerPosition(),i=this.getCenterCenterPosition(),o=this.getBottomRightPosition();e.x>window.innerWidth?(n=!0,e.x=window.innerWidth,this.position.x=0,this.position.anchorX="left"):r.x<=Math.abs(i.x)&&r.x<=-1*o.x?(this.position.x=r.x,this.position.anchorX="left"):-1*o.x<=Math.abs(i.x)?(this.position.x=o.x,this.position.anchorX="right"):(this.position.x=i.x,this.position.anchorX="center"),e.y>window.innerHeight?(n=!0,e.y=window.innerHeight,this.position.y=0,this.position.anchorY="top"):r.y<=Math.abs(i.y)&&r.y<=-1*o.y?(this.position.y=r.y,this.position.anchorY="top"):-1*o.y<=Math.abs(i.y)?(this.position.y=o.y,this.position.anchorY="bottom"):(this.position.y=i.y,this.position.anchorY="center"),"top"===this.position.anchorY?(this._container.style.top=this.position.y+"px",this._container.style.removeProperty("bottom")):"bottom"===this.position.anchorY?(this._container.style.bottom=-1*this.position.y+"px",this._container.style.removeProperty("top")):(this._container.style.top="calc(50% + "+this.position.y.toString()+"px - "+(e.y/2).toString()+"px)",this._container.style.removeProperty("bottom")),"left"===this.position.anchorX?(this._container.style.left=this.position.x+"px",this._container.style.removeProperty("right")):"right"===this.position.anchorX?(this._container.style.right=-1*this.position.x+"px",this._container.style.removeProperty("left")):(this._container.style.left="calc(50% + "+this.position.x.toString()+"px - "+(e.x/2).toString()+"px)",this._container.style.removeProperty("right")),this.saveData.position=this.position,!this._container.classList.contains("minimized")&&t&&n&&this.setDimension(e.x,e.y)}},{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return o(u(f.prototype),"onStart",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.onStart.call(this,e),this._checkPositionAndDimension(),t.abrupt("return",r);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"moveAt",value:function(e,t){var n=this.getTopLeftCornerPosition();return this.moveTo(e+n.x,t+n.y)}},{key:"moveTo",value:function(e,t){this.position={x:e,y:t,anchorX:"left",anchorY:"top"},this._checkPositionAndDimension(),this.save()}},{key:"onButtonClick",value:function(e,t,n){switch(e){case"minimize-button":this.toggleMinimize();break;case"maximize-button":this.toggleMaximize();break;case"new-window-button":this.openInNewWindow()}}},{key:"openInNewWindow",value:function(){var e=this;if("popup"!==this.state){var t=window.open("","","modal=yes");if(null!==t){this.state="popup",this.saveData.state=this.state,this.save();var n=document.createElement("base");n.href=window.location.href,t.document.head.appendChild(n);var r=document.createElement("title");r.innerText=this.title,t.document.head.appendChild(r),document.querySelectorAll("link[rel='stylesheet']").forEach((function(e){t.document.head.appendChild(e.cloneNode())}));var i=this._view.parentNode;this._view.remove(),this._container.classList.add("popup"),this._container.classList.remove("minimized"),this._container.classList.remove("maximized");var o=m.Translator.getInstance().addTranslationCallback((function(t){t!==e._container&&m.Translator.getInstance().updateTranslations(e._container)}),!1);t.document.body.appendChild(this._view),t.addEventListener("beforeunload",(function(){e.state="normal",e.saveData.state=e.state,e.save(),e._view.remove(),e._container.classList.remove("popup"),e._container.classList.remove("minimized"),e._container.classList.remove("maximized"),i.appendChild(e._view),e.popupWindow=null,m.Translator.getInstance().removeTranslationCallback(o)})),this.popupWindow=t,document.body.classList.forEach((function(e){console.log("adding class",e),t.document.body.classList.add(e)}))}else new g.Toast("cannot open popups").show()}}},{key:"getPosition",value:function(){return this.position}}])&&i(t.prototype,n),r&&i(t,r),f}(f.AbstractFragment);t.AbstractWindowFragment=v},function(e,t,n){e.exports=n.p+"html/abstractWindowTemplate.html"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AlphabeticListFragment=void 0;var f=n(68),h=n(85),d=n(7),p=n(203),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,e,d.Helper.nonNull(t,p))).elements={},n.sideScrolling=!1,n}return t=f,(n=[{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(u(f.prototype),"onViewLoaded",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this.findBy(".alphabetic-list-sidealphabet").addEventListener("mousedown",(function(){r.sideScrolling=!0})),window.addEventListener("touchstart",(function(e){r.sideScrolling=!0})),window.addEventListener("mouseup",(function(){r.sideScrolling=!1})),window.addEventListener("touchend",(function(){r.sideScrolling=!1})),this.findBy(".alphabet-scroll-to",!0).forEach((function(e){var t=function(t){r.sideScrolling&&r.findBy(".alphabet-section."+e.dataset.letter).scrollIntoView({behavior:"smooth",block:"start"})};e.addEventListener("mousedown",(function(e){r.sideScrolling=!0,t()})),e.addEventListener("mousemove",t),e.addEventListener("touchstart",(function(e){r.sideScrolling=!0,t()})),e.addEventListener("touchmove",t)})),this.headingElement=this.findBy("#alphabetic-list-heading"),this.renderList(),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})))}},{key:"setElements",value:function(e){var t=this;this.elements={},Object.keys(e).sort((function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())})).forEach((function(n){t.elements[n]=e[n]}))}},{key:"setHeading",value:function(e){this.heading=e,this.headingElement&&this.heading&&(h.ViewHelper.removeAllChildren(this.headingElement),this.headingElement.appendChild(this.heading))}},{key:"renderElement",value:function(e){console.warn("should be overloaded?");var t=document.createElement("div");return t.innerText=e,t}},{key:"renderList",value:function(){var e=this;h.ViewHelper.removeAllChildren(this.headingElement),this.heading&&this.headingElement.appendChild(this.heading),this.findBy(".alphabet-section",!0).forEach((function(e){h.ViewHelper.removeAllChildren(e)}));var t="A",n=this.findBy(".alphabet-section.A");Object.keys(this.elements).forEach((function(r){var i=r.trim().substring(0,1).toUpperCase();if(i!==t){t=i;var o=e.findBy(".alphabet-section."+i);null!==o&&(n=o)}var a=e.renderElement(e.elements[r]);n.appendChild(a)}))}}])&&i(t.prototype,n),r&&i(t,r),f}(f.AbstractFragment);t.AlphabeticListFragment=m},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabFragment=void 0;var f=n(68),h=n(520),d=n(22),p=n(31),m=n(85),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,e,d.Helper.nonNull(t,h))).lastTabId=0,n.activeTab=null,n.onTabChangeListener=null,n.tabs=new Map,n.tabViewPromise=n._viewLoadedPromise,n}return t=f,(n=[{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(u(f.prototype),"onViewLoaded",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this.nameContainer=this.findBy(".tab-names"),this.nameButton=this.findBy(".tab-button-template"),this.nameButton.classList.remove("tab-button-template"),this.nameButton.remove(),this.tabContent=this.findBy(".tab-content"),this.tabSite=this.findBy(".tab-site-template"),this.tabSite.classList.remove("tab-site-template"),this.tabSite.remove(),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})))}},{key:"addFragment",value:function(e,t,n){var r=this;o(u(f.prototype),"addFragment",this).call(this,".tab-content",t),t._viewLoadedPromise.then((function(){var i=r.tabSite.cloneNode(!0);i.appendChild(t._view),r.lastTabId++;var o={name:e,fragment:t,view:i,nameIsTranslatable:d.Helper.nonNull(n,!0),button:null,id:r.lastTabId};r.tabs.set(r.lastTabId,o),r._viewLoadedPromise.then((function(){var t=r.nameButton.cloneNode(!0);t.appendChild(o.nameIsTranslatable?p.Translator.makePersistentTranslation(e):document.createTextNode(e)),r.nameContainer.appendChild(t),t.addEventListener("click",(function(){r.showTab(o.id)})),o.button=t,d.Helper.isNull(r.activeTab)&&r.showTab(o.id)}))}))}},{key:"showTab",value:function(e){var t=this.tabs.get(e);if(t&&e!==this.activeTab){var n=this.findBy(".tab-button.active");d.Helper.isNotNull(n)&&n.classList.remove("active"),t.button.classList.add("active"),m.ViewHelper.removeAllChildren(this.tabContent),this.tabContent.appendChild(t.view),this.activeTab=e,this.onTabChangeListener&&this.onTabChangeListener(t)}}},{key:"setOnTabChangeListener",value:function(e){this.onTabChangeListener=e}}])&&i(t.prototype,n),r&&i(t,r),f}(f.AbstractFragment);t.TabFragment=y},function(e,t,n){e.exports=n.p+"html/tabFragment.html"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorAction=void 0;var u=n(121),l=n(64),f=n(31),h=n(523),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,e);var t,n,r,s=a(c);function c(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(e=s.call(this,"",(function(){var e=new l.Dialog(c._errors.join("<br/>"),f.Translator.translate("error"));e.setTranslatable(!1),e.show()}),u.MenuAction.SHOW_ALWAYS,-1e3,c.ERROR_ICON))._visible=c._errors.length>0,e._shouldTranslate=!1,console.log("icon: ",c.ERROR_ICON),e}return t=c,r=[{key:"addError",value:function(e){-1===this._errors.indexOf(e)&&(this._errors.push(e),this.getInstance().setVisibility(this._errors.length>0))}},{key:"removeError",value:function(e){var t=this._errors.indexOf(e);t>=0&&(this._errors.splice(t,1),this.getInstance().setVisibility(this._errors.length>0))}},{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new c),this._instance}}],(n=null)&&i(t.prototype,n),r&&i(t,r),c}(u.MenuAction);t.ErrorAction=d,d.ERROR_ICON=h,d._instance=null,d._errors=[]},function(e,t){e.exports="./img/errorIcon.png"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.StartSiteMenuAction=void 0;var c=n(121),u=n(38),l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e,r,i,o,a){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e,(function(){n._app&&(Array.isArray(r)&&r.length>=2?n._app.startSite(r[0],r[1]):n._app.startSite(r))}),i,o,a)}return n}(c.MenuAction);t.StartSiteMenuAction=l,l._app=null,u.App.addInitialization((function(e){l._app=e}))},function(e,t,n){e.exports=n.p+"html/navbar.html"},function(e,t,n){e.exports=n.p+"html/menuSite.html"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SwipeFragment=void 0;var f=n(68),h=n(265),d=n(22),p=n(528),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=c.call(this,e,p))._activeIndex=0,t._touchStart=null,t}return t=f,(n=[{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(u(f.prototype),"onViewLoaded",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._view.addEventListener("touchstart",(function(e){n._touchStart=e.touches[0]}),!1),this._view.addEventListener("touchend",(function(e){n._handleSwipe(e.changedTouches[0].clientX,e.changedTouches[0].clientY),n._touchStart=null})),this._view.addEventListener("mousedown",(function(e){n._touchStart=e}),!1),this._view.addEventListener("mouseup",(function(e){n._handleSwipe(e.clientX,e.clientY),n._touchStart=null})),e.abrupt("return",t.onViewLoaded.call(this));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"_handleSwipe",value:function(e,t){return l(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!d.Helper.isNull(this._touchStart)){n.next=2;break}return n.abrupt("return");case 2:if(r=this._touchStart,this._touchStart=null,i=r.clientX-e,!(Math.abs(r.clientY-t)<=f.MAX_Y&&Math.abs(i)>=f.MIN_X)){n.next=13;break}if(!(i>0)){n.next=11;break}return n.next=9,this._fragments[this._activeIndex].onSwipeLeft();case 9:n.next=13;break;case 11:return n.next=13,this._fragments[this._activeIndex].onSwipeRight();case 13:case"end":return n.stop()}}),n,this)})))}},{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return o(u(f.prototype),"onStart",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._activeIndex>=0&&this._activeIndex<this._fragments.length&&this.setActiveFragment(this._activeIndex),t.abrupt("return",n.onStart.call(this,e));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"setActiveFragment",value:function(e){var t=this;e instanceof h.SwipeChildFragment&&(e=this._fragments.indexOf(e)),e>=0&&e<this._fragments.length&&(this._activeIndex=e,this._fragments.forEach((function(e,n){e.setActive(n===t._activeIndex)})))}},{key:"nextFragment",value:function(){this.setActiveFragment((this._activeIndex+1)%this._fragments.length)}},{key:"previousFragment",value:function(){this.setActiveFragment((this._activeIndex+this._fragments.length-1)%this._fragments.length)}},{key:"addFragment",value:function(e){if(e instanceof h.SwipeChildFragment)return e.setParent(this),o(u(f.prototype),"addFragment",this).call(this,".swipe-container",e)}}])&&i(t.prototype,n),r&&i(t,r),f}(f.AbstractFragment);t.SwipeFragment=m,m.MAX_Y=80,m.MIN_X=150},function(e,t,n){e.exports=n.p+"html/swipeFragment.html"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonChooseDialog=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e,r,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),o=t.call(this,e,r),Object.keys(i).forEach((function(e){o.addButton(i[e],e)})),o}return n}(n(64).Dialog);t.ButtonChooseDialog=c},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ImgChooseDialog=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=o(n);function n(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var i={};return Object.keys(e).forEach((function(t){var n=document.createElement("img");n.src=e[t],i[t]=n})),t.call(this,i,r)}return n}(n(267).ElemChooseDialog);t.ImgChooseDialog=c},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Form=void 0;var c=n(63),u=n(22),l=n(31),f=n(69),h=n(268),d=n(7),p=function(){function e(t,n,r,o){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.imageSelectionElementReady=new d.PromiseWithHandlers,this.imageSelectionElements={},this.formElem=t,this._method=u.Helper.nonNull(r,t.method,"POST"),this._elementChangeListener=null,this._validators=[],this._isBusy=!1,void 0===o&&(o="input.image-selection"),this._submitHandler="string"==typeof n?function(e){if("get"===a._method.toLowerCase())return c.DataManager.load(n+c.DataManager.buildQuery(e))}:n,this._editors=[],this._submitCallback=null,this.errorCallback=function(e){return s(a,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setErrors(e);case 2:case"end":return t.stop()}}),t,this)})))},t.addEventListener("submit",(function(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.next=3,l.doSubmit(e);case 3:case"end":return t.stop()}}),t)})))})),this.prepareForImageSelection(o).then((function(e){return a.imageSelectionElementReady.resolve(e)}));var l=this;i(t.elements).forEach((function(e){e.addEventListener("change",(function(){if(""!==this.value.trim()?this.classList.add("notEmpty"):this.classList.remove("notEmpty"),this.setCustomValidity(""),u.Helper.isNotNull(l._elementChangeListener)&&l._elementChangeListener(e,this),this.setCustomValidity(""),e.accept&&-1!==e.accept.indexOf("image"))if(e.files&&e.files[0]){var n=new FileReader;n.onload=function(n){var r=t.querySelector("."+e.name+"-preview");r&&(r.src=n.target.result)},n.readAsDataURL(e.files[0])}else t.querySelector("."+e.name+"-preview").src=""})),e.addEventListener("keydown",(function(){this.setCustomValidity("")}))}))}var t,n,o;return t=e,o=[{key:"filesToBase64",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],Object.keys(e).forEach((function(t){e[t]instanceof Blob&&n.push(new Promise((function(n,r){var i=new FileReader;i.onload=function(){return n(i.result)},i.onerror=function(e){return r(e)},i.readAsDataURL(e[t])})).then((function(n){return e[t]=n})))})),t.next=4,Promise.all(n);case 4:return t.abrupt("return",e);case 5:case"end":return t.stop()}}),t)})))}}],(n=[{key:"prepareForImageSelection",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.Helper.asyncForEach(this.formElem.querySelectorAll(e),(function(e){return s(n,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="",r="",e instanceof HTMLInputElement&&(n=e.name,r=e.value),(u.Helper.isNull(n)||""===n)&&(n=e.dataset.name),(u.Helper.isNull(r)||""===r)&&(r=e.dataset.value),i=new h.ImageSelectionElement(n),!r||""===r.trim()){t.next=15;break}return t.prev=7,t.next=10,i.setValue(JSON.parse(r));case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(7),console.warn(t.t0);case 15:return this.imageSelectionElements[n]=i,t.t1=e,t.next=19,i.getView();case 19:t.t2=t.sent,t.t1.replaceWith.call(t.t1,t.t2);case 21:case"end":return t.stop()}}),t,this,[[7,12]])})))}),!0);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"setImagesForImageSelectionElement",value:function(e,t){return s(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.imageSelectionElementReady;case 2:this.imageSelectionElements[e]&&this.imageSelectionElements[e].setImages(t);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"addValidator",value:function(e){this._validators.push(e)}},{key:"onError",value:function(e){this.errorCallback=e}},{key:"addEditor",value:function(e){this._editors.push(e)}},{key:"doSubmit",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._isBusy){e.next=5;break}return e.next=3,this.submit();case 3:return t=e.sent,e.abrupt("return",t);case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"setValues",value:function(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setIsBusy(!0),t.next=3,Promise.resolve(e);case 3:for(r in n=t.sent,this.setIsBusy(!1),n){if(u.Helper.isNotNull(this.formElem.elements[r])){if(u.Helper.isNotNull(this.formElem.elements[r].options)&&u.Helper.isNotNull(n[r+"Options"]))for(o in i=this.formElem.elements[r].options,n[r+"Options"])(a=document.createElement("option")).value=o,a.innerText=n[r+"Options"][o],i.add(a);!this.formElem.elements[r].type||"checkbox"!==this.formElem.elements[r].type&&"radio"!==this.formElem.elements[r].type?this.formElem.elements[r].type&&"file"===this.formElem.elements[r].type?(this.formElem.elements[r+"-hidden"]&&(this.formElem.elements[r+"-hidden"].value=n[r]),this.formElem.elements[r].accept&&-1!==this.formElem.elements[r].accept.indexOf("image")&&(s=this.formElem.querySelector("."+r+"-preview"))&&(s.src=n[r])):(this.formElem.elements[r].value=u.Helper.htmlspecialcharsDecode(n[r]),this.formElem.elements[r].classList&&(u.Helper.isNotNull(n[r])&&""!==(""+n[r]).trim()?this.formElem.elements[r].classList.add("notEmpty"):this.formElem.elements[r].classList.remove("notEmpty"))):this.formElem.elements[r].checked=this.formElem.elements[r].value==n[r]}u.Helper.isNotNull(this.imageSelectionElements[r])&&(console.log("setImg",r,n[r]),this.imageSelectionElements[r].setValue(n[r]))}return t.abrupt("return",this);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"getValues",value:function(t){return s(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=new FormData(this.formElem),i=Array.from(r.entries()).reduce((function(e,t){return Object.assign(Object.assign({},e),(n={},r=t[0],i=t[1],r in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n));var n,r,i}),{}),!u.Helper.nonNull(t,!0)){n.next=6;break}return n.next=5,e.filesToBase64(i);case 5:i=n.sent;case 6:return n.abrupt("return",i);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setElementChangeListener",value:function(e){this._elementChangeListener=e}},{key:"clearErrors",value:function(){var e=this;Object.keys(this.formElem.elements).forEach((function(t){e.formElem.elements[t].setCustomValidity("")}))}},{key:"setErrors",value:function(e){var t=!1;for(var n in e)u.Helper.isNotNull(this.formElem.elements[n])&&"hidden"!==this.formElem.elements[n].type&&u.Helper.isNull(this.formElem.elements[n].readonly)&&(u.Helper.isNull(this.formElem.elements[n].disabled)||!this.formElem.elements[n].disabled)?(this.formElem.elements[n].setCustomValidity(l.Translator.translate(u.Helper.nonNull(e[n],"form-default-error"))),t=!0):new f.Toast(u.Helper.nonNull(e[n],"form-default-error")).show();t&&"reportValidity"in this.formElem&&this.formElem.reportValidity()}},{key:"setIsBusy",value:function(e){this._isBusy=e,this._isBusy?this.formElem.classList.add("sending"):this.formElem.classList.remove("sending")}},{key:"submit",value:function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._editors.forEach((function(e){return e.updateSourceElement()})),this.setIsBusy(!0),e.next=4,this.validate();case 4:if(!e.sent){e.next=24;break}return t=!1,e.prev=6,e.t0=this,e.next=10,this.getValues();case 10:return e.t1=e.sent,e.t2=this,e.next=14,e.t0._submitHandler.call(e.t0,e.t1,e.t2);case 14:t=e.sent,e.next=20;break;case 17:e.prev=17,e.t3=e.catch(6),console.error(e.t3);case 20:return e.prev=20,this.setIsBusy(!1),e.finish(20);case 23:return e.abrupt("return",t);case 24:return this.setIsBusy(!1),e.abrupt("return",!1);case 26:case"end":return e.stop()}}),e,this,[[6,17,20,23]])})))}},{key:"validate",value:function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,i,o,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("reportValidity"in this.formElem)||this.formElem.reportValidity()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,this.getValues();case 4:return t=e.sent,e.next=7,u.Helper.asyncForEach(this._validators,(function(e){return s(a,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e(t,this));case 1:case"end":return n.stop()}}),n,this)})))}),!0);case 7:if(n=e.sent,i=!1,o={},n.forEach((function(e){if(!0!==e&&(i=!0,"object"===r(e)))for(var t in e)o[t]=e[t]})),!i){e.next=15;break}return e.next=14,this.setErrors(o);case 14:return e.abrupt("return",!1);case 15:return e.abrupt("return",!0);case 16:case"end":return e.stop()}}),e,this)})))}},{key:"onSubmit",value:function(e){this._submitCallback=e}},{key:"getFormElement",value:function(){return this.formElem}}])&&a(t.prototype,n),o&&a(t,o),e}();t.Form=p},function(e,t,n){e.exports=n.p+"html/imageSelectionElement.html"},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Matomo=void 0;var o=n(7),a=n(11),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,s=[{key:"init",value:function(){var t=this;e.isTrackingPromise=new Promise((function(n){return i(t,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.NativeStoragePromise.getItem(e.LOCAL_STORAGE_KEY,"1");case 2:if(r=t.sent,!o.Helper.isNull(r)){t.next=11;break}return t.next=6,e._askIsTracking();case 6:return r=t.sent,t.next=9,a.NativeStoragePromise.setItem(e.LOCAL_STORAGE_KEY,r);case 9:t.next=14;break;case 11:return r="1"===r,t.next=14,e.setTrack(r);case 14:n(r);case 15:case"end":return t.stop()}}),t)})))})),e.isTrackingPromise.then((function(){e.push(["trackPageView"],!0),e.push(["enableLinkTracking"],!0),e.push(["setTrackerUrl",e.TRACK_SITE+"/piwik.php"],!0),e.push(["setSiteId",e.SIDE_ID+""],!0);var t=document,n=t.createElement("script"),r=t.getElementsByTagName("head")[0];n.type="text/javascript",n.async=!0,n.defer=!0,n.src=e.TRACK_SITE+"/piwik.js",r.appendChild(n)}))}},{key:"update",value:function(t){o.Helper.nonNull(e.currentUrl)&&e.push(["setReferrerUrl",e.currentUrl]),e.currentUrl=window.location.pathname+window.location.search,e.push(["setCustomUrl",e.currentUrl]),e.push(["setDocumentTitle",t]),e.push(["deleteCustomVariables","page"]),e.push(["setGenerationTimeMs",0]),e.push(["trackPageView"]);var n=document.getElementById("site-content");e.push(["MediaAnalytics::scanForMedia",n]),e.push(["FormAnalytics::scanForForms",n]),e.push(["trackContentImpressionsWithinNode",n]),e.push(["enableLinkTracking"])}},{key:"_askIsTracking",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isTrackingPromise=new Promise((function(t){e.push([function(){t(!this.isUserOptedOut())}])})),t.abrupt("return",e.isTrackingPromise);case 2:case"end":return t.stop()}}),t)})))}},{key:"query",value:function(t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",fetch(e.TRACK_SITE+e.BASE_PATH+t,{mode:"cors",credentials:"include"}).then((function(e){return e.text()})).then((function(e){return(new window.DOMParser).parseFromString(e,"text/xml")})));case 1:case"end":return n.stop()}}),n)})))}},{key:"getTrackingPromise",value:function(){return e.isTrackingPromise}},{key:"setTrack",value:function(t){return i(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.isTrackingPromise=Promise.resolve(t),n.next=3,a.NativeStoragePromise.setItem(e.LOCAL_STORAGE_KEY,!0===t?"1":"0");case 3:if(!t){n.next=8;break}return n.next=6,e.push(["forgetUserOptOut"],!0);case 6:n.next=10;break;case 8:return n.next=10,e.push(["optUserOut"],!0);case 10:case"end":return n.stop()}}),n)})))}},{key:"trackEvent",value:function(e,t,n,r){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){var a;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=["trackEvent",e,t],o.Helper.isNotNull(n)&&a.push(n),o.Helper.isNotNull(r)&&!isNaN(parseFloat(r))&&isFinite(r)&&a.push(r),i.abrupt("return",this.push(a));case 4:case"end":return i.stop()}}),i,this)})))}},{key:"push",value:function(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}}],(n=null)&&r(t.prototype,n),s&&r(t,s),e}();t.Matomo=s,s.LOCAL_STORAGE_KEY="matomoShouldTrack",s.TRACK_SITE="",s.BASE_PATH="",s.SIDE_ID="1",s.currentUrl=null,s.isTrackingPromise=null},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ScaleHelper=void 0;var o=n(7),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,(n=[{key:"scaleTo",value:function(e,t,n,r,a,s,c,u,l){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){var f,h,d;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return l=o.Helper.nonNull(l,!0),u=o.Helper.nonNull(u,0),i.next=4,this._getNewFontSize(e,t,n,r,a,s,c,0===u);case 4:if(f=i.sent,!(u>0)){i.next=8;break}return i.next=8,new Promise((function(e){setTimeout(e,u),t.style.fontSize=f+"px"}));case 8:return h=this,d=function(){return new Promise((function(i){setTimeout((function(){i(h.scaleTo(e,t,n,r,a,s,c,u,!1))}),"number"==typeof l?l:255)}))},!1!==l&&window.addEventListener("resize",d),i.abrupt("return",d);case 12:case"end":return i.stop()}}),i,this)})))}},{key:"scaleToFull",value:function(e,t,n,r,o,a,s,c){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",this.scaleTo(1,e,t,n,r,o,a,s,c));case 1:case"end":return i.stop()}}),i,this)})))}},{key:"_getNewFontSize",value:function(e,t,n,r,a,s,c,u){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){var l,f,h,d,p,m,y,g,b,v,w,_,k;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:for(s=o.Helper.nonNull(s,10),r=o.Helper.nonNull(r,!1),a=o.Helper.nonNull(a,!1),c=o.Helper.nonNull(c,t.innerHTML.length),u=o.Helper.nonNull(u,!0),(l=n.classList.contains("no-transition"))||n.classList.add("no-transition"),f=5,h=0,d=[],p=0;p<f;p++)d.push(0);m=t.style.fontSize,y=1,g=0,b=0,v=0,w=0;case 17:if(y+=d[h]/(c+1),t.style.fontSize=y+"px",_=window.getComputedStyle(n),v=parseFloat(_.getPropertyValue("width").replace("px","")),w=parseFloat(_.getPropertyValue("height").replace("px","")),g=v-t.offsetWidth,b=w-t.offsetHeight,h=(h+1)%f,(k=a?b:r?g:Math.min(g,b))!==d[(h+1)%f]){i.next=28;break}return i.abrupt("break",30);case 28:d[h]=k;case 29:if((g>(1-e)*v||a)&&(b>(1-e)*w||r)){i.next=17;break}case 30:if(y-=s,t.style.fontSize=u?y+"px":m,l){i.next=36;break}return i.next=35,new Promise((function(e){setTimeout(e,50)}));case 35:n.classList.remove("no-transition");case 36:return i.abrupt("return",y);case 37:case"end":return i.stop()}}),i)})))}}])&&r(t.prototype,n),a&&r(t,a),e}();t.ScaleHelper=a},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseHelper=void 0;var o=n(22),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"delay",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){setTimeout(t,e)})));case 1:case"end":return t.stop()}}),t)})))}},{key:"tryMultipleTimes",value:function(t,n,r){return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){var a,s;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=o.Helper.nonNull(n,5),r=o.Helper.nonNull(r,50),a=0;case 3:if(!(a<n)){i.next=16;break}return i.next=6,t();case 6:if(void 0===(s=i.sent)){i.next=11;break}return i.abrupt("return",s);case 11:return i.next=13,e.delay(r);case 13:a++,i.next=3;break;case 16:return i.abrupt("return",void 0);case 17:case"end":return i.stop()}}),i)})))}},{key:"tryUntilTimeout",value:function(t,n,r){return i(this,void 0,void 0,regeneratorRuntime.mark((function a(){var s=this;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=o.Helper.nonNull(n,500),r=o.Helper.nonNull(r,50),a.abrupt("return",new Promise((function(o,a){return i(s,void 0,void 0,regeneratorRuntime.mark((function i(){var s,c;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:s=!0,e.delay(n).then((function(){a(new Error("timeout")),s=!1}));case 2:if(!s){i.next=13;break}return i.next=5,t();case 5:if(void 0===(c=i.sent)){i.next=9;break}return o(c),i.abrupt("break",13);case 9:return i.next=11,e.delay(r);case 11:i.next=2;break;case 13:case"end":return i.stop()}}),i)})))})));case 3:case"end":return a.stop()}}),a)})))}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();t.PromiseHelper=a},function(e,t,n){e.exports=n.p+"html/shareDialog.html"},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.ShareManager=void 0;var i=n(269),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"share",value:function(e){"browser"===device.platform?this._shareBrowser(e):this._shareMobile(e)}},{key:"_shareMobile",value:function(e){navigator.share(e)}},{key:"_shareBrowser",value:function(e){new i.ShareDialog(e).show()}}])&&r(t.prototype,n),o&&r(t,o),e}();t.ShareManager=o},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MatomoDelegateSite=void 0;var h=n(259),d=n(7),p=n(165),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(h,e);var t,n,r,u=c(h);function h(){return i(this,h),u.apply(this,arguments)}return t=h,(n=[{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return a(l(h.prototype),"onStart",t)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.onStart.call(this,e),this.update();case 2:case"end":return t.stop()}}),t,this)})))}},{key:"update",value:function(){d.Helper.isNotNull(h.currentUrl)&&p.MatomoHelper.apiCall("setReferrerUrl",h.currentUrl),h.currentUrl=window.location.pathname+window.location.search,p.MatomoHelper.apiCall("setCustomUrl",h.currentUrl),p.MatomoHelper.apiCall("deleteCustomVariables","page"),p.MatomoHelper.apiCall("setGenerationTimeMs",0),p.MatomoHelper.apiCall("trackPageView");var e=document.getElementById("site-content");p.MatomoHelper.apiCall("MediaAnalytics::scanForMedia",e),p.MatomoHelper.apiCall("FormAnalytics::scanForForms",e),p.MatomoHelper.apiCall("trackContentImpressionsWithinNode",e),p.MatomoHelper.apiCall("enableLinkTracking")}}])&&o(t.prototype,n),r&&o(t,r),h}(h.DelegateSite);t.MatomoDelegateSite=m},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SoundManager=void 0;var a=n(270),s=n(5),c=n(38),u=n(63),l=function(){function e(){var t=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.channels={},"AudioContext"in window)this.context=new AudioContext;else{if(!("webkitAudioContext"in window))throw new Error("No audio context found!");this.context=new webkitAudioContext}this.context.onstatechange=function(){console.log("stateChange from context",arguments)},this.context.oncomplete=function(){console.log("onComplete from context",arguments)},window.addEventListener("visibilitychange",(function(e){t.handleVisibilityChange()}));!function e(){t.handleVisibilityChange(),setTimeout(e,500)}()}var t,n,c;return t=e,c=[{key:"getInstance",value:function(){return s.Helper.isNull(e._instance)&&(e._instance=new e),e._instance}}],(n=[{key:"isNotSuspended",value:function(){return"suspended"!==this.context.state}},{key:"set",value:function(t,n){var r=this;n=s.Helper.nonNull(n,e.CHANNELS.DEFAULT);var i=s.Helper.nonNull(this.channels[n],{});"string"==typeof t&&(t={audio:t});var o=t.audio;return s.Helper.isNotNull(o)&&(i.loadedPromise=u.DataManager.loadAsset(o,"raw").then((function(e){return e.arrayBuffer()})).then((function(e){return new Promise((function(t,n){return r.context.decodeAudioData(e,t)}))})).catch((function(e){return console.error(e)})),this.stop(n)),i.muted=s.Helper.nonNull(t.muted,i.muted,!1),i.volume=s.Helper.nonNull(t.volume,i.volume,1),i.loop=s.Helper.nonNull(t.loop,i.loop,!1),i.timeOffset=s.Helper.nonNull(t.timeOffset,i.timeOffset,0),this.channels[n]=i,i.muted&&this.stop(n),this.channels[n]}},{key:"resumeContext",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof this.context.resume){e.next=2;break}return e.abrupt("return",this.context.resume());case 2:case"end":return e.stop()}}),e,this)})))}},{key:"play",value:function(t,n){return o(this,void 0,void 0,regeneratorRuntime.mark((function i(){var o,c,u=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(this.resumeContext(),t=s.Helper.nonNull(t,e.CHANNELS.DEFAULT),s.Helper.isNull(n)?n={}:"object"!==r(n)&&(n={audio:n}),n.timeOffset=s.Helper.nonNull(n.timeOffset,0),this.stop(t),this.set(n,t),this.channels[t].muted){i.next=16;break}return i.next=9,this.channels[t].loadedPromise;case 9:return o=i.sent,(c=new a.AudioChain(this.context,o,(function(e){var n=u.context.createGain();n.gain.value=u.channels[t].volume,e.connect(n),n.connect(u.context.destination)}))).setBuffer(o),c.setLooping(this.channels[t].loop,.3,o.duration-.3),this.channels[t].source=c,i.next=16,c.start();case 16:return i.abrupt("return",this.channels[t]);case 17:case"end":return i.stop()}}),i,this)})))}},{key:"stop",value:function(t){t=s.Helper.nonNull(t,e.CHANNELS.DEFAULT);var n=this.channels[t];s.Helper.isNotNull(n)&&s.Helper.isNotNull(n.source)&&n.source.stop()}},{key:"get",value:function(t){return t=s.Helper.nonNull(t,e.CHANNELS.DEFAULT),this.channels[t]}},{key:"resume",value:function(t){return o(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=s.Helper.nonNull(t,e.CHANNELS.DEFAULT),!s.Helper.isNotNull(this.channels[t])||this.channels[t].muted||!s.Helper.isNotNull(this.channels[t].source)){n.next=3;break}return n.abrupt("return",this.channels[t].source.resume());case 3:case"end":return n.stop()}}),n,this)})))}},{key:"stopAll",value:function(){for(var e in this.channels)s.Helper.isNotNull(this.channels[e].source)&&this.channels[e].source.stop()}},{key:"resumeAllIfNotMuted",value:function(){for(var e in this.channels)s.Helper.isNotNull(this.channels[e])&&!this.channels[e].muted&&s.Helper.isNotNull(this.channels[e].source)&&this.channels[e].source.resume()}},{key:"handleVisibilityChange",value:function(){document.hidden?this.stopAll():this.resumeAllIfNotMuted()}}])&&i(t.prototype,n),c&&i(t,c),e}();t.SoundManager=l,l.CHANNELS={MUSIC:"music",SOUND:"sound",DEFAULT:"default"},c.App.addInitialization((function(e){}))},function(e){e.exports=JSON.parse('{"Sunday":"Sonntag","Monday":"Montag","Tuesday":"Dienstag","Wednesday":"Mittwoch","Thursday":"Donnerstag","Friday":"Freitag","Saturday":"Samstag","January":"Januar","February":"Februar","March":"März","April":"April","May":"Mai","June":"Juni","July":"Juli","August":"August","September":"September","October":"Oktober","November":"November","December":"Dezember","Sun":"So","Mon":"Mo","Tue":"Di","Wed":"Mi","Thu":"Do","Fri":"Fr","Sat":"Sa","Jan":"Jan","Feb":"Feb","Mar":"Mär","Apr":"Apr","Jun":"Jun","Jul":"Jul","Aug":"Aug","Sep":"Sep","Oct":"Okt","Nov":"Nov","Dec":"Dez","cannot open popups":"Bitte erlaube Popups, um die Funktion nutzen zu können."}')},function(e){e.exports=JSON.parse('{"Sunday":"Sunday","Monday":"Monday","Tuesday":"Tuesday","Wednesday":"Wednesday","Thursday":"Thursday","Friday":"Friday","Saturday":"Saturday","January":"January","February":"February","March":"March","April":"April","May":"May","June":"June","July":"July","August":"August","September":"September","October":"October","November":"November","December":"December","Sun":"Sun","Mon":"Mon","Tue":"Tue","Wed":"Wed","Thu":"Thu","Fri":"Fri","Sat":"Sat","Jan":"Jan","Feb":"Feb","Mar":"Mar","Apr":"Apr","Jun":"Jun","Jul":"Jul","Aug":"Aug","Sep":"Sep","Oct":"Oct","Nov":"Nov","Dec":"Dec","cannot open popups":"Please allow popups to use this function."}')},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ModifyEntitySite=void 0;var f=n(153),h=n(2),d=n(7),p=n(39),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,n,r,c=s(f);function f(e,t,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(i=c.call(this,e,t,r))._formSelector=".entity-form",i._ckEditorConfig={".editor":{toolbar:["bold","italic","link","bulletedList","numberedList","blockQuote"],removePlugins:["Heading","Image","ImageCaption","ImageStyle","ImageToolbar","ImageUpload","Table","TableToolbar","MediaEmbed","CKFinderUploadAdapter"],language:"de"}},i._entity=null,i._model=n,i}return t=f,(n=[{key:"getEntityFromParameters",value:function(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._model.prototype instanceof p.EasySyncBaseModel){t.next=2;break}throw{error:"wrong class given! Expected EasySyncBaseModel, given "+this._model.name};case 2:return n=null,d.Helper.isSet(e,"id")&&(n=this._model.findById(e.id,this._model.getRelations())),d.Helper.isNull(n)&&(n=new this._model),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return o(u(f.prototype),"onConstruct",t)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.onConstruct.call(this,e),t.next=3,this.getEntityFromParameters(e);case 3:return null!==(i=t.sent)&&this.setEntity(i),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"setEntity",value:function(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._entity=e,t.next=3,this._viewLoadedPromise;case 3:return t.next=5,this.dehydrate(this._entity);case 5:if(n=t.sent,!d.Helper.isNotNull(n)){t.next=9;break}return t.next=9,this._form.setValues(n);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"hydrate",value:function(e,t){return l(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.constructor.getSchemaDefinition(),Object.keys(r.columns).forEach((function(n){d.Helper.isSet(e,n)&&(t[n]=e[n])})),n.abrupt("return",t);case 3:case"end":return n.stop()}}),n)})))}},{key:"dehydrate",value:function(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},r=e.constructor.getSchemaDefinition(),Object.keys(r.columns).forEach((function(t){d.Helper.isSet(e,t)&&(n[t]=e[t])})),t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))}},{key:"validate",value:function(e,t){return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})))}},{key:"saveListener",value:function(){this.finish()}},{key:"save",value:function(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.hydrate(e,this._entity);case 2:return n=t.sent,t.next=5,n.save();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(u(f.prototype),"onViewLoaded",e)}}});return l(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this._form=new h.Form(this.findBy(this._formSelector),(function(e){return l(r,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.showLoadingSymbol(),t.prev=1,t.next=4,this.save(e);case 4:this.saveListener(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(1),console.error(t.t0),this._form.setErrors({error:t.t0.message});case 11:return t.prev=11,this.removeLoadingSymbol(),t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,7,11,14]])})))})),d.Helper.isNotNull(window.CKEditor)&&Object.keys(this._ckEditorConfig).forEach((function(e){r.findBy(e,!0).forEach((function(t){return l(r,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=this._form,n.next=3,CKEditor.create(t,this._ckEditorConfig[e]);case 3:n.t1=n.sent,n.t0.addEditor.call(n.t0,n.t1);case 5:case"end":return n.stop()}}),n,this)})))}))})),this._form.addValidator((function(e){return l(r,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.validate(e,this._form);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})))}}])&&i(t.prototype,n),r&&i(t,r),f}(f.MenuSite);t.ModifyEntitySite=m},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SetupEasySync1000000000500=void 0;var o=n(13),a=n(4),SetupEasySync1000000000500=function(){function SetupEasySync1000000000500(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SetupEasySync1000000000500)}var e,t,n;return e=SetupEasySync1000000000500,(t=[{key:"up",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.dropTable("last_sync_dates",!0);case 2:return t.next=4,this._addLastSyncDates(e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_addLastSyncDates",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new o.Table({name:"last_sync_dates",columns:[{name:"id",type:"Integer",isPrimary:!0,isGenerated:!0,generationStrategy:"increment"},{name:"model",type:a.BaseDatabase.TYPES.STRING,isNullable:!0},{name:"lastSynced",type:a.BaseDatabase.TYPES.DATE,isNullable:!0},{name:"where",type:a.BaseDatabase.TYPES.TEXT}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))}},{key:"down",value:function(e){}}])&&r(e.prototype,t),n&&r(e,n),SetupEasySync1000000000500}();t.SetupEasySync1000000000500=SetupEasySync1000000000500},function(e,t,n){e.exports=n.p+"html/welcomeSite.html"},function(e,t){e.exports="./img/component.jpg"},function(e,t,n){e.exports=n.p+"html/absoluteBarMenuSiteTemplate.html"},function(e,t,n){e.exports=n.p+"html/calendarSite.html"},function(e,t,n){e.exports=n.p+"html/footerSite.html"},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AddFileMediumMigration1000000011000=void 0;var o=n(7),a=n(81),s=function(){function AddFileMediumMigration1000000011000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AddFileMediumMigration1000000011000)}var e,t,n;return e=AddFileMediumMigration1000000011000,(t=[{key:"down",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve(void 0));case 1:case"end":return e.stop()}}),e)})))}},{key:"up",value:function(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=o.MigrationHelper.createTableFromModelClass(a.FileMedium)).columns.forEach((function(e){"src"===e.name&&(e.type=o.MigrationHelper.isServer()?"MEDIUMTEXT":"TEXT")})),t.next=4,e.createTable(n);case 4:case"end":return t.stop()}}),t)})))}}])&&r(e.prototype,t),n&&r(e,n),AddFileMediumMigration1000000011000}();t.AddFileMediumMigration1000000011000=s},function(e,t,n){e.exports=n.p+"html/eventSite.html"},function(e,t,n){e.exports=n.p+"html/place.html"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.Access=void 0;var l=n(10),f=n(4),Access=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(Access,e);var t,n,r,c=s(Access);function Access(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Access),(e=c.call(this)).name=null,e.description=null,e}return t=Access,r=[{key:"getColumnDefinitions",value:function(){var e=o(u(Access),"getColumnDefinitions",this).call(this);return e.name={type:f.BaseDatabase.TYPES.STRING,unique:!0},e.description={type:f.BaseDatabase.TYPES.STRING},e}}],(n=null)&&i(t.prototype,n),r&&i(t,r),Access}(l.EasySyncBaseModel);t.Access=Access,Access.CAN_BE_SYNCED=!1,f.BaseDatabase.addModel(Access)},function(e,t,n){e.exports=n.p+"html/loginSite.html"},function(e,t,n){e.exports=n.p+"html/forgotPasswordSite.html"},function(e,t,n){e.exports=n.p+"html/notAllowedSite.html"},function(e,t,n){e.exports=n.p+"html/selectUserDialog.html"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineUserManager=void 0;var h=n(132),d=n(2),p=n(34),m=n(278),y=n(208),g=n(5),b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(u,e);var t,n,r,o=c(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=o.call(this))._userData={id:null,loggedIn:!1,online:!0,username:null,email:null,accesses:u.LOGGED_OUT_ACCESSES},e}return t=u,r=[{key:"_getNewId",value:function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g.Helper.isNull(u._lastId)){e.next=5;break}return e.next=3,y.User.findOne(void 0,{id:"DESC"});case 3:t=e.sent,u._lastId=t.id;case 5:return u._lastId++,e.abrupt("return",u._lastId);case 7:case"end":return e.stop()}}),e)})))}}],(n=[{key:"_doGetMe",value:function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.NativeStoragePromise.getItem("user-manager-user-id");case 2:if(t=e.sent,!g.Helper.isNotNull(t)){e.next=10;break}return e.next=6,y.User.findById(t,y.User.getRelations());case 6:if(n=e.sent,!g.Helper.isNotNull(n)||!n.activated||n.blocked){e.next=10;break}return e.next=10,this._handleLoginFromUser(n);case 10:return e.abrupt("return",this._userData);case 11:case"end":return e.stop()}}),e,this)})))}},{key:"_handleLoginFromUser",value:function(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,a,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],r=e.roles,o=[],r.forEach((function(e){o.push(e.id)})),t.next=6,m.Role.findByIds(o,["accesses"]);case 6:return r=t.sent,t.next=9,g.Helper.asyncForEach(r,(function(e){return f(s,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=n.push,t.t1=n,t.t2=i,t.next=5,this._getAccessesFromRole(e);case 5:t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.t0.apply.call(t.t0,t.t1,t.t4);case 8:case"end":return t.stop()}}),t,this)})))}));case 9:a=[],n.forEach((function(e){a.push(e.name)})),this._userData={id:e.id,loggedIn:!0,online:!0,username:e.username,email:e.email,accesses:a};case 12:case"end":return t.stop()}}),t,this)})))}},{key:"_doLogin",value:function(e,t,n){return f(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,y.User.findOne({email:e,password:this._hashPassword(t),activated:!0,blocked:!1},void 0,void 0,y.User.getRelations());case 2:if(!(i=r.sent)){r.next=10;break}return r.next=6,this._handleLoginFromUser(i);case 6:if(!n){r.next=9;break}return r.next=9,d.NativeStoragePromise.setItem("user-manager-user-id",i.id);case 9:return r.abrupt("return",!0);case 10:return r.abrupt("return",!1);case 11:case"end":return r.stop()}}),r,this)})))}},{key:"_doLogout",value:function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._userData={id:null,loggedIn:!1,online:!0,username:null,email:null,accesses:u.LOGGED_OUT_ACCESSES},e.next=3,d.NativeStoragePromise.remove("user-manager-user-id");case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"_getAccessesFromRole",value:function(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.accesses,t.next=3,h.EasySyncClientDb.getInstance()._getRepository(m.Role.getSchemaName());case 3:return r=t.sent,t.next=6,r.createQueryBuilder(m.Role.getSchemaName()).leftJoinAndSelect(m.Role.getSchemaName()+".accesses","access").leftJoinAndSelect(m.Role.getSchemaName()+".children","child").where("child.id = :id",{id:e.id}).getMany();case 6:return o=t.sent,t.next=9,g.Helper.asyncForEach(o,(function(e){return f(a,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getAccessesFromRole(e);case 2:r=t.sent,n.push.apply(n,i(r));case 4:case"end":return t.stop()}}),t,this)})))}));case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}}),t)})))}},{key:"_doRegister",value:function(e,t,n){return f(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,o,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i={},r.next=3,Promise.all([y.User.findOne({email:e}),y.User.findOne({username:t})]);case 3:if(o=r.sent,g.Helper.isNotNull(o[0])&&(i.email="email is already in use."),g.Helper.isNotNull(o[1])&&(i.username="username is already in use."),!(Object.keys(i).length>0)){r.next=8;break}return r.abrupt("return",i);case 8:return a=new y.User,r.next=11,u._getNewId();case 11:return a.id=r.sent,a.email=e,a.password=this._hashPassword(n),a.username=t,a.roles=u.DEFAULT_ROLES,a.activated=!0,r.next=19,a.save();case 19:return r.next=21,this.login(e,n);case 21:return r.abrupt("return",a);case 22:case"end":return r.stop()}}),r,this)})))}},{key:"_hashPassword",value:function(e){return e}}])&&a(t.prototype,n),r&&a(t,r),u}(p.UserManager);t.OfflineUserManager=b,b.LOGGED_OUT_ACCESSES=p.UserManager.OFFLINE_ACCESSES,b.DEFAULT_ROLES=[],b._lastId=null},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeUserSite=void 0;var h=n(153),d=n(56),p=n(5),m=n(63),y=n(2),g=n(57),b=n(155),v=n(154),w=n(281),_=n(559),k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(h,e);var t,n,r,c=s(h);function h(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=c.call(this,e,_)).addDelegate(new d.UserSite(u(t),h.ACCESS)),t}return t=h,(n=[{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return o(l(h.prototype),"onConstruct",t)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.onConstruct.call(this,e),!p.Helper.isSet(e,"id")){t.next=5;break}return t.next=4,m.DataManager.load(h.LOAD_USER_INFOS_URL+m.DataManager.buildQuery({id:e.id}));case 4:i=t.sent;case 5:return i&&!0===i.success||(new y.Toast(i.message).show(),this.finish()),this._roles=i.roles,this._userData=i.userData,t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(l(h.prototype),"onViewLoaded",e)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this.findBy("#username").innerText=this._userData.username,this._hasRoleContainer=this.findBy("#has-role-container"),this._availableRoleContainer=this.findBy("#available-role-container"),this._hasRoleTemplate=this.findBy("#has-role-template"),this._availableRoleTemplate=this.findBy("#available-role-template"),this._hasRoleTemplate.removeAttribute("id"),this._availableRoleTemplate.removeAttribute("id"),this._hasRoleTemplate.remove(),this._availableRoleTemplate.remove(),this.updateRoles(),e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})))}},{key:"updateRoles",value:function(){var e=this,t=[],n=[];this._roles.forEach((function(r){-1!==e._userData.roleIds.indexOf(r.id)?t.push(r):n.push(r)})),g.ViewHelper.removeAllChildren(this._hasRoleContainer),t.forEach((function(t,n){var r=e._hasRoleTemplate.cloneNode(!0);r.querySelector(".role-name").innerText=t.name,r.querySelector(".remove-role").addEventListener("click",(function(){return f(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoadingSymbol(),e.next=3,m.DataManager.send(h.CHANGE_USER_ROLE_URL,{id:this._userData.id,roleId:t.id,addRole:!1});case 3:e.sent.success&&(this._userData.roleIds.splice(this._userData.roleIds.indexOf(t.id),1),this.updateRoles()),this.removeLoadingSymbol();case 6:case"end":return e.stop()}}),e,this)})))})),e._hasRoleContainer.appendChild(r)})),g.ViewHelper.removeAllChildren(this._availableRoleContainer),n.forEach((function(t){var n=e._availableRoleTemplate.cloneNode(!0);n.querySelector(".role-name").innerText=t.name,n.querySelector(".add-role").addEventListener("click",(function(){return f(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoadingSymbol(),e.next=3,m.DataManager.send(h.CHANGE_USER_ROLE_URL,{id:this._userData.id,roleId:t.id,addRole:!0});case 3:e.sent.success&&(this._userData.roleIds.push(t.id),this.updateRoles()),this.removeLoadingSymbol();case 6:case"end":return e.stop()}}),e,this)})))})),e._availableRoleContainer.appendChild(n)}))}}])&&i(t.prototype,n),r&&i(t,r),h}(h.MenuSite);t.ChangeUserSite=k,k.ACCESS="admin",k.LOAD_USER_INFOS_URL="/user/userRoles",k.CHANGE_USER_ROLE_URL="/user/changeUserRole",k.ADD_CHANGE_USER_ACTION=!0,y.App.addInitialization((function(e){k.ADD_CHANGE_USER_ACTION&&y.NavbarFragment.defaultActions.push(new b.UserMenuAction("change user",k.ACCESS,(function(){return f(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(new w.SelectUserDialog).show();case 2:return n=t.sent,t.next=5,e.startSite(k,{id:n.id});case 5:case"end":return t.stop()}}),t)})))}))),e.addDeepLink("login",v.LoginSite)}))},function(e,t,n){e.exports=n.p+"html/changeUserSite.html"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RegistrationSite=void 0;var h=n(2),d=n(561),p=n(56),m=n(209),y=n(34),g=n(208),b=n(7),v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(m,e);var t,n,r,c=s(m);function m(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(n=c.call(this,e,b.Helper.nonNull(t,d))).addDelegate(new p.UserSite(u(n),m.ACCESS)),n}return t=m,(n=[{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return o(l(m.prototype),"onViewLoaded",e)}}});return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),(r=new h.Form(this.findBy("#registration-form"),(function(e){return f(i,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.UserManager.getInstance().register(e.email,e.username,e.password);case 2:if(!((n=t.sent)instanceof g.User||!0===n)){t.next=9;break}return new h.Toast("registration successful").show(),t.next=7,this.finish();case 7:t.next=11;break;case 9:return t.next=11,r.setErrors(n);case 11:case"end":return t.stop()}}),t,this)})))}))).addValidator((function(e){return e.password===e.password2||{password2:"the passwords do not match."}})),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})))}}])&&i(t.prototype,n),r&&i(t,r),m}(h.MenuSite);t.RegistrationSite=v,v.ACCESS="loggedOut",v.ADD_REGISTRATION_ACTION=!0,v.ADD_DEEP_LINK=!0,h.App.addInitialization((function(e){v.ADD_REGISTRATION_ACTION&&h.NavbarFragment.defaultActions.push(new m.StartUserSiteMenuAction("registration",v.ACCESS,v)),v.ADD_DEEP_LINK&&e.addDeepLink("registration",v)}))},function(e,t,n){e.exports=n.p+"html/registrationSite.html"},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(247),t)},function(e){e.exports=JSON.parse('{"login":"Login","logout":"Logout","email":"E-Mail","password":"Passwort","email or password is wrong":"Die E-Mail oder das Passwort stimmt nicht!","stay logged in":"Angemeldet bleiben","goodbye":"Auf Wiedersehen","welcome back":"Willkommen zurück","registration successful":"Registrierung erfolgreich","registration":"Anmelden","I have read and accepted the terms and conditions.":"Ich habe die AGB gelesen und akzeptiert.","retype password":"Passwort wiederholen","the passwords do not match.":"Die Passwörter stimmen nicht überein.","username":"Username","email is already in use.":"Die E-Mail wird bereits verwendet.","username is already in use.":"Der Username ist bereits vergeben.","wrong email or password":"Falsche E-Mail oder falsches Passwort","wrong rights":"Keine Berechtigung!","passwort vergessen?":"Passwort vergessen?","password forgotten":"Passwort vergessen","request new password":"Neues Passwort setzen","email is not in our database":"Die E-Mail ist nicht registriert!","forgot-password-mail sent":"Es wurde eine E-Mail an die angegebene Adresse gesendet.","password resetted":"Das Passwort wurde erfolgreich zurückgesetzt.","token is not valid":"Der Link ist nicht mehr gültig.","reset password":"Passwort zurücksetzen","repeat password":"Passwort wiederholen","token not valid":"Der Link ist nicht mehr gültig","Not allowed":"Nicht erlaubt","You don\'t have the rights to do this!":"Du hast nicht die Berechtigung, um das zu tun!","If you are not logged in, please log in and try again.":"Wenn du noch nicht eingeloggt bist, logge dich ein und versuche es erneut."}')},function(e){e.exports=JSON.parse('{"login":"Login","logout":"Logout","email":"E-Mail","password":"Password","email or password is wrong":"The e-mail or password is incorrect!","stay logged in":"Stay logged in","goodbye":"Goodbye","welcome back":"Welcome back","registration successful":"Registration successful","registration":"Registration","I have read and accepted the terms and conditions.":"I have read and accepted the terms and conditions.","retype password":"Retype Password","the passwords do not match.":"The passwords do not match.","username":"Username","email is already in use.":"This e-mail is already in use.","username is already in use.":"This Username is already taken.","wrong email or password":"Wrong E-Mail or Password!","wrong rights":"Wrong Rights!","passwort vergessen?":"password forgotten?","password forgotten":"Password Forgotten","request new password":"Request New Password","email is not in our database":"The given E-Mailaddress is not registered!","forgot-password-mail sent":"We sent you an E-Mail with instructions","password resetted":"The password was successfully changed.","token is not valid":"The given link is no longer valid.","reset password":"Reset Password","repeat password":"Repeat Password","token not valid":"The link is not valid any more","Not allowed":"Not allowed","You don\'t have the rights to do this!":"You don\'t have the rights to do this!","If you are not logged in, please log in and try again.":"If you are not logged in, please log in and try again."}')},function(e,t,n){e.exports=n.p+"html/addEventSite.html"},function(e,t,n){"use strict";"function"!=typeof Object.assign&&(Object.assign=function(e,...t){if(!e)throw TypeError("Cannot convert undefined or null to object");for(const n of t)n&&Object.keys(n).forEach((t=>e[t]=n[t]));return e})},function(e,t,n){e.exports=n.p+"html/searchSite.html"},function(e,t,n){e.exports=n.p+"html/eventOverviewFragment.html"},function(e,t,n){e.exports=n.p+"html/qrSite.html"},function(e,t){e.exports="./img/flag_german.svg"},function(e,t){e.exports="./img/flag_usa.svg"},function(e,t,n){e.exports=n.p+"html/showChurchSite.html"},function(e,t,n){e.exports=n.p+"html/modifyChurchSite.html"},function(e,t,n){e.exports=n.p+"html/fsjChurchBaseListFragment.html"},function(e,t,n){e.exports=n.p+"html/listChurchesSite.html"},function(e,t,n){e.exports=n.p+"html/systemCalendarSettingsFragment.html"},function(e,t,n){e.exports=n.p+"html/contactSite.html"},function(e,t,n){e.exports=n.p+"index.css"},function(e,t,n){"use strict";n.r(t);var r=n(284),i=n(285),o=n(2),a=n(7),s=n(132),c=n(291),u=n.n(c);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},v=n(548),w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(a,e);var t,n,r,i=p(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t,v,"#site-content"))._footerFragment=new ui(y(n)),n.addFragment("#footer-fragment",n._footerFragment),n.addDelegate(new o.MatomoDelegateSite(y(n))),n}return t=a,(n=[{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return h(g(a.prototype),"onStart",t)}}});return b(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.onStart.call(this,e);case 2:window.StatusBar&&(StatusBar.overlaysWebView(!0),StatusBar.backgroundColorByHexString("#33000000"));case 3:case"end":return t.stop()}}),t,this)})))}},{key:"getFooterFragment",value:function(){return this._footerFragment}}])&&f(t.prototype,n),r&&f(t,r),a}(o.TemplateSite);function _(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){_(o,r,i,a,s,"next",e)}function s(e){_(o,r,i,a,s,"throw",e)}a(void 0)}))}}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,i,a;return t=e,(n=[{key:"scaleHeightThroughWidth",value:(a=k(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.style.transition="none",e.next=3,this.scale(n,k(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.getBoundingClientRect().height);case 1:case"end":return e.stop()}}),e)}))),k(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.getBoundingClientRect().width);case 1:case"end":return e.stop()}}),e)}))),(function(e){t.style.width=Math.fround(1e3*e+1e-5)/1e3+"px"}),null,t);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"scale",value:(i=k(regeneratorRuntime.mark((function e(t,n,r,i,a,s){var c,u,l,f,h,d,p,m=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.Helper.nonNull(a,.01),c=0,"function"!=typeof t){e.next=8;break}return e.next=5,t();case 5:c=e.sent,e.next=9;break;case 8:c=t;case 9:return c=parseFloat(c),u=0,l=[],e.t0=parseFloat,e.next=15,n();case 15:e.t1=e.sent,f=(0,e.t0)(e.t1),h=Math.abs(c-f);case 18:if(!(h>a)){e.next=42;break}return d=f,l.push(d),e.t2=parseFloat,e.next=24,r();case 24:return e.t3=e.sent,p=(0,e.t2)(e.t3),e.next=28,i(p*c/f);case 28:return e.t4=parseFloat,e.next=31,n();case 31:if(e.t5=e.sent,f=(0,e.t4)(e.t5),!(Math.abs(d-f)<a/2||-1!==l.indexOf(f))){e.next=35;break}return e.abrupt("break",42);case 35:if(h=Math.abs(c-f),!(++u>=25)){e.next=40;break}return console.log("breaking after ",u," iterations"),e.abrupt("break",42);case 40:e.next=18;break;case 42:s&&s.addEventListener("resize",k(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.scale(t,n,r,i,a);case 2:case"end":return e.stop()}}),e)}))));case 43:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o,a){return i.apply(this,arguments)})}])&&E(t.prototype,n),r&&E(t,r),e}(),T=n(4),x=n(10),S=n(16),EasySyncBaseModel=n(39),AccessEasySyncModel=n(26);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t,n){return(P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=j(e);if(t){var i=j(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return A(this,n)}}function A(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(Region,e);var t,n,r,i=M(Region);function Region(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Region),(e=i.call(this)).name=null,e.churches=null,e.events=null,e}return t=Region,r=[{key:"getColumnDefinitions",value:function(){var e=P(j(Region),"getColumnDefinitions",this).call(this);return e.name={type:T.BaseDatabase.TYPES.STRING},e}},{key:"getRelationDefinitions",value:function(){var e=x.EasySyncBaseModel.getRelationDefinitions();return e.churches={target:$.getSchemaName(),type:"many-to-many",joinTable:{name:"churchRegion"},inverseSide:"regions",sync:!1},e.events={target:ue.getSchemaName(),type:"many-to-many",joinTable:{name:"eventRegion"},inverseSide:"regions",sync:!1},e}}],(n=[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"setChurches",value:function(e){this.churches=e}},{key:"getChurches",value:function(){return this.churches}}])&&R(t.prototype,n),r&&R(t,r),Region}(AccessEasySyncModel.AccessEasySyncModel);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t,n){return(B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=U(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U(e);if(t){var i=U(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return V(this,n)}}function V(e,t){return!t||"object"!==D(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}I.ACCESS_MODIFY="events",I.SCHEMA_NAME="Region",T.BaseDatabase.addModel(I);var H=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(FsjChurchBaseObject,e);var t,n,r,i=q(FsjChurchBaseObject);function FsjChurchBaseObject(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FsjChurchBaseObject),(e=i.call(this)).names=[],e.descriptions=[],e.website=null,e}return t=FsjChurchBaseObject,r=[{key:"getColumnDefinitions",value:function(){var e=B(U(FsjChurchBaseObject),"getColumnDefinitions",this).call(this);return e.names=T.BaseDatabase.TYPES.MY_JSON,e.descriptions=T.BaseDatabase.TYPES.MY_JSON,e.website=T.BaseDatabase.TYPES.STRING,e}}],(n=[{key:"getNames",value:function(){return this.names}},{key:"getDescriptions",value:function(){return this.descriptions}},{key:"getWebsite",value:function(){return this.website}},{key:"getImages",value:function(){return this.images}},{key:"getNameTranslation",value:function(){return this.constructor.getSchemaName()+"-name-"+this.id}},{key:"getDescriptionTranslation",value:function(){return this.constructor.getSchemaName()+"-description-"+this.id}},{key:"getDynamicTranslations",value:function(){var e=this,t={};return Object.keys(this.names).forEach((function(n){t[n]=t[n]||{},t[n][e.getNameTranslation()]=e.names[n]})),Object.keys(this.descriptions).forEach((function(n){t[n]=t[n]||{},t[n][e.getDescriptionTranslation()]=e.descriptions[n]})),t}}])&&L(t.prototype,n),r&&L(t,r),FsjChurchBaseObject}(AccessEasySyncModel.AccessEasySyncModel);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t,n){return(Y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=K(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=K(e);if(t){var i=K(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return J(this,n)}}function J(e,t){return!t||"object"!==z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(Church,e);var t,n,r,i=G(Church);function Church(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Church),(e=i.call(this)).places=[],e.instagram="",e}return t=Church,r=[{key:"getColumnDefinitions",value:function(){var e=Y(K(Church),"getColumnDefinitions",this).call(this);return e.places=T.BaseDatabase.TYPES.MY_JSON,e.instagram={type:T.BaseDatabase.TYPES.STRING,nullable:!0},e}},{key:"getRelationDefinitions",value:function(){var e=EasySyncBaseModel.EasySyncBaseModel.getRelationDefinitions();return e.regions={target:I.getSchemaName(),type:"many-to-many",joinTable:{name:"churchRegion"},sync:!0},e.images={target:x.FileMedium.getSchemaName(),type:"many-to-many",joinTable:{name:"churchImages"},sync:!0},e}}],(n=[{key:"getInstagram",value:function(){return this.instagram}},{key:"setInstagram",value:function(e){this.instagram=e}}])&&W(t.prototype,n),r&&W(t,r),Church}(H);$.ACCESS_MODIFY="organisers",$.SCHEMA_NAME="Church",T.BaseDatabase.addModel($);var X=n(5),Z=n(42),ee=n(111);function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e,t,n){return(re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=se(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=se(e);if(t){var i=se(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ae(this,n)}}function ae(e,t){return!t||"object"!==te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ce=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(Event,e);var t,n,r,i=oe(Event);function Event(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Event),(e=i.call(this)).isTemplate=!1,e.names=null,e.descriptions=null,e.startTime=null,e.endTime=null,e.type=null,e.organisers=null,e.places=[],e.regions=null,e.website=null,e.isTemplate=!1,e}return t=Event,r=[{key:"getRelations",value:function(){var e=re(se(Event),"getRelations",this).call(this);return e.push("repeatedEvent.originalEvent"),e.push("repeatedEvent.originalEvent.images"),e.push("repeatedEvent.originalEvent.organisers"),e}},{key:"getColumnDefinitions",value:function(){var e=re(se(Event),"getColumnDefinitions",this).call(this);return e.names={type:S.BaseDatabase.TYPES.MY_JSON,nullable:!0},e.descriptions={type:S.BaseDatabase.TYPES.MY_JSON,nullable:!0},e.places={type:S.BaseDatabase.TYPES.MY_JSON,nullable:!0},e.startTime={type:S.BaseDatabase.TYPES.DATE,nullable:!0},e.endTime={type:S.BaseDatabase.TYPES.DATE,nullable:!0},e.isTemplate={type:S.BaseDatabase.TYPES.BOOLEAN,default:!1},e.website={type:S.BaseDatabase.TYPES.STRING,nullable:!0},e.type={type:S.BaseDatabase.TYPES.STRING,default:Event.TYPES.GOTTESDIENST,nullable:!0},e}},{key:"find",value:function(e,t,n,r,i){return ce(this,void 0,void 0,regeneratorRuntime.mark((function o(){var a;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return void 0===i&&(i=Event.getRelations()),X.Helper.isNull(e)&&(e={}),Array.isArray(e)||(e=[e]),a=[],e.forEach((function(e){X.Helper.isSet(e,"isTemplate")||"object"!==("undefined"==typeof document?"undefined":te(document))?"false"===e.isTemplate?e.isTemplate=!1:"true"===e.isTemplate&&(e.isTemplate=!0):e.isTemplate=!1,a.push(e);var t={};Object.keys(e).forEach((function(n){return t[n]=e[n]})),t.isTemplate=t.isTemplate?"true":"false",a.push(t)})),o.abrupt("return",this._database.findEntities(this,a,t,n,r,i));case 6:case"end":return o.stop()}}),o,this)})))}},{key:"findAndCount",value:function(e,t,n,r,i){return ce(this,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return void 0===i&&(i=Event.getRelations()),X.Helper.isNull(e)&&(e={}),X.Helper.isSet(e,"isTemplate")||"object"!==("undefined"==typeof document?"undefined":te(document))||(e.isTemplate=!1),o.abrupt("return",this._database.findAndCountEntities(this,e,t,n,r,i));case 4:case"end":return o.stop()}}),o,this)})))}},{key:"findOne",value:function(e,t,n,r){return ce(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return void 0===r&&(r=Event.getRelations()),X.Helper.isNull(e)&&(e={}),X.Helper.isSet(e,"isTemplate")||"object"!==("undefined"==typeof document?"undefined":te(document))||(e.isTemplate=!1),i.abrupt("return",this._database.findOneEntity(this,e,t,n,r));case 4:case"end":return i.stop()}}),i,this)})))}},{key:"findById",value:function(e,t){return ce(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===t&&(t=Event.getRelations()),n.next=3,this._database.findById(this,e,t);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"findByIds",value:function(e,t){return ce(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===t&&(t=Event.getRelations()),r=[],n.next=4,this._database.findByIds(this,e,t);case 4:return i=n.sent,"object"===("undefined"==typeof document?"undefined":te(document))&&i.forEach((function(e){e.getIsTemplate()||r.push(e)})),n.abrupt("return",i);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getRelationDefinitions",value:function(){var e=x.EasySyncBaseModel.getRelationDefinitions();return e.repeatedEvent={target:"RepeatedEvent",type:"many-to-one",nullable:!0,joinColumn:!0,inverseSide:"events"},e.organisers={target:$.getSchemaName(),type:"many-to-many",joinTable:{name:"churchEvent"}},e.regions={target:I.getSchemaName(),type:"many-to-many",joinTable:{name:"eventRegion"},sync:!0},e.images={target:x.FileMedium.getSchemaName(),type:"many-to-many",joinTable:{name:"eventImages"},sync:!0},e}}],(n=[{key:"getRepeatedEvent",value:function(){return this.repeatedEvent}},{key:"getNameTranslation",value:function(){return"event-name-"+this.id}},{key:"getDescriptionTranslation",value:function(){return"event-description-"+this.id}},{key:"getDynamicTranslations",value:function(){var e=this,t={};return Object.keys(this.getNames()).forEach((function(n){t[n]=t[n]||{},t[n][e.getNameTranslation()]=e.getNames()[n]})),Object.keys(this.getDescriptions()).forEach((function(n){t[n]=t[n]||{},t[n][e.getDescriptionTranslation()]=e.getDescriptions()[n]})),t}},{key:"getNames",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getNames():this.names}},{key:"setNames",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getNames(),e)?this.names=null:this.names=e}},{key:"getWebsite",value:function(){return X.Helper.isNull(this.website)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getWebsite():this.website}},{key:"setWebsite",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&this.repeatedEvent.getWebsite()===e?this.website=null:this.website=e}},{key:"getDescriptions",value:function(){return X.Helper.isNull(this.descriptions)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getDescriptions():this.descriptions}},{key:"setDescriptions",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getDescriptions(),e)?this.descriptions=null:this.descriptions=e}},{key:"getStartTime",value:function(){return X.Helper.isNull(this.startTime)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getStartTime():this.startTime}},{key:"setStartTime",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getStartTime(),e)?this.startTime=null:this.startTime=e}},{key:"getEndTime",value:function(){return X.Helper.isNull(this.endTime)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getEndTime():this.endTime}},{key:"setEndTime",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getEndTime(),e)?this.endTime=null:this.endTime=e}},{key:"getType",value:function(){return X.Helper.isNull(this.type)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getType():this.type}},{key:"setType",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&this.repeatedEvent.getType()==e?this.type=null:this.type=e}},{key:"getImages",value:function(){return X.Helper.isNull(this.images)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getImages():this.images}},{key:"setImages",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getImages(),e)?this.images=null:this.images=e}},{key:"getOrganisers",value:function(){return X.Helper.isNull(this.organisers)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getOrganisers():this.organisers}},{key:"setOrganisers",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&ee.BaseModel.equals(this.repeatedEvent.getOrganisers(),e)?this.organisers=null:this.organisers=e}},{key:"getPlaces",value:function(){return X.Helper.isNull(this.places)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getPlaces():this.places}},{key:"setPlaces",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getPlaces(),e)?this.places=null:this.places=e}},{key:"getRegions",value:function(){return X.Helper.isNull(this.regions)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getRegions():this.regions}},{key:"setRegions",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&ee.BaseModel.equals(this.repeatedEvent.getRegions(),e)?this.regions=null:this.regions=e}},{key:"getIsTemplate",value:function(){return this.isTemplate}},{key:"setIsTemplate",value:function(e){this.isTemplate=e}},{key:"setRepeatedEvent",value:function(e){this.repeatedEvent=e}}])&&ne(t.prototype,n),r&&ne(t,r),Event}(AccessEasySyncModel.AccessEasySyncModel);function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function de(e,t,n){return(de="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ge(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ge(e);if(t){var i=ge(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ye(this,n)}}function ye(e,t){return!t||"object"!==le(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}ue.TYPES={GOTTESDIENST:"gottesdienst",KONZERT:"konzert",KONFERENZ:"konferenz",JUGENDKREIS:"jugendkreis",STUDENTENKREIS:"studentenkreis",SONSTIGES:"sonstiges"},ue.ACCESS_MODIFY="events",ue.SCHEMA_NAME="Event",S.BaseDatabase.addModel(ue);var be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(BlockedDay,e);var t,n,r,i=me(BlockedDay);function BlockedDay(){return fe(this,BlockedDay),i.apply(this,arguments)}return t=BlockedDay,r=[{key:"getColumnDefinitions",value:function(){var e=de(ge(BlockedDay),"getColumnDefinitions",this).call(this);return e.day=S.BaseDatabase.TYPES.DATE,e}},{key:"getRelationDefinitions",value:function(){var e=EasySyncBaseModel.EasySyncBaseModel.getRelationDefinitions();return e.repeatedEvent={target:xe.getSchemaName(),type:"many-to-one",inverseSide:"blockedDays",joinColumn:!0,sync:!0},e.event={target:ue.getSchemaName(),type:"one-to-one",joinColumn:!0,sync:!0},e}}],(n=[{key:"getEvent",value:function(){return this.event}},{key:"setEvent",value:function(e){this.event=e}},{key:"getRepeatedEvent",value:function(){return this.repeatedEvent}},{key:"setRepeatedEvent",value:function(e){this.repeatedEvent=e}},{key:"getDay",value:function(){return this.day}},{key:"setDay",value:function(e){this.day=e}}])&&he(t.prototype,n),r&&he(t,r),BlockedDay}(AccessEasySyncModel.AccessEasySyncModel);function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e,t,n){return(_e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Te(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Te(e);if(t){var i=Te(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Oe(this,n)}}function Oe(e,t){return!t||"object"!==ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}be.ACCESS_MODIFY="events",S.BaseDatabase.addModel(be);var xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(RepeatedEvent,e);var t,n,r,i=Ee(RepeatedEvent);function RepeatedEvent(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,RepeatedEvent),(e=i.call(this)).repeatingStrategy=0,e.repeatingArguments="",e.originalEvent=null,e.repeatUntil=null,e.startDate=null,e}return t=RepeatedEvent,r=[{key:"getRelations",value:function(){var e=_e(Te(RepeatedEvent),"getRelations",this).call(this);return e.push("originalEvent.images"),e.push("originalEvent.organisers"),e}},{key:"getColumnDefinitions",value:function(){var e=_e(Te(RepeatedEvent),"getColumnDefinitions",this).call(this);return e.repeatUntil={type:S.BaseDatabase.TYPES.DATE,nullable:!0},e.startDate={type:S.BaseDatabase.TYPES.DATE},e.repeatingStrategy=S.BaseDatabase.TYPES.INTEGER,e.repeatingArguments=S.BaseDatabase.TYPES.TEXT,e}},{key:"getRelationDefinitions",value:function(){var e=EasySyncBaseModel.EasySyncBaseModel.getRelationDefinitions();return e.originalEvent={target:ue.getSchemaName(),type:"one-to-one",joinColumn:!0,sync:!0},e.blockedDays={target:be.getSchemaName(),type:"one-to-many",inverseSide:"repeatedEvent"},e}}],(n=[{key:"getNames",value:function(){return this.originalEvent.getNames()}},{key:"getWebsite",value:function(){return this.originalEvent.getWebsite()}},{key:"getDescriptions",value:function(){return this.originalEvent.getDescriptions()}},{key:"getStartTime",value:function(){return this.originalEvent.getStartTime()}},{key:"getEndTime",value:function(){return this.originalEvent.getEndTime()}},{key:"getType",value:function(){return this.originalEvent.getType()}},{key:"getImages",value:function(){return this.originalEvent.getImages()}},{key:"getOrganisers",value:function(){return this.originalEvent.getOrganisers()}},{key:"getPlaces",value:function(){return this.originalEvent.getPlaces()}},{key:"getRegions",value:function(){return this.originalEvent.getRegions()}},{key:"getOriginalEvent",value:function(){return this.originalEvent}},{key:"getRepeatUntil",value:function(){return this.repeatUntil}},{key:"setRepeatUntil",value:function(e){this.repeatUntil=e}},{key:"getStartDate",value:function(){return this.startDate}},{key:"setStartDate",value:function(e){this.startDate=e}},{key:"getRepeatingArguments",value:function(){return this.repeatingArguments}},{key:"setRepeatingArguments",value:function(e){this.repeatingArguments=e}},{key:"getRepeatingStrategy",value:function(){return this.repeatingStrategy}},{key:"setRepeatingStrategy",value:function(e){this.repeatingStrategy=e}},{key:"setOriginalEvent",value:function(e){this.originalEvent=e}}])&&we(t.prototype,n),r&&we(t,r),RepeatedEvent}(AccessEasySyncModel.AccessEasySyncModel);xe.DELETE_PATH="/sync/deleteRepeatedEvent",xe.ACCESS_MODIFY="events",xe.SCHEMA_NAME="RepeatedEvent",S.BaseDatabase.addModel(xe);var Se=n(109),Ce=n(13),Re=n(126),Pe=n(38),Ne=n(11);function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Le(e);if(t){var i=Le(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return De(this,n)}}function De(e,t){return!t||"object"!==Me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Le(e){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(n,e);var t=Ie(n);function n(){return Ae(this,n),t.apply(this,arguments)}return n}(Ne.NativeStoragePromise);Be.persistent=!0,Be.prefix="necessary_";var Fe=n(64),qe=n(292),Ve=n.n(qe),Ue=n(43);function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ze(e,t){return(ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qe(e);if(t){var i=Qe(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ye(this,n)}}function Ye(e,t){return!t||"object"!==He(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ze(e,t)}(n,e);var t=We(n);function n(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=t.call(this,Ue.ViewInflater.getInstance().load(Ve.a).then((function(t){t.querySelector("#accept-all").addEventListener("click",(function(){r._result=["functional","statistic","thirdParty"],r.close()})),t.querySelector("#open-settings").addEventListener("click",(function(){t.querySelector("#cookie-settings").classList.remove("hidden")}));var n=new o.Form(t.querySelector("#cookie-settings-form"),(function(e){r._result=Object.keys(e),r.close()})),i={};return e.forEach((function(e){i[e]=1})),n.setValues(i),t})),"Cookie-Einstellungen")).setCancelable(!1),r}return n}(Fe.Dialog);function Je(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Ke(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Je(o,r,i,a,s,"next",e)}function s(e){Je(o,r,i,a,s,"throw",e)}a(void 0)}))}}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,i,o,a,s,c,u,l;return t=e,n=null,r=[{key:"giveConsentToCookies",value:(l=Ke(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Be.setItem(e.consentKey,JSON.stringify(n)).catch((function(e){return console.error(e)}));case 2:if(-1===n.indexOf("functional")){t.next=7;break}return t.next=5,Ne.NativeStoragePromise.makePersistent();case 5:t.next=9;break;case 7:return t.next=9,Ne.NativeStoragePromise.makeUnpersistent();case 9:case"end":return t.stop()}}),t)}))),function(e){return l.apply(this,arguments)})},{key:"mustAskForConsent",value:(u=Ke(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Be.getItem(e.consentKey,null);case 2:return t.t0=t.sent,t.abrupt("return",null===t.t0);case 4:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})},{key:"getConsent",value:(c=Ke(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,Be.getItem(e.consentKey,"[]");case 3:return t.t1=t.sent,t.abrupt("return",t.t0.parse.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},{key:"hasConsent",value:(s=Ke(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getConsent();case 2:return n=e.sent,e.abrupt("return",-1!==n.indexOf(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"addConsent",value:(a=Ke(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getConsent();case 2:-1===(n=e.sent).indexOf(t)&&(n.push(t),this.giveConsentToCookies(n));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"revokeConsentToAll",value:(o=Ke(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Be.remove(e.consentKey);case 2:return t.abrupt("return",Ne.NativeStoragePromise.makeUnpersistent());case 3:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"showCookieDialog",value:(i=Ke(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Ge,e.next=3,this.getConsent();case 3:return e.t1=e.sent,e.next=6,new e.t0(e.t1).show();case 6:return t=e.sent,e.next=9,this.giveConsentToCookies(t);case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}],n&&$e(t.prototype,n),r&&$e(t,r),e}();function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Xe.consentKey="cookieConsent";var et=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},tt=n(551),nt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"isURL",value:function(e){return"string"==typeof e&&(e.startsWith("https://")||e.startsWith("http://")||e.startsWith("www."))}},{key:"createPlace",value:function(e,t,n){return et(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=o.Helper.nonNull(n,!1),r.next=3,o.ViewInflater.getInstance().load(tt);case 3:if(i=r.sent,!this.isURL(t)){r.next=14;break}(a=document.createElement("a")).href=t,a.innerText=e,a.target="_blank",a.classList.add("link"),a.classList.add("without-arrow"),n?(a.classList.add("grow"),i.querySelector(".place-name").replaceWith(a)):i.querySelector(".place-name").appendChild(a),r.next=21;break;case 14:if(i.querySelector(".place-name").innerText=e,!0!==n){r.next=19;break}i.querySelector(".place").classList.add("small"),r.next=21;break;case 19:return r.next=21,this.buildGoogleMaps(i,t);case 21:return r.abrupt("return",i);case 22:case"end":return r.stop()}}),r,this)})))}},{key:"_buildMapsLink",value:function(t){return"https://www.google.com/maps/embed/v1/place?key="+e.API_KEY+"&q="+encodeURIComponent(t.replace(/\n/g,", "))}},{key:"createMultipleLocationsView",value:function(){return et(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.ViewInflater.getInstance().load(tt);case 2:return(t=e.sent).querySelector(".place-name").appendChild(o.Translator.makePersistentTranslation("Multiple locations")),t.querySelector(".place").classList.add("small"),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))}},{key:"buildGoogleMaps",value:function(e,t){return et(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.querySelector(".place-google-maps"),n.next=3,Xe.hasConsent("thirdParty");case 3:if(!n.sent){n.next=8;break}r.src=this._buildMapsLink(t),r.classList.remove("hidden"),n.next=11;break;case 8:(i=e.querySelector(".non-third-party-cookies-accepted-message")).classList.remove("hidden"),e.querySelector(".activate-map").addEventListener("click",(function(){r.src=o._buildMapsLink(t),r.classList.remove("hidden"),i.classList.add("hidden"),e.querySelector(".accept-third-party-cookies").checked&&Xe.addConsent("thirdParty")}));case 11:case"end":return n.stop()}}),n,this)})))}}],(n=null)&&Ze(t.prototype,n),r&&Ze(t,r),e}();nt.API_KEY="AIzaSyCVzdiXCm6e-qGVjl_a2-As3Y6z9vyJt_k";var rt=n(74),it=n(293),ot=n.n(it);function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ut(e,t,n){return(ut="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pt(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function lt(e,t){return(lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ft(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pt(e);if(t){var i=pt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ht(this,n)}}function ht(e,t){return!t||"object"!==at(t)&&"function"!=typeof t?dt(e):t}function dt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var mt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lt(e,t)}(c,e);var t,n,r,i,a,s=ft(c);function c(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=s.call(this,e,t,ot.a))._footerFragment=new ui(dt(n)),n.addFragment("#footer-fragment",n._footerFragment),n.addDelegate(new o.MatomoDelegateSite(dt(n))),n}return t=c,(n=[{key:"onStart",value:(i=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ut(pt(c.prototype),"onStart",this).call(this,t);case 2:window.StatusBar&&(StatusBar.overlaysWebView(!0),StatusBar.backgroundColorByHexString("#33000000"));case 3:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){st(o,n,r,a,s,"next",e)}function s(e){st(o,n,r,a,s,"throw",e)}a(void 0)}))},function(e){return a.apply(this,arguments)})}])&&ct(t.prototype,n),r&&ct(t,r),c}(o.MenuSite);const yt=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],gt={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:e=>"undefined"!=typeof console&&console.warn(e),getWeek:e=>{const t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var n=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},bt={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:e=>{const t=e%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1};var vt=bt;const wt=(e,t=2)=>`000${e}`.slice(-1*t),_t=e=>!0===e?1:0;function kt(e,t){let n;return function(){clearTimeout(n),n=setTimeout((()=>e.apply(this,arguments)),t)}}const Et=e=>e instanceof Array?e:[e];function Ot(e,t,n){if(!0===n)return e.classList.add(t);e.classList.remove(t)}function Tt(e,t,n){const r=window.document.createElement(e);return t=t||"",n=n||"",r.className=t,void 0!==n&&(r.textContent=n),r}function xt(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function St(e,t){return t(e)?e:e.parentNode?St(e.parentNode,t):void 0}function Ct(e,t){const n=Tt("div","numInputWrapper"),r=Tt("input","numInput "+e),i=Tt("span","arrowUp"),o=Tt("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?r.type="number":(r.type="text",r.pattern="\\d*"),void 0!==t)for(const e in t)r.setAttribute(e,t[e]);return n.appendChild(r),n.appendChild(i),n.appendChild(o),n}function Rt(e){try{if("function"==typeof e.composedPath){return e.composedPath()[0]}return e.target}catch(t){return e.target}}const Pt=()=>{},Nt=(e,t,n)=>n.months[t?"shorthand":"longhand"][e],Mt={D:Pt,F:function(e,t,n){e.setMonth(n.months.longhand.indexOf(t))},G:(e,t)=>{e.setHours(parseFloat(t))},H:(e,t)=>{e.setHours(parseFloat(t))},J:(e,t)=>{e.setDate(parseFloat(t))},K:(e,t,n)=>{e.setHours(e.getHours()%12+12*_t(new RegExp(n.amPM[1],"i").test(t)))},M:function(e,t,n){e.setMonth(n.months.shorthand.indexOf(t))},S:(e,t)=>{e.setSeconds(parseFloat(t))},U:(e,t)=>new Date(1e3*parseFloat(t)),W:function(e,t,n){const r=parseInt(t),i=new Date(e.getFullYear(),0,2+7*(r-1),0,0,0,0);return i.setDate(i.getDate()-i.getDay()+n.firstDayOfWeek),i},Y:(e,t)=>{e.setFullYear(parseFloat(t))},Z:(e,t)=>new Date(t),d:(e,t)=>{e.setDate(parseFloat(t))},h:(e,t)=>{e.setHours(parseFloat(t))},i:(e,t)=>{e.setMinutes(parseFloat(t))},j:(e,t)=>{e.setDate(parseFloat(t))},l:Pt,m:(e,t)=>{e.setMonth(parseFloat(t)-1)},n:(e,t)=>{e.setMonth(parseFloat(t)-1)},s:(e,t)=>{e.setSeconds(parseFloat(t))},u:(e,t)=>new Date(parseFloat(t)),w:Pt,y:(e,t)=>{e.setFullYear(2e3+parseFloat(t))}},At={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},jt={Z:e=>e.toISOString(),D:function(e,t,n){return t.weekdays.shorthand[jt.w(e,t,n)]},F:function(e,t,n){return Nt(jt.n(e,t,n)-1,!1,t)},G:function(e,t,n){return wt(jt.h(e,t,n))},H:e=>wt(e.getHours()),J:function(e,t){return void 0!==t.ordinal?e.getDate()+t.ordinal(e.getDate()):e.getDate()},K:(e,t)=>t.amPM[_t(e.getHours()>11)],M:function(e,t){return Nt(e.getMonth(),!0,t)},S:e=>wt(e.getSeconds()),U:e=>e.getTime()/1e3,W:function(e,t,n){return n.getWeek(e)},Y:e=>wt(e.getFullYear(),4),d:e=>wt(e.getDate()),h:e=>e.getHours()%12?e.getHours()%12:12,i:e=>wt(e.getMinutes()),j:e=>e.getDate(),l:function(e,t){return t.weekdays.longhand[e.getDay()]},m:e=>wt(e.getMonth()+1),n:e=>e.getMonth()+1,s:e=>e.getSeconds(),u:e=>e.getTime(),w:e=>e.getDay(),y:e=>String(e.getFullYear()).substring(2)},It=({config:e=gt,l10n:t=bt,isMobile:n=!1})=>(r,i,o)=>{const a=o||t;return void 0===e.formatDate||n?i.split("").map(((t,n,i)=>jt[t]&&"\\"!==i[n-1]?jt[t](r,a,e):"\\"!==t?t:"")).join(""):e.formatDate(r,i,a)},Dt=({config:e=gt,l10n:t=bt})=>(n,r,i,o)=>{if(0!==n&&!n)return;const a=o||t;let s;const c=n;if(n instanceof Date)s=new Date(n.getTime());else if("string"!=typeof n&&void 0!==n.toFixed)s=new Date(n);else if("string"==typeof n){const t=r||(e||gt).dateFormat,o=String(n).trim();if("today"===o)s=new Date,i=!0;else if(/Z$/.test(o)||/GMT$/.test(o))s=new Date(n);else if(e&&e.parseDate)s=e.parseDate(n,t);else{s=e&&e.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0);let r,i=[];for(let e=0,o=0,c="";e<t.length;e++){const u=t[e],l="\\"===u,f="\\"===t[e-1]||l;if(At[u]&&!f){c+=At[u];const e=new RegExp(c).exec(n);e&&(r=!0)&&i["Y"!==u?"push":"unshift"]({fn:Mt[u],val:e[++o]})}else l||(c+=".");i.forEach((({fn:e,val:t})=>s=e(s,t,a)||s))}s=r?s:void 0}}if(s instanceof Date&&!isNaN(s.getTime()))return!0===i&&s.setHours(0,0,0,0),s;e.errorHandler(new Error(`Invalid date provided: ${c}`))};function Lt(e,t,n=!0){return!1!==n?new Date(e.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):e.getTime()-t.getTime()}const Bt=864e5;function Ft(e){let t=e.defaultHour,n=e.defaultMinute,r=e.defaultSeconds;if(void 0!==e.minDate){const i=e.minDate.getHours(),o=e.minDate.getMinutes(),a=e.minDate.getSeconds();t<i&&(t=i),t===i&&n<o&&(n=o),t===i&&n===o&&r<a&&(r=e.minDate.getSeconds())}if(void 0!==e.maxDate){const i=e.maxDate.getHours(),o=e.maxDate.getMinutes();t=Math.min(t,i),t===i&&(n=Math.min(o,n)),t===i&&n===o&&(r=e.maxDate.getSeconds())}return{hours:t,minutes:n,seconds:r}}n(566);function qt(e,t){const n={config:Object.assign(Object.assign({},gt),Ut.defaultConfig),l10n:vt};function r(e){return e.bind(n)}function i(){const e=n.config;!1===e.weekNumbers&&1===e.showMonths||!0!==e.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==n.calendarContainer&&(n.calendarContainer.style.visibility="hidden",n.calendarContainer.style.display="block"),void 0!==n.daysContainer){const t=(n.days.offsetWidth+1)*e.showMonths;n.daysContainer.style.width=t+"px",n.calendarContainer.style.width=t+(void 0!==n.weekWrapper?n.weekWrapper.offsetWidth:0)+"px",n.calendarContainer.style.removeProperty("visibility"),n.calendarContainer.style.removeProperty("display")}}))}function o(e){if(0===n.selectedDates.length){const e=void 0===n.config.minDate||Lt(new Date,n.config.minDate)>=0?new Date:new Date(n.config.minDate.getTime()),t=Ft(n.config);e.setHours(t.hours,t.minutes,t.seconds,e.getMilliseconds()),n.selectedDates=[e],n.latestSelectedDateObj=e}void 0!==e&&"blur"!==e.type&&function(e){e.preventDefault();const t="keydown"===e.type,r=Rt(e),i=r;void 0!==n.amPM&&r===n.amPM&&(n.amPM.textContent=n.l10n.amPM[_t(n.amPM.textContent===n.l10n.amPM[0])]);const o=parseFloat(i.getAttribute("min")),a=parseFloat(i.getAttribute("max")),s=parseFloat(i.getAttribute("step")),c=parseInt(i.value,10),u=e.delta||(t?38===e.which?1:-1:0);let l=c+s*u;if(void 0!==i.value&&2===i.value.length){const e=i===n.hourElement,t=i===n.minuteElement;l<o?(l=a+l+_t(!e)+(_t(e)&&_t(!n.amPM)),t&&p(void 0,-1,n.hourElement)):l>a&&(l=i===n.hourElement?l-a-_t(!n.amPM):o,t&&p(void 0,1,n.hourElement)),n.amPM&&e&&(1===s?l+c===23:Math.abs(l-c)>s)&&(n.amPM.textContent=n.l10n.amPM[_t(n.amPM.textContent===n.l10n.amPM[0])]),i.value=wt(l)}}(e);const t=n._input.value;a(),$(),n._input.value!==t&&n._debouncedChange()}function a(){if(void 0===n.hourElement||void 0===n.minuteElement)return;let e=(parseInt(n.hourElement.value.slice(-2),10)||0)%24,t=(parseInt(n.minuteElement.value,10)||0)%60,r=void 0!==n.secondElement?(parseInt(n.secondElement.value,10)||0)%60:0;var i,o;void 0!==n.amPM&&(i=e,o=n.amPM.textContent,e=i%12+12*_t(o===n.l10n.amPM[1]));const a=void 0!==n.config.minTime||n.config.minDate&&n.minDateHasTime&&n.latestSelectedDateObj&&0===Lt(n.latestSelectedDateObj,n.config.minDate,!0);if(void 0!==n.config.maxTime||n.config.maxDate&&n.maxDateHasTime&&n.latestSelectedDateObj&&0===Lt(n.latestSelectedDateObj,n.config.maxDate,!0)){const i=void 0!==n.config.maxTime?n.config.maxTime:n.config.maxDate;e=Math.min(e,i.getHours()),e===i.getHours()&&(t=Math.min(t,i.getMinutes())),t===i.getMinutes()&&(r=Math.min(r,i.getSeconds()))}if(a){const i=void 0!==n.config.minTime?n.config.minTime:n.config.minDate;e=Math.max(e,i.getHours()),e===i.getHours()&&t<i.getMinutes()&&(t=i.getMinutes()),t===i.getMinutes()&&(r=Math.max(r,i.getSeconds()))}c(e,t,r)}function s(e){const t=e||n.latestSelectedDateObj;t&&c(t.getHours(),t.getMinutes(),t.getSeconds())}function c(e,t,r){void 0!==n.latestSelectedDateObj&&n.latestSelectedDateObj.setHours(e%24,t,r||0,0),n.hourElement&&n.minuteElement&&!n.isMobile&&(n.hourElement.value=wt(n.config.time_24hr?e:(12+e)%12+12*_t(e%12==0)),n.minuteElement.value=wt(t),void 0!==n.amPM&&(n.amPM.textContent=n.l10n.amPM[_t(e>=12)]),void 0!==n.secondElement&&(n.secondElement.value=wt(r)))}function u(e){const t=Rt(e),n=parseInt(t.value)+(e.delta||0);(n/1e3>1||"Enter"===e.key&&!/[^\d]/.test(n.toString()))&&R(n)}function l(e,t,r,i){return t instanceof Array?t.forEach((t=>l(e,t,r,i))):e instanceof Array?e.forEach((e=>l(e,t,r,i))):(e.addEventListener(t,r,i),void n._handlers.push({remove:()=>e.removeEventListener(t,r)}))}function f(){Y("onChange")}function h(e,t){const r=void 0!==e?n.parseDate(e):n.latestSelectedDateObj||(n.config.minDate&&n.config.minDate>n.now?n.config.minDate:n.config.maxDate&&n.config.maxDate<n.now?n.config.maxDate:n.now),i=n.currentYear,o=n.currentMonth;try{void 0!==r&&(n.currentYear=r.getFullYear(),n.currentMonth=r.getMonth())}catch(e){e.message="Invalid date supplied: "+r,n.config.errorHandler(e)}t&&n.currentYear!==i&&(Y("onYearChange"),_()),!t||n.currentYear===i&&n.currentMonth===o||Y("onMonthChange"),n.redraw()}function d(e){const t=Rt(e);~t.className.indexOf("arrow")&&p(e,t.classList.contains("arrowUp")?1:-1)}function p(e,t,n){const r=e&&Rt(e),i=n||r&&r.parentNode&&r.parentNode.firstChild,o=Q("increment");o.delta=t,i&&i.dispatchEvent(o)}function m(e,t,r,i){const o=P(t,!0),a=Tt("span","flatpickr-day "+e,t.getDate().toString());return a.dateObj=t,a.$i=i,a.setAttribute("aria-label",n.formatDate(t,n.config.ariaDateFormat)),-1===e.indexOf("hidden")&&0===Lt(t,n.now)&&(n.todayDateElem=a,a.classList.add("today"),a.setAttribute("aria-current","date")),o?(a.tabIndex=-1,G(t)&&(a.classList.add("selected"),n.selectedDateElem=a,"range"===n.config.mode&&(Ot(a,"startRange",n.selectedDates[0]&&0===Lt(t,n.selectedDates[0],!0)),Ot(a,"endRange",n.selectedDates[1]&&0===Lt(t,n.selectedDates[1],!0)),"nextMonthDay"===e&&a.classList.add("inRange")))):a.classList.add("flatpickr-disabled"),"range"===n.config.mode&&function(e){return!("range"!==n.config.mode||n.selectedDates.length<2)&&(Lt(e,n.selectedDates[0])>=0&&Lt(e,n.selectedDates[1])<=0)}(t)&&!G(t)&&a.classList.add("inRange"),n.weekNumbers&&1===n.config.showMonths&&"prevMonthDay"!==e&&r%7==1&&n.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+n.config.getWeek(t)+"</span>"),Y("onDayCreate",a),a}function y(e){e.focus(),"range"===n.config.mode&&j(e)}function g(e){const t=e>0?0:n.config.showMonths-1,r=e>0?n.config.showMonths:-1;for(let i=t;i!=r;i+=e){const t=n.daysContainer.children[i],r=e>0?0:t.children.length-1,o=e>0?t.children.length:-1;for(let n=r;n!=o;n+=e){const e=t.children[n];if(-1===e.className.indexOf("hidden")&&P(e.dateObj))return e}}}function b(e,t){const r=N(document.activeElement||document.body),i=void 0!==e?e:r?document.activeElement:void 0!==n.selectedDateElem&&N(n.selectedDateElem)?n.selectedDateElem:void 0!==n.todayDateElem&&N(n.todayDateElem)?n.todayDateElem:g(t>0?1:-1);void 0===i?n._input.focus():r?function(e,t){const r=-1===e.className.indexOf("Month")?e.dateObj.getMonth():n.currentMonth,i=t>0?n.config.showMonths:-1,o=t>0?1:-1;for(let a=r-n.currentMonth;a!=i;a+=o){const i=n.daysContainer.children[a],s=r-n.currentMonth===a?e.$i+t:t<0?i.children.length-1:0,c=i.children.length;for(let n=s;n>=0&&n<c&&n!=(t>0?c:-1);n+=o){const r=i.children[n];if(-1===r.className.indexOf("hidden")&&P(r.dateObj)&&Math.abs(e.$i-n)>=Math.abs(t))return y(r)}}n.changeMonth(o),b(g(o),0)}(i,t):y(i)}function v(e,t){const r=(new Date(e,t,1).getDay()-n.l10n.firstDayOfWeek+7)%7,i=n.utils.getDaysInMonth((t-1+12)%12,e),o=n.utils.getDaysInMonth(t,e),a=window.document.createDocumentFragment(),s=n.config.showMonths>1,c=s?"prevMonthDay hidden":"prevMonthDay",u=s?"nextMonthDay hidden":"nextMonthDay";let l=i+1-r,f=0;for(;l<=i;l++,f++)a.appendChild(m(c,new Date(e,t-1,l),l,f));for(l=1;l<=o;l++,f++)a.appendChild(m("",new Date(e,t,l),l,f));for(let i=o+1;i<=42-r&&(1===n.config.showMonths||f%7!=0);i++,f++)a.appendChild(m(u,new Date(e,t+1,i%o),i,f));const h=Tt("div","dayContainer");return h.appendChild(a),h}function w(){if(void 0===n.daysContainer)return;xt(n.daysContainer),n.weekNumbers&&xt(n.weekNumbers);const e=document.createDocumentFragment();for(let t=0;t<n.config.showMonths;t++){const r=new Date(n.currentYear,n.currentMonth,1);r.setMonth(n.currentMonth+t),e.appendChild(v(r.getFullYear(),r.getMonth()))}n.daysContainer.appendChild(e),n.days=n.daysContainer.firstChild,"range"===n.config.mode&&1===n.selectedDates.length&&j()}function _(){if(n.config.showMonths>1||"dropdown"!==n.config.monthSelectorType)return;const e=function(e){return!(void 0!==n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&e<n.config.minDate.getMonth())&&!(void 0!==n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()&&e>n.config.maxDate.getMonth())};n.monthsDropdownContainer.tabIndex=-1,n.monthsDropdownContainer.innerHTML="";for(let t=0;t<12;t++){if(!e(t))continue;const r=Tt("option","flatpickr-monthDropdown-month");r.value=new Date(n.currentYear,t).getMonth().toString(),r.textContent=Nt(t,n.config.shorthandCurrentMonth,n.l10n),r.tabIndex=-1,n.currentMonth===t&&(r.selected=!0),n.monthsDropdownContainer.appendChild(r)}}function k(){const e=Tt("div","flatpickr-month"),t=window.document.createDocumentFragment();let r;n.config.showMonths>1||"static"===n.config.monthSelectorType?r=Tt("span","cur-month"):(n.monthsDropdownContainer=Tt("select","flatpickr-monthDropdown-months"),n.monthsDropdownContainer.setAttribute("aria-label",n.l10n.monthAriaLabel),l(n.monthsDropdownContainer,"change",(e=>{const t=Rt(e),r=parseInt(t.value,10);n.changeMonth(r-n.currentMonth),Y("onMonthChange")})),_(),r=n.monthsDropdownContainer);const i=Ct("cur-year",{tabindex:"-1"}),o=i.getElementsByTagName("input")[0];o.setAttribute("aria-label",n.l10n.yearAriaLabel),n.config.minDate&&o.setAttribute("min",n.config.minDate.getFullYear().toString()),n.config.maxDate&&(o.setAttribute("max",n.config.maxDate.getFullYear().toString()),o.disabled=!!n.config.minDate&&n.config.minDate.getFullYear()===n.config.maxDate.getFullYear());const a=Tt("div","flatpickr-current-month");return a.appendChild(r),a.appendChild(i),t.appendChild(a),e.appendChild(t),{container:e,yearElement:o,monthElement:r}}function E(){xt(n.monthNav),n.monthNav.appendChild(n.prevMonthNav),n.config.showMonths&&(n.yearElements=[],n.monthElements=[]);for(let e=n.config.showMonths;e--;){const e=k();n.yearElements.push(e.yearElement),n.monthElements.push(e.monthElement),n.monthNav.appendChild(e.container)}n.monthNav.appendChild(n.nextMonthNav)}function O(){n.weekdayContainer?xt(n.weekdayContainer):n.weekdayContainer=Tt("div","flatpickr-weekdays");for(let e=n.config.showMonths;e--;){const e=Tt("div","flatpickr-weekdaycontainer");n.weekdayContainer.appendChild(e)}return T(),n.weekdayContainer}function T(){if(!n.weekdayContainer)return;const e=n.l10n.firstDayOfWeek;let t=[...n.l10n.weekdays.shorthand];e>0&&e<t.length&&(t=[...t.splice(e,t.length),...t.splice(0,e)]);for(let e=n.config.showMonths;e--;)n.weekdayContainer.children[e].innerHTML=`\n      <span class='flatpickr-weekday'>\n        ${t.join("</span><span class='flatpickr-weekday'>")}\n      </span>\n      `}function x(e,t=!0){const r=t?e:e-n.currentMonth;r<0&&!0===n._hidePrevMonthArrow||r>0&&!0===n._hideNextMonthArrow||(n.currentMonth+=r,(n.currentMonth<0||n.currentMonth>11)&&(n.currentYear+=n.currentMonth>11?1:-1,n.currentMonth=(n.currentMonth+12)%12,Y("onYearChange"),_()),w(),Y("onMonthChange"),J())}function S(e){return!(!n.config.appendTo||!n.config.appendTo.contains(e))||n.calendarContainer.contains(e)}function C(e){if(n.isOpen&&!n.config.inline){const t=Rt(e),r=S(t),i=t===n.input||t===n.altInput||n.element.contains(t)||e.path&&e.path.indexOf&&(~e.path.indexOf(n.input)||~e.path.indexOf(n.altInput)),a="blur"===e.type?i&&e.relatedTarget&&!S(e.relatedTarget):!i&&!r&&!S(e.relatedTarget),s=!n.config.ignoredFocusElements.some((e=>e.contains(t)));a&&s&&(void 0!==n.timeContainer&&void 0!==n.minuteElement&&void 0!==n.hourElement&&""!==n.input.value&&void 0!==n.input.value&&o(),n.close(),n.config&&"range"===n.config.mode&&1===n.selectedDates.length&&(n.clear(!1),n.redraw()))}}function R(e){if(!e||n.config.minDate&&e<n.config.minDate.getFullYear()||n.config.maxDate&&e>n.config.maxDate.getFullYear())return;const t=e,r=n.currentYear!==t;n.currentYear=t||n.currentYear,n.config.maxDate&&n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth=Math.min(n.config.maxDate.getMonth(),n.currentMonth):n.config.minDate&&n.currentYear===n.config.minDate.getFullYear()&&(n.currentMonth=Math.max(n.config.minDate.getMonth(),n.currentMonth)),r&&(n.redraw(),Y("onYearChange"),_())}function P(e,t=!0){var r;const i=n.parseDate(e,void 0,t);if(n.config.minDate&&i&&Lt(i,n.config.minDate,void 0!==t?t:!n.minDateHasTime)<0||n.config.maxDate&&i&&Lt(i,n.config.maxDate,void 0!==t?t:!n.maxDateHasTime)>0)return!1;if(!n.config.enable&&0===n.config.disable.length)return!0;if(void 0===i)return!1;const o=!!n.config.enable,a=null!==(r=n.config.enable)&&void 0!==r?r:n.config.disable;for(let e,t=0;t<a.length;t++){if(e=a[t],"function"==typeof e&&e(i))return o;if(e instanceof Date&&void 0!==i&&e.getTime()===i.getTime())return o;if("string"==typeof e){const t=n.parseDate(e,void 0,!0);return t&&t.getTime()===i.getTime()?o:!o}if("object"==typeof e&&void 0!==i&&e.from&&e.to&&i.getTime()>=e.from.getTime()&&i.getTime()<=e.to.getTime())return o}return!o}function N(e){return void 0!==n.daysContainer&&(-1===e.className.indexOf("hidden")&&-1===e.className.indexOf("flatpickr-disabled")&&n.daysContainer.contains(e))}function M(e){!(e.target===n._input)||!(n.selectedDates.length>0||n._input.value.length>0)||e.relatedTarget&&S(e.relatedTarget)||n.setDate(n._input.value,!0,e.target===n.altInput?n.config.altFormat:n.config.dateFormat)}function A(t){const r=Rt(t),i=n.config.wrap?e.contains(r):r===n._input,s=n.config.allowInput,c=n.isOpen&&(!s||!i),u=n.config.inline&&i&&!s;if(13===t.keyCode&&i){if(s)return n.setDate(n._input.value,!0,r===n.altInput?n.config.altFormat:n.config.dateFormat),r.blur();n.open()}else if(S(r)||c||u){const e=!!n.timeContainer&&n.timeContainer.contains(r);switch(t.keyCode){case 13:e?(t.preventDefault(),o(),V()):U(t);break;case 27:t.preventDefault(),V();break;case 8:case 46:i&&!n.config.allowInput&&(t.preventDefault(),n.clear());break;case 37:case 39:if(e||i)n.hourElement&&n.hourElement.focus();else if(t.preventDefault(),void 0!==n.daysContainer&&(!1===s||document.activeElement&&N(document.activeElement))){const e=39===t.keyCode?1:-1;t.ctrlKey?(t.stopPropagation(),x(e),b(g(1),0)):b(void 0,e)}break;case 38:case 40:t.preventDefault();const a=40===t.keyCode?1:-1;n.daysContainer&&void 0!==r.$i||r===n.input||r===n.altInput?t.ctrlKey?(t.stopPropagation(),R(n.currentYear-a),b(g(1),0)):e||b(void 0,7*a):r===n.currentYearElement?R(n.currentYear-a):n.config.enableTime&&(!e&&n.hourElement&&n.hourElement.focus(),o(t),n._debouncedChange());break;case 9:if(e){const e=[n.hourElement,n.minuteElement,n.secondElement,n.amPM].concat(n.pluginElements).filter((e=>e)),i=e.indexOf(r);if(-1!==i){const r=e[i+(t.shiftKey?-1:1)];t.preventDefault(),(r||n._input).focus()}}else!n.config.noCalendar&&n.daysContainer&&n.daysContainer.contains(r)&&t.shiftKey&&(t.preventDefault(),n._input.focus())}}if(void 0!==n.amPM&&r===n.amPM)switch(t.key){case n.l10n.amPM[0].charAt(0):case n.l10n.amPM[0].charAt(0).toLowerCase():n.amPM.textContent=n.l10n.amPM[0],a(),$();break;case n.l10n.amPM[1].charAt(0):case n.l10n.amPM[1].charAt(0).toLowerCase():n.amPM.textContent=n.l10n.amPM[1],a(),$()}(i||S(r))&&Y("onKeyDown",t)}function j(e){if(1!==n.selectedDates.length||e&&(!e.classList.contains("flatpickr-day")||e.classList.contains("flatpickr-disabled")))return;const t=e?e.dateObj.getTime():n.days.firstElementChild.dateObj.getTime(),r=n.parseDate(n.selectedDates[0],void 0,!0).getTime(),i=Math.min(t,n.selectedDates[0].getTime()),o=Math.max(t,n.selectedDates[0].getTime());let a=!1,s=0,c=0;for(let e=i;e<o;e+=Bt)P(new Date(e),!0)||(a=a||e>i&&e<o,e<r&&(!s||e>s)?s=e:e>r&&(!c||e<c)&&(c=e));for(let i=0;i<n.config.showMonths;i++){const o=n.daysContainer.children[i];for(let i=0,h=o.children.length;i<h;i++){const h=o.children[i],d=h.dateObj.getTime(),p=s>0&&d<s||c>0&&d>c;p?(h.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach((e=>{h.classList.remove(e)}))):a&&!p||(["startRange","inRange","endRange","notAllowed"].forEach((e=>{h.classList.remove(e)})),void 0!==e&&(e.classList.add(t<=n.selectedDates[0].getTime()?"startRange":"endRange"),r<t&&d===r?h.classList.add("startRange"):r>t&&d===r&&h.classList.add("endRange"),d>=s&&(0===c||d<=c)&&(l=r,f=t,(u=d)>Math.min(l,f)&&u<Math.max(l,f))&&h.classList.add("inRange")))}}var u,l,f}function I(){!n.isOpen||n.config.static||n.config.inline||F()}function D(e){return t=>{const r=n.config[`_${e}Date`]=n.parseDate(t,n.config.dateFormat),i=n.config[`_${"min"===e?"max":"min"}Date`];void 0!==r&&(n["min"===e?"minDateHasTime":"maxDateHasTime"]=r.getHours()>0||r.getMinutes()>0||r.getSeconds()>0),n.selectedDates&&(n.selectedDates=n.selectedDates.filter((e=>P(e))),n.selectedDates.length||"min"!==e||s(r),$()),n.daysContainer&&(q(),void 0!==r?n.currentYearElement[e]=r.getFullYear().toString():n.currentYearElement.removeAttribute(e),n.currentYearElement.disabled=!!i&&void 0!==r&&i.getFullYear()===r.getFullYear())}}function L(){return n.config.wrap?e.querySelector("[data-input]"):e}function B(){"object"!=typeof n.config.locale&&void 0===Ut.l10ns[n.config.locale]&&n.config.errorHandler(new Error(`flatpickr: invalid locale ${n.config.locale}`)),n.l10n=Object.assign(Object.assign({},Ut.l10ns.default),"object"==typeof n.config.locale?n.config.locale:"default"!==n.config.locale?Ut.l10ns[n.config.locale]:void 0),At.K=`(${n.l10n.amPM[0]}|${n.l10n.amPM[1]}|${n.l10n.amPM[0].toLowerCase()}|${n.l10n.amPM[1].toLowerCase()})`;void 0===Object.assign(Object.assign({},t),JSON.parse(JSON.stringify(e.dataset||{}))).time_24hr&&void 0===Ut.defaultConfig.time_24hr&&(n.config.time_24hr=n.l10n.time_24hr),n.formatDate=It(n),n.parseDate=Dt({config:n.config,l10n:n.l10n})}function F(e){if("function"==typeof n.config.position)return void n.config.position(n,e);if(void 0===n.calendarContainer)return;Y("onPreCalendarPosition");const t=e||n._positionElement,r=Array.prototype.reduce.call(n.calendarContainer.children,((e,t)=>e+t.offsetHeight),0),i=n.calendarContainer.offsetWidth,o=n.config.position.split(" "),a=o[0],s=o.length>1?o[1]:null,c=t.getBoundingClientRect(),u=window.innerHeight-c.bottom,l="above"===a||"below"!==a&&u<r&&c.top>r,f=window.pageYOffset+c.top+(l?-r-2:t.offsetHeight+2);if(Ot(n.calendarContainer,"arrowTop",!l),Ot(n.calendarContainer,"arrowBottom",l),n.config.inline)return;let h=window.pageXOffset+c.left,d=!1,p=!1;"center"===s?(h-=(i-c.width)/2,d=!0):"right"===s&&(h-=i-c.width,p=!0),Ot(n.calendarContainer,"arrowLeft",!d&&!p),Ot(n.calendarContainer,"arrowCenter",d),Ot(n.calendarContainer,"arrowRight",p);const m=window.document.body.offsetWidth-(window.pageXOffset+c.right),y=h+i>window.document.body.offsetWidth,g=m+i>window.document.body.offsetWidth;if(Ot(n.calendarContainer,"rightMost",y),!n.config.static)if(n.calendarContainer.style.top=`${f}px`,y)if(g){const e=function(){let e=null;for(let t=0;t<document.styleSheets.length;t++){const n=document.styleSheets[t];try{n.cssRules}catch(e){continue}e=n;break}return null!=e?e:function(){const e=document.createElement("style");return document.head.appendChild(e),e.sheet}()}();if(void 0===e)return;const t=window.document.body.offsetWidth,r=Math.max(0,t/2-i/2),o=".flatpickr-calendar.centerMost:before",a=".flatpickr-calendar.centerMost:after",s=e.cssRules.length,u=`{left:${c.left}px;right:auto;}`;Ot(n.calendarContainer,"rightMost",!1),Ot(n.calendarContainer,"centerMost",!0),e.insertRule(`${o},${a}${u}`,s),n.calendarContainer.style.left=`${r}px`,n.calendarContainer.style.right="auto"}else n.calendarContainer.style.left="auto",n.calendarContainer.style.right=`${m}px`;else n.calendarContainer.style.left=`${h}px`,n.calendarContainer.style.right="auto"}function q(){n.config.noCalendar||n.isMobile||(_(),J(),w())}function V(){n._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(n.close,0):n.close()}function U(e){e.preventDefault(),e.stopPropagation();const t=St(Rt(e),(e=>e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")));if(void 0===t)return;const r=t,i=n.latestSelectedDateObj=new Date(r.dateObj.getTime()),o=(i.getMonth()<n.currentMonth||i.getMonth()>n.currentMonth+n.config.showMonths-1)&&"range"!==n.config.mode;if(n.selectedDateElem=r,"single"===n.config.mode)n.selectedDates=[i];else if("multiple"===n.config.mode){const e=G(i);e?n.selectedDates.splice(parseInt(e),1):n.selectedDates.push(i)}else"range"===n.config.mode&&(2===n.selectedDates.length&&n.clear(!1,!1),n.latestSelectedDateObj=i,n.selectedDates.push(i),0!==Lt(i,n.selectedDates[0],!0)&&n.selectedDates.sort(((e,t)=>e.getTime()-t.getTime())));if(a(),o){const e=n.currentYear!==i.getFullYear();n.currentYear=i.getFullYear(),n.currentMonth=i.getMonth(),e&&(Y("onYearChange"),_()),Y("onMonthChange")}if(J(),w(),$(),o||"range"===n.config.mode||1!==n.config.showMonths?void 0!==n.selectedDateElem&&void 0===n.hourElement&&n.selectedDateElem&&n.selectedDateElem.focus():y(r),void 0!==n.hourElement&&void 0!==n.hourElement&&n.hourElement.focus(),n.config.closeOnSelect){const e="single"===n.config.mode&&!n.config.enableTime,t="range"===n.config.mode&&2===n.selectedDates.length&&!n.config.enableTime;(e||t)&&V()}f()}n.parseDate=Dt({config:n.config,l10n:n.l10n}),n._handlers=[],n.pluginElements=[],n.loadedPlugins=[],n._bind=l,n._setHoursFromDate=s,n._positionCalendar=F,n.changeMonth=x,n.changeYear=R,n.clear=function(e=!0,t=!0){n.input.value="",void 0!==n.altInput&&(n.altInput.value="");void 0!==n.mobileInput&&(n.mobileInput.value="");n.selectedDates=[],n.latestSelectedDateObj=void 0,!0===t&&(n.currentYear=n._initialDate.getFullYear(),n.currentMonth=n._initialDate.getMonth());if(!0===n.config.enableTime){const{hours:e,minutes:t,seconds:r}=Ft(n.config);c(e,t,r)}n.redraw(),e&&Y("onChange")},n.close=function(){n.isOpen=!1,n.isMobile||(void 0!==n.calendarContainer&&n.calendarContainer.classList.remove("open"),void 0!==n._input&&n._input.classList.remove("active"));Y("onClose")},n._createElement=Tt,n.destroy=function(){void 0!==n.config&&Y("onDestroy");for(let e=n._handlers.length;e--;)n._handlers[e].remove();if(n._handlers=[],n.mobileInput)n.mobileInput.parentNode&&n.mobileInput.parentNode.removeChild(n.mobileInput),n.mobileInput=void 0;else if(n.calendarContainer&&n.calendarContainer.parentNode)if(n.config.static&&n.calendarContainer.parentNode){const e=n.calendarContainer.parentNode;if(e.lastChild&&e.removeChild(e.lastChild),e.parentNode){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)}}else n.calendarContainer.parentNode.removeChild(n.calendarContainer);n.altInput&&(n.input.type="text",n.altInput.parentNode&&n.altInput.parentNode.removeChild(n.altInput),delete n.altInput);n.input&&(n.input.type=n.input._type,n.input.classList.remove("flatpickr-input"),n.input.removeAttribute("readonly"));["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((e=>{try{delete n[e]}catch(e){}}))},n.isEnabled=P,n.jumpToDate=h,n.open=function(e,t=n._positionElement){if(!0===n.isMobile){if(e){e.preventDefault();const t=Rt(e);t&&t.blur()}return void 0!==n.mobileInput&&(n.mobileInput.focus(),n.mobileInput.click()),void Y("onOpen")}if(n._input.disabled||n.config.inline)return;const r=n.isOpen;n.isOpen=!0,r||(n.calendarContainer.classList.add("open"),n._input.classList.add("active"),Y("onOpen"),F(t));!0===n.config.enableTime&&!0===n.config.noCalendar&&(!1!==n.config.allowInput||void 0!==e&&n.timeContainer.contains(e.relatedTarget)||setTimeout((()=>n.hourElement.select()),50))},n.redraw=q,n.set=function(e,t){if(null!==e&&"object"==typeof e){Object.assign(n.config,e);for(const t in e)void 0!==H[t]&&H[t].forEach((e=>e()))}else n.config[e]=t,void 0!==H[e]?H[e].forEach((e=>e())):yt.indexOf(e)>-1&&(n.config[e]=Et(t));n.redraw(),$(!0)},n.setDate=function(e,t=!1,r=n.config.dateFormat){if(0!==e&&!e||e instanceof Array&&0===e.length)return n.clear(t);z(e,r),n.latestSelectedDateObj=n.selectedDates[n.selectedDates.length-1],n.redraw(),h(void 0,t),s(),0===n.selectedDates.length&&n.clear(!1);$(t),t&&Y("onChange")},n.toggle=function(e){if(!0===n.isOpen)return n.close();n.open(e)};const H={locale:[B,T],showMonths:[E,i,O],minDate:[h],maxDate:[h],clickOpens:[()=>{!0===n.config.clickOpens?(l(n._input,"focus",n.open),l(n._input,"click",n.open)):(n._input.removeEventListener("focus",n.open),n._input.removeEventListener("click",n.open))}]};function z(e,t){let r=[];if(e instanceof Array)r=e.map((e=>n.parseDate(e,t)));else if(e instanceof Date||"number"==typeof e)r=[n.parseDate(e,t)];else if("string"==typeof e)switch(n.config.mode){case"single":case"time":r=[n.parseDate(e,t)];break;case"multiple":r=e.split(n.config.conjunction).map((e=>n.parseDate(e,t)));break;case"range":r=e.split(n.l10n.rangeSeparator).map((e=>n.parseDate(e,t)))}else n.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(e)}`));n.selectedDates=n.config.allowInvalidPreload?r:r.filter((e=>e instanceof Date&&P(e,!1))),"range"===n.config.mode&&n.selectedDates.sort(((e,t)=>e.getTime()-t.getTime()))}function W(e){return e.slice().map((e=>"string"==typeof e||"number"==typeof e||e instanceof Date?n.parseDate(e,void 0,!0):e&&"object"==typeof e&&e.from&&e.to?{from:n.parseDate(e.from,void 0),to:n.parseDate(e.to,void 0)}:e)).filter((e=>e))}function Y(e,t){if(void 0===n.config)return;const r=n.config[e];if(void 0!==r&&r.length>0)for(let e=0;r[e]&&e<r.length;e++)r[e](n.selectedDates,n.input.value,n,t);"onChange"===e&&(n.input.dispatchEvent(Q("change")),n.input.dispatchEvent(Q("input")))}function Q(e){const t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}function G(e){for(let t=0;t<n.selectedDates.length;t++)if(0===Lt(n.selectedDates[t],e))return""+t;return!1}function J(){n.config.noCalendar||n.isMobile||!n.monthNav||(n.yearElements.forEach(((e,t)=>{const r=new Date(n.currentYear,n.currentMonth,1);r.setMonth(n.currentMonth+t),n.config.showMonths>1||"static"===n.config.monthSelectorType?n.monthElements[t].textContent=Nt(r.getMonth(),n.config.shorthandCurrentMonth,n.l10n)+" ":n.monthsDropdownContainer.value=r.getMonth().toString(),e.value=r.getFullYear().toString()})),n._hidePrevMonthArrow=void 0!==n.config.minDate&&(n.currentYear===n.config.minDate.getFullYear()?n.currentMonth<=n.config.minDate.getMonth():n.currentYear<n.config.minDate.getFullYear()),n._hideNextMonthArrow=void 0!==n.config.maxDate&&(n.currentYear===n.config.maxDate.getFullYear()?n.currentMonth+1>n.config.maxDate.getMonth():n.currentYear>n.config.maxDate.getFullYear()))}function K(e){return n.selectedDates.map((t=>n.formatDate(t,e))).filter(((e,t,r)=>"range"!==n.config.mode||n.config.enableTime||r.indexOf(e)===t)).join("range"!==n.config.mode?n.config.conjunction:n.l10n.rangeSeparator)}function $(e=!0){void 0!==n.mobileInput&&n.mobileFormatStr&&(n.mobileInput.value=void 0!==n.latestSelectedDateObj?n.formatDate(n.latestSelectedDateObj,n.mobileFormatStr):""),n.input.value=K(n.config.dateFormat),void 0!==n.altInput&&(n.altInput.value=K(n.config.altFormat)),!1!==e&&Y("onValueUpdate")}function X(e){const t=Rt(e),r=n.prevMonthNav.contains(t),i=n.nextMonthNav.contains(t);r||i?x(r?-1:1):n.yearElements.indexOf(t)>=0?t.select():t.classList.contains("arrowUp")?n.changeYear(n.currentYear+1):t.classList.contains("arrowDown")&&n.changeYear(n.currentYear-1)}return function(){n.element=n.input=e,n.isOpen=!1,function(){const i=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],o=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e.dataset||{}))),t),a={};n.config.parseDate=o.parseDate,n.config.formatDate=o.formatDate,Object.defineProperty(n.config,"enable",{get:()=>n.config._enable,set:e=>{n.config._enable=W(e)}}),Object.defineProperty(n.config,"disable",{get:()=>n.config._disable,set:e=>{n.config._disable=W(e)}});const s="time"===o.mode;if(!o.dateFormat&&(o.enableTime||s)){const e=Ut.defaultConfig.dateFormat||gt.dateFormat;a.dateFormat=o.noCalendar||s?"H:i"+(o.enableSeconds?":S":""):e+" H:i"+(o.enableSeconds?":S":"")}if(o.altInput&&(o.enableTime||s)&&!o.altFormat){const e=Ut.defaultConfig.altFormat||gt.altFormat;a.altFormat=o.noCalendar||s?"h:i"+(o.enableSeconds?":S K":" K"):e+` h:i${o.enableSeconds?":S":""} K`}Object.defineProperty(n.config,"minDate",{get:()=>n.config._minDate,set:D("min")}),Object.defineProperty(n.config,"maxDate",{get:()=>n.config._maxDate,set:D("max")});const c=e=>t=>{n.config["min"===e?"_minTime":"_maxTime"]=n.parseDate(t,"H:i:S")};Object.defineProperty(n.config,"minTime",{get:()=>n.config._minTime,set:c("min")}),Object.defineProperty(n.config,"maxTime",{get:()=>n.config._maxTime,set:c("max")}),"time"===o.mode&&(n.config.noCalendar=!0,n.config.enableTime=!0);Object.assign(n.config,a,o);for(let e=0;e<i.length;e++)n.config[i[e]]=!0===n.config[i[e]]||"true"===n.config[i[e]];yt.filter((e=>void 0!==n.config[e])).forEach((e=>{n.config[e]=Et(n.config[e]||[]).map(r)})),n.isMobile=!n.config.disableMobile&&!n.config.inline&&"single"===n.config.mode&&!n.config.disable.length&&!n.config.enable&&!n.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(let e=0;e<n.config.plugins.length;e++){const t=n.config.plugins[e](n)||{};for(const e in t)yt.indexOf(e)>-1?n.config[e]=Et(t[e]).map(r).concat(n.config[e]):void 0===o[e]&&(n.config[e]=t[e])}o.altInputClass||(n.config.altInputClass=L().className+" "+n.config.altInputClass);Y("onParseConfig")}(),B(),function(){if(n.input=L(),!n.input)return void n.config.errorHandler(new Error("Invalid input element specified"));n.input._type=n.input.type,n.input.type="text",n.input.classList.add("flatpickr-input"),n._input=n.input,n.config.altInput&&(n.altInput=Tt(n.input.nodeName,n.config.altInputClass),n._input=n.altInput,n.altInput.placeholder=n.input.placeholder,n.altInput.disabled=n.input.disabled,n.altInput.required=n.input.required,n.altInput.tabIndex=n.input.tabIndex,n.altInput.type="text",n.input.setAttribute("type","hidden"),!n.config.static&&n.input.parentNode&&n.input.parentNode.insertBefore(n.altInput,n.input.nextSibling));n.config.allowInput||n._input.setAttribute("readonly","readonly");n._positionElement=n.config.positionElement||n._input}(),function(){n.selectedDates=[],n.now=n.parseDate(n.config.now)||new Date;const e=n.config.defaultDate||("INPUT"!==n.input.nodeName&&"TEXTAREA"!==n.input.nodeName||!n.input.placeholder||n.input.value!==n.input.placeholder?n.input.value:null);e&&z(e,n.config.dateFormat);n._initialDate=n.selectedDates.length>0?n.selectedDates[0]:n.config.minDate&&n.config.minDate.getTime()>n.now.getTime()?n.config.minDate:n.config.maxDate&&n.config.maxDate.getTime()<n.now.getTime()?n.config.maxDate:n.now,n.currentYear=n._initialDate.getFullYear(),n.currentMonth=n._initialDate.getMonth(),n.selectedDates.length>0&&(n.latestSelectedDateObj=n.selectedDates[0]);void 0!==n.config.minTime&&(n.config.minTime=n.parseDate(n.config.minTime,"H:i"));void 0!==n.config.maxTime&&(n.config.maxTime=n.parseDate(n.config.maxTime,"H:i"));n.minDateHasTime=!!n.config.minDate&&(n.config.minDate.getHours()>0||n.config.minDate.getMinutes()>0||n.config.minDate.getSeconds()>0),n.maxDateHasTime=!!n.config.maxDate&&(n.config.maxDate.getHours()>0||n.config.maxDate.getMinutes()>0||n.config.maxDate.getSeconds()>0)}(),n.utils={getDaysInMonth:(e=n.currentMonth,t=n.currentYear)=>1===e&&(t%4==0&&t%100!=0||t%400==0)?29:n.l10n.daysInMonth[e]},n.isMobile||function(){const e=window.document.createDocumentFragment();if(n.calendarContainer=Tt("div","flatpickr-calendar"),n.calendarContainer.tabIndex=-1,!n.config.noCalendar){if(e.appendChild((n.monthNav=Tt("div","flatpickr-months"),n.yearElements=[],n.monthElements=[],n.prevMonthNav=Tt("span","flatpickr-prev-month"),n.prevMonthNav.innerHTML=n.config.prevArrow,n.nextMonthNav=Tt("span","flatpickr-next-month"),n.nextMonthNav.innerHTML=n.config.nextArrow,E(),Object.defineProperty(n,"_hidePrevMonthArrow",{get:()=>n.__hidePrevMonthArrow,set(e){n.__hidePrevMonthArrow!==e&&(Ot(n.prevMonthNav,"flatpickr-disabled",e),n.__hidePrevMonthArrow=e)}}),Object.defineProperty(n,"_hideNextMonthArrow",{get:()=>n.__hideNextMonthArrow,set(e){n.__hideNextMonthArrow!==e&&(Ot(n.nextMonthNav,"flatpickr-disabled",e),n.__hideNextMonthArrow=e)}}),n.currentYearElement=n.yearElements[0],J(),n.monthNav)),n.innerContainer=Tt("div","flatpickr-innerContainer"),n.config.weekNumbers){const{weekWrapper:e,weekNumbers:t}=function(){n.calendarContainer.classList.add("hasWeeks");const e=Tt("div","flatpickr-weekwrapper");e.appendChild(Tt("span","flatpickr-weekday",n.l10n.weekAbbreviation));const t=Tt("div","flatpickr-weeks");return e.appendChild(t),{weekWrapper:e,weekNumbers:t}}();n.innerContainer.appendChild(e),n.weekNumbers=t,n.weekWrapper=e}n.rContainer=Tt("div","flatpickr-rContainer"),n.rContainer.appendChild(O()),n.daysContainer||(n.daysContainer=Tt("div","flatpickr-days"),n.daysContainer.tabIndex=-1),w(),n.rContainer.appendChild(n.daysContainer),n.innerContainer.appendChild(n.rContainer),e.appendChild(n.innerContainer)}n.config.enableTime&&e.appendChild(function(){n.calendarContainer.classList.add("hasTime"),n.config.noCalendar&&n.calendarContainer.classList.add("noCalendar");const e=Ft(n.config);n.timeContainer=Tt("div","flatpickr-time"),n.timeContainer.tabIndex=-1;const t=Tt("span","flatpickr-time-separator",":"),r=Ct("flatpickr-hour",{"aria-label":n.l10n.hourAriaLabel});n.hourElement=r.getElementsByTagName("input")[0];const i=Ct("flatpickr-minute",{"aria-label":n.l10n.minuteAriaLabel});n.minuteElement=i.getElementsByTagName("input")[0],n.hourElement.tabIndex=n.minuteElement.tabIndex=-1,n.hourElement.value=wt(n.latestSelectedDateObj?n.latestSelectedDateObj.getHours():n.config.time_24hr?e.hours:function(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}(e.hours)),n.minuteElement.value=wt(n.latestSelectedDateObj?n.latestSelectedDateObj.getMinutes():e.minutes),n.hourElement.setAttribute("step",n.config.hourIncrement.toString()),n.minuteElement.setAttribute("step",n.config.minuteIncrement.toString()),n.hourElement.setAttribute("min",n.config.time_24hr?"0":"1"),n.hourElement.setAttribute("max",n.config.time_24hr?"23":"12"),n.hourElement.setAttribute("maxlength","2"),n.minuteElement.setAttribute("min","0"),n.minuteElement.setAttribute("max","59"),n.minuteElement.setAttribute("maxlength","2"),n.timeContainer.appendChild(r),n.timeContainer.appendChild(t),n.timeContainer.appendChild(i),n.config.time_24hr&&n.timeContainer.classList.add("time24hr");if(n.config.enableSeconds){n.timeContainer.classList.add("hasSeconds");const t=Ct("flatpickr-second");n.secondElement=t.getElementsByTagName("input")[0],n.secondElement.value=wt(n.latestSelectedDateObj?n.latestSelectedDateObj.getSeconds():e.seconds),n.secondElement.setAttribute("step",n.minuteElement.getAttribute("step")),n.secondElement.setAttribute("min","0"),n.secondElement.setAttribute("max","59"),n.secondElement.setAttribute("maxlength","2"),n.timeContainer.appendChild(Tt("span","flatpickr-time-separator",":")),n.timeContainer.appendChild(t)}n.config.time_24hr||(n.amPM=Tt("span","flatpickr-am-pm",n.l10n.amPM[_t((n.latestSelectedDateObj?n.hourElement.value:n.config.defaultHour)>11)]),n.amPM.title=n.l10n.toggleTitle,n.amPM.tabIndex=-1,n.timeContainer.appendChild(n.amPM));return n.timeContainer}());Ot(n.calendarContainer,"rangeMode","range"===n.config.mode),Ot(n.calendarContainer,"animate",!0===n.config.animate),Ot(n.calendarContainer,"multiMonth",n.config.showMonths>1),n.calendarContainer.appendChild(e);const t=void 0!==n.config.appendTo&&void 0!==n.config.appendTo.nodeType;if((n.config.inline||n.config.static)&&(n.calendarContainer.classList.add(n.config.inline?"inline":"static"),n.config.inline&&(!t&&n.element.parentNode?n.element.parentNode.insertBefore(n.calendarContainer,n._input.nextSibling):void 0!==n.config.appendTo&&n.config.appendTo.appendChild(n.calendarContainer)),n.config.static)){const e=Tt("div","flatpickr-wrapper");n.element.parentNode&&n.element.parentNode.insertBefore(e,n.element),e.appendChild(n.element),n.altInput&&e.appendChild(n.altInput),e.appendChild(n.calendarContainer)}n.config.static||n.config.inline||(void 0!==n.config.appendTo?n.config.appendTo:window.document.body).appendChild(n.calendarContainer)}(),function(){n.config.wrap&&["open","close","toggle","clear"].forEach((e=>{Array.prototype.forEach.call(n.element.querySelectorAll(`[data-${e}]`),(t=>l(t,"click",n[e])))}));if(n.isMobile)return void function(){const e=n.config.enableTime?n.config.noCalendar?"time":"datetime-local":"date";n.mobileInput=Tt("input",n.input.className+" flatpickr-mobile"),n.mobileInput.tabIndex=1,n.mobileInput.type=e,n.mobileInput.disabled=n.input.disabled,n.mobileInput.required=n.input.required,n.mobileInput.placeholder=n.input.placeholder,n.mobileFormatStr="datetime-local"===e?"Y-m-d\\TH:i:S":"date"===e?"Y-m-d":"H:i:S",n.selectedDates.length>0&&(n.mobileInput.defaultValue=n.mobileInput.value=n.formatDate(n.selectedDates[0],n.mobileFormatStr));n.config.minDate&&(n.mobileInput.min=n.formatDate(n.config.minDate,"Y-m-d"));n.config.maxDate&&(n.mobileInput.max=n.formatDate(n.config.maxDate,"Y-m-d"));n.input.getAttribute("step")&&(n.mobileInput.step=String(n.input.getAttribute("step")));n.input.type="hidden",void 0!==n.altInput&&(n.altInput.type="hidden");try{n.input.parentNode&&n.input.parentNode.insertBefore(n.mobileInput,n.input.nextSibling)}catch(e){}l(n.mobileInput,"change",(e=>{n.setDate(Rt(e).value,!1,n.mobileFormatStr),Y("onChange"),Y("onClose")}))}();const e=kt(I,50);n._debouncedChange=kt(f,300),n.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&l(n.daysContainer,"mouseover",(e=>{"range"===n.config.mode&&j(Rt(e))}));l(window.document.body,"keydown",A),n.config.inline||n.config.static||l(window,"resize",e);void 0!==window.ontouchstart?l(window.document,"touchstart",C):l(window.document,"mousedown",C);l(window.document,"focus",C,{capture:!0}),!0===n.config.clickOpens&&(l(n._input,"focus",n.open),l(n._input,"click",n.open));void 0!==n.daysContainer&&(l(n.monthNav,"click",X),l(n.monthNav,["keyup","increment"],u),l(n.daysContainer,"click",U));if(void 0!==n.timeContainer&&void 0!==n.minuteElement&&void 0!==n.hourElement){const e=e=>Rt(e).select();l(n.timeContainer,["increment"],o),l(n.timeContainer,"blur",o,{capture:!0}),l(n.timeContainer,"click",d),l([n.hourElement,n.minuteElement],["focus","click"],e),void 0!==n.secondElement&&l(n.secondElement,"focus",(()=>n.secondElement&&n.secondElement.select())),void 0!==n.amPM&&l(n.amPM,"click",(e=>{o(e),f()}))}n.config.allowInput&&l(n._input,"blur",M)}(),(n.selectedDates.length||n.config.noCalendar)&&(n.config.enableTime&&s(n.config.noCalendar?n.latestSelectedDateObj:void 0),$(!1)),i();const a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!n.isMobile&&a&&F(),Y("onReady")}(),n}function Vt(e,t){const n=Array.prototype.slice.call(e).filter((e=>e instanceof HTMLElement)),r=[];for(let e=0;e<n.length;e++){const i=n[e];try{if(null!==i.getAttribute("data-fp-omit"))continue;void 0!==i._flatpickr&&(i._flatpickr.destroy(),i._flatpickr=void 0),i._flatpickr=qt(i,t||{}),r.push(i._flatpickr)}catch(e){console.error(e)}}return 1===r.length?r[0]:r}"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return Vt(this,e)},HTMLElement.prototype.flatpickr=function(e){return Vt([this],e)});var Ut=function(e,t){return"string"==typeof e?Vt(window.document.querySelectorAll(e),t):e instanceof Node?Vt([e],t):Vt(e,t)};Ut.defaultConfig={},Ut.l10ns={en:Object.assign({},vt),default:Object.assign({},vt)},Ut.localize=e=>{Ut.l10ns.default=Object.assign(Object.assign({},Ut.l10ns.default),e)},Ut.setDefaults=e=>{Ut.defaultConfig=Object.assign(Object.assign({},Ut.defaultConfig),e)},Ut.parseDate=Dt({}),Ut.formatDate=It({}),Ut.compareDates=Lt,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(e){return Vt(this,e)}),Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof e?parseInt(e,10):e))},"undefined"!=typeof window&&(window.flatpickr=Ut);var Ht=Ut,zt=n(56),Wt=n(93),Yt=n.n(Wt);var Qt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};Qt.CK_EDITOR_CONFIG={toolbar:["bold","italic","link","bulletedList","numberedList","blockQuote"],removePlugins:["Heading","Image","ImageCaption","ImageStyle","ImageToolbar","ImageUpload","Table","TableToolbar","MediaEmbed","CKFinderUploadAdapter"],language:"de"},Qt.CK_EDITOR_POST_CONFIG={removePlugins:["Table","TableToolbar","MediaEmbed","CKFinderUploadAdapter"],language:"de"};var Gt=n(294),Jt=n(28),FileMedium=n(81);function Kt(e){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xt(e,t,n){return(Xt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rn(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Zt(e,t){return(Zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function en(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rn(e);if(t){var i=rn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return tn(this,n)}}function tn(e,t){return!t||"object"!==Kt(t)&&"function"!=typeof t?nn(e):t}function nn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rn(e){return(rn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var on=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},an=n(565),sn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zt(e,t)}(a,e);var t,n,r,i=en(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e,an)).addDelegate(new zt.UserSite(nn(t),"events")),t}return t=a,(n=[{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return Xt(rn(a.prototype),"onConstruct",t)}}});return on(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i,o,a,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.onConstruct.call(this,e),t.next=3,$.find();case 3:if(this._churches=t.sent,!e.id){t.next=30;break}if(!e.isRepeatableEvent){t.next=12;break}return i=xe.getRelations(),t.next=9,xe.findById(e.id,i);case 9:this._event=t.sent,t.next=30;break;case 12:if("string"!=typeof(o=e.id)||!o.startsWith("r")){t.next=27;break}if(4!==(a=o.split("-")).length){t.next=25;break}return s=xe.getRelations(),t.next=19,xe.findById(a[0].substr(1),s);case 19:return c=t.sent,this._blockedDay=new Date(parseInt(a[1]),parseInt(a[2])-1,parseInt(a[3])),t.next=23,or.generateSingleEventFromRepeatedEvent(c,this._blockedDay);case 23:this._event=t.sent,this._event.id=null;case 25:t.next=30;break;case 27:return t.next=29,ue.findById(o,ue.getRelations());case 29:this._event=t.sent;case 30:return this._placeNumber=0,t.abrupt("return",r);case 32:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return Xt(rn(a.prototype),"onViewLoaded",e)}}});return on(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,a,s,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),r=this.findBy(".organizer-template"),i=r.parentElement,r.remove(),r.classList.remove("organizer-template"),this._placesContainer=this.findBy("#places-container"),this._placesLineTemplate=this.findBy("#place-line-template"),this._placesLineTemplate.removeAttribute("id"),this._placesLineTemplate.remove(),this._placePreview=this.findBy("#place-preview"),this._churches.forEach((function(e){o.Translator.addDynamicTranslations(e.getDynamicTranslations());var t=r.cloneNode(!0);t.querySelector(".organizer-checkbox").name="church-"+e.id,t.querySelector(".organizer-checkbox").value=e.id,t.querySelector(".church-name").appendChild(o.Translator.makePersistentTranslation(e.getNameTranslation())),i.appendChild(t)})),(a=this.findBy("#event-image-input")).addEventListener("change",(function(){if(a.files&&a.files[0]){var e=new FileReader;e.onload=function(e){c.findBy("#event-image").src=e.target.result},e.readAsDataURL(a.files[0])}})),s=this.findBy("[name=type]"),Object.values(ue.TYPES).forEach((function(e){var t=o.Translator.makePersistentTranslation(e,void 0,"option");t.value=e,s.appendChild(t)})),this._form=new o.Form(this.findBy("#add-event-form"),(function(e){return on(c,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a,s,c,u,l,f,h,d,p,m,y,g,b;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.showLoadingSymbol(),n={},r={},i=[],a=e.image,o.Helper.imageUrlIsEmpty(e.image)&&(a=e["image-before"]),s={},t.next=9,I.findById(1);case 9:return t.t0=t.sent,c=[t.t0],u=o.Helper.arrayToObject(this._churches,(function(e){return e.id})),Object.keys(e).forEach((function(t){if(t.startsWith("church-")&&i.push(u[parseInt(e[t])]),t.startsWith("name-")&&(n[t.split("-")[1]]=e[t]),t.startsWith("description-")&&(r[t.split("-")[1]]=e[t].replace(/&nbsp;/g," ")),t.startsWith("place-name-")){var o=e["place-query-"+t.substring(11)];""===o.trim()&&(o=e[t]),s[e[t]]=o}})),l=this._event?this._event instanceof xe?this._event.getOriginalEvent():this._event:new ue,f=null,(f=l.images&&l.images.length>=0?l.images[0]:new FileMedium.FileMedium).src=a,t.next=19,f.save();case 19:if(l.setNames(n),l.setDescriptions(r),l.setOrganisers(i),l.setImages([f]),l.setPlaces(s),l.setStartTime(new Date(e.start)),l.setEndTime(new Date(e.end)),l.setType(e.type),l.setRegions(c),""===e.website.trim()&&(e.website=null),l.setWebsite(e.website),h=l.id,d=l.save(),!o.Helper.isNotNull(l.repeatedEvent)||null!==h){t.next=43;break}return(p=new be).setDay(this._blockedDay),this._blockedDay.setHours(12),p.setRepeatedEvent(l.repeatedEvent),p.setEvent(l),l.repeatedEvent.blockedDays.push(p),t.next=41,d;case 41:return t.next=43,p.save();case 43:return t.next=45,d;case 45:if(!(e.repeatable||this._event instanceof xe)){t.next=62;break}return m=null,this._event instanceof xe?m=this._event:(m=new xe,this._event=m),m.setStartDate(new Date(e.start)),m.setOriginalEvent(l),l.repeatedEvent=m,l.setIsTemplate(!0),y=new Date(e["repeat-until"]),isNaN(y.getTime())?m.setRepeatUntil(null):m.setRepeatUntil(y),g=[],[1,2,3,4,5,6,0].forEach((function(t){e["repeat-"+t]&&g.push(e["repeat-"+t])})),m.setRepeatingArguments(g.join(",")),t.next=60,m.save();case 60:return t.next=62,l.save();case 62:if(!(this._event instanceof xe)){t.next=69;break}return t.next=65,or.generateNextSingleEventFromRepeatedEvent(this._event);case 65:b=t.sent,this.finishAndStartSite(qn,{id:b.getId()}),t.next=70;break;case 69:this.finishAndStartSite(qn,{id:l.id});case 70:this.showLoadingSymbol();case 71:case"end":return t.stop()}}),t,this)})))})),this._form.addValidator((function(e){var t={};return""===e.start.trim()&&(t.error1="required"),""===e.end.trim()&&(t.error2="reqired"),Object.keys(t).length>0?t:!(new Date(e.start).getTime()>new Date(e.end).getTime())||(new o.Toast("the endpoint must be after the start").show(),{end:"the endpoint must be after the start"})})),this.findBy(".editor",!0).forEach((function(e){return on(c,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=this._form,t.next=3,Yt.a.create(e,Qt.CK_EDITOR_CONFIG);case 3:t.t1=t.sent,t.t0.addEditor.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t,this)})))})),this.findBy("#add-place").addEventListener("click",(function(){c.addPlaceLine()})),this.addPlaceLine(),this._repeatableSectionElement=this.findBy("#repeatable-section"),this._repeatableCheckbox=this.findBy("#repeatable-checkbox"),this._repeatableCheckbox.addEventListener("change",(function(){c._repeatableCheckbox.checked?c._repeatableSectionElement.classList.remove("hidden"):c._repeatableSectionElement.classList.add("hidden")})),e.next=25,this.setFormValuesFromEvent();case 25:return Ht(this.findBy(".date-time",!0),{enableTime:!0,dateFormat:"Y-m-dTH:i",time_24hr:!0,locale:Gt.German}),e.abrupt("return",n);case 27:case"end":return e.stop()}}),e,this)})))}},{key:"addPlaceLine",value:function(){var e=this;this._placeNumber++;var t=this._placesLineTemplate.cloneNode(!0),n=t.querySelector(".place-name");n.name="place-name-"+this._placeNumber;var r=t.querySelector(".place-query");r.name="place-query-"+this._placeNumber,n.addEventListener("input",(function(e){r.placeholder=n.value,a()})),n.addEventListener("change",(function(e){r.placeholder=n.value,a()}));var i=null,a=function(){null!==i&&clearTimeout(i),i=setTimeout((function(){var t=nt._buildMapsLink(r.value||r.placeholder);e._placePreview.src!==t&&(e._placePreview.src=t)}),200)};n.addEventListener("focus",a),r.addEventListener("focus",a),r.addEventListener("change",a),r.addEventListener("keyup",a),t.querySelector(".remove-place").addEventListener("click",(function(){t.remove()})),this._placesContainer.appendChild(t),requestAnimationFrame((function(){n.focus()})),o.Translator.getInstance().updateTranslations(t)}},{key:"setFormValuesFromEvent",value:function(){var e;return on(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a,s,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this._event instanceof ue||this._event instanceof xe)){t.next=22;break}return n={},r=this._event.getNames(),Object.keys(r).forEach((function(e){n["name-"+e]=r[e]})),i=this._event.getDescriptions(),Object.keys(i).forEach((function(e){n["description-"+e]=i[e].replace(/&nbsp;/g," ")})),n.type=this._event.getType(),n.start=Jt.DateHelper.strftime("%Y-%m-%d %H:%M",this._event.getStartTime()),n.end=Jt.DateHelper.strftime("%Y-%m-%d %H:%M",this._event.getEndTime()),n.website=this._event.getWebsite(),a=this._event.getOrganisers(),o.Helper.isNotNull(a)&&a.forEach((function(e){n["church-"+e.id]=e.id})),this.findBy("#event-image").src=this._event.getImages()[0],this.findBy("input[type='hidden'][name='image-before']").value=this._event.getImages()[0],this.findBy("input[type='file'][name='image']").removeAttribute("required"),s=this._event.getPlaces(),Array.isArray(s)&&(s=o.Helper.arrayToObject(s,(function(e){return e}))),Object.keys(s).forEach((function(e,t){if(t>0&&c.addPlaceLine(),n["place-name-"+(t+1)]=e,e!==s[e])n["place-query-"+(t+1)]=s[e];else{var r=c.findBy("[name='place-query-"+(t+1)+"']");r.placeholder=e,r.removeAttribute("data-translation-placeholder")}})),0===Object.keys(s).length&&(null===(e=this.findBy(".remove-place"))||void 0===e||e.dispatchEvent(new MouseEvent("click"))),this._event instanceof xe?(this._repeatableCheckbox.checked=!0,this._repeatableCheckbox.setAttribute("readonly","true"),this._repeatableCheckbox.setAttribute("disabled","true"),this._repeatableSectionElement.classList.remove("hidden"),o.Helper.isNotNull(this._event.getRepeatUntil())&&(n["repeat-until"]=Jt.DateHelper.strftime("%Y-%m-%d %H:%M",this._event.getRepeatUntil())),this._event.getRepeatingArguments().split(",").forEach((function(e){n["repeat-"+e]=e}))):this._event.getRepeatedEvent()&&(this._repeatableCheckbox.setAttribute("readonly","true"),this._repeatableCheckbox.setAttribute("disabled","true")),t.next=22,this._form.setValues(n);case 22:case"end":return t.stop()}}),t,this)})))}}])&&$t(t.prototype,n),r&&$t(t,r),a}(mt);o.App.addInitialization((function(e){e.addDeepLink("addEvent",sn)}));var cn=n(85);function un(e){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fn(e,t,n){return(fn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mn(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function hn(e,t){return(hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mn(e);if(t){var i=mn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return pn(this,n)}}function pn(e,t){return!t||"object"!==un(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mn(e){return(mn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},gn=n(568),bn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hn(e,t)}(s,e);var t,n,r,i=dn(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e,gn)).showMaxEvents=0,t._events=[],t._showInPast=!0,t}return t=s,(n=[{key:"setShowMaxEvents",value:function(e){var t=this;this.showMaxEvents=e,this._viewLoadedPromise.then((function(){return t._renderList()}))}},{key:"setShowInPast",value:function(e){this._showInPast=!0===e}},{key:"setEvents",value:function(e){return yn(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._events=e,t.next=3,this._viewLoadedPromise;case 3:return t.next=5,this._renderList();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return fn(mn(s.prototype),"onViewLoaded",e)}}});return yn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this._eventContainer=this.findBy("#event-container-future"),this._eventContainerPast=this.findBy("#event-container-past"),this._eventTemplate=this.findBy("#event-template"),this._eventOverviewTemplate=this.findBy("#event-overview-template"),this._pastSection=this.findBy("#past-section"),this._eventTemplate.removeAttribute("id"),this._eventOverviewTemplate.removeAttribute("id"),this._eventTemplate.remove(),this._eventOverviewTemplate.remove(),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})))}},{key:"_renderList",value:function(){return yn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,s,c,u,l,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Jt.DateHelper.strftime("%y"),n={},this._events.forEach((function(e){if(a.Helper.isNotNull(e)){o.Translator.addDynamicTranslations(e.getDynamicTranslations());var r=Jt.DateHelper.strftime("%y",e.getStartTime()),i=Jt.DateHelper.strftime("%y",e.getEndTime()),s=Jt.DateHelper.strftime("%a %d.%m.",e.getStartTime()),c=Jt.DateHelper.strftime("%a %d.%m.",e.getEndTime());i!==r?s+=" "+r+" - "+c+" "+i:s!==c&&(s+=" - "+c,t!==r&&(s+=" "+r));var u=Jt.DateHelper.strftime("%Y.%m.%d",e.getStartTime())+","+s+","+Jt.DateHelper.strftime("%Y.%m.%d",e.getEndTime());a.Helper.isNull(n[u])&&(n[u]={});var l=Jt.DateHelper.strftime("%H:%M",e.getStartTime());a.Helper.isNull(n[u][l])&&(n[u][l]=[]),n[u][l].push(e)}})),r={},Object.keys(n).sort().forEach((function(e){r[e]={},Object.keys(n[e]).sort().forEach((function(t){r[e][t]=n[e][t].sort((function(e,t){var n=o.Translator.translate(e.getNameTranslation()).toUpperCase(),r=o.Translator.translate(t.getNameTranslation()).toUpperCase();return n<r?-1:n>r?1:0}))}))})),i=Jt.DateHelper.strftime("%Y.%m.%d"),cn.ViewHelper.removeAllChildren(this._eventContainer),cn.ViewHelper.removeAllChildren(this._eventContainerPast),s=!1,c=o.Translator.getInstance(),u=0,Object.keys(r).some((function(e){var t=e.split(","),n=f._eventTemplate.cloneNode(!0);n.querySelector(".day").innerHTML=t[1];var a=Object.keys(r[e]).some((function(t){return r[e][t].some((function(e){var r=f._eventOverviewTemplate.cloneNode(!0);r.querySelector(".name").appendChild(c.makePersistentTranslation(e.getNameTranslation())),r.querySelector(".time").innerText=t;var i=e.getPlaces(),a=Array.isArray(i),s=i;a||(s=Object.keys(i)),s.length>0&&(1===s.length?nt.createPlace(s[0],a?i[0]:i[s[0]],!0):nt.createMultipleLocationsView()).then((function(e){return r.querySelector(".place-container").appendChild(e)})),r.addEventListener("click",(function(){f.startSite(qn,{id:e.getId()})}));var l=r.querySelector(".favorite");pr.eventIsFavorite(e.getId()).then((function(e){e&&l.classList.add("is-favorite")})),l.addEventListener("click",(function(t){return yn(f,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.stopPropagation(),t.preventDefault(),n.next=4,or.toggleFavorite(e);case 4:n.sent?l.classList.add("is-favorite"):l.classList.remove("is-favorite");case 6:case"end":return n.stop()}}),n)})))}));var h=e.getOrganisers();if(Array.isArray(h)){var d=r.querySelector(".tag-panel");h.forEach((function(e){o.Translator.addDynamicTranslations(e.getDynamicTranslations());var t=document.createElement("span");t.classList.add("tag"),t.appendChild(o.Translator.makePersistentTranslation(e.getNameTranslation())),d.appendChild(t)}))}if(n.appendChild(r),u++,f.showMaxEvents>0&&u>=f.showMaxEvents)return!0}))}));return f._showInPast&&t[2]<i?(f._eventContainerPast.appendChild(n),s=!0):f._eventContainer.appendChild(n),a})),0===Object.keys(r).length&&((l=document.createElement("div")).classList.add("no-events"),l.appendChild(o.Translator.makePersistentTranslation("no events")),this._eventContainer.appendChild(l)),s?this._pastSection.classList.remove("hidden"):this._pastSection.classList.add("hidden"),o.Translator.getInstance().updateTranslations(this._eventContainer),o.Translator.getInstance().updateTranslations(this._eventContainerPast);case 16:case"end":return e.stop()}}),e,this)})))}}])&&ln(t.prototype,n),r&&ln(t,r),s}(o.AbstractFragment),vn=n(57);function wn(e){return(wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kn(e,t,n){return(kn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sn(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function On(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Sn(e);if(t){var i=Sn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Tn(this,n)}}function Tn(e,t){return!t||"object"!==wn(t)&&"function"!=typeof t?xn(e):t}function xn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sn(e){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Rn=n(567),Pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&En(e,t)}(s,e);var t,n,r,i=On(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e,Rn)).eventListFragment=new bn(xn(t)),t.addFragment("#event-list",t.eventListFragment),t.getFooterFragment().setSelected(".icon.search"),t}return t=s,(n=[{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return kn(Sn(s.prototype),"onConstruct",t)}}});return Cn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.onConstruct.call(this,e),this._searchString="",a.Helper.isSet(e,"q")&&(this._searchString=e.q),this._start=a.DateHelper.strftime("%Y-%m-%d"),a.Helper.isSet(e,"start")&&(this._start=e.start),this._end="",a.Helper.isSet(e,"end")&&(this._end=e.end),this._types=[],a.Helper.isSet(e,"types")&&""!==e.types.trim())try{this._types=e.types.split(",")}catch(e){}if(this._churches=[],a.Helper.isSet(e,"churches")&&""!==e.churches.trim())try{this._churches=e.churches.split(",")}catch(e){}return t.next=13,$.find();case 13:return this._possibleChurches=t.sent.sort((function(e,t){o.Translator.getInstance().addDynamicTranslations(e.getDynamicTranslations()),o.Translator.getInstance().addDynamicTranslations(t.getDynamicTranslations());var n=o.Translator.getInstance().translate(e.getNameTranslation()),r=o.Translator.getInstance().translate(t.getNameTranslation());return n.toLowerCase().localeCompare(r.toLowerCase())})),t.abrupt("return",r);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return kn(Sn(s.prototype),"onViewLoaded",e)}}});return Cn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.onViewLoaded.call(this),this._searchFilter=this.findBy("#search-filter"),this._searchResults=this.findBy("#search-results"),this._filterTagTemplate=this.findBy("#filter-tag-template"),this._filterTagTemplate.removeAttribute("id"),this._filterTagTemplate.remove(),this._filterEventContainer=this.findBy("#filter-event-tag-container"),this._filterOrganiserContainer=this.findBy("#filter-organiser-tag-container"),this._searchInput=this.findBy("#search-input"),this.findBy("#search-button").addEventListener("click",(function(){r._search()})),this._searchInput.addEventListener("keyup",(function(){r._filterTags(r._searchInput.value)})),this._searchInput.addEventListener("focus",(function(){r._showFilter()})),this._searchInput.addEventListener("keydown",(function(e){"Enter"===e.key&&(r._search(),r._searchInput.blur())})),!(""!==this._searchString.trim()||this._types.length>=1||this._churches.length>=1)){e.next=18;break}return e.next=16,this._search();case 16:e.next=20;break;case 18:return e.next=20,this._showFilter();case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})))}},{key:"_showFilter",value:function(){return Cn(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._searchFilter.classList.remove("hidden"),this._searchResults.classList.add("hidden"),this._filterTags(this._searchInput.value);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"_search",value:function(){return Cn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._searchString=this._searchInput.value,e.next=3,this.showLoadingSymbol();case 3:return this.setParameters({q:this._searchString,types:this._types,churches:this._churches}),e.next=6,or.search(this._searchString,this._start,this._end,this._types,this._churches,void 0,!0);case 6:return t=e.sent,e.next=9,this.eventListFragment.setEvents(t);case 9:return this._searchFilter.classList.add("hidden"),this._searchResults.classList.remove("hidden"),e.next=13,this.removeLoadingSymbol();case 13:case"end":return e.stop()}}),e,this)})))}},{key:"_filterTags",value:function(e){var t=this;vn.ViewHelper.removeAllChildren(this._filterEventContainer),vn.ViewHelper.removeAllChildren(this._filterOrganiserContainer),Object.values(ue.TYPES).sort((function(e,t){if(e===ue.TYPES.SONSTIGES)return 1;if(t===ue.TYPES.SONSTIGES)return-1;var n=o.Translator.getInstance().translate(e),r=o.Translator.getInstance().translate(t);return n.toLowerCase().localeCompare(r.toLowerCase())})).forEach((function(n){if(-1!==o.Translator.translate(n).toLowerCase().indexOf(e.toLowerCase())){var r=t._filterTagTemplate.cloneNode(!0);r.appendChild(o.Translator.makePersistentTranslation(n)),r.dataset.type=n,-1!==t._types.indexOf(n)&&r.classList.add("selected"),r.addEventListener("click",(function(){-1===t._types.indexOf(n)?(t._types=[n],r.classList.add("selected")):(t._types=[],r.classList.remove("selected")),t._churches=[],t._search()})),t._filterEventContainer.appendChild(r)}})),this._possibleChurches.forEach((function(n){if(o.Translator.addDynamicTranslations(n.getDynamicTranslations()),-1!==o.Translator.translate(n.getNameTranslation()).toLowerCase().indexOf(e.toLowerCase())){var r=t._filterTagTemplate.cloneNode(!0);r.appendChild(o.Translator.makePersistentTranslation(n.getNameTranslation())),r.dataset.churchId=n.id.toString(),-1!==t._churches.indexOf(n.id+"")&&r.classList.add("selected"),r.addEventListener("click",(function(){-1===t._churches.indexOf(n.id+"")?(t._churches=[n.id.toString()],r.classList.add("selected")):(t._churches=[],r.classList.remove("selected")),t._types=[],t._search()})),t._filterOrganiserContainer.appendChild(r)}}))}}])&&_n(t.prototype,n),r&&_n(t,r),s}(w);function Nn(e){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function An(e,t,n){return(An="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ln(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function jn(e,t){return(jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function In(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ln(e);if(t){var i=Ln(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Dn(this,n)}}function Dn(e,t){return!t||"object"!==Nn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ln(e){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}o.App.addInitialization((function(e){e.addDeepLink("search",Pn)}));var Bn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Fn=n(550),qn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jn(e,t)}(s,e);var t,n,r,i=In(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e,Fn)).getFooterFragment().setSelected(".icon.calendar"),t}return t=s,(n=[{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return An(Ln(s.prototype),"onConstruct",t)}}});return Bn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i,s,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.onConstruct.call(this,e),a.Helper.isSet(e,"id")){t.next=5;break}return new o.Toast("no id given").show(),this.finish(),t.abrupt("return");case 5:if("string"!=typeof(i=e.id)||!i.startsWith("r")){t.next=17;break}if(4!==(s=i.split("-")).length){t.next=15;break}return t.next=11,xe.findById(s[0].substr(1),xe.getRelations());case 11:return c=t.sent,t.next=14,or.generateSingleEventFromRepeatedEvent(c,new Date(parseInt(s[1]),parseInt(s[2])-1,parseInt(s[3])));case 14:this._event=t.sent;case 15:t.next=21;break;case 17:return u=ue.getRelations(),t.next=20,ue.findById(e.id,u);case 20:this._event=t.sent;case 21:if(this._event){t.next=25;break}return new o.Toast("no event found").show(),this.finish(),t.abrupt("return");case 25:return t.next=27,pr.findOne({eventId:this._event.getId(),isFavorite:!0});case 27:return t.t0=t.sent,this._isFavorite=null!==t.t0,t.abrupt("return",r);case 30:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return An(Ln(s.prototype),"onViewLoaded",e)}}});return Bn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,s,c,u,l,f,h,d,p,m,y=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.onViewLoaded.call(this),(r=o.Translator.getInstance()).addDynamicTranslations(this._event.getDynamicTranslations()),this.findBy("#event-name").appendChild(r.makePersistentTranslation(this._event.getNameTranslation())),this.findBy("#event-description").appendChild(r.makePersistentTranslation(this._event.getDescriptionTranslation())),!(this._event.getImages().length>0)){e.next=9;break}return e.next=8,this._event.getImages()[0].isDownloadedState();case 8:this.findBy("#event-img").src=this._event.getImages()[0].getUrl();case 9:return i=this.findBy("#event-time"),this._event.getStartTime().getFullYear()===this._event.getEndTime().getFullYear()&&this._event.getStartTime().getMonth()===this._event.getEndTime().getMonth()&&this._event.getStartTime().getDate()===this._event.getEndTime().getDate()?this._event.getStartTime().getHours()===this._event.getEndTime().getHours()&&this._event.getStartTime().getMinutes()===this._event.getEndTime().getMinutes()?i.innerHTML=Jt.DateHelper.strftime("%d. %B ´%y, %H:%M ",this._event.getStartTime())+r.makePersistentTranslation("uhr").outerHTML:i.innerHTML=Jt.DateHelper.strftime("%d. %B ´%y<br/>%H:%M",this._event.getStartTime())+" - "+Jt.DateHelper.strftime("%H:%M",this._event.getEndTime()):i.innerHTML=Jt.DateHelper.strftime("%d. %b ´%y, %H:%M",this._event.getStartTime())+" -<br/>"+Jt.DateHelper.strftime("%d. %b ´%y, %H:%M",this._event.getEndTime()),s=this.findBy("#places-container"),c=this._event.getPlaces(),u=!1,Array.isArray(c)||(c=Object.keys(c),u=!0),e.next=17,a.Helper.asyncForEach(c,(function(e){return Bn(y,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=s,t.next=3,nt.createPlace(e,u?this._event.getPlaces()[e]:e);case 3:t.t1=t.sent,t.t0.appendChild.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t,this)})))}));case 17:return l=this.findBy("#favorite .favorite"),this._isFavorite&&l.classList.add("is-favorite"),l.addEventListener("click",(function(e){return Bn(y,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.stopPropagation(),this.showLoadingSymbol(),t.next=4,or.toggleFavorite(this._event);case 4:(n=t.sent)?l.classList.add("is-favorite"):l.classList.remove("is-favorite"),this._isFavorite=n,this.removeLoadingSymbol();case 8:case"end":return t.stop()}}),t,this)})))})),f=this.findBy("#tag-panel"),(h=document.createElement("span")).classList.add("tag"),h.appendChild(o.Translator.makePersistentTranslation(this._event.getType())),f.addEventListener("click",(function(){y.startSite(Pn,{types:y._event.getType()})})),f.appendChild(h),d=this._event.getOrganisers(),Array.isArray(d)&&d.forEach((function(e){o.Translator.addDynamicTranslations(e.getDynamicTranslations());var t=document.createElement("span");t.classList.add("tag"),t.appendChild(o.Translator.makePersistentTranslation(e.getNameTranslation())),t.addEventListener("click",(function(){y.startSite(Pn,{churches:e.id+""})})),f.appendChild(t)})),p=this.findBy("#event-website"),(m=this._event.getWebsite())?(p.href=m,m.startsWith("http://")?m=m.substring(7):m.startsWith("https://")&&(m=m.substring(8)),p.innerText=m):p.remove(),this._checkRightsPanel(),e.abrupt("return",n);case 33:case"end":return e.stop()}}),e,this)})))}},{key:"_checkRightsPanel",value:function(){var e=this;rt.UserManager.getInstance().addLoginChangeCallback((function(t,n){t&&n.hasAccess(ue.ACCESS_MODIFY)?e.findBy(".admin-panel").classList.remove("hidden"):e.findBy(".admin-panel").classList.add("hidden")}),!0),this.findBy("#delete-event").addEventListener("click",(function(){return Bn(e,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!rt.UserManager.getInstance().hasAccess(ue.ACCESS_MODIFY)){e.next=42;break}if(!a.Helper.isNotNull(this._event.getRepeatedEvent())){e.next=33;break}return e.next=4,new o.ButtonChooseDialog("","delete event or event series",{0:"event",1:"series",2:"abort"}).show();case 4:if("1"!==(t=e.sent)){e.next=13;break}this.showLoadingSymbol(),this._event.getRepeatedEvent().delete(),new o.Toast("eventserie wurde erfolgreich gelöscht").show(),this.finish(),this.removeLoadingSymbol(),e.next=31;break;case 13:if("0"!==t){e.next=31;break}if(this.showLoadingSymbol(),"string"!=typeof this._event.id||!this._event.id.startsWith("r")){e.next=27;break}return(n=new be).setDay(this._event.getStartTime()),n.getDay().setHours(12),n.setRepeatedEvent(this._event.getRepeatedEvent()),this._event.getRepeatedEvent().blockedDays.push(n),e.next=23,n.save();case 23:new o.Toast("event wurde erfolgreich gelöscht").show(),this.finish(),e.next=30;break;case 27:this._event.delete(),new o.Toast("event wurde erfolgreich gelöscht").show(),this.finish();case 30:this.removeLoadingSymbol();case 31:e.next=42;break;case 33:return e.next=35,new o.ConfirmDialog("möchtest du das Event wirklich löschen? Es wird unwiederbringlich verloren gehen!","Event löschen?").show();case 35:if(!e.sent){e.next=42;break}return this.showLoadingSymbol(),e.next=39,this._event.delete();case 39:new o.Toast("event wurde erfolgreich gelöscht").show(),this.finish(),this.removeLoadingSymbol();case 42:case"end":return e.stop()}}),e,this)})))})),this.findBy("#modify-event").addEventListener("click",(function(){return Bn(e,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!rt.UserManager.getInstance().hasAccess(ue.ACCESS_MODIFY)){e.next=9;break}if(!a.Helper.isNotNull(this._event.getRepeatedEvent())){e.next=8;break}return e.next=4,new o.ButtonChooseDialog("","edit event or event series",{1:"event",2:"series"}).show();case 4:"2"===(t=e.sent)?this.finishAndStartSite(sn,{id:this._event.getRepeatedEvent().id,isRepeatableEvent:!0}):"1"===t&&this.finishAndStartSite(sn,{id:this._event.getId()}),e.next=9;break;case 8:this.finishAndStartSite(sn,{id:this._event.getId()});case 9:case"end":return e.stop()}}),e,this)})))}))}}])&&Mn(t.prototype,n),r&&Mn(t,r),s}(w);function Vn(e){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Un(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zn(e,t){return(zn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qn(e);if(t){var i=Qn(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yn(this,n)}}function Yn(e,t){return!t||"object"!==Vn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qn(e){return(Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}o.App.addInitialization((function(e){e.addDeepLink("event",qn)}));var Gn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Jn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zn(e,t)}(o,e);var t,n,r,i=Wn(o);function o(){return Un(this,o),i.apply(this,arguments)}return t=o,(n=[{key:"_canNotify",value:function(){return"undefined"==typeof device||"browser"!==device.platform}},{key:"hasPermission",value:function(){return Gn(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._canNotify()){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){cordova.plugins.notification.local.hasPermission((function(t){return e(t)}))})));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"requestPermission",value:function(){return Gn(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._canNotify()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.hasPermission();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",new Promise((function(e){cordova.plugins.notification.local.requestPermission((function(t){return e(t)}))})));case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"schedule",value:function(e,t,n,r,i){return Gn(this,void 0,void 0,regeneratorRuntime.mark((function o(){var a;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(this._canNotify()){o.next=2;break}return o.abrupt("return");case 2:return o.next=4,this.hasPermission();case 4:if(o.t0=!o.sent,!o.t0){o.next=9;break}return o.next=8,this.requestPermission();case 8:o.t0=!o.sent;case 9:if(!o.t0){o.next=11;break}return o.abrupt("return");case 11:return a=new Date,i.getTime()<=a.getTime()&&i.setTime(a.getTime()+6e4),o.abrupt("return",new Promise((function(o){cordova.plugins.notification.local.schedule({id:e,title:n,text:r,trigger:{at:i},data:t},o)})));case 14:case"end":return o.stop()}}),o,this)})))}},{key:"cancelAllNotifications",value:function(){return Gn(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._canNotify()){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){cordova.plugins.notification.local.cancelAll(e)})));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"cancelNotification",value:function(e){return Gn(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._canNotify()){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",new Promise((function(t){cordova.plugins.notification.local.cancel(e,t)})));case 3:case"end":return t.stop()}}),t,this)})))}},{key:"_handleClick",value:function(e){return Gn(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._canNotify()){t.next=2;break}return t.abrupt("return");case 2:cordova.plugins.notification.local.on("click",(function(t){e.startSite(qn,{id:t.data}),Pe.App.setStartParam("s","event"),Pe.App.setStartParam("id",t.data)}));case 3:case"end":return t.stop()}}),t,this)})))}}])&&Hn(t.prototype,n),r&&Hn(t,r),o}(Re.Singleton);Pe.App.addInitialization((function(e){return Jn.getInstance()._handleClick(e)}));var Kn=n(31),$n=n(63);function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zn=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},er=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"createCalendar",value:function(){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){return Zn(n,void 0,void 0,regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0="browser"===device.platform,n.t0){n.next=6;break}return n.next=4,this.askIfFavoritesShouldBeInSystemCalendar();case 4:n.t1=n.sent,n.t0=!1===n.t1;case 6:if(!n.t0){n.next=10;break}t(void 0),n.next=13;break;case 10:(i=window.plugins.calendar.getCreateCalendarOptions()).calendarName=e.NAME,window.plugins.calendar.createCalendar(i,t,r);case 13:case"end":return n.stop()}}),n,this)})))})).catch((function(e){return console.error(e)})));case 1:case"end":return t.stop()}}),t)})))}},{key:"deleteCalendar",value:function(){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){return Zn(n,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0="browser"===device.platform,n.t0){n.next=6;break}return n.next=4,this.askIfFavoritesShouldBeInSystemCalendar();case 4:n.t1=n.sent,n.t0=!1===n.t1;case 6:if(!n.t0){n.next=8;break}return n.abrupt("return",t(void 0));case 8:window.plugins.calendar.deleteCalendar(e.NAME,t,r);case 9:case"end":return n.stop()}}),n,this)})))})).catch((function(e){return console.error(e)})));case 1:case"end":return t.stop()}}),t)})))}},{key:"createEvent",value:function(e,t,n,r,i,o){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function s(){var c=this;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s,u){return Zn(c,void 0,void 0,regeneratorRuntime.mark((function c(){var l,f;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(c.t0="browser"===device.platform,c.t0){c.next=6;break}return c.next=4,this.askIfFavoritesShouldBeInSystemCalendar();case 4:c.t1=c.sent,c.t0=!1===c.t1;case 6:if(!c.t0){c.next=10;break}s(void 0),c.next=20;break;case 10:return c.next=12,this.getSelectedCalendar().catch((function(e){return console.error(e)}));case 12:if(l=c.sent,!a.Helper.isNull(l)){c.next=15;break}return c.abrupt("return",s(void 0));case 15:(f=window.plugins.calendar.getCalendarOptions()).calendarName=l.name,f.calendarId=l.id,f.url=o,window.plugins.calendar.createEventWithOptions(e,t,n,r,i,f,s,u);case 20:case"end":return c.stop()}}),c,this)})))})).catch((function(e){return console.error(e)})));case 1:case"end":return s.stop()}}),s)})))}},{key:"findEvent",value:function(e,t,n,r,i){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function o(){var a=this;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",new Promise((function(o,s){return Zn(a,void 0,void 0,regeneratorRuntime.mark((function a(){var c,u;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.t0="browser"===device.platform,a.t0){a.next=6;break}return a.next=4,this.askIfFavoritesShouldBeInSystemCalendar();case 4:a.t1=a.sent,a.t0=!1===a.t1;case 6:if(!a.t0){a.next=10;break}o(void 0),a.next=18;break;case 10:return a.next=12,this.getMyCalendar();case 12:c=a.sent,(u=window.plugins.calendar.getCalendarOptions()).calendarName=c.name,u.calendarId=c.id,u.url="https://echo.silas.link?s=event&id=1",window.plugins.calendar.findEventWithOptions(e,t,n,r,i,u,o,s);case 18:case"end":return a.stop()}}),a,this)})))})).catch((function(e){return console.error(e)})));case 1:case"end":return o.stop()}}),o)})))}},{key:"hasCalendarPermission",value:function(){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return Zn(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("browser"!==device.platform){t.next=2;break}return t.abrupt("return",e(!0));case 2:window.plugins.calendar.hasReadPermission((function(t){return e(t)}));case 3:case"end":return t.stop()}}),t)})))})));case 1:case"end":return e.stop()}}),e)})))}},{key:"askIfFavoritesShouldBeInSystemCalendar",value:function(){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ne.NativeStoragePromise.getItem("insert-favorites",null);case 2:if(t=e.sent,!a.Helper.isNull(t)){e.next=17;break}return e.next=6,new o.ConfirmDialog("should favorites inserted to system calendar","insert favorites","yes","no").show();case 6:if(!(n=e.sent)){e.next=12;break}return e.next=10,Ne.NativeStoragePromise.setItem("insert-favorites","1");case 10:e.next=14;break;case 12:return e.next=14,Ne.NativeStoragePromise.setItem("insert-favorites","0");case 14:return e.abrupt("return",n);case 17:return e.abrupt("return","1"===t);case 18:case"end":return e.stop()}}),e)})))}},{key:"listCalendars",value:function(){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return Zn(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0="browser"===device.platform,t.t0){t.next=6;break}return t.next=4,this.askIfFavoritesShouldBeInSystemCalendar();case 4:t.t1=t.sent,t.t0=!1===t.t1;case 6:if(!t.t0){t.next=8;break}return t.abrupt("return",e([]));case 8:window.plugins.calendar.listCalendars(e,n);case 9:case"end":return t.stop()}}),t,this)})))})).catch((function(e){return console.error(e),[]})));case 1:case"end":return e.stop()}}),e)})))}},{key:"addEventToSystemCalendar",value:function(t){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,pr.findOne({eventId:t.id});case 2:return(r=n.sent)||(r=new pr),(i=Kn.Translator.getInstance()).addDynamicTranslations(t.getDynamicTranslations()),n.next=8,t.getPlaces();case 8:return o=n.sent,n.t0=this,n.t1=i.translate(t.getNameTranslation()),n.t2=a.Helper.isNotNull(o)&&Object.keys(o).length>=1?Object.keys(o)[0]:"",n.t3=i.translate(t.getDescriptionTranslation())+"\n\n",n.next=15,t.getStartTime();case 15:return n.t4=n.sent,n.next=18,t.getEndTime();case 18:return n.t5=n.sent,n.t6=e.WEBSITE+$n.DataManager.buildQuery({s:"event",id:t.id}),n.next=22,n.t0.createEvent.call(n.t0,n.t1,n.t2,n.t3,n.t4,n.t5,n.t6);case 22:return r.systemCalendarId=n.sent,n.next=25,r.save();case 25:case"end":return n.stop()}}),n,this)})))}},{key:"deleteEventFromSystemCalendar",value:function(e){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pr.findOne({eventId:e.id});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:return r=this.deleteEvenById(n.systemCalendarId),n.systemCalendarId=null,t.next=9,n.save();case 9:return t.abrupt("return",r);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"deleteEvenById",value:function(e){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){return Zn(n,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0="browser"===device.platform||a.Helper.isNull(e),n.t0){n.next=6;break}return n.next=4,this.askIfFavoritesShouldBeInSystemCalendar();case 4:n.t1=n.sent,n.t0=!1===n.t1;case 6:if(!n.t0){n.next=8;break}return n.abrupt("return",t(void 0));case 8:window.plugins.calendar.deleteEventById(e,void 0,t,r);case 9:case"end":return n.stop()}}),n,this)})))})).catch((function(e){return console.error(e)})));case 1:case"end":return t.stop()}}),t)})))}},{key:"getMyCalendar",value:function(){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.listCalendars();case 2:if(n=t.sent,r=null,n.some((function(t){return t.name===e.NAME&&(r=t,!0)})),null!==r){t.next=7;break}return t.abrupt("return",this.getMyCalendar());case 7:return t.abrupt("return",r);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"getSelectedCalendar",value:function(){return Zn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.askIfFavoritesShouldBeInSystemCalendar();case 2:if(t.sent){t.next=4;break}return t.abrupt("return",null);case 4:return t.next=6,this.listCalendars();case 6:return n=t.sent,r=null,t.next=10,Ne.NativeStoragePromise.getItem(e.SYSTEM_CALENDAR_ID_KEY);case 10:if(i=t.sent,n.some((function(t){return!!(a.Helper.isNotNull(i)&&t.id===i||a.Helper.isNull(i)&&t.isPrimary&&-1!==t.name.indexOf("@")||"OK, Calendar already exists"===i&&t.name===e.NAME)&&(r=t,!0)})),t.t0=null===r,!t.t0){t.next=17;break}return t.next=16,this.hasCalendarPermission();case 16:t.t0=t.sent;case 17:if(!t.t0){t.next=24;break}return t.next=20,this.createCalendar();case 20:return o=t.sent,t.next=23,Ne.NativeStoragePromise.setItem(e.SYSTEM_CALENDAR_ID_KEY,o);case 23:return t.abrupt("return",this.getSelectedCalendar());case 24:return t.abrupt("return",r);case 25:case"end":return t.stop()}}),t,this)})))}}],(n=null)&&Xn(t.prototype,n),r&&Xn(t,r),e}();function tr(e){return function(e){if(Array.isArray(e))return nr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return nr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}er.NAME="echo",er.SYSTEM_CALENDAR_ID_KEY="system-calendar-id",er.WEBSITE="echo.silas.link";var ir=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},or=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"search",value:function(t,n,r,i,o,s,c){return ir(this,void 0,void 0,regeneratorRuntime.mark((function s(){var u,l,f,h,d,p=this;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Se.EasySyncClientDb.getInstance().createQueryBuilder(ue);case 2:return u=(u=(u=s.sent).leftJoinAndSelect("Event.repeatedEvent","repeatedEvent")).leftJoinAndSelect("repeatedEvent.originalEvent","originalEvent"),a.Helper.nonNull(c,!1)&&(u=(u=u.leftJoinAndSelect("Event.organisers","organisers")).leftJoinAndSelect("originalEvent.organisers","originalOrganisers")),a.Helper.isNotNull(t)&&""!==t.trim()&&(t="%"+t+"%",u=u.andWhere(new Ce.Brackets((function(e){e.orWhere("Event.names LIKE :searchString",{searchString:t}).orWhere("Event.descriptions LIKE :searchString",{searchString:t}).orWhere("Event.places LIKE :searchString",{searchString:t})})))),a.Helper.isNotNull(i)&&(Array.isArray(i)||(i=[i]),i.length>0&&(u=u.andWhere("Event.type IN (:...types)",{types:i}))),a.Helper.isNotNull(o)&&(Array.isArray(o)||(o=[o]),o.length>0&&(u=u.innerJoin("Event.organisers","organiser").andWhere("organiser.id IN(:...organisers)",{organisers:o}))),l=u.clone(),u=u.andWhere("(Event.isTemplate = 0 or Event.isTemplate = 'false')"),a.Helper.isNotNull(n)&&""!==n.trim()&&(u=u.andWhere("Event.endTime >= :beginTime",{beginTime:n})),a.Helper.isNotNull(r)&&""!==r.trim()&&(u=u.andWhere("Event.startTime < :endTime",{endTime:r})),f=u.getMany(),l=l.andWhere("(Event.isTemplate = 1 OR Event.isTemplate = 'true')"),a.Helper.isNotNull(n)&&""!==n.trim()&&(l=l.andWhere("(repeatedEvent.repeatUntil >= :beginTime OR repeatedEvent.repeatUntil IS NULL)",{beginTime:n})),a.Helper.isNotNull(r)&&""!==r.trim()&&(l=l.andWhere("repeatedEvent.startDate <= :endTime",{endTime:r})),s.next=19,l.getMany();case 19:return h=s.sent,n=a.Helper.isNull(n)||""===n.trim()?new Date:new Date(Date.parse(n.replace(" ","T"))),r=a.Helper.isNull(r)||""===r.trim()?new Date(n.getTime()+2592e6):new Date(Date.parse(r.replace(" ","T"))),d=[],s.next=25,a.Helper.asyncForEach(h,(function(t){return ir(p,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.repeatedEvent){i.next=7;break}return i.t0=d.push,i.t1=d,i.next=5,e.generateEventFromRepeatedEvent(t.repeatedEvent,n,r,!1,!1);case 5:i.t2=i.sent,i.t0.apply.call(i.t0,i.t1,i.t2);case 7:case"end":return i.stop()}}),i)})))}));case 25:return s.t0=d.push,s.t1=d,s.next=29,f;case 29:return s.t2=s.sent,s.t0.apply.call(s.t0,s.t1,s.t2),s.abrupt("return",d);case 32:case"end":return s.stop()}}),s)})))}},{key:"toggleFavorite",value:function(t){return ir(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,pr.toggle(t.id);case 2:if(!(r=n.sent).isFavorite){n.next=9;break}return n.next=6,Promise.all([e.setNotificationFor(r.id,t).catch(console.error),er.addEventToSystemCalendar(t).catch(console.error)]);case 6:return n.abrupt("return",!0);case 9:return i=Jn.getInstance(),n.next=12,i.cancelNotification(r.id);case 12:return n.next=14,er.deleteEventFromSystemCalendar(t);case 14:return n.abrupt("return",!1);case 15:case"end":return n.stop()}}),n)})))}},{key:"updateNotificationsForEvents",value:function(e){return ir(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ue.findByIds(e);case 2:return n=t.sent,r=Jn.getInstance(),t.next=6,pr.find({eventId:Object(Ce.In)(e)});case 6:return i=t.sent,o=[this.updateNotificationsForFavorites(i)],i=a.Helper.arrayToObject(i,(function(e){return e.eventId})),n.forEach((function(e){a.Helper.isNotNull(i[e.id])&&!1===i[e.id].isFavorite&&o.push(r.cancelNotification(i[e.id].id))})),t.next=12,Promise.all(o);case 12:case"end":return t.stop()}}),t,this)})))}},{key:"deleteNotificationsForEvents",value:function(e){return ir(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Jn.getInstance(),t.next=3,pr.find({eventId:Object(Ce.In)(e)});case 3:return r=t.sent,t.next=6,a.Helper.asyncForEach(r,(function(e){return ir(i,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.cancelNotification(e.id);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))}),!0);case 6:case"end":return t.stop()}}),t)})))}},{key:"updateNotificationsForFavorites",value:function(t){return ir(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!a.Helper.isNull(t)){n.next=4;break}return n.next=3,pr.find();case 3:t=n.sent;case 4:return n.next=6,pr.getEvents(t);case 6:return r=n.sent,n.next=9,a.Helper.asyncForEach(t,(function(t,n){return ir(i,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.isFavorite){i.next=3;break}return i.next=3,e.setNotificationFor(t.id,r[n]);case 3:case"end":return i.stop()}}),i)})))}),!0);case 9:case"end":return n.stop()}}),n)})))}},{key:"setNotificationFor",value:function(e,t){return ir(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,s,c,u,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([o.NativeStoragePromise.getItem("send-notifications","1"),o.NativeStoragePromise.getItem("time-to-notify-base",1),o.NativeStoragePromise.getItem("time-to-notify-multiplier",86400)]);case 2:if(r=n.sent,i=Jn.getInstance(),"0"!==r[0]){n.next=8;break}return n.next=7,i.cancelNotification(e);case 7:return n.abrupt("return");case 8:return o.Translator.getInstance().addDynamicTranslations(t.getDynamicTranslations()),n.next=11,t.getStartTime();case 11:if(s=n.sent,c=new Date,!(s.getTime()<c.getTime())){n.next=15;break}return n.abrupt("return");case 15:return(u=new Date).setTime(s.getTime()-parseInt(r[1])*parseInt(r[2])*1e3),l="",l=u.getFullYear()!==s.getFullYear()?a.DateHelper.strftime("%a., %d.%m.%y, %H:%M",s,void 0):u.getMonth()!==s.getMonth()?a.DateHelper.strftime("%a., %d.%m, %H:%M",s,void 0):u.getDate()===s.getDate()?o.Translator.translate("today")+a.DateHelper.strftime(", %H:%M",s):u.getDate()+1===s.getDate()?o.Translator.getInstance().translate("tomorrow")+a.DateHelper.strftime(", %H:%M",s):a.DateHelper.strftime("%a., %d.%m, %H:%M",s,void 0),n.next=21,i.schedule(e,t.getId(),o.Translator.translate(t.getNameTranslation()),l,u);case 21:case"end":return n.stop()}}),n)})))}},{key:"generateNextSingleEventFromRepeatedEvent",value:function(e,t){return ir(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,o,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Math.max((new Date).getTime(),e.getStartDate().getTime()),i=new Date(r),(o=new Date(r)).setDate(o.getDate()+7),n.next=6,this.generateEventFromRepeatedEvent(e,i,o,t);case 6:if(!((a=n.sent).length>=1)){n.next=11;break}return n.abrupt("return",a[0]);case 11:return n.abrupt("return",null);case 12:case"end":return n.stop()}}),n,this)})))}},{key:"generateSingleEventFromRepeatedEvent",value:function(e,t,n){return ir(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.generateEventFromRepeatedEvent(e,t,t,n);case 2:if(1!==(i=r.sent).length){r.next=7;break}return r.abrupt("return",i[0]);case 7:return r.abrupt("return",null);case 8:case"end":return r.stop()}}),r,this)})))}},{key:"generateEventFromRepeatedEvent",value:function(e,t,n,r,i){return ir(this,void 0,void 0,regeneratorRuntime.mark((function o(){var s,c,u,l,f,h,d,p,m,y,g,b;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=a.Helper.nonNull(r,!1),i=a.Helper.nonNull(i,!0),0===e.getRepeatingStrategy()){o.next=4;break}return o.abrupt("return",[]);case 4:return t.getTime()<e.getStartDate().getTime()&&(t=e.getStartDate()),t=new Date(t.getTime()),n=new Date(n.getTime()),t.setHours(0),i&&n.setHours(23),s=new Date(t.getTime()),c=a.DateHelper.strftime("%Y-%m-%d",t),u=a.DateHelper.strftime("%Y-%m-%d %H:%M",n),o.next=14,be.find({repeatedEvent:{id:e.id},day:Object(Ce.Between)(c,u)},null,null,null,be.getRelations());case 14:for(l=o.sent,f=a.Helper.arrayToObject(l,(function(e){return a.DateHelper.strftime("%Y-%m-%d",e.day)})),h=Object.keys(f),d=e.getRepeatingArguments().split(","),p=[],d.forEach((function(e){p.push(parseInt(e))})),s.setHours(e.getStartTime().getHours()),s.setMinutes(e.getStartTime().getMinutes()),s.setSeconds(e.getStartTime().getSeconds()),s.setMilliseconds(e.getStartTime().getMilliseconds()),m=e.getEndTime().getTime()-e.getStartTime().getTime(),y=[];t.getTime()<n.getTime()&&(i||s.getTime()<=n.getTime());)g=a.DateHelper.strftime("%Y-%m-%d",t),-1===h.indexOf(g)&&-1!==p.indexOf(t.getDay())?((b=new ue).id="r"+e.id+"-"+a.DateHelper.strftime("%Y-%m-%d",s),b.setRepeatedEvent(e),b.setStartTime(new Date(s.getTime())),b.setEndTime(new Date(s.getTime()+m)),b.setPlaces(null),b.setImages(null),y.push(b)):r&&-1!==h.indexOf(g)&&null!==f[g].event&&(f[g].event.repeatedEvent=e,y.push(f[g].event)),t.setDate(t.getDate()+1),s.setDate(s.getDate()+1);return o.abrupt("return",y);case 28:case"end":return o.stop()}}),o)})))}},{key:"updateFavorites",value:function(e){return ir(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],e.changed.forEach((function(e){n.push(e)})),t.next=4,be.findByIds(n,be.getRelations());case 4:return r=t.sent,i={},r.forEach((function(e){i["r"+e.repeatedEvent.id+"-"+a.DateHelper.strftime("%Y-%m-%d",e.day)]=e})),t.next=9,pr.find({eventId:Object(Ce.In)(Object.keys(i))});case 9:return o=t.sent,s=[],c=[],o.forEach((function(e){var t=i[e.eventId];t.event?(e.eventId=t.event.id,c.push(e)):s.push(e.id)})),t.next=15,Promise.all([pr.saveMany(c),Se.EasySyncClientDb.getInstance().deleteEntity(s,pr)]);case 15:case"end":return t.stop()}}),t)})))}},{key:"deleteEventsOlderThan",value:function(e){return ir(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ue.find({isTemplate:!1,endTime:Object(Ce.LessThan)(e.toString())},null,null,null,["images"]);case 2:return n=t.sent,r=[],n.forEach((function(e){r.push.apply(r,tr(e.getImages()))})),t.next=7,x.FileMedium.deleteMany(r);case 7:return t.next=9,ue.deleteMany(n);case 9:return t.t0=console,t.next=12,ue.find({isTemplate:!1,endTime:Object(Ce.LessThan)(e.toString())},null,null,null,["images"]);case 12:t.t1=t.sent,t.t0.log.call(t.t0,"events",t.t1);case 14:case"end":return t.stop()}}),t)})))}}],(n=null)&&rr(t.prototype,n),r&&rr(t,r),e}();function ar(e){return(ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cr(e,t,n){return(cr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hr(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ur(e,t){return(ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hr(e);if(t){var i=hr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return fr(this,n)}}function fr(e,t){return!t||"object"!==ar(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hr(e){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dr=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ur(e,t)}(Favorite,e);var t,n,r,i=lr(Favorite);function Favorite(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Favorite),(e=i.call(this)).isFavorite=!0,e.systemCalendarId=null,e}return t=Favorite,r=[{key:"getColumnDefinitions",value:function(){var e=cr(hr(Favorite),"getColumnDefinitions",this).call(this);return e.eventId={type:T.BaseDatabase.TYPES.STRING},e.isFavorite=T.BaseDatabase.TYPES.BOOLEAN,e.systemCalendarId={type:T.BaseDatabase.TYPES.INTEGER,nullable:!0},e}},{key:"getEvents",value:function(e){return dr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},r={},i={},e.forEach((function(e,t){if(e.eventId.startsWith("r")){var r=e.eventId.substr(1).split("-");n[r[0]]=X.Helper.nonNull(n[r[0]],[]),n[r[0]].push(t)}else i[parseInt(e.eventId)]=t})),(o=[]).push(xe.findByIds(Object.keys(n),xe.getRelations()).then((function(t){return dr(a,void 0,void 0,regeneratorRuntime.mark((function i(){var o=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,X.Helper.asyncForEach(t,(function(t){return dr(o,void 0,void 0,regeneratorRuntime.mark((function i(){var o,a=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=n[t.id],i.next=3,X.Helper.asyncForEach(o,(function(n){return dr(a,void 0,void 0,regeneratorRuntime.mark((function i(){var o,a;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o=e[n],4!==(a=o.eventId.substr(1).split("-")).length){i.next=8;break}return i.next=5,or.generateSingleEventFromRepeatedEvent(t,new Date(parseInt(a[1]),parseInt(a[2])-1,parseInt(a[3])),!0);case 5:r[n]=i.sent,i.next=9;break;case 8:r[n]=t;case 9:case"end":return i.stop()}}),i)})))}),!0);case 3:case"end":return i.stop()}}),i)})))}),!0);case 2:case"end":return i.stop()}}),i)})))}))),o.push(ue.findByIds(Object.keys(i),["repeatedEvent","repeatedEvent.originalEvent"]).then((function(e){e.forEach((function(e){var t=i[e.id];r[t]=e}))}))),t.next=9,Promise.all(o);case 9:return t.abrupt("return",Object.values(r));case 10:case"end":return t.stop()}}),t)})))}},{key:"eventIsFavorite",value:function(e){return dr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.findOne({eventId:e});case 2:return n=t.sent,t.abrupt("return",n instanceof Favorite&&n.isFavorite);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"toggle",value:function(e){return dr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.findOne({eventId:e});case 2:if(!((n=t.sent)instanceof Favorite)){t.next=9;break}return n.isFavorite=!n.isFavorite,t.next=7,n.save();case 7:t.next=13;break;case 9:return(n=new Favorite).eventId=e,t.next=13,n.save();case 13:return t.abrupt("return",n);case 14:case"end":return t.stop()}}),t,this)})))}}],(n=[{key:"getEvent",value:function(){return dr(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.eventId.startsWith("r")){e.next=12;break}return t=this.eventId.substr(1).split("-"),e.next=4,xe.findById(t[0]);case 4:if(n=e.sent,4!==t.length){e.next=9;break}return e.abrupt("return",or.generateSingleEventFromRepeatedEvent(n,new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]))));case 9:return e.abrupt("return",n);case 10:e.next=13;break;case 12:return e.abrupt("return",ue.findById(this.eventId));case 13:case"end":return e.stop()}}),e,this)})))}}])&&sr(t.prototype,n),r&&sr(t,r),Favorite}(T.BaseModel);function mr(e){return(mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function br(e,t){return(br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_r(e);if(t){var i=_r(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return wr(this,n)}}function wr(e,t){return!t||"object"!==mr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _r(e){return(_r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}T.BaseDatabase.addModel(pr);var kr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&br(e,t)}(o,e);var t,n,r,i=vr(o);function o(){return yr(this,o),i.apply(this,arguments)}return t=o,r=[{key:"setMonth",value:function(e,t,n){a.Helper.isNull(n)&&t instanceof Date&&(n=t,t=void 0);var r=(n=a.Helper.nonNull(n,new Date)).getDate();n.setDate(1),n.setMonth(e);var i=o.getNumberDaysOfMonth(n);return r>i&&(r=i),n.setDate(r),n}},{key:"getNumberDaysOfMonth",value:function(e){e instanceof Date||("number"==typeof e&&e<=11?(e=new Date).setMonth(e,1):e=new Date(e));var t=new Date(e);return t.setDate(1),t.setMonth(e.getMonth()+1),t.setDate(0),t.getDate()}}],(n=null)&&gr(t.prototype,n),r&&gr(t,r),o}(a.DateHelper);function Er(e){return(Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Or(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tr(e,t){return(Tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Cr(e);if(t){var i=Cr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Sr(this,n)}}function Sr(e,t){return!t||"object"!==Er(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cr(e){return(Cr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rr=n(283),Pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tr(e,t)}(a,e);var t,n,r,i=xr(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),n=i.call(this,Promise.all([Ue.ViewInflater.getInstance().load(Rr),$.find()]).then((function(r){var i=r[0];return n._possibleChurches=r[1].sort((function(e,t){o.Translator.getInstance().addDynamicTranslations(e.getDynamicTranslations()),o.Translator.getInstance().addDynamicTranslations(t.getDynamicTranslations());var n=o.Translator.getInstance().translate(e.getNameTranslation()),r=o.Translator.getInstance().translate(t.getNameTranslation());return n.toLowerCase().localeCompare(r.toLowerCase())})),n._types=X.Helper.nonNull(e,[]),n._churches=X.Helper.nonNull(t,[]),n._filterEventContainer=i.querySelector("#filter-event-tag-container"),n._filterOrganiserContainer=i.querySelector("#filter-organiser-tag-container"),n._filterTagTemplate=i.querySelector("#filter-tag-template"),n._filterTagTemplate.removeAttribute("id"),n._filterTagTemplate.remove(),i.querySelector("#search-button").addEventListener("click",(function(){n.applyFilter()})),n._filterTags(),i})),"Filter")}return t=a,(n=[{key:"_filterTags",value:function(){var e=this;vn.ViewHelper.removeAllChildren(this._filterEventContainer),vn.ViewHelper.removeAllChildren(this._filterOrganiserContainer),Object.values(ue.TYPES).sort((function(e,t){if(e===ue.TYPES.SONSTIGES)return 1;if(t===ue.TYPES.SONSTIGES)return-1;var n=o.Translator.getInstance().translate(e),r=o.Translator.getInstance().translate(t);return n.toLowerCase().localeCompare(r.toLowerCase())})).forEach((function(t){var n=e._filterTagTemplate.cloneNode(!0);n.appendChild(o.Translator.makePersistentTranslation(t)),n.dataset.type=t,-1!==e._types.indexOf(t)&&n.classList.add("selected"),n.addEventListener("click",(function(){var r=e._types.indexOf(t);-1===r?(e._types.push(t),n.classList.add("selected")):(e._types.splice(r,1),n.classList.remove("selected"))})),e._filterEventContainer.appendChild(n)})),o.Translator.getInstance().updateTranslations(this._filterEventContainer),this._possibleChurches.forEach((function(t){o.Translator.addDynamicTranslations(t.getDynamicTranslations());var n=e._filterTagTemplate.cloneNode(!0);n.appendChild(o.Translator.makePersistentTranslation(t.getNameTranslation())),n.dataset.churchId=String(t.id),-1!==e._churches.indexOf(t.id)&&n.classList.add("selected"),n.addEventListener("click",(function(){var r=e._churches.indexOf(t.id);-1===r?(e._churches.push(t.id),n.classList.add("selected")):(e._churches.splice(r,1),n.classList.remove("selected"))})),e._filterOrganiserContainer.appendChild(n)})),o.Translator.getInstance().updateTranslations(this._filterOrganiserContainer)}},{key:"applyFilter",value:function(){this._result={types:this._types,churches:this._churches},this.close()}}])&&Or(t.prototype,n),r&&Or(t,r),a}(Fe.Dialog);function Nr(e){return(Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ar(e,t,n){return(Ar="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Br(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function jr(e,t){return(jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ir(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Br(e);if(t){var i=Br(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Dr(this,n)}}function Dr(e,t){return!t||"object"!==Nr(t)&&"function"!=typeof t?Lr(e):t}function Lr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Br(e){return(Br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fr=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},qr=n(547),Vr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jr(e,t)}(s,e);var t,n,r,i=Ir(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e,qr))._date=new Date,t.getFooterFragment().setSelected(".icon.calendar"),t.favorites={},t._filter={},t._eventListFragment=new bn(Lr(t)),t._eventListFragment.setShowInPast(!1),t.addFragment("#event-overview",t._eventListFragment),t}return t=s,(n=[{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return Ar(Br(s.prototype),"onConstruct",t)}}});return Fr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.onConstruct.call(this,e),a.Helper.isSet(e,"date")&&(this._date=new Date(e.date)),t.next=4,pr.find();case 4:if(t.sent.forEach((function(e){i.favorites[e.eventId]=!0})),!a.Helper.isSet(e,"filter")){t.next=10;break}"string"==typeof e.filter?this._filter=JSON.parse(e.filter):this._filter=e.filter,t.next=13;break;case 10:return t.next=12,Ne.NativeStoragePromise.getItem("calendar-filter",{});case 12:this._filter=t.sent;case 13:return t.abrupt("return",r);case 14:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return Ar(Br(s.prototype),"onViewLoaded",e)}}});return Fr(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this._view.classList.add("calendar-site"),this._dayTemplate=this.findBy("#day-template"),this._dayContainer=this.findBy("#day-container"),this._dayTemplate.removeAttribute("id"),this._dayTemplate.remove(),this._eventOverviewContainer=this.findBy("#event-overview-container"),this._eventOverview=this.findBy("#event-overview"),this._monthNameElement=this.findBy("#month-name"),this.buttonLeft=this.findBy("#button-left"),this.buttonLeft.addEventListener("click",(function(){kr.setMonth(i._date.getMonth()-1,i._date),i.drawMonth(i._date)})),this.findBy("#button-right").addEventListener("click",(function(){kr.setMonth(i._date.getMonth()+1,i._date),i.drawMonth(i._date)})),(r=this.findBy("#button-filter")).addEventListener("click",(function(){return Fr(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Pr(this._filter.types,this._filter.churches).show();case 2:return t=e.sent,a.Helper.isNotNull(t)?this._filter=t:this._filter={},this._filter.types&&this._filter.types.length>0||this._filter.churches&&this._filter.churches.length>0?r.classList.add("active"):r.classList.remove("active"),this.setParameter("filter",JSON.stringify(this._filter)),e.next=8,this.drawMonth(this._date);case 8:return e.next=10,Ne.NativeStoragePromise.setItem("calendar-filter",this._filter);case 10:case"end":return e.stop()}}),e,this)})))})),(this._filter.types&&this._filter.types.length>0||this._filter.churches&&this._filter.churches.length>0)&&r.classList.add("active"),this.findBy("#icon-big-small .makeBig").addEventListener("click",(function(){return i.openEventList()})),this.findBy("#icon-big-small .makeSmall").addEventListener("click",(function(){return i.closeEventList()})),this.scrollContainer=this.findBy("#calendar-scroll-container"),this.scrollContainer.addEventListener("scroll",(function(e){i.scrollContainer.scrollTop>0?i.openEventList():i.closeEventList()})),e.abrupt("return",n);case 20:case"end":return e.stop()}}),e,this)})))}},{key:"openEventList",value:function(){this._eventOverviewContainer.classList.add("is-open"),this.scrollContainer.scroll(0,1)}},{key:"closeEventList",value:function(){this._eventOverviewContainer.classList.remove("is-open"),this.scrollContainer.scroll(0,0)}},{key:"loadEventsForMonth",value:function(e){return Fr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new Date(e)).setDate(1),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),(r=new Date(n)).setMonth(r.getMonth()+1),t.next=10,or.search("",kr.strftime("%Y-%m-%d",n),kr.strftime("%Y-%m-%d %H:%M:%S",r),this._filter.types,this._filter.churches,void 0,!0);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t,this)})))}},{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return Ar(Br(s.prototype),"onStart",t)}}});return Fr(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.drawMonth(this._date);case 2:return t.next=4,n.onStart.call(this,e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"drawMonth",value:function(e){return Fr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,s,c,u,l,f,h,d,p,m,y,g,b,v,w=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=["January","February","March","April","May","June","July","August","September","October","November","December"],r=e.getDate(),(e=new Date(a.Helper.nonNull(e,new Date))).setDate(1),i=new Date,s=e.getMonth(),c=i.getFullYear()===e.getFullYear()&&i.getMonth()===s,u=(e.getDay()+6)%7,l=kr.getNumberDaysOfMonth(e),f={},t.next=12,this.loadEventsForMonth(e);case 12:for(t.sent.forEach((function(e){var t=e.getStartTime().getDate(),n=e.getEndTime().getDate();s>e.getStartTime().getMonth()?t=1:s<e.getEndTime().getMonth()&&(n=l);for(var r=t-1;r<n;r++)f[r]||(f[r]=[]),f[r].push(e)})),cn.ViewHelper.removeAllChildren(this._monthNameElement),this._monthNameElement.appendChild(o.Translator.makePersistentTranslation(n[e.getMonth()])),this._monthNameElement.appendChild(document.createTextNode(" "+e.getFullYear())),cn.ViewHelper.removeAllChildren(this._dayContainer),h=0;h<u;h++)(d=this._dayTemplate.cloneNode(!0)).classList.add("oldMonth"),this._dayContainer.appendChild(d);for(p=function(t){var n=w._dayTemplate.cloneNode(!0);n.querySelector(".day-number").innerText=(t+1).toString(),c&&i.getDate()===t+1&&n.classList.add("today"),n.addEventListener("click",(function(){var r=w.findBy(".day.active");r&&r.classList.remove("active"),n.classList.add("active"),w.showEventOverviews(f[t]?f[t]:[]);var i=new Date(e);i.setDate(t+1),w._date=i,w.setParameter("date",kr.strftime("%Y-%m-%d",i))})),f[t]&&n.classList.add("has-event"),t+1===r&&(n.classList.add("active"),f[t]?w.showEventOverviews(f[t]):w.showEventOverviews([])),w._dayContainer.appendChild(n)},m=0;m<l;m++)p(m);for(y=u+l;y<37;y++)(g=this._dayTemplate.cloneNode(!0)).classList.add("nextMonth"),this._dayContainer.appendChild(g);return e.setDate(r),b=new O,v=window.getComputedStyle(this.findBy("#calendar")).getPropertyValue("height").replace("px",""),t.next=27,b.scaleHeightThroughWidth(this.findBy("#scale-container"),.73*parseFloat(v));case 27:this.setParameter("date",kr.strftime("%Y-%m-%d",e));case 28:case"end":return t.stop()}}),t,this)})))}},{key:"showEventOverviews",value:function(e){return Fr(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._eventListFragment.setEvents(e);case 2:case"end":return t.stop()}}),t,this)})))}}])&&Mr(t.prototype,n),r&&Mr(t,r),s}(w);o.App.addInitialization((function(e){e.addDeepLink("calendar",Vr)}));var Ur=n(295),Hr=n.n(Ur);function zr(e){return(zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wr(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Yr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qr(e,t,n){return(Qr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xr(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Gr(e,t){return(Gr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xr(e);if(t){var i=Xr(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Kr(this,n)}}function Kr(e,t){return!t||"object"!==zr(t)&&"function"!=typeof t?$r(e):t}function $r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xr(e){return(Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gr(e,t)}(s,e);var t,n,r,i,o,a=Jr(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e,Hr.a))._eventListFragment=new bn($r(t)),t.addFragment("#favorite-list",t._eventListFragment),t._footerFragment.setSelected(".icon.favorites"),t}return t=s,(n=[{key:"onStart",value:(i=regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Qr(Xr(s.prototype),"onStart",this).call(this,t),e.next=3,pr.find({isFavorite:!0},void 0,void 0,void 0);case 3:return r=e.sent,e.next=6,pr.getEvents(r);case 6:return i=e.sent,console.log("favorites",r,i),this._eventListFragment.setEvents(i),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Wr(o,n,r,a,s,"next",e)}function s(e){Wr(o,n,r,a,s,"throw",e)}a(void 0)}))},function(e){return o.apply(this,arguments)})}])&&Yr(t.prototype,n),r&&Yr(t,r),s}(w);function ei(e){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ti(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function ni(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ti(o,r,i,a,s,"next",e)}function s(e){ti(o,r,i,a,s,"throw",e)}a(void 0)}))}}function ri(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ii(e,t,n){return(ii="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ci(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function oi(e,t){return(oi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ai(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ci(e);if(t){var i=ci(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return si(this,n)}}function si(e,t){return!t||"object"!==ei(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ci(e){return(ci=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}o.App.addInitialization((function(e){e.addDeepLink("favorites",Zr)}));var ui=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oi(e,t)}(c,e);var t,n,r,i,a,s=ai(c);function c(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),s.call(this,e,u.a)}return t=c,(n=[{key:"onViewLoaded",value:(a=ni(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ii(ci(c.prototype),"onViewLoaded",this).call(this),this.findBy(".icon.home").addEventListener("click",(function(){n.getSite().startSite(uo)})),this.findBy(".icon.calendar").addEventListener("click",(function(){n.getSite().startSite(Vr)})),this.findBy(".icon.favorites").addEventListener("click",(function(){n.getSite().startSite(Zr)})),this.findBy(".icon.search").addEventListener("click",(function(){n.getSite().startSite(Pn)})),this.findBy(".icon",!0).forEach((function(e){e.addEventListener("click",(function(e){n.setSelected(e.target)}))})),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setSelected",value:(i=ni(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._viewPromise;case 2:n=this.findBy(".selected"),o.Helper.isNotNull(n)&&n.classList.remove("selected"),"string"==typeof t&&(t=this.findBy(t)),t&&t.classList.add("selected");case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}])&&ri(t.prototype,n),r&&ri(t,r),c}(o.AbstractFragment);function li(e){return(li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fi(e,t){return(fi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=mi(e);if(t){var i=mi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return di(this,n)}}function di(e,t){return!t||"object"!==li(t)&&"function"!=typeof t?pi(e):t}function pi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mi(e){return(mi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fi(e,t)}(n,e);var t=hi(n);function n(e,r,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e,r,i)).addDelegate(new o.MatomoDelegateSite(pi(a))),a}return n}(o.MenuSite);function gi(e){return(gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vi(e,t,n){return(vi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Oi(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function wi(e,t){return(wi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Oi(e);if(t){var i=Oi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ki(this,n)}}function ki(e,t){return!t||"object"!==gi(t)&&"function"!=typeof t?Ei(e):t}function Ei(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oi(e){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ti=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},xi=n(546),Si=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wi(e,t)}(o,e);var t,n,r,i=_i(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=i.call(this,e,t,xi)).getNavbarFragment().setBackgroundImage(""),n.footerFragment=new ui(Ei(n)),n.addFragment("#footer-fragment",n.footerFragment),n}return t=o,(n=[{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return vi(Oi(o.prototype),"onStart",t)}}});return Ti(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.onStart.call(this,e);case 2:window.StatusBar&&(window.StatusBar.overlaysWebView(!0),window.StatusBar.backgroundColorByHexString("#33000000"));case 3:case"end":return t.stop()}}),t,this)})))}}])&&bi(t.prototype,n),r&&bi(t,r),o}(yi);function Ci(e){return(Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ri(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pi(e,t,n){return(Pi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ji(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Ni(e,t){return(Ni=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ji(e);if(t){var i=ji(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ai(this,n)}}function Ai(e,t){return!t||"object"!==Ci(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ji(e){return(ji=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ii=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ni(e,t)}(Post,e);var t,n,r,i=Mi(Post);function Post(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Post),(e=i.call(this)).texts=null,e.priority=0,e}return t=Post,r=[{key:"getColumnDefinitions",value:function(){var e=Pi(ji(Post),"getColumnDefinitions",this).call(this);return e.texts=T.BaseDatabase.TYPES.MY_JSON,e.priority=T.BaseDatabase.TYPES.INTEGER,e}},{key:"getRelationDefinitions",value:function(){var e=x.EasySyncBaseModel.getRelationDefinitions();return e.regions={target:I.getSchemaName(),type:"many-to-many",joinTable:{name:"postRegion"},sync:!0},e}}],(n=[{key:"getTextTranslation",value:function(){return"post-text-"+this.id}},{key:"getDynamicTranslations",value:function(){var e=this,t={};return Object.keys(this.texts).forEach((function(n){t[n]=t[n]||{},t[n][e.getTextTranslation()]=e.texts[n]})),t}}])&&Ri(t.prototype,n),r&&Ri(t,r),Post}(AccessEasySyncModel.AccessEasySyncModel);Ii.ACCESS_MODIFY="posts",Ii.SCHEMA_NAME="Post",T.BaseDatabase.addModel(Ii);var Di=n(34),Li=n(139),Bi=n(69),Fi=n(296),qi=n.n(Fi);function Vi(e){return(Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ui(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Hi(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ui(o,r,i,a,s,"next",e)}function s(e){Ui(o,r,i,a,s,"throw",e)}a(void 0)}))}}function zi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wi(e,t,n){return(Wi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ki(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Yi(e,t){return(Yi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ki(e);if(t){var i=Ki(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Gi(this,n)}}function Gi(e,t){return!t||"object"!==Vi(t)&&"function"!=typeof t?Ji(e):t}function Ji(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ki(e){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $i=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yi(e,t)}(u,e);var t,n,r,i,a,s,c=Qi(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e,qi.a)).addDelegate(new zt.UserSite(Ji(t),"posts")),t}return t=u,(n=[{key:"onConstruct",value:(s=Hi(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Wi(Ki(u.prototype),"onConstruct",this).call(this,t),this._post=null,!t.id){e.next=7;break}return e.next=5,Ii.findById(t.id,$.getRelations());case 5:this._post=e.sent,console.log(this._post);case 7:return this._placeNumber=0,e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"onViewLoaded",value:(a=Hi(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Wi(Ki(u.prototype),"onViewLoaded",this).call(this),this._form=new o.Form(this.findBy("#modify-post-form"),function(){var e=Hi(regeneratorRuntime.mark((function e(t){var r,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.showLoadingSymbol(),r={},e.next=4,I.findById(1);case 4:return e.t0=e.sent,i=[e.t0],Object.keys(t).forEach((function(e){e.startsWith("text-")&&(r[e.split("-")[1]]=t[e])})),o=null,(o=n._post?n._post:new Ii).texts=r,o.regions=i,o.priority=parseInt(t.priority),e.next=14,o.save();case 14:n.removeLoadingSymbol(),n.finish();case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.findBy(".editor",!0).forEach(function(){var e=Hi(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=n._form,e.next=3,Yt.a.create(t,Qt.CK_EDITOR_POST_CONFIG);case 3:e.t1=e.sent,e.t0.addEditor.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=5,this.setFormValuesFromPost();case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setFormValuesFromPost",value:(i=Hi(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o.Helper.isNull(this._post)||!this._post instanceof Ii)){e.next=2;break}return e.abrupt("return");case 2:return t={},n=this._post.texts,Object.keys(n).forEach((function(e){t["text-"+e]=n[e]})),t.priority=this._post.priority,console.log(t),e.next=9,this._form.setValues(t);case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}])&&zi(t.prototype,n),r&&zi(t,r),u}(mt);function Xi(e){return(Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eo(e,t,n){return(eo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oo(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function to(e,t){return(to=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function no(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=oo(e);if(t){var i=oo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ro(this,n)}}function ro(e,t){return!t||"object"!==Xi(t)&&"function"!=typeof t?io(e):t}function io(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oo(e){return(oo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}o.App.addInitialization((function(e){e.addDeepLink("modifyPost",$i)}));var ao=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},so=n(544),co=n(545),uo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&to(e,t)}(o,e);var t,n,r,i=no(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,e,so)).getNavbarFragment().setCanGoBack(!1),t.footerFragment.setSelected(".icon.home"),t.getNavbarFragment().setBackgroundImage(co),t._eventListFragment=new bn(io(t)),t.addFragment("#favorite-list",t._eventListFragment),t}return t=o,(n=[{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return eo(oo(o.prototype),"onViewLoaded",e)}}});return ao(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this._postTemplate=this.findBy("#post-template"),this._postTemplate.remove(),this._postTemplate.removeAttribute("id"),this._postContainer=this.findBy("#post-container"),(r=this.findBy(".text-spoiler")).addEventListener("click",(function(){return r.classList.toggle("open")})),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"onStart",value:function(e){return ao(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ii.find(void 0,{priority:"DESC",createdAt:"ASC"});case 2:return this._posts=e.sent,this._posts=[],vn.ViewHelper.removeAllChildren(this._postContainer),this._posts.forEach((function(e){Kn.Translator.getInstance().addDynamicTranslations(e.getDynamicTranslations());var t=i._postTemplate.cloneNode(!0);t.querySelector(".text").appendChild(Kn.Translator.getInstance().makePersistentTranslation(e.getTextTranslation())),t.querySelector(".date").innerText=a.DateHelper.strftime("%d.%m.%y",e.createdAt),t.querySelector(".delete-button").addEventListener("click",(function(){return ao(i,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Di.UserManager.getInstance().hasAccess(ue.ACCESS_MODIFY)){t.next=8;break}return t.next=3,new Li.ConfirmDialog("Möchtest du den Post wirklich löschen? Er wird unwiederbringlich verloren gehen!","Post löschen?").show();case 3:if(!t.sent){t.next=8;break}return t.next=6,e.delete();case 6:new Bi.Toast("Post  wurde erfolgreich gelöscht").show(),this.finishAndStartSite(o);case 8:case"end":return t.stop()}}),t,this)})))})),t.querySelector(".modify-button").addEventListener("click",(function(){Di.UserManager.getInstance().hasAccess(Ii.ACCESS_MODIFY)&&i.startSite($i,{id:e.id})})),i._postContainer.appendChild(t)})),this._checkRightsPanel(),Kn.Translator.getInstance().updateTranslations(this._postContainer),t=new Date,(n=new Date).setDate(t.getDate()+7),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),e.next=17,or.search("",a.DateHelper.strftime("%Y-%m-%d",t),a.DateHelper.strftime("%Y-%m-%d",n),void 0,void 0,void 0,!0);case 17:r=e.sent,this._eventListFragment.setShowMaxEvents(1),this._eventListFragment.setEvents(r);case 20:case"end":return e.stop()}}),e,this)})))}},{key:"_checkRightsPanel",value:function(){var e=this;Di.UserManager.getInstance().addLoginChangeCallback((function(t,n){t&&n.hasAccess(ue.ACCESS_MODIFY)?e.findBy(".admin-panel",!0).forEach((function(e){return e.classList.remove("hidden")})):e.findBy(".admin-panel",!0).forEach((function(e){return e.classList.add("hidden")}))}),!0)}}])&&Zi(t.prototype,n),r&&Zi(t,r),o}(Si);function lo(e){return(lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ho(e,t,n){return(ho="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=go(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function po(e,t){return(po=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=go(e);if(t){var i=go(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return yo(this,n)}}function yo(e,t){return!t||"object"!==lo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function go(e){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bo=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},vo=n(569),wo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&po(e,t)}(o,e);var t,n,r,i=mo(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,e,vo)}return t=o,(n=[{key:"onViewLoaded",value:function(){var e=ho(go(o.prototype),"onViewLoaded",this).call(this);return this.find("#redirect-link").href=o.LINK,e}},{key:"onStart",value:function(e){var t=this,n=Object.create(null,{onStart:{get:function(){return ho(go(o.prototype),"onStart",t)}}});return bo(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.onStart.call(this,e);case 2:return r=t.sent,window.location.replace(o.LINK),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)})))}}])&&fo(t.prototype,n),r&&fo(t,r),o}(yi);wo.LINK="https://linktr.ee/EchoApp",o.App.addInitialization((function(e){e.addDeepLink("qr",wo)}));n(570),n(571);var _o=n(297),ko=n.n(_o);function Eo(e){return(Eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function To(e,t,n){return(To="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Po(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function xo(e,t){return(xo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function So(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Po(e);if(t){var i=Po(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Co(this,n)}}function Co(e,t){return!t||"object"!==Eo(t)&&"function"!=typeof t?Ro(e):t}function Ro(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Po(e){return(Po=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var No=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Mo=n(573),Ao=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xo(e,t)}(a,e);var t,n,r,i=So(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e,Mo)).addDelegate(new zt.UserSite(Ro(t),"organisers")),t}return t=a,(n=[{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return To(Po(a.prototype),"onConstruct",t)}}});return No(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.onConstruct.call(this,e),this._church=null,!e.id){t.next=6;break}return t.next=5,$.findById(e.id,$.getRelations());case 5:this._church=t.sent;case 6:return this._placeNumber=0,t.abrupt("return",r);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return To(Po(a.prototype),"onViewLoaded",e)}}});return No(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this._placesContainer=this.findBy("#places-container"),this._placesLineTemplate=this.findBy("#place-line-template"),this._placesLineTemplate.removeAttribute("id"),this._placesLineTemplate.remove(),this._placePreview=this.findBy("#place-preview"),(r=this.findBy("#event-image-input")).addEventListener("change",(function(){if(r.files&&r.files[0]){var e=new FileReader;e.onload=function(e){i.findBy("#event-image").src=e.target.result},e.readAsDataURL(r.files[0])}})),this._form=new o.Form(this.findBy("#modify-church-form"),(function(e){return No(i,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a,s,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},r={},i=o.Helper.imageUrlIsEmpty(e.image)?e["image-before"]:e.image,a={},t.next=6,I.findById(1);case 6:return t.t0=t.sent,s=[t.t0],Object.keys(e).forEach((function(t){if(t.startsWith("name-")&&(n[t.split("-")[1]]=e[t]),t.startsWith("description-")&&(r[t.split("-")[1]]=e[t].replace(/&nbsp;/g," ")),t.startsWith("place-name-")){var i=e["place-query-"+t.substring(11)];""===i.trim()&&(i=e[t]),a[e[t]]=i}})),c=null,c=this._church?this._church:new $,u=null,(u=c.images&&c.images.length>=0?c.images[0]:new FileMedium.FileMedium).src=i,t.next=16,u.save();case 16:return c.names=n,c.descriptions=r,c.images=[u],c.places=a,c.website=e["website-url"],c.regions=s,e.instagram&&""===e.instagram.trim()&&(e.instagram=null),c.setInstagram(e.instagram),t.next=26,c.save();case 26:this.finishAndStartSite(Ho,{id:c.id});case 27:case"end":return t.stop()}}),t,this)})))})),this.findBy(".editor",!0).forEach((function(e){return No(i,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=this._form,t.next=3,Yt.a.create(e,Qt.CK_EDITOR_CONFIG);case 3:t.t1=t.sent,t.t0.addEditor.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t,this)})))})),this.findBy("#add-place").addEventListener("click",(function(){i.addPlaceLine()})),this.addPlaceLine(),e.next=14,this.setFormValuesFromChurch();case 14:return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"addPlaceLine",value:function(){var e=this;this._placeNumber++;var t=this._placesLineTemplate.cloneNode(!0),n=t.querySelector(".place-name");n.name="place-name-"+this._placeNumber;var r=t.querySelector(".place-query");r.name="place-query-"+this._placeNumber,n.addEventListener("keyup",(function(e){r.placeholder=n.value,a()})),n.addEventListener("change",(function(e){r.placeholder=n.value,a()}));var i=null,a=function(){null!==i&&clearTimeout(i),i=setTimeout((function(){var t=nt._buildMapsLink(r.value||r.placeholder);e._placePreview.src!==t&&(e._placePreview.src=t)}),200)};n.addEventListener("focus",a),r.addEventListener("focus",a),r.addEventListener("change",a),r.addEventListener("keyup",a),t.querySelector(".remove-place").addEventListener("click",(function(){t.remove()})),this._placesContainer.appendChild(t),requestAnimationFrame((function(){n.focus()})),o.Translator.getInstance().updateTranslations(t)}},{key:"setFormValuesFromChurch",value:function(){return No(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.Helper.isNull(this._church)&&this._church instanceof $){e.next=2;break}return e.abrupt("return");case 2:return t={},n=this._church.getNames(),Object.keys(n).forEach((function(e){t["name-"+e]=n[e]})),r=this._church.getDescriptions(),Object.keys(r).forEach((function(e){t["description-"+e]=r[e]})),t["website-url"]=this._church.getWebsite(),this.findBy("#event-image").src=this._church.getImages()[0],this.findBy("input[type='hidden'][name='image-before']").value=this._church.getImages()[0],this.findBy("input[type='file'][name='image']").removeAttribute("required"),i=this._church.places,Array.isArray(i)&&(i=o.Helper.arrayToObject(i,(function(e){return e}))),Object.keys(i).forEach((function(e,n){if(n>0&&a.addPlaceLine(),t["place-name-"+(n+1)]=e,e!==i[e])t["place-query-"+(n+1)]=i[e];else{var r=a.findBy("[name='place-query-"+(n+1)+"']");r.placeholder=e,r.removeAttribute("data-translation-placeholder")}})),this._church.getInstagram()&&(t.instagram=this._church.getInstagram()),e.next=17,this._form.setValues(t);case 17:case"end":return e.stop()}}),e,this)})))}}])&&Oo(t.prototype,n),r&&Oo(t,r),a}(mt);function jo(e){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Io(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Do(e,t,n){return(Do="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qo(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Lo(e,t){return(Lo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qo(e);if(t){var i=qo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fo(this,n)}}function Fo(e,t){return!t||"object"!==jo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qo(e){return(qo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}o.App.addInitialization((function(e){e.addDeepLink("modifyChurch",Ao)}));var Vo=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Uo=n(572),Ho=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lo(e,t)}(a,e);var t,n,r,i=Bo(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e,Uo)).footerFragment.setSelected(".icon.home"),t}return t=a,(n=[{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return Do(qo(a.prototype),"onConstruct",t)}}});return Vo(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.onConstruct.call(this,e),(o.Helper.isNull(e)||o.Helper.isNull(e.id))&&(new o.Toast("no id given").show(),this.finish()),t.next=4,$.findById(parseInt(e.id),$.getRelations());case 4:return this._church=t.sent,o.Helper.isNull(this._church)&&(new o.Toast("no church found").show(),this.finish()),(i=this._church.getImages()).length>0&&this.getNavbarFragment().setBackgroundImage(i[0]),t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return Do(qo(a.prototype),"onViewLoaded",e)}}});return Vo(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,a,s,c,u,l,f,h=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.onViewLoaded.call(this),this._view.classList.add("church-site"),(r=o.Translator.getInstance()).addDynamicTranslations(this._church.getDynamicTranslations()),this.findBy("#name").appendChild(r.makePersistentTranslation(this._church.getNameTranslation(),!0)),this.findBy("#description").appendChild(r.makePersistentTranslation(this._church.getDescriptionTranslation())),i=this.findBy("#website"),(a=this._church.getWebsite()).startsWith("http")||a.startsWith("//")||(a="https://"+a),i.href=a,i.appendChild(document.createTextNode(this._church.getWebsite())),(s=this._church.getInstagram())&&(s.startsWith("http")||s.startsWith("//")||(s="https://"+s),(c=this.findBy("#instagram-link")).href=s,c.classList.remove("hidden")),u=this.findBy("#places-container"),l=this._church.places,f=!1,Array.isArray(l)||(l=Object.keys(l),f=!0),e.next=19,o.Helper.asyncForEach(l,(function(e){return Vo(h,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=u,t.next=3,nt.createPlace(e,f?this._church.places[e]:e);case 3:t.t1=t.sent,t.t0.appendChild.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t,this)})))}));case 19:return u.dataset.numPlaces=""+l.length,Di.UserManager.getInstance().addLoginChangeCallback((function(e,t){e&&t.hasAccess($.ACCESS_MODIFY)?h.findBy(".admin-panel").classList.remove("hidden"):h.findBy(".admin-panel").classList.add("hidden")}),!0),this.findBy("#delete-church").addEventListener("click",(function(){return Vo(h,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Di.UserManager.getInstance().hasAccess($.ACCESS_MODIFY)){e.next=8;break}return e.next=3,new o.ConfirmDialog("möchtest du die Kirche wirklich löschen? Sie wird unwiederbringlich verloren gehen!","Kirche löschen?").show();case 3:if(!e.sent){e.next=8;break}return e.next=6,this._church.delete();case 6:new o.Toast("Kirche wurde erfolgreich gelöscht").show(),this.finish();case 8:case"end":return e.stop()}}),e,this)})))})),this.findBy("#modify-church").addEventListener("click",(function(){return Vo(h,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Di.UserManager.getInstance().hasAccess($.ACCESS_MODIFY)&&this.finishAndStartSite(Ao,{id:this._church.id});case 1:case"end":return e.stop()}}),e,this)})))})),this.findBy("#view-calendar").addEventListener("click",(function(){h.startSite(Vr,{filter:{churches:[h._church.id]}})})),e.abrupt("return",n);case 25:case"end":return e.stop()}}),e,this)})))}}])&&Io(t.prototype,n),r&&Io(t,r),a}(Si);function zo(e){return(zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yo(e,t,n){return(Yo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ko(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Qo(e,t){return(Qo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Go(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ko(e);if(t){var i=Ko(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Jo(this,n)}}function Jo(e,t){return!t||"object"!==zo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ko(e){return(Ko=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}o.App.addInitialization((function(e){e.addDeepLink("church",Ho)}));var $o=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Xo=n(574),Zo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qo(e,t)}(s,e);var t,n,r,i=Go(s);function s(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),i.call(this,e,a.Helper.nonNull(t,Xo))}return t=s,(n=[{key:"onViewLoaded",value:function(){var e=this,t=Object.create(null,{onViewLoaded:{get:function(){return Yo(Ko(s.prototype),"onViewLoaded",e)}}});return $o(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.template=this.findBy(".info-template"),this.template.remove(),this.template.classList.remove("info-template"),e.abrupt("return",t.onViewLoaded.call(this));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"renderElement",value:function(e){var t=this;o.Translator.getInstance().addDynamicTranslations(e.getDynamicTranslations());var n=this.template.cloneNode(!0);return n.querySelector(".name").appendChild(o.Translator.makePersistentTranslation(e.getNameTranslation())),n.addEventListener("click",(function(){t.infoElemClicked(e.id)})),n}},{key:"infoElemClicked",value:function(e){}}])&&Wo(t.prototype,n),r&&Wo(t,r),s}(o.AlphabeticListFragment);function ea(e){return(ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ta(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function na(e,t,n){return(na="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=aa(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ra(e,t){return(ra=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ia(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=aa(e);if(t){var i=aa(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return oa(this,n)}}function oa(e,t){return!t||"object"!==ea(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aa(e){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ra(e,t)}(o,e);var t,n,r,i=ia(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,e,ko.a)}return t=o,(n=[{key:"renderElement",value:function(e){var t=na(aa(o.prototype),"renderElement",this).call(this,e),n=e.places,r=Array.isArray(n),i=n;return i||(i=Object.keys(n)),i.length>0&&(1===i.length?nt.createPlace(i[0],r?n[0]:n[i[0]],!0):nt.createMultipleLocationsView()).then((function(e){return t.querySelector(".place-container").appendChild(e)})),t}},{key:"infoElemClicked",value:function(e){this.getSite().startSite(Ho,{id:e})}}])&&ta(t.prototype,n),r&&ta(t,r),o}(Zo);function ca(e){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ua(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function la(e,t,n){return(la="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ma(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function fa(e,t){return(fa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ha(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ma(e);if(t){var i=ma(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return da(this,n)}}function da(e,t){return!t||"object"!==ca(t)&&"function"!=typeof t?pa(e):t}function pa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ma(e){return(ma=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ya=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ga=n(575),ba=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fa(e,t)}(a,e);var t,n,r,i=ha(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e,ga)).alphabeticListFragment=new sa(pa(t)),t.addFragment("#church-list",t.alphabeticListFragment),t._footerFragment.setSelected(".icon.home"),t}return t=a,(n=[{key:"onConstruct",value:function(e){var t=this,n=Object.create(null,{onConstruct:{get:function(){return la(ma(a.prototype),"onConstruct",t)}}});return ya(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i,a,s,c,u,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.onConstruct.call(this,e),i=[],e&&o.Helper.nonNull(e.regionIds,[]),a=[],!(i.length>=1)){t.next=10;break}return t.next=7,I.findByIds(i,I.getRelations());case 7:a=t.sent,t.next=13;break;case 10:return t.next=12,I.find(void 0,void 0,void 0,void 0,I.getRelations());case 12:a=t.sent;case 13:return s={},a.forEach((function(e){e.churches&&e.churches.forEach((function(e){s[e.id]=e}))})),c=o.Translator.getInstance().getCurrentLanguage(),u=o.Translator.getInstance().getFallbackLanguage(),l={},Object.values(s).forEach((function(e){var t=e.getNames(),n=o.Helper.nonNull(t[c],t[u],t[Object.keys(t)[0]],"");l[n+"-"+e.id]=e})),this.alphabeticListFragment.setElements(l),t.abrupt("return",r);case 21:case"end":return t.stop()}}),t,this)})))}},{key:"onViewLoaded",value:function(){var e=la(ma(a.prototype),"onViewLoaded",this).call(this),t=this.findBy("#church-list-heading");return t.remove(),this.alphabeticListFragment.setHeading(t),e}},{key:"goBack",value:function(){this.finishAndStartSite(uo)}}])&&ua(t.prototype,n),r&&ua(t,r),a}(mt);o.App.addInitialization((function(e){e.addDeepLink("churches",ba)}));var va=n(298),wa=n.n(va);function _a(e){return(_a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ka(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ea(e,t,n){return(Ea="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sa(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Oa(e,t){return(Oa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ta(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Sa(e);if(t){var i=Sa(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return xa(this,n)}}function xa(e,t){return!t||"object"!==_a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sa(e){return(Sa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ca=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oa(e,t)}(o,e);var t,n,r,i=Ta(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,e,wa.a)}return t=o,(n=[{key:"onViewLoaded",value:function(){var e=Ea(Sa(o.prototype),"onViewLoaded",this).call(this);return this.findBy("#open-cookie-settings").addEventListener("click",(function(){Xe.showCookieDialog()})),e}}])&&ka(t.prototype,n),r&&ka(t,r),o}(mt);Pe.App.addInitialization((function(e){e.addDeepLink("impressum",Ca)}));var Ra=n(213),Pa=(n(282),n(271),n(299)),Na=n.n(Pa);function Ma(e){return(Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Aa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ja=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ia=function(){function SetupSchema1000000000000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SetupSchema1000000000000)}var e,t,n;return e=SetupSchema1000000000000,(t=[{key:"_isServer",value:function(){return"object"!==("undefined"==typeof document?"undefined":Ma(document))}},{key:"_createManyToManyTable",value:function(e,t){return a.MigrationHelper.createManyToManyTable(e,t)}},{key:"up",value:function(e){return ja(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._addChurch(e);case 2:return t.next=4,this._addEvent(e);case 4:return t.next=6,this._addRegion(e);case 6:return t.next=8,this._addPost(e);case 8:return t.next=10,this._addChurchEvent(e);case 10:return t.next=12,this._addChurchRegion(e);case 12:return t.next=14,this._addEventRegion(e);case 14:return t.next=16,this._addPostRegion(e);case 16:return t.next=18,e.dropTable("Clear_Database_Migrations",!0);case 18:case"end":return t.stop()}}),t,this)})))}},{key:"_addChurch",value:function(e){return ja(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Ce.Table({name:"church",columns:[{name:"id",isPrimary:!0,type:T.BaseDatabase.TYPES.INTEGER,isGenerated:this._isServer(),generationStrategy:"increment"},{name:"createdAt",type:T.BaseDatabase.TYPES.DATE},{name:"updatedAt",type:T.BaseDatabase.TYPES.DATE},{name:"version",type:T.BaseDatabase.TYPES.INTEGER},{name:"deleted",type:T.BaseDatabase.TYPES.BOOLEAN},{name:"names",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"descriptions",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"places",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"images",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"website",type:T.BaseDatabase.TYPES.STRING}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_addEvent",value:function(e){return ja(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Ce.Table({name:"event",columns:[{name:"id",isPrimary:!0,type:T.BaseDatabase.TYPES.INTEGER,isGenerated:this._isServer(),generationStrategy:"increment"},{name:"createdAt",type:T.BaseDatabase.TYPES.DATE},{name:"updatedAt",type:T.BaseDatabase.TYPES.DATE},{name:"version",type:T.BaseDatabase.TYPES.INTEGER},{name:"deleted",type:T.BaseDatabase.TYPES.BOOLEAN},{name:"names",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"descriptions",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"places",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"images",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"startTime",type:T.BaseDatabase.TYPES.DATE},{name:"endTime",type:T.BaseDatabase.TYPES.DATE},{name:"type",type:T.BaseDatabase.TYPES.STRING}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_addRegion",value:function(e){return ja(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Ce.Table({name:"region",columns:[{name:"id",isPrimary:!0,type:T.BaseDatabase.TYPES.INTEGER,isGenerated:this._isServer(),generationStrategy:"increment"},{name:"createdAt",type:T.BaseDatabase.TYPES.DATE},{name:"updatedAt",type:T.BaseDatabase.TYPES.DATE},{name:"version",type:T.BaseDatabase.TYPES.INTEGER},{name:"deleted",type:T.BaseDatabase.TYPES.BOOLEAN},{name:"name",type:T.BaseDatabase.TYPES.STRING}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_addPost",value:function(e){return ja(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Ce.Table({name:"post",columns:[{name:"id",isPrimary:!0,type:T.BaseDatabase.TYPES.INTEGER,isGenerated:this._isServer(),generationStrategy:"increment"},{name:"createdAt",type:T.BaseDatabase.TYPES.DATE},{name:"updatedAt",type:T.BaseDatabase.TYPES.DATE},{name:"version",type:T.BaseDatabase.TYPES.INTEGER},{name:"deleted",type:T.BaseDatabase.TYPES.BOOLEAN},{name:"texts",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"priority",type:T.BaseDatabase.TYPES.INTEGER}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_addChurchEvent",value:function(e){return ja(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createTable(this._createManyToManyTable("church","event"),!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"_addChurchRegion",value:function(e){return ja(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createTable(this._createManyToManyTable("church","region"),!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"_addEventRegion",value:function(e){return ja(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createTable(this._createManyToManyTable("event","region"),!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"_addPostRegion",value:function(e){return ja(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createTable(this._createManyToManyTable("post","region"),!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"down",value:function(e){}}])&&Aa(e.prototype,t),n&&Aa(e,n),SetupSchema1000000000000}(),Da=n(300);function La(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ba=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Fa=function(){function SetupFavorite1000000000001(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SetupFavorite1000000000001)}var e,t,n;return e=SetupFavorite1000000000001,(t=[{key:"up",value:function(e){return Ba(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._addFavorite(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"_addFavorite",value:function(e){return Ba(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Ce.Table({name:"favorite",columns:[{name:"id",isPrimary:!0,type:"integer",isGenerated:!0,generationStrategy:"increment"},{name:"eventId",type:T.BaseDatabase.TYPES.INTEGER}],indices:[{name:"IDX_favorite_eventId",columnNames:["eventId"]}],foreignKeys:[{name:"FK_favorite_eventId",columnNames:["eventId"],referencedTableName:"event",referencedColumnNames:["id"]}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))}},{key:"down",value:function(e){}}])&&La(e.prototype,t),n&&La(e,n),SetupFavorite1000000000001}(),qa=n(24);function Va(e){return(Va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ua(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ha=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},za=function(){function FsjSchema1000000006000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FsjSchema1000000006000)}var e,t,n;return e=FsjSchema1000000006000,(t=[{key:"_isServer",value:function(){return"object"!==("undefined"==typeof document?"undefined":Va(document))}},{key:"_createManyToManyTable",value:function(e,t){return qa.MigrationHelper.createManyToManyTable(e,t)}},{key:"up",value:function(e){return Ha(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._addFsj(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"_addFsj",value:function(e){return Ha(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Ce.Table({name:"fsj",columns:[{name:"id",isPrimary:!0,type:T.BaseDatabase.TYPES.INTEGER,isGenerated:this._isServer(),generationStrategy:"increment"},{name:"createdAt",type:T.BaseDatabase.TYPES.DATE},{name:"updatedAt",type:T.BaseDatabase.TYPES.DATE},{name:"version",type:T.BaseDatabase.TYPES.INTEGER},{name:"deleted",type:T.BaseDatabase.TYPES.BOOLEAN},{name:"names",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"descriptions",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"images",type:this._isServer()?T.BaseDatabase.TYPES.MEDIUMTEXT:T.BaseDatabase.TYPES.TEXT},{name:"website",type:T.BaseDatabase.TYPES.STRING}]}),t.next=3,e.createTable(n,!0);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"down",value:function(e){}}])&&Ua(e.prototype,t),n&&Ua(e,n),FsjSchema1000000006000}(),Wa=n(301),Ya=n.n(Wa);function Qa(e){return(Qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ja(e,t){return(Ja=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xa(e);if(t){var i=Xa(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return $a(this,n)}}function $a(e,t){return!t||"object"!==Qa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xa(e){return(Xa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Za=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ja(e,t)}(Fsj,e);var t,n,r,i=Ka(Fsj);function Fsj(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Fsj),i.call(this)}return t=Fsj,r=[{key:"getRelationDefinitions",value:function(){var e=x.EasySyncBaseModel.getRelationDefinitions();return e.images={target:x.FileMedium.getSchemaName(),type:"many-to-many",joinTable:{name:"fsjImages"},sync:!0},e}}],(n=null)&&Ga(t.prototype,n),r&&Ga(t,r),Fsj}(H);Za.ACCESS_MODIFY="fsjs",Za.SCHEMA_NAME="Fsj",T.BaseDatabase.addModel(Za);var es=n(302),ts=n.n(es);function ns(e){return(ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rs(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function is(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){rs(o,r,i,a,s,"next",e)}function s(e){rs(o,r,i,a,s,"throw",e)}a(void 0)}))}}function os(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function as(e,t,n){return(as="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ls(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ss(e,t){return(ss=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ls(e);if(t){var i=ls(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return us(this,n)}}function us(e,t){return!t||"object"!==ns(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ls(e){return(ls=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fs(e){return(fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hs(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function ds(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){hs(o,r,i,a,s,"next",e)}function s(e){hs(o,r,i,a,s,"throw",e)}a(void 0)}))}}function ps(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ms(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ys(e,t){return(ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vs(e);if(t){var i=vs(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return bs(this,n)}}function bs(e,t){return!t||"object"!==fs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vs(e){return(vs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ws=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ys(e,t)}(s,e);var t,n,r,i,o,a=gs(s);function s(){return ps(this,s),a.apply(this,arguments)}return t=s,(n=[{key:"_loadElem",value:(o=ds(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Za.findById(t,Za.getRelations());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"_deleteElem",value:(i=ds(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Di.UserManager.getInstance().hasAccess(Za.ACCESS_MODIFY)){e.next=8;break}return e.next=3,new Li.ConfirmDialog("Möchtest du das FSJ wirklich löschen? Es wird unwiederbringlich verloren gehen!","FSJ löschen?").show();case 3:if(!e.sent){e.next=8;break}return e.next=6,this._element.delete();case 6:new Bi.Toast("FSJ wurde erfolgreich gelöscht").show(),this.finish();case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"_modifyElem",value:function(){Di.UserManager.getInstance().hasAccess(Za.ACCESS_MODIFY)&&this.finishAndStartSite(Ns,{id:this._element.id})}}])&&ms(t.prototype,n),r&&ms(t,r),s}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ss(e,t)}(u,e);var t,n,r,i,a,s,c=cs(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e,ts.a)).footerFragment.setSelected(".icon.home"),t}return t=u,(n=[{key:"setElement",value:function(e){if(this._element=e,o.Helper.isNull(this._element))return new o.Toast("no element found").show(),void this.finish();var t=this._element.images;t.length>0&&this._navbarFragment.setBackgroundImage(t[0])}},{key:"onConstruct",value:(s=is(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=as(ls(u.prototype),"onConstruct",this).call(this,t),!o.Helper.isNull(t)&&!o.Helper.isNull(t.id)){e.next=5;break}return new o.Toast("no id given").show(),this.finish(),e.abrupt("return");case 5:return e.next=7,this._loadElem(parseInt(t.id));case 7:return r=e.sent,this.setElement(r),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"onViewLoaded",value:(a=is(regeneratorRuntime.mark((function e(){var t,n,r,i,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=as(ls(u.prototype),"onViewLoaded",this).call(this),(n=o.Translator.getInstance()).addDynamicTranslations(this._element.getDynamicTranslations()),this.findBy("#name").appendChild(n.makePersistentTranslation(this._element.getNameTranslation(),!0)),this.findBy("#description").appendChild(n.makePersistentTranslation(this._element.getDescriptionTranslation())),r=this.findBy("#website"),(i=this._element.website).startsWith("http")||i.startsWith("//")||(i="https://"+i),r.href=i,r.appendChild(document.createTextNode(this._element.website)),Di.UserManager.getInstance().addLoginChangeCallback((function(e,t){e&&t.hasAccess($.ACCESS_MODIFY)?a.findBy(".admin-panel").classList.remove("hidden"):a.findBy(".admin-panel").classList.add("hidden")}),!0),this.findBy("#delete-elem").addEventListener("click",is(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a._deleteElem();case 1:case"end":return e.stop()}}),e)})))),this.findBy("#modify-elem").addEventListener("click",is(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a._modifyElem();case 1:case"end":return e.stop()}}),e)})))),e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"_loadElem",value:(i=is(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("needs to be overriden! - loadElem");case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"_deleteElem",value:function(){throw new Error("needs to be overriden! - deleteElem")}},{key:"_modifyElem",value:function(){throw new Error("needs to be overriden! - modifyElem")}}])&&os(t.prototype,n),r&&os(t,r),u}(Si));function _s(e){return(_s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ks(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Es(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ks(o,r,i,a,s,"next",e)}function s(e){ks(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Os(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ts(e,t,n){return(Ts="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ps(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function xs(e,t){return(xs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ss(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ps(e);if(t){var i=Ps(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Cs(this,n)}}function Cs(e,t){return!t||"object"!==_s(t)&&"function"!=typeof t?Rs(e):t}function Rs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ps(e){return(Ps=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Pe.App.addInitialization((function(e){e.addDeepLink("fsj",ws)}));var Ns=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xs(e,t)}(u,e);var t,n,r,i,a,s,c=Ss(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this,e,Ya.a)).addDelegate(new zt.UserSite(Rs(t),"fsjs")),t}return t=u,(n=[{key:"onConstruct",value:(s=Es(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Ts(Ps(u.prototype),"onConstruct",this).call(this,t),this._fsj=null,!t.id){e.next=6;break}return e.next=5,Za.findById(t.id,Za.getRelations());case 5:this._fsj=e.sent;case 6:return this._placeNumber=0,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"onViewLoaded",value:(a=Es(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ts(Ps(u.prototype),"onViewLoaded",this).call(this),(n=this.findBy("#event-image-input")).addEventListener("change",(function(){if(n.files&&n.files[0]){var e=new FileReader;e.onload=function(e){r.findBy("#event-image").src=e.target.result},e.readAsDataURL(n.files[0])}})),this._form=new o.Form(this.findBy("#modify-fsj-form"),function(){var e=Es(regeneratorRuntime.mark((function e(t){var n,i,a,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.showLoadingSymbol(),n={},i={},a=o.Helper.imageUrlIsEmpty(t.image)?t["image-before"]:t.image,Object.keys(t).forEach((function(e){e.startsWith("name-")&&(n[e.split("-")[1]]=t[e]),e.startsWith("description-")&&(i[e.split("-")[1]]=t[e])})),s=null,s=r._fsj?r._fsj:new Za,c=null,(c=s.images&&s.images.length>=0?s.images[0]:new x.FileMedium).src=a,e.next=12,c.save();case 12:return s.names=n,s.descriptions=i,s.website=t["website-url"],s.images=[c],e.next=18,s.save();case 18:r.finishAndStartSite(ws,{id:s.id});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.findBy(".editor",!0).forEach(function(){var e=Es(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=r._form,e.next=3,Yt.a.create(t,Qt.CK_EDITOR_CONFIG);case 3:e.t1=e.sent,e.t0.addEditor.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=7,this.setFormValuesFromFsj();case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setFormValuesFromFsj",value:(i=Es(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o.Helper.isNull(this._fsj)||!this._fsj instanceof Za)){e.next=2;break}return e.abrupt("return");case 2:return t={},n=this._fsj.names,Object.keys(n).forEach((function(e){t["name-"+e]=n[e]})),r=this._fsj.descriptions,Object.keys(r).forEach((function(e){t["description-"+e]=r[e]})),t["website-url"]=this._fsj.website,this.findBy("#event-image").src=this._fsj.images[0],this.findBy("input[type='hidden'][name='image-before']").value=this._fsj.images[0],this.findBy("input[type='file'][name='image']").removeAttribute("required"),e.next=13,this._form.setValues(t);case 13:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}])&&Os(t.prototype,n),r&&Os(t,r),u}(mt);o.App.addInitialization((function(e){e.addDeepLink("modifyFsj",Ns)}));var Ms=n(303),As=n.n(Ms);function js(e){return(js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Is(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ls(e,t){return(Ls=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qs(e);if(t){var i=qs(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Fs(this,n)}}function Fs(e,t){return!t||"object"!==js(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qs(e){return(qs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ls(e,t)}(o,e);var t,n,r,i=Bs(o);function o(){return Is(this,o),i.apply(this,arguments)}return t=o,(n=[{key:"infoElemClicked",value:function(e){this.getSite().startSite(ws,{id:e})}}])&&Ds(t.prototype,n),r&&Ds(t,r),o}(Zo);function Us(e){return(Us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hs(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function zs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ws(e,t,n){return(Ws="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ks(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Ys(e,t){return(Ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ks(e);if(t){var i=Ks(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Gs(this,n)}}function Gs(e,t){return!t||"object"!==Us(t)&&"function"!=typeof t?Js(e):t}function Js(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ks(e){return(Ks=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ys(e,t)}(c,e);var t,n,r,i,a,s=Qs(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e,As.a))._alphabeticListFragment=new Vs(Js(t)),t.addFragment("#fsj-list",t._alphabeticListFragment),t._footerFragment.setSelected(".icon.home"),t}return t=c,(n=[{key:"onConstruct",value:(i=regeneratorRuntime.mark((function e(t){var n,r,i,a,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ws(Ks(c.prototype),"onConstruct",this).call(this,t),e.next=3,Za.find();case 3:return r=e.sent,i=o.Helper.arrayToObject(r,(function(e){return e.id})),a=o.Translator.getInstance().getCurrentLanguage(),s=o.Translator.getInstance().getFallbackLanguage(),u={},Object.values(i).forEach((function(e){var t=o.Helper.nonNull(e.names[a],e.names[s],e.names[Object.keys(e.names)[0]],"");u[t+"-"+e.id]=e})),this._alphabeticListFragment.setElements(u),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Hs(o,n,r,a,s,"next",e)}function s(e){Hs(o,n,r,a,s,"throw",e)}a(void 0)}))},function(e){return a.apply(this,arguments)})},{key:"goBack",value:function(){this.finishAndStartSite(uo)}}])&&zs(t.prototype,n),r&&zs(t,r),c}(mt);function Xs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}o.App.addInitialization((function(e){e.addDeepLink("fsjs",$s)}));var Zs=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},FavoriteWithSystemCalendar1000000000002=function(){function FavoriteWithSystemCalendar1000000000002(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FavoriteWithSystemCalendar1000000000002)}var e,t,n;return e=FavoriteWithSystemCalendar1000000000002,(t=[{key:"up",value:function(e){return Zs(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._changeFavorite(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"_changeFavorite",value:function(e){return Zs(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.query("ALTER TABLE favorite ADD isFavorite boolean NOT NULL DEFAULT true");case 2:return t.next=4,e.query("ALTER TABLE favorite ADD systemCalendarId INTEGER");case 4:case"end":return t.stop()}}),t)})))}},{key:"down",value:function(e){}}])&&Xs(e.prototype,t),n&&Xs(e,n),FavoriteWithSystemCalendar1000000000002}(),ec=n(304),tc=n.n(ec),nc=n(68),rc=n(211);function ic(e){return(ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ac(e,t,n){return(ac="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lc(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function sc(e,t){return(sc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lc(e);if(t){var i=lc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return uc(this,n)}}function uc(e,t){return!t||"object"!==ic(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lc(e){return(lc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fc=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},hc=n(576),dc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sc(e,t)}(o,e);var t,n,r,i=cc(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,e,hc)}return t=o,(n=[{key:"onViewLoaded",value:function(){var e,t=this,n=Object.create(null,{onViewLoaded:{get:function(){return ac(lc(o.prototype),"onViewLoaded",t)}}});return fc(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i,o,s,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.onViewLoaded.call(this),t.next=3,er.getSelectedCalendar();case 3:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=7;break}t.t0=void 0===e;case 7:if(!t.t0){t.next=11;break}t.t2=void 0,t.next=12;break;case 11:t.t2=e.name;case 12:return i=t.t2,a.Helper.isNull(i)&&(i=""),this.findBy("#system-calendar").innerText=i,(o=this.findBy("#system-calendar-line")).addEventListener("click",(function(){return fc(c,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectNewCalendar();case 2:i=e.sent;case 3:case"end":return e.stop()}}),e,this)})))})),t.next=19,Ne.NativeStoragePromise.getItem("insert-favorites","1");case 19:if(s=t.sent,this.insertFavoritesCheckbox=this.findBy("#insert-favorites"),this.insertFavoritesCheckbox.addEventListener("change",(function(){return fc(c,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.insertFavoritesCheckbox.checked){e.next=17;break}return o.classList.remove("hidden"),e.next=4,Ne.NativeStoragePromise.setItem("insert-favorites","1");case 4:if(""!==i){e.next=15;break}return e.next=7,this.selectNewCalendar();case 7:return i=e.sent,e.next=10,er.hasCalendarPermission();case 10:if(e.sent){e.next=15;break}return e.next=13,Ne.NativeStoragePromise.setItem("insert-favorites","0");case 13:o.classList.add("hidden"),this.insertFavoritesCheckbox.checked=!1;case 15:e.next=20;break;case 17:return o.classList.add("hidden"),e.next=20,Ne.NativeStoragePromise.setItem("insert-favorites","0");case 20:case"end":return e.stop()}}),e,this)})))})),t.t3="0"===s,t.t3){t.next=27;break}return t.next=26,er.hasCalendarPermission();case 26:t.t3=!t.sent;case 27:if(!t.t3){t.next=30;break}this.insertFavoritesCheckbox.checked=!1,o.classList.add("hidden");case 30:return t.abrupt("return",r);case 31:case"end":return t.stop()}}),t,this)})))}},{key:"selectNewCalendar",value:function(){return fc(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.getSite().showLoadingSymbol(),e.next=3,this.getCalendarOptions();case 3:return t=e.sent,e.next=6,er.hasCalendarPermission();case 6:if(e.sent){e.next=9;break}return this.getSite().removeLoadingSymbol(),e.abrupt("return","");case 9:return e.next=11,new rc.ChooseDialog(t,"select-calendar",!1).show();case 11:if(n=e.sent,this.getSite().removeLoadingSymbol(),!n){e.next=18;break}return this.findBy("#system-calendar").innerText=t[n],e.next=17,Ne.NativeStoragePromise.setItem(er.SYSTEM_CALENDAR_ID_KEY,n);case 17:return e.abrupt("return",t[n]);case 18:return e.abrupt("return","");case 19:case"end":return e.stop()}}),e,this)})))}},{key:"getCalendarOptions",value:function(){return fc(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,er.listCalendars();case 2:return t=e.sent,n={},r=!0,t.forEach((function(e){n[e.id]=e.name,e.name===er.NAME&&(r=!1)})),r&&(n[-1]=er.NAME),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})))}}])&&oc(t.prototype,n),r&&oc(t,r),o}(nc.AbstractFragment),pc=n(305),mc=n.n(pc);function yc(e){return(yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gc(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function bc(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){gc(o,r,i,a,s,"next",e)}function s(e){gc(o,r,i,a,s,"throw",e)}a(void 0)}))}}function vc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wc(e,t,n){return(wc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Oc(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _c(e,t){return(_c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Oc(e);if(t){var i=Oc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ec(this,n)}}function Ec(e,t){return!t||"object"!==yc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oc(e){return(Oc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_c(e,t)}(a,e);var t,n,r,i,o=kc(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,e,mc.a)}return t=a,(n=[{key:"onViewLoaded",value:(i=bc(regeneratorRuntime.mark((function e(){var t,n,r,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=wc(Oc(a.prototype),"onViewLoaded",this).call(this),e.next=3,Promise.all([Ne.NativeStoragePromise.getItem("send-notifications","1"),Ne.NativeStoragePromise.getItem("time-to-notify-base","1"),Ne.NativeStoragePromise.getItem("time-to-notify-multiplier","86400")]);case 3:return n=e.sent,this._timeBeforeNotificationRow=this.findBy("#time-before-setting-row"),this._sendNotificationCheckbox=this.findBy("#send-notifications"),this._sendNotificationCheckbox.addEventListener("change",bc(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o._sendNotificationCheckbox.checked){e.next=8;break}return o._timeBeforeNotificationRow.classList.remove("hidden"),e.next=4,Ne.NativeStoragePromise.setItem("send-notifications","1");case 4:return e.next=6,or.updateNotificationsForFavorites();case 6:e.next=13;break;case 8:return o._timeBeforeNotificationRow.classList.add("hidden"),e.next=11,Ne.NativeStoragePromise.setItem("send-notifications","0");case 11:return e.next=13,Jn.getInstance().cancelAllNotifications();case 13:case"end":return e.stop()}}),e)})))),"0"===n[0]&&(this._sendNotificationCheckbox.checked=!1,this._timeBeforeNotificationRow.classList.add("hidden")),r=this.findBy("#after"),i=this.findBy("#multiplier"),n[1]&&(r.value=n[1]),n[2]&&(i.value=n[2]),r.addEventListener("change",(function(){Ne.NativeStoragePromise.setItem("time-to-notify-base",parseInt(r.value))})),i.addEventListener("change",(function(){Ne.NativeStoragePromise.setItem("time-to-notify-multiplier",parseInt(i.value))})),e.abrupt("return",t);case 15:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}])&&vc(t.prototype,n),r&&vc(t,r),a}(nc.AbstractFragment);function xc(e){return(xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sc(e,t){return(Sc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Nc(e);if(t){var i=Nc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Rc(this,n)}}function Rc(e,t){return!t||"object"!==xc(t)&&"function"!=typeof t?Pc(e):t}function Pc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nc(e){return(Nc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sc(e,t)}(n,e);var t=Cc(n);function n(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=t.call(this,e,tc.a)).addFragment("#systemCalendarSettings",new dc(Pc(r))),r.addFragment("#notificationsSettings",new Tc(Pc(r))),r}return n}(mt);function Ac(e){return(Ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ic(e,t,n){return(Ic="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fc(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Dc(e,t){return(Dc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fc(e);if(t){var i=Fc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Bc(this,n)}}function Bc(e,t){return!t||"object"!==Ac(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fc(e){return(Fc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Pe.App.addInitialization((function(e){e.addDeepLink("settings",Mc)}));var qc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dc(e,t)}(Region,e);var t,n,r,i=Lc(Region);function Region(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Region),(e=i.call(this)).name=null,e.churches=null,e.events=null,e}return t=Region,r=[{key:"getColumnDefinitions",value:function(){var e=Ic(Fc(Region),"getColumnDefinitions",this).call(this);return e.name={type:T.BaseDatabase.TYPES.STRING},e}},{key:"getRelationDefinitions",value:function(){var e=x.EasySyncBaseModel.getRelationDefinitions();return e.churches={target:tu.getSchemaName(),type:"many-to-many",joinTable:{name:"churchRegion"},inverseSide:"regions",sync:!1},e.events={target:lu.getSchemaName(),type:"many-to-many",joinTable:{name:"eventRegion"},inverseSide:"regions",sync:!1},e}}],(n=[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"setChurches",value:function(e){this.churches=e}},{key:"getChurches",value:function(){return this.churches}}])&&jc(t.prototype,n),r&&jc(t,r),Region}(AccessEasySyncModel.AccessEasySyncModel);function Vc(e){return(Vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hc(e,t,n){return(Hc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qc(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function zc(e,t){return(zc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qc(e);if(t){var i=Qc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Yc(this,n)}}function Yc(e,t){return!t||"object"!==Vc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qc(e){return(Qc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gc(e){return(Gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kc(e,t,n){return(Kc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eu(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function $c(e,t){return($c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=eu(e);if(t){var i=eu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Zc(this,n)}}function Zc(e,t){return!t||"object"!==Gc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eu(e){return(eu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}qc.ACCESS_MODIFY="admin",qc.SCHEMA_NAME="Region";var tu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$c(e,t)}(Church,e);var t,n,r,i=Xc(Church);function Church(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Church),(e=i.call(this)).places=[],e}return t=Church,r=[{key:"getColumnDefinitions",value:function(){var e=Kc(eu(Church),"getColumnDefinitions",this).call(this);return e.places=T.BaseDatabase.TYPES.MY_JSON,e}},{key:"getRelationDefinitions",value:function(){var e=EasySyncBaseModel.EasySyncBaseModel.getRelationDefinitions();return e.regions={target:qc.getSchemaName(),type:"many-to-many",joinTable:{name:"churchRegion"},sync:!0},e}}],(n=null)&&Jc(t.prototype,n),r&&Jc(t,r),Church}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zc(e,t)}(FsjChurchBaseObject,e);var t,n,r,i=Wc(FsjChurchBaseObject);function FsjChurchBaseObject(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FsjChurchBaseObject),(e=i.call(this)).names=[],e.descriptions=[],e.images=[],e.website=null,e}return t=FsjChurchBaseObject,r=[{key:"getColumnDefinitions",value:function(){var e=Hc(Qc(FsjChurchBaseObject),"getColumnDefinitions",this).call(this);return e.names=T.BaseDatabase.TYPES.MY_JSON,e.descriptions=T.BaseDatabase.TYPES.MY_JSON,e.images=T.BaseDatabase.TYPES.MY_JSON,e.website=T.BaseDatabase.TYPES.STRING,e}}],(n=[{key:"getNameTranslation",value:function(){return this.constructor.getSchemaName()+"-name-"+this.id}},{key:"getDescriptionTranslation",value:function(){return this.constructor.getSchemaName()+"-description-"+this.id}},{key:"getDynamicTranslations",value:function(){var e=this,t={};return Object.keys(this.names).forEach((function(n){t[n]=t[n]||{},t[n][e.getNameTranslation()]=e.names[n]})),Object.keys(this.descriptions).forEach((function(n){t[n]=t[n]||{},t[n][e.getDescriptionTranslation()]=e.descriptions[n]})),t}}])&&Uc(t.prototype,n),r&&Uc(t,r),FsjChurchBaseObject}(AccessEasySyncModel.AccessEasySyncModel));function nu(e){return(nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ru(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iu(e,t,n){return(iu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cu(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ou(e,t){return(ou=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function au(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cu(e);if(t){var i=cu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return su(this,n)}}function su(e,t){return!t||"object"!==nu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cu(e){return(cu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}tu.ACCESS_MODIFY="admin",tu.SCHEMA_NAME="Church";var uu=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},lu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ou(e,t)}(Event,e);var t,n,r,i=au(Event);function Event(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Event),(e=i.call(this)).names=null,e.descriptions=null,e.startTime=null,e.endTime=null,e.type=null,e.images=[],e.organisers=null,e.places=[],e.regions=null,e}return t=Event,r=[{key:"getColumnDefinitions",value:function(){var e=iu(cu(Event),"getColumnDefinitions",this).call(this);return e.names={type:T.BaseDatabase.TYPES.MY_JSON,nullable:!0},e.descriptions={type:T.BaseDatabase.TYPES.MY_JSON,nullable:!0},e.places={type:T.BaseDatabase.TYPES.MY_JSON,nullable:!0},e.images={type:T.BaseDatabase.TYPES.MY_JSON,nullable:!0},e.startTime={type:T.BaseDatabase.TYPES.DATE,nullable:!0},e.endTime={type:T.BaseDatabase.TYPES.DATE,nullable:!0},e.isTemplate={type:T.BaseDatabase.TYPES.BOOLEAN,default:0},e.type={type:T.BaseDatabase.TYPES.STRING,default:Event.TYPES.GOTTESDIENST,nullable:!0},e}},{key:"find",value:function(e,t,n,r,i){return uu(this,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return void 0===i&&(i=Event.getRelations()),o.abrupt("return",this._database.findEntities(this,e,t,n,r,i));case 2:case"end":return o.stop()}}),o,this)})))}},{key:"findAndCount",value:function(e,t,n,r,i){return uu(this,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return void 0===i&&(i=Event.getRelations()),o.abrupt("return",this._database.findAndCountEntities(this,e,t,n,r,i));case 2:case"end":return o.stop()}}),o,this)})))}},{key:"findOne",value:function(e,t,n,r){return uu(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return void 0===r&&(r=Event.getRelations()),i.abrupt("return",this._database.findOneEntity(this,e,t,n,r));case 2:case"end":return i.stop()}}),i,this)})))}},{key:"findById",value:function(e,t){return uu(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===t&&(t=Event.getRelations()),n.abrupt("return",this._database.findById(this,e,t));case 2:case"end":return n.stop()}}),n,this)})))}},{key:"findByIds",value:function(e,t){return uu(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===t&&(t=Event.getRelations()),n.abrupt("return",this._database.findByIds(this,e,t));case 2:case"end":return n.stop()}}),n,this)})))}},{key:"getRelationDefinitions",value:function(){var e=x.EasySyncBaseModel.getRelationDefinitions();return e.repeatedEvent={target:"RepeatedEvent",type:"many-to-one",nullable:!0,joinColumn:!0,inverseSide:"events"},e.organisers={target:tu.getSchemaName(),type:"many-to-many",joinTable:{name:"churchEvent"}},e.regions={target:qc.getSchemaName(),type:"many-to-many",joinTable:{name:"eventRegion"},sync:!0},e}}],(n=[{key:"getNameTranslation",value:function(){return"event-name-"+this.id}},{key:"getDescriptionTranslation",value:function(){return"event-description-"+this.id}},{key:"getDynamicTranslations",value:function(){var e=this,t={};return Object.keys(this.getNames()).forEach((function(n){t[n]=t[n]||{},t[n][e.getNameTranslation()]=e.getNames()[n]})),Object.keys(this.getDescriptions()).forEach((function(n){t[n]=t[n]||{},t[n][e.getDescriptionTranslation()]=e.getDescriptions()[n]})),t}},{key:"getNames",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getNames():this.names}},{key:"setNames",value:function(e){this.names=e}},{key:"getDescriptions",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getDescription():this.descriptions}},{key:"setDescriptions",value:function(e){this.descriptions=e}},{key:"getStartTime",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getStartTime():this.startTime}},{key:"setStartTime",value:function(e){this.startTime=e}},{key:"getEndTime",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getEndTime():this.endTime}},{key:"setEndTime",value:function(e){this.endTime=e}},{key:"getType",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getType():this.type}},{key:"setType",value:function(e){this.type=e}},{key:"getImages",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getImages():this.images}},{key:"setImages",value:function(e){this.images=e}},{key:"getOrganisers",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getOrganisers():this.organisers}},{key:"setOrganisers",value:function(e){this.organisers=e}},{key:"getPlaces",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getPlaces():this.places}},{key:"setPlaces",value:function(e){this.places=e}},{key:"getRegions",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getRegions():this.regions}},{key:"setRegions",value:function(e){this.regions=e}}])&&ru(t.prototype,n),r&&ru(t,r),Event}(AccessEasySyncModel.AccessEasySyncModel);function fu(e){return(fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}lu.TYPES={GOTTESDIENST:"gottesdienst",KONZERT:"konzert",HAUSKREIS:"hauskreis",KONFERENZ:"konferenz",GEBETSKREIS:"gebetskreis",SPORT:"sport",JUGENDKREIS:"jugendkreis",STUDENTENKREIS:"studentenkreis",SONSTIGES:"sonstiges"},lu.ACCESS_MODIFY="admin",lu.SCHEMA_NAME="Event";var du=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},pu=function(){function AddRepeatedEvent1000000007000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AddRepeatedEvent1000000007000)}var e,t,n;return e=AddRepeatedEvent1000000007000,(t=[{key:"_isServer",value:function(){return"object"!==("undefined"==typeof document?"undefined":fu(document))}},{key:"_createManyToManyTable",value:function(e,t){return qa.MigrationHelper.createManyToManyTable(e,t)}},{key:"up",value:function(e){return du(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isServer()){t.next=3;break}return t.next=3,e.query("ALTER TABLE event ENGINE=InnoDB;");case 3:return n=qa.MigrationHelper.createTableFromModelClass(xe),t.next=6,e.createTable(n);case 6:return r=qa.MigrationHelper.createTableFromModelClass(be),t.next=9,e.createTable(r);case 9:if(!this._isServer()){t.next=18;break}return t.next=12,e.query("SET foreign_key_checks=0;");case 12:return t.next=14,qa.MigrationHelper.updateModel(e,lu);case 14:return t.next=16,e.query("SET foreign_key_checks=1;");case 16:t.next=24;break;case 18:return t.next=20,e.query("PRAGMA foreign_keys = OFF");case 20:return t.next=22,qa.MigrationHelper.updateModel(e,lu);case 22:return t.next=24,e.query("PRAGMA foreign_keys = ON");case 24:case"end":return t.stop()}}),t,this)})))}},{key:"down",value:function(e){}}])&&hu(e.prototype,t),n&&hu(e,n),AddRepeatedEvent1000000007000}();function mu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var yu=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},gu=function(){function FavoriteWithoutEventRelation1000000008000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FavoriteWithoutEventRelation1000000008000)}var e,t,n;return e=FavoriteWithoutEventRelation1000000008000,(t=[{key:"up",value:function(e){return yu(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._changeFavorite(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"_changeFavorite",value:function(e){return yu(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.dropTable("favorite");case 2:return n=new Ce.Table({name:"favorite",columns:[{name:"id",isPrimary:!0,type:"integer",isGenerated:!0,generationStrategy:"increment"},{name:"eventId",type:T.BaseDatabase.TYPES.STRING},{name:"isFavorite",type:T.BaseDatabase.TYPES.BOOLEAN,default:1,isNullable:!1},{name:"systemCalendarId",type:T.BaseDatabase.TYPES.INTEGER,isNullable:!0}]}),t.next=5,e.createTable(n,!0);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))}},{key:"down",value:function(e){}}])&&mu(e.prototype,t),n&&mu(e,n),FavoriteWithoutEventRelation1000000008000}();function bu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var vu=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},wu=function(){function ClearDatabaseMigration1000000000000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ClearDatabaseMigration1000000000000)}var e,t,n;return e=ClearDatabaseMigration1000000000000,(t=[{key:"up",value:function(e){return vu(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.commitTransaction();case 2:return t.next=4,e.clearDatabase();case 4:return t.next=6,e.startTransaction();case 6:return t.next=8,e.createTable(new Ce.Table({name:"Clear_Database_Migrations",columns:[{name:"id",isPrimary:!0,type:"integer",isGenerated:!0,generationStrategy:"increment"},{name:"timestamp",type:T.BaseDatabase.TYPES.INTEGER},{name:"name",type:T.BaseDatabase.TYPES.STRING}]}));case 8:case"end":return t.stop()}}),t)})))}},{key:"down",value:function(e){}}])&&bu(e.prototype,t),n&&bu(e,n),ClearDatabaseMigration1000000000000}();function _u(e){return(_u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ku(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Eu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ou(e,t,n){return(Ou="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Cu(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Tu(e,t){return(Tu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Cu(e);if(t){var i=Cu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Su(this,n)}}function Su(e,t){return!t||"object"!==_u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cu(e){return(Cu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ru=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tu(e,t)}(o,e);var t,n,r,i=xu(o);function o(){return ku(this,o),i.apply(this,arguments)}return t=o,(n=[{key:"_createConnectionOptions",value:function(e){var t=Ou(Cu(o.prototype),"_createConnectionOptions",this).call(this,e);return Object.assign(t,{synchronize:!1,migrationsRun:!0,migrations:[wu],entities:[],migrationsTableName:"Clear_Database_Migrations"}),console.log(t),t}}])&&Eu(t.prototype,n),r&&Eu(t,r),o}(Se.EasySyncClientDb);function Pu(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Nu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Mu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,i,o;return t=e,n=null,r=[{key:"doJob",value:(i=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(new Ru)._connectionPromise);case 1:case"end":return e.stop()}}),e)})),o=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Pu(o,n,r,a,s,"next",e)}function s(e){Pu(o,n,r,a,s,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})}],n&&Nu(t.prototype,n),r&&Nu(t,r),e}();function Au(e){return(Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ju(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Iu(e,t,n){return(Iu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fu(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Du(e,t){return(Du=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fu(e);if(t){var i=Fu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Bu(this,n)}}function Bu(e,t){return!t||"object"!==Au(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fu(e){return(Fu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Du(e,t)}(FsjChurchBaseObject,e);var t,n,r,i=Lu(FsjChurchBaseObject);function FsjChurchBaseObject(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FsjChurchBaseObject),(e=i.call(this)).names=[],e.descriptions=[],e.website=null,e}return t=FsjChurchBaseObject,r=[{key:"getColumnDefinitions",value:function(){var e=Iu(Fu(FsjChurchBaseObject),"getColumnDefinitions",this).call(this);return e.names=T.BaseDatabase.TYPES.MY_JSON,e.descriptions=T.BaseDatabase.TYPES.MY_JSON,e.website=T.BaseDatabase.TYPES.STRING,e}}],(n=[{key:"getNameTranslation",value:function(){return this.constructor.getSchemaName()+"-name-"+this.id}},{key:"getDescriptionTranslation",value:function(){return this.constructor.getSchemaName()+"-description-"+this.id}},{key:"getDynamicTranslations",value:function(){var e=this,t={};return Object.keys(this.names).forEach((function(n){t[n]=t[n]||{},t[n][e.getNameTranslation()]=e.names[n]})),Object.keys(this.descriptions).forEach((function(n){t[n]=t[n]||{},t[n][e.getDescriptionTranslation()]=e.descriptions[n]})),t}}])&&ju(t.prototype,n),r&&ju(t,r),FsjChurchBaseObject}(AccessEasySyncModel.AccessEasySyncModel);function Vu(e){return(Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hu(e,t){return(Hu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Yu(e);if(t){var i=Yu(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Wu(this,n)}}function Wu(e,t){return!t||"object"!==Vu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yu(e){return(Yu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hu(e,t)}(Fsj,e);var t,n,r,i=zu(Fsj);function Fsj(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Fsj),i.call(this)}return t=Fsj,r=[{key:"getRelationDefinitions",value:function(){var e=x.EasySyncBaseModel.getRelationDefinitions();return e.images={target:x.FileMedium.getSchemaName(),type:"many-to-many",joinTable:{name:"fsjImages"},sync:!0},e}}],(n=null)&&Uu(t.prototype,n),r&&Uu(t,r),Fsj}(qu);function Gu(e){return(Gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ju(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ku(e,t,n){return(Ku="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=el(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function $u(e,t){return($u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=el(e);if(t){var i=el(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Zu(this,n)}}function Zu(e,t){return!t||"object"!==Gu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function el(e){return(el=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Qu.ACCESS_MODIFY="admin",Qu.SCHEMA_NAME="Fsj";var tl=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},nl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$u(e,t)}(Event,e);var t,n,r,i=Xu(Event);function Event(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Event),(e=i.call(this)).isTemplate=!1,e.names=null,e.descriptions=null,e.startTime=null,e.endTime=null,e.type=null,e.organisers=null,e.places=[],e.regions=null,e.isTemplate=!1,e}return t=Event,r=[{key:"getRelations",value:function(){var e=Ku(el(Event),"getRelations",this).call(this);return e.push("repeatedEvent.originalEvent"),e.push("repeatedEvent.originalEvent.images"),e.push("repeatedEvent.originalEvent.organisers"),e}},{key:"getColumnDefinitions",value:function(){var e=Ku(el(Event),"getColumnDefinitions",this).call(this);return e.names={type:S.BaseDatabase.TYPES.MY_JSON,nullable:!0},e.descriptions={type:S.BaseDatabase.TYPES.MY_JSON,nullable:!0},e.places={type:S.BaseDatabase.TYPES.MY_JSON,nullable:!0},e.startTime={type:S.BaseDatabase.TYPES.DATE,nullable:!0},e.endTime={type:S.BaseDatabase.TYPES.DATE,nullable:!0},e.isTemplate={type:S.BaseDatabase.TYPES.BOOLEAN,default:!1},e.type={type:S.BaseDatabase.TYPES.STRING,default:Event.TYPES.GOTTESDIENST,nullable:!0},e}},{key:"find",value:function(e,t,n,r,i){return tl(this,void 0,void 0,regeneratorRuntime.mark((function o(){var a;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return void 0===i&&(i=Event.getRelations()),X.Helper.isNull(e)&&(e={}),Array.isArray(e)||(e=[e]),a=[],e.forEach((function(e){X.Helper.isSet(e,"isTemplate")||"object"!==("undefined"==typeof document?"undefined":Gu(document))?"false"===e.isTemplate?e.isTemplate=!1:"true"===e.isTemplate&&(e.isTemplate=!0):e.isTemplate=!1,a.push(e);var t={};Object.keys(e).forEach((function(n){return t[n]=e[n]})),t.isTemplate=t.isTemplate?"true":"false",a.push(t)})),o.abrupt("return",this._database.findEntities(this,a,t,n,r,i));case 6:case"end":return o.stop()}}),o,this)})))}},{key:"findAndCount",value:function(e,t,n,r,i){return tl(this,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return void 0===i&&(i=Event.getRelations()),X.Helper.isNull(e)&&(e={}),X.Helper.isSet(e,"isTemplate")||"object"!==("undefined"==typeof document?"undefined":Gu(document))||(e.isTemplate=!1),o.abrupt("return",this._database.findAndCountEntities(this,e,t,n,r,i));case 4:case"end":return o.stop()}}),o,this)})))}},{key:"findOne",value:function(e,t,n,r){return tl(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return void 0===r&&(r=Event.getRelations()),X.Helper.isNull(e)&&(e={}),X.Helper.isSet(e,"isTemplate")||"object"!==("undefined"==typeof document?"undefined":Gu(document))||(e.isTemplate=!1),i.abrupt("return",this._database.findOneEntity(this,e,t,n,r));case 4:case"end":return i.stop()}}),i,this)})))}},{key:"findById",value:function(e,t){return tl(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===t&&(t=Event.getRelations()),n.next=3,this._database.findById(this,e,t);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"findByIds",value:function(e,t){return tl(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===t&&(t=Event.getRelations()),r=[],n.next=4,this._database.findByIds(this,e,t);case 4:return i=n.sent,"object"===("undefined"==typeof document?"undefined":Gu(document))&&i.forEach((function(e){e.getIsTemplate()||r.push(e)})),n.abrupt("return",i);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getRelationDefinitions",value:function(){var e=x.EasySyncBaseModel.getRelationDefinitions();return e.repeatedEvent={target:"RepeatedEvent",type:"many-to-one",nullable:!0,joinColumn:!0,inverseSide:"events"},e.organisers={target:bl.getSchemaName(),type:"many-to-many",joinTable:{name:"churchEvent"}},e.regions={target:ll.getSchemaName(),type:"many-to-many",joinTable:{name:"eventRegion"},sync:!0},e.images={target:x.FileMedium.getSchemaName(),type:"many-to-many",joinTable:{name:"eventImages"},sync:!0},e}}],(n=[{key:"getNameTranslation",value:function(){return"event-name-"+this.id}},{key:"getDescriptionTranslation",value:function(){return"event-description-"+this.id}},{key:"getDynamicTranslations",value:function(){var e=this,t={};return Object.keys(this.getNames()).forEach((function(n){t[n]=t[n]||{},t[n][e.getNameTranslation()]=e.getNames()[n]})),Object.keys(this.getDescriptions()).forEach((function(n){t[n]=t[n]||{},t[n][e.getDescriptionTranslation()]=e.getDescriptions()[n]})),t}},{key:"getNames",value:function(){return X.Helper.isNull(this.names)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getNames():this.names}},{key:"setNames",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getNames(),e)?this.names=null:this.names=e}},{key:"getDescriptions",value:function(){return X.Helper.isNull(this.descriptions)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getDescriptions():this.descriptions}},{key:"setDescriptions",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getDescriptions(),e)?this.descriptions=null:this.descriptions=e}},{key:"getStartTime",value:function(){return X.Helper.isNull(this.startTime)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getStartTime():this.startTime}},{key:"setStartTime",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getStartTime(),e)?this.startTime=null:this.startTime=e}},{key:"getEndTime",value:function(){return X.Helper.isNull(this.endTime)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getEndTime():this.endTime}},{key:"setEndTime",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getEndTime(),e)?this.endTime=null:this.endTime=e}},{key:"getType",value:function(){return X.Helper.isNull(this.type)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getType():this.type}},{key:"setType",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&this.repeatedEvent.getType()==e?this.type=null:this.type=e}},{key:"getImages",value:function(){return X.Helper.isNull(this.images)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getImages():this.images}},{key:"setImages",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getImages(),e)?this.images=null:this.images=e}},{key:"getOrganisers",value:function(){return X.Helper.isNull(this.organisers)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getOrganisers():this.organisers}},{key:"setOrganisers",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&ee.BaseModel.equals(this.repeatedEvent.getOrganisers(),e)?this.organisers=null:this.organisers=e}},{key:"getPlaces",value:function(){return X.Helper.isNull(this.places)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getPlaces():this.places}},{key:"setPlaces",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&Z.JsonHelper.deepEqual(this.repeatedEvent.getPlaces(),e)?this.places=null:this.places=e}},{key:"getRegions",value:function(){return X.Helper.isNull(this.regions)&&X.Helper.isNotNull(this.repeatedEvent)?this.repeatedEvent.getRegions():this.regions}},{key:"setRegions",value:function(e){!this.getIsTemplate()&&X.Helper.isNotNull(this.repeatedEvent)&&ee.BaseModel.equals(this.repeatedEvent.getRegions(),e)?this.regions=null:this.regions=e}},{key:"getIsTemplate",value:function(){return this.isTemplate}},{key:"setIsTemplate",value:function(e){this.isTemplate=e}}])&&Ju(t.prototype,n),r&&Ju(t,r),Event}(AccessEasySyncModel.AccessEasySyncModel);function rl(e){return(rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function il(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ol(e,t,n){return(ol="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ul(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function al(e,t){return(al=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ul(e);if(t){var i=ul(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return cl(this,n)}}function cl(e,t){return!t||"object"!==rl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ul(e){return(ul=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}nl.TYPES={GOTTESDIENST:"gottesdienst",KONZERT:"konzert",HAUSKREIS:"hauskreis",KONFERENZ:"konferenz",GEBETSKREIS:"gebetskreis",SPORT:"sport",JUGENDKREIS:"jugendkreis",STUDENTENKREIS:"studentenkreis",SONSTIGES:"sonstiges"},nl.ACCESS_MODIFY="admin",nl.SCHEMA_NAME="Event";var ll=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&al(e,t)}(Region,e);var t,n,r,i=sl(Region);function Region(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Region),(e=i.call(this)).name=null,e.churches=null,e.events=null,e}return t=Region,r=[{key:"getColumnDefinitions",value:function(){var e=ol(ul(Region),"getColumnDefinitions",this).call(this);return e.name={type:T.BaseDatabase.TYPES.STRING},e}},{key:"getRelationDefinitions",value:function(){var e=x.EasySyncBaseModel.getRelationDefinitions();return e.churches={target:bl.getSchemaName(),type:"many-to-many",joinTable:{name:"churchRegion"},inverseSide:"regions",sync:!1},e.events={target:nl.getSchemaName(),type:"many-to-many",joinTable:{name:"eventRegion"},inverseSide:"regions",sync:!1},e}}],(n=[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"setChurches",value:function(e){this.churches=e}},{key:"getChurches",value:function(){return this.churches}}])&&il(t.prototype,n),r&&il(t,r),Region}(AccessEasySyncModel.AccessEasySyncModel);function fl(e){return(fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dl(e,t,n){return(dl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gl(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function pl(e,t){return(pl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ml(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gl(e);if(t){var i=gl(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return yl(this,n)}}function yl(e,t){return!t||"object"!==fl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gl(e){return(gl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}ll.ACCESS_MODIFY="admin",ll.SCHEMA_NAME="Region";var bl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pl(e,t)}(Church,e);var t,n,r,i=ml(Church);function Church(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Church),(e=i.call(this)).places=[],e}return t=Church,r=[{key:"getColumnDefinitions",value:function(){var e=dl(gl(Church),"getColumnDefinitions",this).call(this);return e.places=T.BaseDatabase.TYPES.MY_JSON,e}},{key:"getRelationDefinitions",value:function(){var e=EasySyncBaseModel.EasySyncBaseModel.getRelationDefinitions();return e.regions={target:ll.getSchemaName(),type:"many-to-many",joinTable:{name:"churchRegion"},sync:!0},e.images={target:x.FileMedium.getSchemaName(),type:"many-to-many",joinTable:{name:"churchImages"},sync:!0},e}}],(n=null)&&hl(t.prototype,n),r&&hl(t,r),Church}(qu);function vl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}bl.ACCESS_MODIFY="admin",bl.SCHEMA_NAME="Church";var wl=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},_l=function(){function ImagesSchema1000000010000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ImagesSchema1000000010000)}var e,t,n;return e=ImagesSchema1000000010000,(t=[{key:"up",value:function(e){return wl(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!qa.MigrationHelper.isServer()){t.next=5;break}return t.next=3,e.query("ALTER TABLE church ENGINE=InnoDB;");case 3:return t.next=5,e.query("ALTER TABLE fsj ENGINE=InnoDB;");case 5:return t.next=7,e.hasTable("file_medium");case 7:if(t.sent){t.next=12;break}return(n=qa.MigrationHelper.createTableFromModelClass(x.FileMedium)).columns.forEach((function(e){"src"===e.name&&(e.type=qa.MigrationHelper.isServer()?"MEDIUMTEXT":"TEXT")})),t.next=12,e.createTable(n);case 12:return(r=qa.MigrationHelper.createManyToManyTable("fsj","fileMedium")).name="fsjImages",(i=qa.MigrationHelper.createManyToManyTable("church","fileMedium")).name="churchImages",(o=qa.MigrationHelper.createManyToManyTable("event","fileMedium")).name="eventImages",t.next=20,e.createTable(i);case 20:return t.next=22,e.createTable(r);case 22:return t.next=24,e.createTable(o);case 24:if(!qa.MigrationHelper.isServer()){t.next=53;break}return t.next=27,e.query("SET foreign_key_checks=0;");case 27:return t.next=29,e.query("INSERT INTO file_medium (id, createdAt, updatedAt, version, deleted, src) SELECT id, now(), now(), 1, 0, SUBSTRING(images, 3, LENGTH(images)-4) FROM fsj");case 29:return t.next=31,e.query("INSERT INTO fsjImages (fsjId, fileMediumId) SELECT id, id FROM fsj");case 31:return t.next=33,e.query("SELECT MAX(id) AS maxId FROM file_medium");case 33:return a=t.sent[0].maxId,a++,t.next=37,e.query("INSERT INTO file_medium (id, createdAt, updatedAt, version, deleted, src) SELECT id+"+a+", now(), now(), 1, 0, SUBSTRING(images, 3, LENGTH(images)-4) FROM church");case 37:return t.next=39,e.query("INSERT INTO churchImages (churchId, fileMediumId) SELECT id, id+"+a+" FROM church");case 39:return t.next=41,e.query("SELECT MAX(id) AS maxId FROM file_medium");case 41:return a=t.sent[0].maxId,a++,t.next=45,e.query("INSERT INTO file_medium (id, createdAt, updatedAt, version, deleted, src) SELECT id+"+a+", now(), now(), 1, 0, SUBSTRING(images, 3, LENGTH(images)-4) FROM event WHERE event.images IS NOT NULL");case 45:return t.next=47,e.query("INSERT INTO eventImages (eventId, fileMediumId) SELECT id, id+"+a+" FROM event");case 47:return t.next=49,e.query("UPDATE fsj SET updatedAt = now();");case 49:return t.next=51,e.query("UPDATE church SET updatedAt = now();");case 51:return t.next=53,e.query("UPDATE event SET updatedAt = now();");case 53:return t.next=55,qa.MigrationHelper.updateModel(e,Qu);case 55:return t.next=57,qa.MigrationHelper.updateModel(e,bl);case 57:return t.next=59,qa.MigrationHelper.updateModel(e,nl);case 59:if(!qa.MigrationHelper.isServer()){t.next=64;break}return t.next=62,e.query("SET foreign_key_checks=1;");case 62:t.next=66;break;case 64:return t.next=66,e.query("PRAGMA foreign_keys = ON");case 66:case"end":return t.stop()}}),t)})))}},{key:"down",value:function(e){}}])&&vl(e.prototype,t),n&&vl(e,n),ImagesSchema1000000010000}();function kl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var El=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ol=function(){function ImagesSchemaDownload1000000011000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ImagesSchemaDownload1000000011000)}var e,t,n;return e=ImagesSchemaDownload1000000011000,(t=[{key:"up",value:function(e){return El(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!qa.MigrationHelper.isServer()){t.next=9;break}return t.next=3,e.query("SET foreign_key_checks=0;");case 3:return t.next=5,qa.MigrationHelper.updateModel(e,x.FileMedium);case 5:return t.next=7,e.query("SET foreign_key_checks=1;");case 7:t.next=19;break;case 9:return t.next=11,e.commitTransaction();case 11:return t.next=13,e.startTransaction();case 13:return t.next=15,e.query("PRAGMA foreign_keys = OFF");case 15:return t.next=17,qa.MigrationHelper.updateModel(e,x.FileMedium);case 17:return t.next=19,e.query("PRAGMA foreign_keys = ON");case 19:case"end":return t.stop()}}),t)})))}},{key:"down",value:function(e){}}])&&kl(e.prototype,t),n&&kl(e,n),ImagesSchemaDownload1000000011000}();function Tl(e){return(Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sl(e,t,n){return(Sl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Nl(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Cl(e,t){return(Cl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Nl(e);if(t){var i=Nl(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Pl(this,n)}}function Pl(e,t){return!t||"object"!==Tl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nl(e){return(Nl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ml=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Al=n(577),jl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cl(e,t)}(a,e);var t,n,r,i=Rl(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e,Al)}return t=a,(n=[{key:"onViewLoaded",value:function(){var e=this,t=Sl(Nl(a.prototype),"onViewLoaded",this).call(this);return this.findBy("#contactText").appendChild(Kn.Translator.makePersistentTranslation("contact text",["kontakt@echoapp.de"])),new o.Form(this.findBy("#contact-form"),(function(t){return Ml(e,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$n.DataManager.send("contact",t);case 2:(n=e.sent).success?(new Bi.Toast("Die Nachricht wurde gesendet!").show(),this.finish()):n?new Bi.Toast(n.message).show():new Bi.Toast("Es ist ein Fehler aufgetreten...").show();case 4:case"end":return e.stop()}}),e,this)})))})),t}}])&&xl(t.prototype,n),r&&xl(t,r),a}(mt);Pe.App.addInitialization((function(e){e.addDeepLink("contact",jl)}));var Il=n(306),Dl=n.n(Il);function Ll(e){return(Ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bl(e,t){return(Bl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vl(e);if(t){var i=Vl(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ql(this,n)}}function ql(e,t){return!t||"object"!==Ll(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vl(e){return(Vl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ul=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bl(e,t)}(n,e);var t=Fl(n);function n(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t.call(this,e,Dl.a)}return n}(mt);Pe.App.addInitialization((function(e){e.addDeepLink("aboutUs",Ul)}));var Hl=function(){return window.BackgroundFetch},zl=function(){function e(){}return Object.defineProperty(e,"STATUS_RESTRICTED",{get:function(){return Hl().STATUS_RESTRICTED},enumerable:!1,configurable:!0}),Object.defineProperty(e,"STATUS_DENIED",{get:function(){return Hl().STATUS_DENIED},enumerable:!1,configurable:!0}),Object.defineProperty(e,"STATUS_AVAILABLE",{get:function(){return Hl().STATUS_AVAILABLE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FETCH_RESULT_NEW_DATA",{get:function(){return Hl().FETCH_RESULT_NEW_DATA},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FETCH_RESULT_NO_DATA",{get:function(){return Hl().FETCH_RESULT_NO_DATA},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FETCH_RESULT_FAILED",{get:function(){return Hl().FETCH_RESULT_FAILED},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NETWORK_TYPE_NONE",{get:function(){return Hl().NETWORK_TYPE_NONE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NETWORK_TYPE_ANY",{get:function(){return Hl().NETWORK_TYPE_ANY},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NETWORK_TYPE_UNMETERED",{get:function(){return Hl().NETWORK_TYPE_UNMETERED},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NETWORK_TYPE_NOT_ROAMING",{get:function(){return Hl().NETWORK_TYPE_NOT_ROAMING},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NETWORK_TYPE_CELLULAR",{get:function(){return Hl().NETWORK_TYPE_CELLULAR},enumerable:!1,configurable:!0}),e.configure=function(){var e=Hl();return e.configure.apply(e,arguments)},e.finish=function(e){var t=Hl();return t.finish.apply(t,arguments)},e.start=function(){var e=Hl();return e.start.apply(e,arguments)},e.scheduleTask=function(e,t,n){var r=Hl();return r.scheduleTask.apply(r,arguments)},e.stopTask=function(e,t,n){var r=Hl();return r.stopTask.apply(r,arguments)},e.stop=function(){var e=Hl();return e.stop.apply(e,arguments)},e.status=function(){var e=Hl();return e.status.apply(e,arguments)},e}(),Wl=n(212);function Yl(e){return(Yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ql(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jl(e,t){return(Jl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xl(e);if(t){var i=Xl(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return $l(this,n)}}function $l(e,t){return!t||"object"!==Yl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xl(e){return(Xl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zl=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ef=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jl(e,t)}(o,e);var t,n,r,i=Kl(o);function o(){var e;return Ql(this,o),(e=i.apply(this,arguments)).syncInProgress=null,e}return t=o,r=[{key:"initializeBackgroundFetch",value:function(){var e=this;Ne.NativeStoragePromise.getItem("num-background-fetches",0).then((function(e){return console.log("num background fetches since last time: ",e)})).then((function(){Ne.NativeStoragePromise.setItem("num-background-fetches",0)})),zl.configure((function(t){return Zl(e,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Ne.NativeStoragePromise,e.next=3,Ne.NativeStoragePromise.getItem("num-background-fetches",0);case 3:return e.t1=e.sent,e.t2=e.t1+1,e.t0.setItem.call(e.t0,"num-background-fetches",e.t2),n=this.getInstance(),r=n.sync(!1),i=new Promise((function(e){return setTimeout(e,29e3)})),e.next=11,Promise.race([r,i]);case 11:zl.finish(t);case 12:case"end":return e.stop()}}),e,this)})))}),(function(t){return Zl(e,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[background-sync]",t),e.next=3,Ne.NativeStoragePromise.getItem("background-error-obj",[]);case 3:return(n=e.sent).push(t),e.next=7,Ne.NativeStoragePromise.setItem("background-error-obj",n);case 7:case"end":return e.stop()}}),e)})))}),{minimumFetchInterval:5,stopOnTerminate:!1,startOnBoot:!0,requiredNetworkType:zl.NETWORK_TYPE_ANY})}}],(n=[{key:"sync",value:function(e){return Zl(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===this.syncInProgress){t.next=2;break}return t.abrupt("return",this.syncInProgress);case 2:return this.syncInProgress=new Promise((function(t){return Zl(n,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=new Wl.SyncJob,n.next=3,r.syncInBackgroundIfDataExists([$,ue,I,Ii,Za,xe,be,FileMedium.FileMedium],!1).catch((function(e){return console.error(e)}));case 3:if(i=r.getSyncPromise().then((function(e){return Zl(o,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,or.updateFavorites(e.BlockedDay);case 2:return t.next=4,or.updateNotificationsForEvents(e.Event.changed);case 4:return t.next=6,or.deleteNotificationsForEvents(e.Event.deleted);case 6:case"end":return t.stop()}}),t)})))})).catch((function(e){return console.error(e)})),!X.Helper.nonNull(e,!0)){n.next=7;break}return n.next=7,i;case 7:this.syncInProgress=null,t(void 0);case 9:case"end":return n.stop()}}),n,this)})))})),t.abrupt("return",this.syncInProgress);case 4:case"end":return t.stop()}}),t,this)})))}}])&&Gl(t.prototype,n),r&&Gl(t,r),o}(Re.Singleton);function tf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}o.App.addInitialization((function(){ef.initializeBackgroundFetch()}));var nf=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},rf=function(){function EventWeblink1000000012000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EventWeblink1000000012000)}var e,t,n;return e=EventWeblink1000000012000,(t=[{key:"up",value:function(e){return nf(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._addWeblink(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"_addWeblink",value:function(e){return nf(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.addColumn("event",new Ce.TableColumn({name:"website",type:S.BaseDatabase.TYPES.STRING,isNullable:!0}));case 2:case"end":return t.stop()}}),t)})))}},{key:"down",value:function(e){}}])&&tf(e.prototype,t),n&&tf(e,n),EventWeblink1000000012000}();function of(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var af=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},sf=function(){function ChurchInstalink1000000013000(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ChurchInstalink1000000013000)}var e,t,n;return e=ChurchInstalink1000000013000,(t=[{key:"up",value:function(e){return af(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._addWeblink(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"_addWeblink",value:function(e){return af(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.addColumn("church",new Ce.TableColumn({name:"instagram",type:S.BaseDatabase.TYPES.STRING,isNullable:!0}));case 2:case"end":return t.stop()}}),t)})))}},{key:"down",value:function(e){}}])&&of(e.prototype,t),n&&of(e,n),ChurchInstalink1000000013000}(),cf=n(165);function uf(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function lf(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){uf(o,r,i,a,s,"next",e)}function s(e){uf(o,r,i,a,s,"throw",e)}a(void 0)}))}}window.JSObject=Object,window.version="0.1.1",s.EasySyncClientDb.BASE_MODEL=x.EasySyncBaseModel,rt.LoginSite.ADD_LOGIN_ACTION=!1,rt.RegistrationSite.ADD_REGISTRATION_ACTION=!1,o.App.setLogo(Na.a),cf.MatomoHelper.start("https://matomo.echoapp.de",1,"m"),o.App.addInitialization(function(){var e=lf(regeneratorRuntime.mark((function e(t){var n,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ra[Math.floor(Math.random()*Ra.length)],document.head.prepend(document.createComment(n.vers+" \n- "+n.stelle+" ("+n.uebersetzung+")")),window.StatusBar&&(StatusBar.overlaysWebView(!0),StatusBar.backgroundColorByHexString("#33000000")),window.missingTranslations={},o.Translator.init({translations:{de:r,en:i},fallbackLanguage:"de",markUntranslatedTranslations:!1,logMissingTranslations:function(e,t){window.missingTranslations[t]=a.Helper.nonNull(window.missingTranslations[t],[]),window.missingTranslations[t].push(e),!1!==window.shouldConsoleMissingTranslation&&console.error("missing translation for language >"+t+"< and key >"+e+"<")}}),a.DateHelper.setTranslationCallback((function(e){return o.Translator.makePersistentTranslation(e).outerHTML})),o.NavbarFragment.title="",o.NavbarFragment.defaultActions.push(new o.StartSiteMenuAction("events",Vr)),o.NavbarFragment.defaultActions.push(new o.StartSiteMenuAction("churches",ba)),o.NavbarFragment.defaultActions.push(new o.StartSiteMenuAction("about us",Ul)),(s=new o.MenuAction("language",lf(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("en"!==o.Translator.getInstance().getCurrentLanguage()){e.next=5;break}return e.next=3,o.Translator.getInstance().setLanguage("de");case 3:e.next=7;break;case 5:return e.next=7,o.Translator.getInstance().setLanguage("en");case 7:case"end":return e.stop()}}),e)}))))).setLiClass("language-action show-for-medium"),(c=new o.MenuAction("language",lf(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("en"!==o.Translator.getInstance().getCurrentLanguage()){e.next=5;break}return e.next=3,o.Translator.getInstance().setLanguage("de");case 3:e.next=7;break;case 5:return e.next=7,o.Translator.getInstance().setLanguage("en");case 7:case"end":return e.stop()}}),e)}))),void 0,1)).setLiClass("language-action-mobile hide-for-medium"),o.NavbarFragment.defaultActions.push(s),o.NavbarFragment.defaultActions.push(c),a.Helper.isMobileApp()&&o.NavbarFragment.defaultActions.push(new o.StartSiteMenuAction("settings",Mc,o.MenuAction.SHOW_NEVER,99e3)),o.NavbarFragment.defaultActions.push(new o.StartSiteMenuAction("contact",jl,o.MenuAction.SHOW_NEVER)),o.NavbarFragment.defaultActions.push(new o.StartSiteMenuAction("imprint",Ca,o.MenuAction.SHOW_NEVER)),o.NavbarFragment.defaultActions.push(new rt.UserMenuAction("add event","events",(function(){t.startSite(sn)}),o.MenuAction.SHOW_FOR_MEDIUM)),o.NavbarFragment.defaultActions.push(new rt.UserMenuAction("add church","organisers",(function(){t.startSite(Ao)}),o.MenuAction.SHOW_FOR_MEDIUM)),o.NavbarFragment.defaultActions.push(new rt.UserMenuAction("add fsj","fsjs",(function(){t.startSite(Ns)}),o.MenuAction.SHOW_FOR_MEDIUM)),o.DataManager.setHeader("Accept-Language","de-DE,dias;q=0.5"),e.next=25,ef.getInstance().sync(!1);case 25:rt.UserManager.getInstance().getMe().catch((function(e){return console.error(e)}));try{(function e(){document.body.style.height=window.innerHeight+"px",setTimeout(e,350)})()}catch(e){}case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),er.NAME="echo",er.WEBSITE="echoapp.de",o.DataManager._basePath="https://echoapp.de/api/v1/",x.FileMedium.PUBLIC_PATH="https://echoapp.de/uploads/img_",o.DataManager.onlineCallback=function(e){e||console.log("not (yet) online!")},Object.assign(T.BaseDatabase.CONNECTION_OPTIONS,{logging:["error","warn"],synchronize:!1,migrationsRun:!0,migrations:[Ia,Fa,Da.SetupUserManagement1000000001000,s.SetupEasySync1000000000500,FavoriteWithSystemCalendar1000000000002,za,pu,gu,_l,Ol,rf,sf]}),s.EasySyncClientDb.errorListener=function(){var e=lf(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.error(t),e.next=3,Mu.doJob();case 3:return e.abrupt("return",new Promise((function(e){setTimeout((function(){e(window.location.reload(!0))}),300)})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne.NativeStoragePromise.prefix="functional_",Ne.NativeStoragePromise.persistent=!1,(new o.App).start(uo).catch((function(e){return console.error(e)})).then(lf(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("initialisation done!",new Date),"browser"!==device.platform){e.next=13;break}return e.next=4,Xe.mustAskForConsent();case 4:if(!e.sent){e.next=9;break}return e.next=7,Xe.showCookieDialog();case 7:e.next=11;break;case 9:return e.next=11,Ne.NativeStoragePromise.makePersistent();case 11:e.next=23;break;case 13:return e.next=15,Xe.mustAskForConsent();case 15:if(!e.sent){e.next=18;break}return e.next=18,Xe.giveConsentToCookies(["functional","statistic","thirdParty"]);case 18:return e.next=20,Xe.hasConsent("functional");case 20:if(!e.sent){e.next=23;break}return e.next=23,Ne.NativeStoragePromise.makePersistent();case 23:window.queryDb=function(){var e=lf(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.EasySyncClientDb.getInstance().rawQuery(t);case 2:return n=e.sent,console.log(n),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();case 24:case"end":return e.stop()}}),e)}))))}]);